(function(t){function e(e){for(var r,o,s=e[0],c=e[1],l=e[2],d=0,h=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&h.push(i[o][0]),i[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(h.length)h.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},i={app:0},a=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"03fb":function(t,e,n){},"0429":function(t,e,n){},"0676":function(t,e,n){},"078d":function(t,e,n){"use strict";n("73ee")},"07aa":function(t,e,n){},"0824":function(t,e,n){},"0868":function(t,e,n){},"08ba":function(t,e,n){"use strict";n("da20")},"08f3":function(t,e,n){"use strict";n.d(e,"s",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"t",(function(){return o})),n.d(e,"h",(function(){return s})),n.d(e,"u",(function(){return c})),n.d(e,"v",(function(){return l})),n.d(e,"r",(function(){return h})),n.d(e,"A",(function(){return f})),n.d(e,"B",(function(){return m})),n.d(e,"w",(function(){return p})),n.d(e,"x",(function(){return v})),n.d(e,"C",(function(){return g})),n.d(e,"D",(function(){return w})),n.d(e,"z",(function(){return x})),n.d(e,"E",(function(){return y})),n.d(e,"i",(function(){return C})),n.d(e,"q",(function(){return k})),n.d(e,"y",(function(){return S})),n.d(e,"m",(function(){return _})),n.d(e,"j",(function(){return A})),n.d(e,"o",(function(){return I})),n.d(e,"a",(function(){return T})),n.d(e,"d",(function(){return O})),n.d(e,"e",(function(){return E})),n.d(e,"f",(function(){return M})),n.d(e,"g",(function(){return L})),n.d(e,"l",(function(){return N})),n.d(e,"k",(function(){return D})),n.d(e,"p",(function(){return F})),n.d(e,"n",(function(){return P}));n("e47f"),n("7e9b"),n("09ae");var r={Success:0,NotLogin:1,Err:2,ArgumentErr:3,VCode:4,NotEmailChecked:5},i={WEB:0,ANDROID:1,IOS:2,CUSTOM:3},a={PX:0,DP:1,PT:2},o={NONE:0,PNG:1,SVG:2,WEBP:4,JPG:8},s={ALL:0,XD:1,SKETCH:2,PHOTOSHOP:4,FIGMA:8,getFileExt:function(t){switch(t){case this.XD:return".xd";case this.SKETCH:return".sketch";case this.PHOTOSHOP:return".psd";case this.FIGMA:return".fig";default:return".unknow"}}},c={PASSTHROUGH:"pass-through",NORMAL:"Normal",DARKEN:"Darken",MULTIPLY:"Multiply",COLOR_BURN:"ColorBurn",LIGHTEN:"Lighten",SCREEN:"Screen",COLOR_DODGE:"ColorDodge",OVERLAY:"Overlay",SOFT_LIGHT:"SoftLight",HARD_LIGHT:"HardLight",DIFFERENCE:"Difference",EXCLUSION:"Exclusion",HUE:"Hue",SATURATION:"Saturation",COLOR:"Color",LUMINOSITY:"Luminosity"},l=b(c),u={Thin:100,ExtraLight:200,Light:300,Normal:400,Medium:500,SemiBold:600,Bold:700,ExtraBold:800,Black:900},d=(b(u),{100:"Thin",200:"ExtraLight",300:"Light",400:"Normal",500:"Medium",600:"Semibold",700:"Bold",800:"ExtraBold",900:"Black"}),h=d,f={Layer:0,Group:1,Page:2,Artboard:3,Shape:4,Image:5,ShapePath:6,Text:7,SymbolMaster:8,SymbolInstance:9,HotSpot:10,Slice:11,StyledLayer:12},m={Rectangle:0,Oval:1,Triangle:2,Polygon:3,Star:4,Custom:5},p={left:0,right:1,center:2,justify:3};function b(t){var e={};return Object.keys(t).forEach((function(n){e[t[n]]=n})),e}var v=b(p),g={top:0,center:1,bottom:2},w=b(g),x={Color:0,Gradient:1,Pattern:4},y=(b(x),{Linear:0,Radial:1,Angular:2}),C={None:0,FillColor:1,LinearGradientFill:2,ImageFill:3,RadialGradientFill:4,AngularGradientFill:5},k={Transparent:0,White:1,Black:2},S={Gaussian:0,Motion:1,Zoom:2,Background:3},_={ArtboardList:0,ArtboardDetail:1,ImageViewer:2},A={Success:0,WebUser_NotLogin:1,Err:2,ArgumentErr:3,VCode:4,NotEmailChecked:5,CloudRank_NotComment:6,CloudRank_SourceFile:7},I={None:0,Artboard_Comment:1,Artboard_Reply:2,Artboard_Comment_At:4,Artboard_Reply_At:8},T="allfolders.opened",O="cloudfolders.visible",E={Folder:0,File:1,Artboard:2},M={Name:0,Date:1,ArtboardRect:2},L={All:0,Artboard:1},N={Small:0,Normal:1,Big:2},D={Other:0,Url:1,XD:2,Sketch:3,XDPlugin:4,SketchPlugin:5,Word:6,PPT:7,Excel:8,Txt:9,Html:10,Image:11,Pdf:12,Zip:13,AxureExport:14,App:15,Dmg:16,PhotoShop:17,AdobeIllustrator:18,AfterEffects:19,Media:20,AxureSourceFile:21,Figma:22,Font:23,AndroidApp:24,Package:25,Lottie:26,getName:function(t,e){var n;switch(e){case N.Small:n="fs-";break;case N.Big:n="fb-";break;default:n="fn-";break}var r=["other","url","xd","sketch","xd-plugin","sketch-plugin","word","ppt","excel","txt","html","image","pdf","zip","axure-export","app","dmg","photoshop","adobe-illustrator","after-effects","media","axure-source","figma","font","apk","package","lottie"],i=r[t];return i||(i=r[0]),n+i},isSupportOnlineViewType:function(t){switch(t){case D.Html:case D.Url:case D.Image:case D.Pdf:case D.AxureExport:case D.Media:case D.Txt:case D.Lottie:return!0}return!1}},F={Folder:0,Artboard:1,File:2},P={Normal:0,File:1,Interaction:2}},"097d":function(t,e,n){},"09a1":function(t,e,n){},"09b4":function(t,e,n){},"0bb5":function(t,e,n){"use strict";n("b4bc")},"0c49":function(t,e,n){"use strict";n("6f25")},"0cbc":function(t,e,n){},"0e27":function(t,e,n){},"0e3c":function(t,e,n){},"12ff":function(t,e,n){"use strict";n("14ad")},1429:function(t,e,n){},"14ad":function(t,e,n){},"14eb":function(t,e,n){},1596:function(t,e,n){"use strict";n("7043")},"16a2":function(t,e,n){},1781:function(t,e,n){"use strict";n("ff09")},"18a8":function(t,e,n){"use strict";n("a8e1")},"1a31":function(t,e,n){},"1a71":function(t,e,n){"use strict";n("2c4a")},"1a83":function(t,e,n){},"1ab9":function(t,e,n){},"1c5e":function(t,e,n){"use strict";n("5c8b")},"1e67":function(t,e,n){},"20c0":function(t,e,n){"use strict";n("646d")},2104:function(t,e,n){"use strict";n("42e1")},"222e":function(t,e,n){},"231b":function(t,e,n){},"237b":function(t,e,n){},2493:function(t,e,n){},"276f":function(t,e,n){"use strict";n("5880")},"27ee":function(t,e,n){},2838:function(t,e,n){"use strict";n("4879")},2893:function(t,e,n){"use strict";n("9d95")},"28cf":function(t,e,n){"use strict";n("4485")},2903:function(t,e,n){"use strict";n("aed7")},"2a9c":function(t,e,n){},"2aef":function(t,e,n){},"2c4a":function(t,e,n){},"2e5e":function(t,e,n){},"2f9d":function(t,e,n){},"2fe9":function(t,e,n){"use strict";n("55b2")},3009:function(t,e,n){"use strict";n("8163")},"30be":function(t,e,n){"use strict";n.d(e,"e",(function(){return u})),n.d(e,"a",(function(){return d})),n.d(e,"g",(function(){return f})),n.d(e,"c",(function(){return g})),n.d(e,"f",(function(){return w})),n.d(e,"d",(function(){return x})),n.d(e,"b",(function(){return y}));var r=n("c15f"),i=n("a35b"),a=n("1554"),o=(n("e099"),n("e47f"),n("7e9b"),n("80f5")),s=function(){function t(e,n){Object(r["a"])(this,t),Object(a["a"])(this,"start",0),Object(a["a"])(this,"end",0),null!=e&&null!=n&&(this.start=Math.min(e,n),this.end=Math.max(e,n))}return Object(i["a"])(t,[{key:"length",get:function(){return this.end-this.start}}]),t}(),c=function(t,e){return t.start<=e.start&&t.end>=e.end},l=function(t,e){var n,r;return t.start<=e.start?(n=t,r=e):(n=e,r=t),r.start>=n.start&&r.start<=n.end},u=function(t,e){var n=e.x,r=n+e.width,i=t.x,a=i+t.width,o=e.y,s=o+e.height,c=t.y,l=c+t.height;return!(r<i||r>a)&&(!(n<i||n>a)&&(!(s<c||s>l)&&!(o<c||o>l)))},d=function(){function t(){Object(r["a"])(this,t),Object(a["a"])(this,"width",0),Object(a["a"])(this,"height",0),Object(a["a"])(this,"x",0),Object(a["a"])(this,"y",0)}return Object(i["a"])(t,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}},{key:"set",value:function(t,e,n,r){return this.x=t,this.y=e,this.width=n,this.height=r,this}},{key:"isSame",value:function(t){return null!=t&&f(this,t)}},{key:"isOverlap",value:function(t){return!(this.left>t.right||this.top>t.bottom||t.left>this.right||t.top>this.bottom)}},{key:"toJSON",value:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}}]),t}();function h(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var f=function(t,e){var n,r,i=5;return n=h(t.x,i),r=h(e.x,i),n===r&&(n=h(t.y,i),r=h(e.y,i),n===r&&(n=h(t.width,i),r=h(e.width,i),n===r&&(n=h(t.height,i),r=h(e.height,i),n===r)))},m=function(t,e){var n=new d;return n.x=Math.min(t.x,e.x),n.y=Math.min(t.y,e.y),n.width=Math.max(t.right,e.right)-n.x,n.height=Math.max(t.bottom,e.bottom)-n.y,n},p=function(t,e){for(var n=t.length,r=[],i=0;i<n;i++)for(var a=t[i],o=i+1;o<n;o++){var l=t[o];a!==l&&function(){var t=new s(a,l),n=e.find((function(e){return c(t,e)}));n||r.push(t)}()}return r},b=0,v=function(t,e,n,r,i,a){var o,s,c,u,h,f;return n?(o="x",s="right",c="width",u="y",h="bottom",f="height"):(o="y",s="bottom",c="height",u="x",h="right",f="width"),e.forEach((function(e){var m,p,v,g,w={start:r[u],end:r[h],length:r[f]},x={start:i[u],end:i[h],length:i[f]};if(l(w,x))m=Math.max(w.start,x.start),p=Math.min(w.end,x.end);else{var y={start:r[o],end:r[s],length:r[c]};l(e,y)?(m=x.start,p=x.end,g=r):(m=w.start,p=w.end,g=i)}var C=m+(p-m)/2,k=new d,S=a(Math.round(100*e.length)/100);if(n?(k.height=1,k.width=e.length,k.x=e.start,k.y=C):(k.height=e.length,k.width=1,k.x=C,k.y=e.start),t.push({rect:k,text:S,isHorizintal:n,id:++b}),null!=g){if(v=new d,n){v.width=1;var _,A=Math.min(Math.abs(k.y-g.y),Math.abs(k.y-g.bottom)),I={};[g.x,g.right,k.x,k.right].forEach((function(t){I[t]&&(_=t),I[t]=1})),v.x=_,v.y=k.y>g.y?k.y-A:k.y,v.height=A}else{v.height=1;var T,O=Math.min(Math.abs(k.x-g.x),Math.abs(k.x-g.right)),E={};[g.y,g.bottom,k.y,k.bottom].forEach((function(t){E[t]&&(T=t),E[t]=1})),v.y=T,v.x=k.x>g.x?k.x-O:k.x,v.width=O}t.push({rect:v,isHorizintal:!n,isDashed:!0,id:++b})}})),t},g=function(t,e,n,r){t.right>n.width&&(t.width=n.width-t.x),t.bottom>n.height&&(t.height=n.height-t.y),e.right>n.width&&(e.width=n.width-e.x),e.bottom>n.height&&(e.height=n.height-e.y),t.width=Math.max(t.width,.001),t.height=Math.max(t.height,.001),e.width=Math.max(e.width,.001),e.height=Math.max(e.height,.001);var i=m(t,e),a=Object(o["p"])([i.x,i.right,t.x,t.right,e.x,e.right]),c=Object(o["p"])([i.y,i.bottom,t.y,t.bottom,e.y,e.bottom]),l=[new s(t.x,t.right),new s(e.x,e.right)],u=[new s(t.y,t.bottom),new s(e.y,e.bottom)],d=p(a,l),h=p(c,u),f=[];return v(f,d,!0,t,e,r),v(f,h,!1,t,e,r),f},w=function(t,e){var n=e.x,r=e.x+e.width,i=e.y,a=e.y+e.height,o=t.x,s=t.x+t.width,c=t.y,l=t.y+t.height,u=r<o||n>s||a<c||i>l;return!u},x=function(t,e){if(w(t,e)){var n=new d,r=Math.max(t.x,e.x),i=Math.max(t.y,e.y),a=Math.min(t.x+t.width,e.x+e.width),o=Math.min(t.y+t.height,e.y+e.height),s=a-r,c=o-i;if(!(s<0||c<0))return n.set(r,i,s,c),n}};function y(t,e,n){return null==t||1===e?t:(t*=e,t=Math.round(100*t)/100,n?Math.ceil(t):t)}},"312d":function(t,e,n){"use strict";n("6fc8")},"32f2":function(t,e,n){},"32f4":function(t,e,n){"use strict";n("96a3")},"34aa":function(t,e,n){"use strict";n("1ab9")},"34d9":function(t,e,n){},"353e":function(t,e,n){},"354d":function(t,e,n){"use strict";n("fc08")},"37cd":function(t,e,n){"use strict";n("237b")},"396e":function(t,e,n){},"39ac":function(t,e,n){},"39cd":function(t,e,n){},"3a11":function(t,e,n){},"3c4a":function(t,e,n){"use strict";n("ea39")},"3d0e":function(t,e,n){},"3da5":function(t,e,n){"use strict";n("a8ba")},"3e62":function(t,e,n){},"3e80":function(t,e,n){"use strict";n("3d0e")},"3ee8":function(t,e,n){"use strict";n("14eb")},4025:function(t,e,n){"use strict";n("b1fd")},"40d5":function(t,e,n){},"427a":function(t,e,n){},"42e1":function(t,e,n){},4455:function(t,e,n){},4485:function(t,e,n){},"463d":function(t,e,n){"use strict";n("2f9d")},"486e":function(t,e,n){"use strict";n("5746")},4879:function(t,e,n){},"48cc":function(t,e,n){},"494d":function(t,e,n){},4973:function(t,e,n){"use strict";n("52b6")},"4e01":function(t,e,n){"use strict";n("d3fa")},"4e4a":function(t,e,n){},"4eb2":function(t,e,n){"use strict";n("51c8")},"4f19":function(t,e,n){},"4f30":function(t,e,n){},"4ff6":function(t,e,n){"use strict";n("2aef")},"516c":function(t,e,n){"use strict";n("097d")},"51c8":function(t,e,n){},5258:function(t,e,n){},"52b6":function(t,e,n){},"53d7":function(t,e,n){"use strict";n("5258")},"53f8":function(t,e,n){"use strict";n("9f38")},"549b":function(t,e,n){},"55b2":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);var r=n("d941"),i=n("c3ae"),a=(n("215b"),n("b619"),n("119d"),n("3d63"),n("e099"),n("e47f"),n("c018"),n("430a")),o=n("08f3"),s=(n("1b2e"),n("a43d")),c=(n("4b74"),n("7e9b"),n("25e4"),n("2c58"),n("09ae"),n("872d"),n("6a04"),n("b2e3"),n("fa7d")),l=n("80f5"),u=n("08714"),d=(n("6307"),n("b24a"),n("0bfb"),n("30be")),h=n("bc8f");function f(t,e,n,r){var i,a=e.overrides.find((function(t){if(t.style){var e=t.style[n];return null!=e?t:void 0}}));return a&&(i=a.style[n],null!=i)||t&&(i=t[n],null!=i)?i:r}function m(t){if(t&&t.type!==o["A"].Artboard){var e=t.layers;if(!e)return t.type===o["A"].ShapePath;var n=0,r=[];if(e.forEach((function(t,e){if(t)switch(t.type){case o["A"].ShapePath:return void(t.markedForExport||n++);case o["A"].Group:return void(m(t)&&(n++,r.push(e)))}})),n===e.length){n>=7&&(t.layers=[]);for(var i=r.length-1;i>=0;i--){var a=r[i];e.splice(a,1)}return!0}return t.type===o["A"].ShapePath}}var p=["topLeft","topRight","bottomRight","bottomLeft"];function b(t){if(t){var e;switch(t.fillType){case o["z"].Color:var n=t.color;n&&(e={value:Object(h["a"])(t.color)});break;case o["z"].Gradient:var r=t.gradient;if(r)switch(r.gradientType){case o["E"].Linear:var i=r.from,a=r.to,s=r.stops;if(i&&a&&s){var c=[];e={endPoints:[i.x,i.y,a.x,a.y],colorStops:c},s.forEach((function(t){c.push({stop:t.position,color:{value:Object(h["a"])(t.color)}})}))}break;case o["E"].Radial:0===r.aspectRatio&&(r.aspectRatio=1);var l=r.from,u=r.to,d=r.stops;if(l&&u&&d){var f=[];e={endPoints:[l.x,l.y,u.x,u.y],colorStops:f},d.forEach((function(t){f.push({stop:t.position,color:{value:Object(h["a"])(t.color)}})}))}break;case o["E"].Angular:var m=r.from,p=r.to,b=r.stops;if(m&&p&&b){var v=[];e={endPoints:[m.x,m.y,p.x,p.y],colorStops:v},b.forEach((function(t){v.push({stop:t.position,color:{value:Object(h["a"])(t.color)}})}))}break}break;case o["z"].Pattern:e={assetId:"sketch"};break}return e}}function v(t,e){var n=e.background;if(n&&n.enabled&&n.color&&n.includedInInstance)return!1;var r=e.frame,i=t.frame;if(r.width!==i.width)return!1;if(r.height!==i.height)return!1;var a=e.style;if(!a)return!0;var o=a.opacity;return null==o||o>=1}function g(t,e){var n=e.nodeSharedStyles={overrides:[],share:null},r=t.sharedStyles;if(r){var i=e.overrideSharedStyleIds;if(i&&i.forEach((function(t){var e=r[t];e&&n.overrides.push(e)})),e.sharedStyleId){var a=r[e.sharedStyleId];a&&(n.share=a)}}}function w(t){var e=t.boxTransform={rotation:0,flippedHorizontally:!1,flippedVertically:!1},n=t.transform;if(Object(l["o"])(n)&&(null!=n.rotation&&(e.rotation=n.rotation),n.flippedHorizontally&&(e.flippedHorizontally=!0),n.flippedVertically&&(e.flippedVertically=!0)),90===e.rotation||-90===e.rotation||270===e.rotation){var r=t.frame,i=r.x,a=r.y,o=r.width,s=r.height;if(o===s)return;t._sketchRealStyle={rotation:e.rotation,x:i,y:a,width:o,height:s},t.markedForExport&&(e.rotation=0);var c=(o-s)/2,u=-c;t.frame={x:i+c,y:a+u,width:s,height:o}}}function x(t,e,n){if(!e.markedForExport){var r=t.frame;r={x:0,y:0,width:r.width,height:r.height};var i=e.frame,a=n.globalBounds.x-t.globalBounds.x,o=n.globalBounds.y-t.globalBounds.y,s={x:a+i.x,y:o+i.y,width:i.width,height:i.height};r=Object(d["d"])(r,s),r||(r={x:0,y:0,width:0,height:0});var c={width:r.width,height:r.height,x:r.x-a,y:r.y-o};if(!Object(d["g"])(c,i)){e.frame=c;var l=e.frame.x-i.x,u=e.frame.y-i.y;e._sketchFixedFrame=1,0===l&&0===u||e.layers&&e.layers.forEach((function(t){t.frame.x-=l,t.frame.y-=u}))}}}function y(t,e,n){if(n){if(x(t,e,n),n._sketchFixedFrame&&!e.markedForExport){var r={x:0,y:0,width:n.frame.width,height:n.frame.height};C(r,e)}if(e.hasClippingMask){var i=n.layers;if(i)for(var a=!1,o=e.frame,s=0,c=i.length;s<c;s++){var l=i[s];if(l!==e){if(a){if(l.hasClippingMask)break;if(l.shouldBreakMaskChain)break;l.markedForExport||C(o,l)}}else a=!0}}}}function C(t,e){var n=e.frame,r=n.x,i=n.y,a=Object(d["d"])(t,e.frame);if(a||(a={x:0,y:0,width:0,height:0}),!Object(d["g"])(a,e.frame)){var o=a.x-r,s=a.y-i;e.frame=a,e._sketchFixedFrame=1,0===o&&0===s||e.layers&&e.layers.forEach((function(t){var e=t.frame;e.x-=o,e.y-=s}))}}var k=[100,100,100,200,300,400,500,500,600,700,800,900,900,900,900,900];function S(t,e,n){e.boundsInParent=e.frame,e.guid=e.id,e.visible=!e.hidden,e.children=e.layers,w(e),g(t,e);var r=e.nodeSharedStyles,i=e.style;e.opacity=f(i,r,"opacity",1);var a=c["SCENENODE_BLEND_MODE"][o["v"][f(i,r,"blendingMode",o["u"].NORMAL)]];a&&(e.blendMode=a);var u=f(i,r,"blur",null);if(null!=u)switch(u.blurType){case o["y"].Gaussian:e.blur={isBackgroundEffect:!1,visible:!0,blurAmount:u.radius};break}var d=f(i,r,"borders",null);d&&d.length>0&&(e.strokeArr=[],d.forEach((function(t){var n=b(t);if(n){var a={strokeEnabled:!0,stroke:n,strokeWidth:t.thickness,strokePosition:t.position},o=f(i,r,"borderOptions",null);if(o&&(a.strokeDashArray=o.dashPattern),0===e.strokeArr.length)for(var s in a)e[s]=a[s];e.strokeArr.push(a)}})));var m=f(i,r,"shadows",null);m&&m.length>0&&(e.shadowArr=[],m.forEach((function(t){if(t){var n={visible:!0,x:t.x,y:t.y,blur:t.blur,spread:t.spread,color:{value:Object(h["a"])(t.color)}};0===e.shadowArr.length&&(e.shadow=n),e.shadowArr.push(n)}})));var v=f(i,r,"innerShadows",null);if(v&&v.length>0&&(e.innerShadowArr=[],v.forEach((function(t){if(t){var n={visible:!0,x:t.x,y:t.y,blur:t.blur,spread:t.spread,color:{value:Object(h["a"])(t.color)}};0===e.innerShadowArr.length&&(e.innerShadow=n),e.innerShadowArr.push(n)}}))),e.type!==o["A"].SymbolMaster&&e.type!==o["A"].Artboard){var x=f(i,r,"fills",null);Object(l["g"])(x)&&(e.fillArr=[],x.forEach((function(t){t&&(t=b(t),0===e.fillArr.length&&(e.fillEnabled=!0,e.fill=t),e.fillArr.push({fillEnabled:!0,fill:t}))})))}if(y(t,e,n),t===e||null==n)e.globalBounds=e.globalDrawBounds=Object(s["a"])({},e.frame);else{var C=n.globalBounds,S=e.frame;e.globalBounds=e.globalDrawBounds={x:C.x+S.x,y:C.y+S.y,width:S.width,height:S.height}}if(!e.types)switch(e.types={GraphicNode:1},e.type){case o["A"].SymbolInstance:e.types.SymbolInstance=1;break;case o["A"].Artboard:e.types.Artboard=1;var _=e.background;_&&_.enabled&&_.color&&(e.fillEnabled=!0,e.fill={value:Object(h["a"])(_.color)});break;case o["A"].Group:e.types.Group=1;break;case o["A"].Text:e.types.Text=1,e.paragraphSpacing=f(i,r,"paragraphSpacing",0),e.lineSpacing=f(i,r,"lineHeight",0);var A=f(i,r,"alignment",o["w"].left);e.textAlign=o["x"][A],null==e.textAlign&&(e.textAlign=A);var I=f(i,r,"verticalAlignment",o["C"].top);I!==o["C"].top&&(e.textVerticalAlign=o["D"][I]);var T={fill:{},charSpacing:f(i,r,"kerning",null),fontFamily:f(i,r,"fontFamily",""),fontWeight:k[f(i,r,"fontWeight",4)],fontItalic:f(i,r,"fontStyle",""),fontSize:f(i,r,"fontSize",""),underline:!!f(i,r,"textUnderline",""),strikethrough:!!f(i,r,"textStrikethrough","")};null==T.fontWeight&&(T.fontWeight=400),T.fontWeightCss=T.fontWeight.toString(),T.fontStyle=T.fontWeight.toString(),T.fontItalic?T.fontStyle+=" "+T.fontItalic:T.fontItalic="normal",e.styleRanges=[T];var O=f(i,r,"textColor","");O&&(T.fill.value=Object(h["a"])(O));break;case o["A"].ShapePath:switch(e.types.Rectangle=1,e.shapeType){case o["B"].Rectangle:var E=e.points,M=null;Object(l["g"])(E)&&E.length>0&&(M={topLeft:0,topRight:0,bottomRight:0,bottomLeft:0},E.forEach((function(t,e){t&&(M[p[e]]=t.cornerRadius)}))),e.cornerRadii=M;break;default:break}break}}var _=n("a35b"),A=n("c15f"),I=n("1554"),T=(n("0f1f"),n("2b54"),n("4e1a"),n("2baf"),n("a858"),n("dab3"),n("091b"),n("1e11"),n("f6b3"),n("02f0"),n("9862"),n("f728"),n("35e9"),n("078c"),n("e9c4"),n("c4e2"),n("0879"),n("266c"),n("cb12"),75),O="quality.jpg",E={None:-1,Brush:0,Line:1,Rectangle:2,Ellipse:3,Text:4,Arrow:5,Image:6,Move:7,Deleted:8,End:9},M=[14,16,18,20,24,28,32,36,48,72],L=36,N={Fine:3,Normal:6,Crude:12},D=[{color:"#545454",border:"#434343",name:"black"},{color:"#ffffff",border:"#cccccc",name:"white"},{color:"#f34e1e",border:"#c23e18",name:"orange"},{color:"#ffc701",border:"#cc9f07",name:"yellow"},{color:"#0ea958",border:"#0d8747",name:"green"},{color:"#417dee",border:"#2b63ce",name:"blue"},{color:"#9847ff",border:"#7e3bd2",name:"purple"},{color:"#d27c2c",border:"#a76323",name:"brown"}],F=function(){function t(e,n){return Object(A["a"])(this,t),Object(I["a"])(this,"_x",0),Object(I["a"])(this,"_y",0),this.x=null!=e?e:0,this.y=null!=n?n:0,this}return Object(_["a"])(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"top",get:function(){return this._y},set:function(t){this._y=t}},{key:"left",get:function(){return this._x},set:function(t){this._x=t}},{key:"toJSON",value:function(){var t=this.x,e=this.y;return{x:t,y:e}}}]),t}(),P=1,j=Object(_["a"])((function t(){Object(A["a"])(this,t),Object(I["a"])(this,"id",0),Object(I["a"])(this,"data",null),Object(I["a"])(this,"blob",null),Object(I["a"])(this,"thumbBlob",null),this.id=P++})),R=Object(_["a"])((function t(){Object(A["a"])(this,t),Object(I["a"])(this,"type",""),Object(I["a"])(this,"thumbType",""),Object(I["a"])(this,"name",""),Object(I["a"])(this,"length",0),Object(I["a"])(this,"thumbLength",0),Object(I["a"])(this,"fold",null),Object(I["a"])(this,"fileName",null),Object(I["a"])(this,"thumbFileName",null),Object(I["a"])(this,"imageSize",null),Object(I["a"])(this,"thumbImageSize",null)}));function B(t){return new Promise((function(e,n){var r=URL.createObjectURL(t),i=function(){URL.revokeObjectURL(r)};try{var a=new Image;a.onload=function(t){i(),e(t.target)},a.onerror=function(){i(),n("图片加载失败,不支持的图片类型")},a.src=r}catch(o){i(),n(o)}}))}var V="image/jpeg";function U(t,e){return $.apply(this,arguments)}function $(){return $=Object(i["a"])(Object(r["a"])().mark((function t(e,n){var i,a,o,s,c,l,u,d;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.naturalWidth,a=e.naturalHeight,o=Math.max(Math.ceil(a/i*n),1),t.prev=2,s=document.createElement("canvas"),c=function(t){return t},l=new W(c(n),c(o)),s.width=l.width,s.height=l.height,s.style.cssText="top:-10000px;left:0;width:1px;height:1px;opacity:0;pointer-events:none;position: absolute;overflow:hidden;z-index:-1;",document.body.appendChild(s),u=s.getContext("2d"),u.fillStyle="#fff",u.fillRect(0,0,l.width,l.height),u.drawImage(e,0,0,i,a,0,0,l.width,l.height),t.next=16,at(s,V,.75);case 16:return t.t0=t.sent,t.t1=n,t.t2=o,t.abrupt("return",{blob:t.t0,width:t.t1,height:t.t2});case 20:return t.prev=20,s&&(d=s.parentNode,d&&d.removeChild(s)),t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[2,,20,23]])}))),$.apply(this,arguments)}function H(t){return z.apply(this,arguments)}function z(){return z=Object(i["a"])(Object(r["a"])().mark((function t(e){var n,i,a,o,s;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e instanceof Blob||e instanceof File){t.next=2;break}throw new Error("附件异常,不支持的图片格式");case 2:return t.next=4,B(e);case 4:if(n=t.sent,i=new j,a=new R,i.data=a,a.imageSize=new W(n.naturalWidth,n.naturalHeight),a.type=e.type,a.name=e.name,a.length=e.size,o=300,i.blob=e,!(a.imageSize.width<=o)){t.next=20;break}a.thumbImageSize=a.imageSize,a.thumbLength=0,a.thumbType=a.type,t.next=27;break;case 20:return t.next=22,U(n,o);case 22:s=t.sent,a.thumbImageSize=new W(s.width,s.height),a.thumbLength=s.blob.size,a.thumbType=V,i.thumbBlob=s.blob;case 27:return t.abrupt("return",i);case 28:case"end":return t.stop()}}),t)}))),z.apply(this,arguments)}var W=function(){function t(e,n){return Object(A["a"])(this,t),Object(I["a"])(this,"_width",0),Object(I["a"])(this,"_height",0),this.width=null!=e?e:0,this.height=null!=n?n:0,this}return Object(_["a"])(t,[{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}},{key:"toJSON",value:function(){var t=this.width,e=this.height;return{width:t,height:e}}}]),t}(),G={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},Y=72,X=3,K=450;function Z(t,e){null==e&&(e=1);var n=t.toLowerCase();if(!n)return n;G[n]&&(n=G[n]);var r=/^\s*rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i;if(/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(n)){if(4===n.length){for(var i="#",a=1;a<4;a+=1)i+=n.slice(a,a+1).concat(n.slice(a,a+1));n=i}for(var o=[],s=1;s<7;s+=2)o.push(parseInt("0x"+n.slice(s,s+2)));o.push(e),n="RGBA("+o.join(",")+")"}else n=r.test(n)?n.replace(r,"rgba($1,$2,$3,"+e+")"):n.replace(/^\s*rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)\s*$/i,"rgba($1,$2,$3,"+e+")");return n}function q(t,e){return{x:t.x*Math.cos(e)+t.y*Math.sin(e),y:t.y*Math.cos(e)-t.x*Math.sin(e)}}function Q(t,e,n,r){var i,a,o,s=Math.atan((r.x-n.x)/(r.y-n.y)),c=q(r,-s),l=q(n,-s),u={x:0,y:0},d={x:0,y:0},h={x:0,y:0},f={x:0,y:0},m=c.y-l.y;switch(t){case N.Fine:m=m>0?6:-6,i=m>0?12:-12,a=m>0?2:-2,o=m>0?4:-4;break;case N.Crude:m=m>0?10:-10,i=m>0?20:-20,a=m>0?6:-6,o=m>0?12:-12;break;default:m=m>0?8:-8,i=m>0?16:-16,a=m>0?4:-4,o=m>0?8:-8}m*=e,i*=e,a*=e,o*=e,u.x=c.x+m,u.y=c.y-i,d.x=c.x-m,d.y=c.y-i,h.x=c.x+a,h.y=c.y-o,f.x=c.x-a,f.y=c.y-o;var p=q(u,s),b=q(d,s),v=q(h,s),g=q(f,s);return{h1:p,h2:b,h3:v,h4:g}}function J(t){var e=t[t.length-1];if(e){var n=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;t.forEach((function(t){n=Math.min(t.x,n),r=Math.min(t.y,r),i=Math.max(t.x+t.width,i),a=Math.max(t.y+t.height,a)}));var o=new d["a"];return o.x=n,o.y=r,o.width=i-n,o.height=a-r,o}}function tt(t){var e=t[t.length-1];if(e){var n=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;t.forEach((function(t){var e=(new d["a"]).set(t.x,t.y,1,1);n=Math.min(e.x,n),r=Math.min(e.y,r),i=Math.max(e.right,i),a=Math.max(e.bottom,a)}));var o=new d["a"];return o.x=n,o.y=r,o.width=i-n,o.height=a-r,o}}var et=function(){function t(){Object(A["a"])(this,t),Object(I["a"])(this,"action",E.None),Object(I["a"])(this,"startPoint",null),Object(I["a"])(this,"endPoint",null),Object(I["a"])(this,"eventRect",null),Object(I["a"])(this,"color",null),Object(I["a"])(this,"brushSize",0),Object(I["a"])(this,"fontSize",0),Object(I["a"])(this,"text",null),Object(I["a"])(this,"family",null),Object(I["a"])(this,"lineHeight",0),Object(I["a"])(this,"textareaSize",null),Object(I["a"])(this,"points",null),Object(I["a"])(this,"textSplit",null),Object(I["a"])(this,"brushHash",null),Object(I["a"])(this,"dragFrom",-1),Object(I["a"])(this,"dragOn",-1),Object(I["a"])(this,"dragOffset",null),Object(I["a"])(this,"dragTarget",null)}return Object(_["a"])(t,[{key:"getBrushSize",value:function(){var t=this.action,e=this.brushSize;if(t!==E.Brush)return e;switch(e){case N.Crude:return 6;case N.Fine:return 1;default:return 3}}},{key:"makeBrushHash",value:function(t){return"".concat(t.offset.x,"-").concat(t.offset.y,"-").concat(t.scale,"-").concat(t.sceneWidth,"-").concat(t.sceneHeight)}},{key:"getArrowEventRect",value:function(){var t=this.startPoint,e=this.endPoint,n=1,r=Q(this.getBrushSize(),n,t,e);return tt([t,e,r.h1,r.h2,r.h3,r.h4])}},{key:"makePoint",value:function(t){switch(this.action){case E.Arrow:this.eventRect=this.getArrowEventRect();break;case E.Text:var e;t.font="".concat(this.fontSize,"px ").concat(null!==(e=this.family)&&void 0!==e?e:"sans-serif"),this.text=this.text.replace(/\r/g,"");for(var n=this.text,r={},i=0,a=this.textSplit=[],o=0,s=K,c=n.length,l=this.lineHeight,u=new W(0,0),h=0;h<c;h++){var f=n[h];if("\n"!==f){var m=r[f];m||(m=r[f]=t.measureText(f).width);var p=o+m;p>s?(u.width=Math.max(u.width,o),u.height+=l,o=m,a.push({index:i,length:h-i}),i=h):o=p}else u.width=Math.max(u.width,o),u.height+=l,o=0,a.push({index:i,length:h-i}),i=h+1}u.width=Math.max(u.width,o),i<=c-1&&(u.height+=l,a.push({index:i,length:c-i}));var b=this.startPoint;this.endPoint=new F(b.x+u.width,b.y+u.height);var v=l/2-l/8;this.eventRect=(new d["a"]).set(b.x,b.y-v,u.width,u.height);break;case E.Brush:var g,w=null!==(g=tt(this.points))&&void 0!==g?g:new d["a"],x=this.getBrushSize(),y=Math.ceil(x/2);this.startPoint=new F(w.x-y,w.y-y),this.endPoint=new F(w.right,w.bottom),this.eventRect=(new d["a"]).set(w.x-y,w.y-y,w.width+x,w.height+x),this.brushHash=null;break;default:var C=this.startPoint,k=this.endPoint;if(this.eventRect=new d["a"],C&&k){var S=Math.min(C.x,k.x),_=Math.min(C.y,k.y),A=Math.round(Math.abs(C.x-k.x)),I=Math.round(Math.abs(C.y-k.y));this.eventRect.set(S,_,A,I)}break}}},{key:"isVaildData",value:function(){switch(this.action){case E.Deleted:var t=this.dragTarget;return!!t;case E.Move:var e=this.startPoint,n=this.endPoint,r=this.dragTarget,i=this.dragOffset;return!!r&&(!(!e||!n)&&((e.x!==n.x||e.y!==n.y)&&(this.dragOffset=new F(n.x-e.x+i.x,n.y-e.y+i.y),!0)));case E.Arrow:case E.Ellipse:case E.Rectangle:var a=this.startPoint,o=this.endPoint;return null!=a&&null!=o&&(a.x!==o.x||a.y!==o.y);case E.Text:var s=this.text;return!!s&&(s=s.trim(),s.length>0);case E.Brush:var c=this.points;return!(!Object(l["g"])(c)||c.length<=1);default:return!1}}},{key:"isOverlapPoint",value:function(t,e,n){var r=nt.arrow(this,e,n);r&&l["a"]&&console.log("isOverlapPoint",t)}}]),t}(),nt={arrow:function(t,e,n){var r=t.startPoint,i=t.endPoint;if(r&&i){var a=ot.getCanvasLocation(e,t.startPoint,n),o=ot.getCanvasLocation(e,t.endPoint,n),s=e.scale*e.canvasScale,c=Q(t.getBrushSize(),s,a,o);return{triangle1:{p0:new F(a.x,a.y),p1:new F(c.h3.x,c.h3.y),p2:new F(c.h4.x,c.h4.y)},triangle2:{p0:new F(o.x,o.y),p1:new F(c.h1.x,c.h1.y),p2:new F(c.h2.x,c.h2.y)}}}}},rt=Object(_["a"])((function t(){Object(A["a"])(this,t),Object(I["a"])(this,"offset",null),Object(I["a"])(this,"scale",1),Object(I["a"])(this,"sceneWidth",1),Object(I["a"])(this,"sceneHeight",1),Object(I["a"])(this,"canvasScale",1)}));function it(t){return new Promise((function(e,n){var r=new Image;r.onload=function(t){e(t.target)},r.onerror=function(){n("画板预览图加载失败")},r.crossOrigin="*",r.src=t}))}function at(t,e,n){return new Promise((function(r,i){try{t.toBlob((function(t){r(t)}),e,n)}catch(a){i(a)}}))}var ot={_supportCanvasEllipse:-1,get supportCanvasEllipse(){var t=this._supportCanvasEllipse;return-1===t&&(t="function"===typeof CanvasRenderingContext2D.prototype.ellipse?1:0),t},getCanvasLocation:function(t,e,n){var r=new F(e.x-t.offset.x,e.y-t.offset.y);n&&(r.x+=n.x,r.y+=n.y);var i=t.scale*t.canvasScale;return r.x=Math.floor(r.x*i),r.y=Math.floor(r.y*i),r},getCanvasRect:function(t,e,n){var r=(new d["a"]).set(e.x-t.offset.x,e.y-t.offset.y,e.width,e.height);n&&(r.x+=n.x,r.y+=n.y);var i=t.scale*t.canvasScale;return r.x=Math.floor(r.x*i),r.y=Math.floor(r.y*i),r.width=Math.ceil(r.width*i),r.height=Math.ceil(r.height*i),r},getMidPointBtw:function(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}},setStrokeStyle:function(t,e,n,r){t.lineCap=t.lineJoin=null!==r&&void 0!==r?r:"round",t.fillStyle=t.strokeStyle=e.color;var i=e.getBrushSize(),a=Math.ceil(i*n.scale*n.canvasScale);t.lineWidth=a},drawRectangle:function(t,e,n,r,i,a){var o=e.startPoint,s=e.endPoint;if(o&&s){var c=this.getCanvasLocation(n,e.startPoint,a),l=this.getCanvasLocation(n,e.endPoint,a);i?this.drawSelectItem(t,e,n,a):r&&this.drawBackground(t,e,n,a),this.setStrokeStyle(t,e,n);var u=Math.round(t.lineWidth/2),d=Math.min(c.x,l.x)+u,h=Math.min(c.y,l.y)+u,f=Math.max(0,Math.abs(c.x-l.x)-2*u),m=Math.max(0,Math.abs(c.y-l.y)-2*u);t.strokeRect(d,h,f,m),i&&this.drawSelectItemBorder(t,e,n,a)}},drawEllipse:function(t,e,n,r,i,a){var o=e.startPoint,s=e.endPoint;if(o&&s){var c=this.getCanvasLocation(n,e.startPoint,a),l=this.getCanvasLocation(n,e.endPoint,a);i?this.drawSelectItem(t,e,n,a):r&&this.drawBackground(t,e,n,a),this.setStrokeStyle(t,e,n);try{var u=Math.ceil(t.lineWidth/2),d=Math.round(Math.abs(c.x-l.x)/2),h=Math.round(Math.abs(c.y-l.y)/2),f=Math.min(c.x,l.x)+d,m=Math.min(c.y,l.y)+h;if(d=Math.max(0,d-u),h=Math.max(0,h-u),this.supportCanvasEllipse)return t.beginPath(),t.ellipse(f,m,d,h,0*Math.PI/180,0,2*Math.PI),t.closePath(),void t.stroke();t.save();var p=d>h?d:h,b=d/p,v=h/p;t.scale(b,v),t.beginPath(),t.arc(f/b,m/v,p,0,2*Math.PI,!1),t.closePath(),t.stroke(),t.restore()}finally{i&&this.drawSelectItemBorder(t,e,n,a)}}},drawArrow:function(t,e,n,r,i,a){if(t){var o=nt.arrow(e,n,a);o&&(i?this.drawSelectItem(t,e,n,a):r&&this.drawBackground(t,e,n,a),this.setStrokeStyle(t,e,n,"buff"),t.beginPath(),t.moveTo(o.triangle1.p0.x,o.triangle1.p0.y),t.lineTo(o.triangle1.p1.x,o.triangle1.p1.y),t.lineTo(o.triangle1.p2.x,o.triangle1.p2.y),t.closePath(),t.fill(),t.beginPath(),t.moveTo(o.triangle2.p0.x,o.triangle2.p0.y),t.lineTo(o.triangle2.p1.x,o.triangle2.p1.y),t.lineTo(o.triangle2.p2.x,o.triangle2.p2.y),t.closePath(),t.fill(),i&&this.drawSelectItemBorder(t,e,n,a))}},drawSelectItem:function(t,e,n,r){return this.drawBackground(t,e,n,r)},drawSelectItemBorder:function(t,e,n,r){if(e.eventRect){var i=this.getCanvasRect(n,e.eventRect,r),a="#1886ff";t.strokeStyle=a,t.lineCap="round";var o=Math.max(Math.ceil(n.scale*n.canvasScale),1);t.lineWidth=o,t.strokeRect(i.x,i.y,i.width,i.height)}},drawBackground:function(t,e,n,r){if(e.eventRect){var i=this.getCanvasRect(n,e.eventRect,r),a="#1886ff";a=Z(a,.2),t.fillStyle=a,t.fillRect(i.x,i.y,i.width,i.height)}},drawText:function(t,e,n,r,i,a){var o,s=e.startPoint,c=e.textSplit;if(s&&c){var l=this.getCanvasLocation(n,e.startPoint,a);if(void 0!=t){i?this.drawSelectItem(t,e,n,a):r&&this.drawBackground(t,e,n,a);var u=n.canvasScale*n.scale,d=e.text,h=Math.max(1,Math.round(e.lineHeight*u)),f=new F(l.x,l.y-Math.round(h/4));t.imageSmoothingEnabled=!0,t.imageSmoothingQuality="high",t.font="".concat(Math.max(1,Math.round(e.fontSize*n.scale)*n.canvasScale),"px ").concat(null!==(o=e.family)&&void 0!==o?o:"sans-serif"),t.fillStyle=e.color,t.textAlign="left",t.textBaseline="top",c.forEach((function(e){if(e.length>0){var n=d.substr(e.index,e.length);t.fillText(n,f.x,f.y)}f.y+=h})),i&&this.drawSelectItemBorder(t,e,n,a)}}},drawBrush:function(t,e,n,r,i,a,o){if(Object(l["g"])(e.points)&&!(e.points.length<=1)){var s=0;o=!1,o&&(s=e.points.length-2);var c,u=this.getCanvasLocation(n,e.points[s],a);i?this.drawSelectItem(t,e,n,a):r&&this.drawBackground(t,e,n,a),this.setStrokeStyle(t,e,n),t.beginPath(),t.moveTo(u.x,u.y);for(var d=s+1,h=e.points.length;d<h;d++){var f=this.getCanvasLocation(n,e.points[d],a);o?t.lineTo(f.x,f.y):(c=this.getMidPointBtw(u,f),t.quadraticCurveTo(f.x,f.y,c.x,c.y)),u=f}c&&t.lineTo(stop.x,stop.y),t.stroke(),t.closePath(),i&&this.drawSelectItemBorder(t,e,n,a),t=null}},save:function(t,e,n,a){var o=this;return Object(i["a"])(Object(r["a"])().mark((function i(){var s,c,u,h,f,m,p,b,v,g,w,x,y,C,k,S,_,A;return Object(r["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(Object(l["h"])(e)){r.next=2;break}throw"artboardPreviewPath is empty";case 2:return r.next=4,it(e+"?r="+Math.random());case 4:if(s=r.sent,c=a>=n.length-1?n:n.slice(0,a+1),0!==c.length){r.next=8;break}throw"没有截图操作信息";case 8:return u=[],h=[t],c.forEach((function(t){var e,r=t.action;switch(r){case E.Brush:case E.Rectangle:case E.Ellipse:case E.Arrow:case E.Text:var i=o.getHistoryTagetWithDragOn(n,t,a);if(i){if(i.action===E.Deleted)return;e=i.dragOffset}var s=new d["a"];s.set(t.eventRect.x,t.eventRect.y,t.eventRect.width,t.eventRect.height),e&&(s.x+=e.x,s.y+=e.y),u.push({target:t,offset:e}),h.push(s);break}})),f=J(h),m=new F(-f.x,-f.y),r.prev=13,l["a"]&&console.time("save.draw"),b=2,p=document.createElement("canvas"),v=function(t){return t*b},p.width=v(f.width),p.height=v(f.height),g=500,w=Math.round(f.height/f.width*g),p.style.cssText="top:-10000px;left:0;width:".concat(g,"px;height:").concat(w,"px;opacity:0;pointer-events:none;position: absolute;overflow:hidden;z-index:-1;"),document.body.appendChild(p),x=p.getContext("2d"),x.fillStyle="#fafafa",x.fillRect(0,0,v(f.width),v(f.height)),y=new W(s.width,s.height),x.drawImage(s,0,0,y.width,y.height,v(m.x+t.x),v(m.y+t.y),v(t.width),v(t.height)),C=!1,k=!1,S=new rt,S.offset=new F,S.canvasScale=b,S.scale=1,S.sceneWidth=f.width,S.sceneHeight=f.height,_=new F,u.forEach((function(t){var e=t.target;switch(_.x=m.x,_.y=m.y,t.offset&&(_.x+=t.offset.x,_.y+=t.offset.y),e.action){case E.Brush:var n=!1;o.drawBrush(x,e,S,C,k,_,n);break;case E.Rectangle:o.drawRectangle(x,e,S,C,k,_);break;case E.Ellipse:o.drawEllipse(x,e,S,C,k,_);break;case E.Arrow:o.drawArrow(x,e,S,C,k,_);break;case E.Text:o.drawText(x,e,S,C,k,_);break}})),r.next=41,at(p,"image/jpeg",.75);case 41:return r.abrupt("return",r.sent);case 42:return r.prev=42,p&&(A=p.parentNode,A&&A.removeChild(p)),l["a"]&&console.timeEnd("save.draw"),r.finish(42);case 46:case"end":return r.stop()}}),i,null,[[13,,42,46]])})))()},getHistoryTagetWithDragOn:function(t,e,n){if(null==e)return null;if(e.action===E.Move)return null;var r=e.dragOn;if(-1===r)return e;if(r>n)return e;var i,a=null;while(r<=n){var o=t[r];if(!o)return null;if(o.action!==E.Move&&o.action!==E.Deleted)return null;if(i=r,r=o.dragOn,-1===r)return o;if(r>n)return o;var s=t[r];if(!s)return o;if(s.action!==E.Move&&s.action!==E.Deleted)return o;if(s.dragFrom!==i)return o;a=o}return a}};l["a"]&&(window.drawContextHelper=ot);n("19f9");var st="function"===typeof AbortController,ct={},lt=function(t){if(null!=t){var e=ct[t];if(e){delete ct[t];try{e()}catch(n){}}}},ut=function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e,n,i,a){var o,c,l,u,d,h,f,m;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(i>0||null!=a)){t.next=43;break}if(lt(a),!st){t.next=27;break}return o=new AbortController,c=!1,l=!1,u=0,null!=a&&(ct[a]=function(){l=!0,u>0&&clearTimeout(u);try{var t;null===(t=o)||void 0===t||t.abort()}catch(e){}o=null}),i>0&&(u=setTimeout((function(){c=!0,null!=a&&delete ct[a];try{var t;null===(t=o)||void 0===t||t.abort()}catch(e){}o=null}),i)),t.prev=9,t.next=12,fetch(e,Object(s["a"])(Object(s["a"])({},n),{},{signal:o.signal}));case 12:d=t.sent,t.next=20;break;case 15:if(t.prev=15,t.t0=t["catch"](9),!c){t.next=19;break}throw"Timeout: 接口请求超时了";case 19:throw t.t0;case 20:return t.prev=20,u>0&&clearTimeout(u),!l&&delete ct[a],t.finish(20);case 24:return t.abrupt("return",d);case 27:return h=0,f=[],m=!1,i>0&&f.push(new Promise((function(t,e){h=setTimeout((function(){m||e("Timeout: 接口请求超时了")}),i)}))),f.push(fetch(e,n)),null!=a&&f.push(new Promise((function(t,e){ct[a]=function(){m=!0,h>0&&clearTimeout(h),delete ct[a],e("Error: The user aborted a request.")}}))),t.prev=33,t.next=36,Promise.race(f);case 36:return t.abrupt("return",t.sent);case 37:return t.prev=37,h>0&&clearTimeout(h),!m&&delete ct[a],t.finish(37);case 41:t.next=46;break;case 43:return t.next=45,fetch(e,n);case 45:return t.abrupt("return",t.sent);case 46:case"end":return t.stop()}}),t,null,[[9,15,20,24],[33,,37,41]])})));return function(e,n,r,i){return t.apply(this,arguments)}}(),dt=function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e,n){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ht(e,Object(s["a"])(Object(s["a"])({},n),{},{method:"GET"}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ht=function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e,n){var i,a,o,u,d;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return Object(l["o"])(n)||(n={}),i=n.timeout,null==i&&(i=0),(Object(l["o"])(n.body)||Object(l["g"])(n.body))&&(n.body=JSON.stringify(n.body)),Object(c["isRelativeUrl"])(e)&&(e="".concat(c["OUTPU_CLOUD_API_DEVPATH"],"/api/").concat(e)),a=n.abortKey,delete n.abortKey,t.next=9,ut(e,Object(s["a"])({method:"POST",credentials:l["a"]?"include":void 0},n),i,a);case 9:o=t.sent,t.t0=o.status,t.next=200===t.t0?13:500===t.t0||403===t.t0?19:23;break;case 13:return t.next=15,o.text();case 15:if(u=t.sent,Object(l["h"])(u)){t.next=18;break}return t.abrupt("return","");case 18:return t.abrupt("return",Object(c["string2Data"])(u));case 19:return t.next=21,o.text();case 21:throw d=t.sent,"[".concat(o.status,"] ").concat(d);case 23:throw"接口".concat(e,"请求失败");case 24:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ft={T:"top",R:"right",B:"bottom",L:"left"},mt={linear:"linear","ease-in":"ease-in","ease-out":"ease-out","ease-in-out":"ease-in-out"},pt={goToArtboard:"goToArtboard",overlay:"overlay",goBack:"goBack",speak:"speak",getTypeName:function(t){switch(t){case pt.goBack:return"返回";case pt.goToArtboard:return"跳转";case pt.overlay:return"覆盖";default:return"未知"}}},bt={none:"none",slideFromLeft:"slideFromLeft",slideFromRight:"slideFromRight",slideFromBottom:"slideFromBottom",slideFromTop:"slideFromTop"},vt={tap:"tap",drag:"drag",time:"time",voice:"voice"},gt=function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e){var n;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return l["a"]&&(e="".concat(location.protocol,"//").concat(location.host).concat(e)),t.next=3,dt(e,{timeout:1e4});case 3:if(n=t.sent,Object(l["o"])(n)){t.next=6;break}throw new Error("无法解析".concat(e,"的返回值:").concat(n));case 6:return t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function wt(t,e){return"".concat(t,":").concat(e)}function xt(t){var e={};return t.forEach((function(t){var n=t.artboard;e[wt(n.fileType,n.guid)]=n})),e}function yt(t){if(l["a"]&&console.log("getInteractionDatas",t),Object(l["g"])(t)){var e=xt(t);t.forEach((function(t){Ct(t.artboard,e)}))}}function Ct(t,e){return kt.apply(this,arguments)}function kt(){return kt=Object(i["a"])(Object(r["a"])().mark((function t(e,n){var i,a,o,s;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=e.pathInteraction,a=e.interactionInfo,i){t.next=6;break}return a.fetchState=c["FetchState"].Success,a.errMsg=null,a.data=null,t.abrupt("return");case 6:return a.fetchState=c["FetchState"].Fetching,a.errMsg=null,t.prev=8,t.next=11,gt(i);case 11:o=t.sent,s=e.fileType,At(o,e),St(o,s,n),a.data=o,a.fetchState=c["FetchState"].Success,t.next=24;break;case 19:t.prev=19,t.t0=t["catch"](8),a.fetchState=c["FetchState"].Error,a.errMsg=t.t0,a.data=null;case 24:case"end":return t.stop()}}),t,null,[[8,19]])}))),kt.apply(this,arguments)}function St(t,e,n){return _t.apply(this,arguments)}function _t(){return _t=Object(i["a"])(Object(r["a"])().mark((function t(e,n,i){var a,o;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=null===e||void 0===e?void 0:e.interactions,Object(l["g"])(a)){t.next=3;break}return t.abrupt("return");case 3:o=e.renderInteractions=[],a.forEach((function(t){if(Object(l["o"])(t)&&Object(l["g"])(t.interactions)){var e=t.renderInteractions=[];t.interactions.forEach((function(t){if(Object(l["o"])(t)){switch(t.trigger_type){case vt.tap:break;default:return}switch(t.type){case pt.goBack:e.push(t);break;case pt.goToArtboard:case pt.overlay:var r=t.toArtboard;if(!Object(l["h"])(r))return;var a=i[wt(n,r)];t.toArtboardItem=a,e.push(t);break;default:return}var o=t.transition,s=t.animationType;if(s&&!o)switch(o=t.transition={duration:.3,easing:"linear"},s){case bt.slideFromBottom:o.type="slide",o.fromSide="T";break;case bt.slideFromLeft:o.type="slide",o.fromSide="R";break;case bt.slideFromRight:o.type="slide",o.fromSide="L";break;case bt.slideFromTop:o.type="slide",o.fromSide="B";break;default:o.type="dissolve";break}}})),e.length>0&&(t.renderTapInteraction=e.find((function(t){return t.trigger_type===vt.tap})),o.push(t),t.mlIgnoreEvent=!1,t.mlIgnoreLeftSide=!1)}}));case 5:case"end":return t.stop()}}),t)}))),_t.apply(this,arguments)}function At(t,e){if(Object(l["o"])(t)){var n,r={artScale:null!==(n=ee(e.pageGuid,e.docGuid))&&void 0!==n?n:t.scale,fileType:null},i=t.interactions,a=t.artboardMap;switch(t.docGuid=e.docGuid,t.pluginPlatform){case"xd":r.fileType=o["h"].XD,Object(l["g"])(i)&&i.forEach((function(t){Gt(a,t,null,r)}));break;case"sketch":r.fileType=o["h"].SKETCH;var s={};if(Object(l["g"])(i)&&i.forEach((function(t){s[t.guid]=t})),Object(l["o"])(a)){var c=["boundsInParent","globalBounds","frame","globalDrawBounds","globalBounds","boundsInArtboard","boundSameWithArtboard"],u=function t(e,n){var i;Gt(a,e,n,r),null===(i=e.layers)||void 0===i||i.forEach((function(n){n&&(n.parentNode=e,t(n,e))}));var o=s[e.guid];o&&c.forEach((function(t){o[t]=e[t]}))};u(a,null)}break;default:throw new Error("lost pluginPlatform")}}}function It(t,e){var n=new F(t.maxRect.x-t.rect.x,t.maxRect.y-t.rect.y),r=new F(e.maxRect.x-e.rect.x,e.maxRect.y-e.rect.y);return r.x-=n.x,r.y-=n.y,r}function Tt(t,e,n,r,i){var a,o=null===e||void 0===e?void 0:e.renderTapInteraction;if(!o)return null;var c,u,h=!1;switch(o.type){case pt.goToArtboard:case pt.overlay:a=!1;break;case pt.goBack:a=!0;break;default:return null}var f=!0;if(c=Object(s["a"])({},e.boundsInArtboard),a)u=Object(s["a"])(Object(s["a"])({},c),{},{width:1,height:1}),u.x+=80+c.width,u.y=u.y+Math.round(c.height/2)-40;else{if(!o.toArtboardItem)return void(l["a"]&&console.log("存在目标画板未导出的原型",e));var m=o.toArtboardItem.pageGuid||o.toArtboardItem.docGuid;if(f=r===m,u=Object(s["a"])({},o.toArtboardItem.boundsInParentForList),u.x-=n.x,u.y-=n.y,!f){var p=t.find((function(t){return t.guid===r||t.docGuid===r})),b=t.find((function(t){return t.guid===m||t.docGuid===m}));if(!p)return;if(null!=b){var v=It(p,b);u.x-=v.x,u.y-=v.y}else h=!0,u=Object(s["a"])(Object(s["a"])({},c),{},{width:1,height:1}),u.x+=80+c.width,u.y=u.y+Math.round(c.height/2)-40}}var g=i?0:40,w={width:20,height:20},x=w.width,y=c.x+c.width,C=c.y+g,k=C+Math.round(c.height/2),S=C+c.height,_=u.x-x,A=u.y+g-5,I=A+Math.round(u.height/2),T=A+u.height,O=Math.abs(_-y)<w.width;O&&Math.abs(I-k)<2*w.height&&(k=C+Math.round(2*c.height/3)),O&&Math.abs(I-k)<2*w.height&&(I=A+Math.round(u.height/3));var E,M,L,N,D=_-y,P=I-k,j=D>0?1:-1,R=P>0?1:-1;if("dca00925-9a24-4d73-ae2a-b0809fe413b9"===e.guid&&console.log(1111111,y,k,_,I,T,S),1===j)M=k+R*P*.2,E=y+.3*D,N=I-.1*R*P,L=y+.66*D;else{var B=Math.abs(D),V=Math.abs(P);B=Math.max(.3*B,200),V=Math.max(.1*B,80),E=y+B,M=k+R*V,L=_-B,N=I-R*V}var U=(new d["a"]).set(c.x,c.y+g,c.width,c.height),$={start:new F(y,k),p1:new F(E,M),p2:new F(L,N),end:new F(_+1,I)},H=h?"otherpage":a?"back":"go",z=H+"_default",W=Object(s["a"])(Object(s["a"])({},w),{},{x:_,y:I-x/2,href:i?void 0:Dt.urls[H],href_default:i?void 0:Dt.urls[z],img:i?Dt.imgs[H]:void 0,img_default:i?Dt.imgs[z]:void 0});return{isBack:a,isOtherPage:h,drawRect:J([(new d["a"]).set(U.x,U.y,U.width,U.height),(new d["a"]).set($.start.x,$.start.y,1,1),(new d["a"]).set($.p1.x,$.p1.y,1,1),(new d["a"]).set($.p2.x,$.p2.y,1,1),(new d["a"]).set($.end.x,$.end.y,1,1),(new d["a"]).set(W.x,W.y,W.width,W.height)]),nodeRect:U,curve:$,arrowIcon:W,sameParent:f}}function Ot(t,e,n,r){var i=Tt(t,e,n,r,!1);if(!i)return null;var a=i.nodeRect,o=i.curve;return i.nodeRect="M ".concat(a.x," ").concat(a.y," \n  l 0 ").concat(a.height,"\n  l ").concat(a.width," 0\n  l 0 -").concat(a.height,"\n  l -").concat(a.width," 0\n  Z"),i.curve="M ".concat(o.start.x," ").concat(o.start.y,"\n  C ").concat(o.p1.x,",").concat(o.p1.y,"\n    ").concat(o.p2.x,",").concat(o.p2.y,"\n  ").concat(o.end.x," ").concat(o.end.y),i}var Et="#1886FF",Mt="#cdcdda",Lt={otherpage:'<?xml version="1.0" encoding="UTF-8"?>\n  <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      <g  stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g  transform="translate(-827.000000, -471.000000)">\n              <g  transform="translate(827.000000, 471.000000)">\n                  <rect  fill="#1886FF" x="0" y="0" width="20" height="20" rx="4"></rect>\n                  <g  transform="translate(5.000000, 5.000000)" stroke="#FFFFFF" stroke-linecap="round" stroke-linejoin="round">\n                      <path d="M3.18917988,0 L1.3,0 C0.582029825,3.53933586e-16 -3.09970593e-16,0.582029825 0,1.3 L0,8.7 C8.79259876e-17,9.41797017 0.582029825,10 1.3,10 L8.7,10 C9.41797017,10 10,9.41797017 10,8.7 L10,6.92115218 L10,6.92115218" ></path>\n                      <polyline  points="5.59135462 1.13732349e-13 10 1.13732349e-13 10 4.53043169"></polyline>\n                      <line x1="4.16417796" y1="5.7565608" x2="10" y2="1.13664457e-13" ></line>\n                  </g>\n              </g>\n          </g>\n      </g>\n  </svg>',back:'<?xml version="1.0" encoding="UTF-8"?>\n  <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-827.000000, -447.000000)">\n              <g transform="translate(827.000000, 447.000000)">\n                  <rect fill="#1886FF" x="0" y="0" width="20" height="20" rx="4"></rect>\n                  <g transform="translate(5.000000, 3.999689)" stroke="#FFFFFF" stroke-linecap="round" stroke-linejoin="round">\n                      <polyline transform="translate(2.988418, 2.988418) rotate(-45.000000) translate(-2.988418, -2.988418) " points="1.01650178 5.1015487 0.875287378 0.875287378 5.1015487 1.01650178"></polyline>\n                      <path d="M0.685919732,3.01908886 L6.50938891,3.01908886 C8.43720018,3.01908886 10,4.58188868 10,6.50969995 C10,8.43751123 8.43720018,10.000311 6.50938891,10.000311 L2.06828362,10.000311 L2.06828362,10.000311"></path>\n                  </g>\n              </g>\n          </g>\n      </g>\n  </svg>',go:'<?xml version="1.0" encoding="UTF-8"?>\n  <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-807.000000, -392.000000)">\n              <g transform="translate(807.000000, 392.000000)">\n                  <path d="M0,0 L16,0 C18.209139,-4.05812251e-16 20,1.790861 20,4 L20,16 C20,18.209139 18.209139,20 16,20 L0,20 L0,20 L0,0 Z" fill="#1886FF" transform="translate(10.000000, 10.000000) scale(-1, 1) translate(-10.000000, -10.000000) "></path>\n                  <polyline stroke="#FFFFFF" stroke-linecap="round" stroke-linejoin="round" transform="translate(8.000000, 10.000000) scale(-1, 1) rotate(-45.000000) translate(-8.000000, -10.000000) " points="4 14 4 6 12 6"></polyline>\n              </g>\n          </g>\n      </g>\n  </svg>',flowStartIcon:'<?xml version="1.0" encoding="UTF-8"?>\n  <svg width="16px" height="26px" viewBox="0 0 16 26" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-232.000000, -323.000000)">\n              <g transform="translate(240.000000, 336.000000) scale(-1, 1) translate(-240.000000, -336.000000) translate(232.000000, 323.000000)">\n                  <path d="M0,0 L16,0 L16,26 L4,26 C1.790861,26 2.705415e-16,24.209139 0,22 L0,0 L0,0 Z" fill="#1886FF" transform="translate(8.000000, 13.000000) scale(-1, 1) translate(-8.000000, -13.000000) "></path>\n                  <path d="M8.04115209,9 L12,12.8990659 L12,13.7290307 L11.012,13.729 L11.0126751,16.7147272 L9.01944469,16.7147272 L9.019,13.729 L7.026,13.729 L7.02621423,16.7147272 L5.03298378,16.7147272 L5.032,13.729 L4,13.7290307 L4,12.8990659 L8.04115209,9 Z" fill="#FFFFFF" transform="translate(8.000000, 12.857364) scale(-1, 1) translate(-8.000000, -12.857364) "></path>\n              </g>\n          </g>\n      </g>\n  </svg>'};function Nt(t){return t=btoa(t),"data:image/svg+xml;base64,".concat(t)}var Dt={urls:{},imgs:{},sizes:{}};function Ft(t){var e=new Image;Dt.imgs[t]=e,e.onload=function(e){var n,r,i=Dt.sizes[t],a=e.target;i.width=null!==(n=a.naturalWidth)&&void 0!==n?n:a.width,i.height=null!==(r=a.naturalHeight)&&void 0!==r?r:a.height},e.src=Dt.urls[t]}function Pt(t){var e=Lt[t];e&&(e=e.replace(new RegExp(Et,"ig"),Mt),Lt["".concat(t,"_default")]=e)}function jt(t){Dt.urls[t]=Nt(Lt[t]),Dt.sizes[t]=new W}["otherpage","go","back"].forEach((function(t){Pt(t)})),Object.keys(Lt).forEach((function(t){jt(t),Ft(t)})),l["a"]&&(window.interactionSvgIcon=Dt),window.addEventListener("error",(function(t){var e=t.filename;if(e){var n=e.match(/marklion_artboard_id=(\w+)/);if(n&&(n=n[1],n)){e=e.replace(/\\/g,"/");var r=e.indexOf("/res/");-1!==r&&(e=e.substr(r+1)),r=e.indexOf("?"),-1!==r&&(e=e.substr(0,r)),e=decodeURIComponent(e);var i=Rt[n];i&&i(!1,"画板数据加载失败[".concat(e,"]"))}}}),!0),window.marklion_artboard=function(t,e){var n=null,r=null;if(arguments.length>2&&(n=arguments[0],t=arguments[1],e=arguments[2],arguments.length>3&&(r=arguments[3])),null!=t){var i=t._marklionBack,a=t._marklionCallId;if(i&&a){if(t._marklionBack=null,t._marklionCallId=null,Rt[a]=null,Object(l["g"])(n)){var o=n;n={},o.forEach((function(t){if(Object(l["o"])(t)){var e=t.name;Object(l["h"])(e)&&(n[e.toLowerCase()]=t.value)}}))}else if(Object(l["o"])(n)){var s=n;n={},Object.keys(s).forEach((function(t){n[t.toLowerCase()]=s[t]}))}i(!0,{artboard:e,linked:n,sizeMap:r})}}};var Rt={},Bt=1;function Vt(t){return new Promise((function(e,n){var r=document.createElement("script"),i=function(t){t&&null!=t.parentNode&&setTimeout((function(){t&&null!=t.parentNode&&(t.parentNode.removeChild(t),t=null)}),200)};r._marklionBack=function(t,a){r._marklionBack=null,r._marklionCallId=null,t?e(a):n(a),i(r),r=null},r.addEventListener("error",(function(e){var n=e.target._marklionBack;n&&n(!1,"画板数据加载失败[".concat(t,"]"))})),r.addEventListener("load",(function(t){i(t.target)}));var a="marklion_".concat(Date.now(),"_").concat(Bt++);r._marklionCallId=a,r.src=t+"?marklion_artboard_id="+a,Rt[a]=r._marklionBack,document.body.appendChild(r)}))}function Ut(t,e,n,r){if(void 0===t.markedForExport&&(t.markedForExport=!1),null==t.mlOutputTime&&(t.mlOutputTime=Date.now()),n){var i,a,o,s,u;t.cid=n.cid,t.replies=n.replies,t.scale=n.scale,t.commentUpdateTime=n.commentUpdateTime;var d=n.boundsInParent||n.frame,h=t.boundsInParent||t.frame;d&&h&&(c["globalData"].inCloudMode?(h.x=d.x,h.y=d.y,h.width=d.width,h.height=d.height):(h.x=d.x,h.y=d.y)),t.pageGuid||(t.pageGuid=n.pageGuid),null==t.flowStart&&(t.flowStart=null!==(i=n.flowStart)&&void 0!==i&&i),null==t.flowName&&(t.flowName=null!==(a=n.flowName)&&void 0!==a?a:""),t.docName=null!==(o=t.docName)&&void 0!==o?o:n.docName,t.pageName=null!==(s=t.pageName)&&void 0!==s?s:n.pageName,t.fileType=null!==(u=t.fileType)&&void 0!==u?u:n.fileType,t.comments=n.comments,t.resNodeCount=n.resNodeCount,t.pathData=n.pathData,t.pathPreview=n.pathPreview,t.pathPreviewWebp=n.pathPreviewWebp,t.pathInteraction=n.pathInteraction,t.pathPreviewMini=n.pathPreviewMini,t.updaterName=n.updaterName,t.updateTimeStr=n.updateTimeStr,t.docGuid=n.docGuid,t.interactionInfo=n.interactionInfo,t.boundsInParentForList=n.boundsInParentForList,n.name&&(t.name=n.name)}else c["globalData"].inCloudMode&&(t.interactionInfo={fetchState:c["FetchState"].Normal,data:null,errMsg:null});c["globalData"].inCloudMode?(t.artboardPreviewPng=t.pathPreview,t.artboardPreviewWebp=t.pathPreviewWebp,t.artboardPreviewThumbPng=t.pathPreviewMini,t.artboardPreviewJS=null):t.artboardPath&&(t.artboardPath="res/".concat(encodeURIComponent(t.artboardPath)),t.artboardPreviewPng=t.artboardPath+"/preview.png",t.artboardPreviewWebp=null,t.artboardPreviewJS=t.artboardPath+"/preview.js",t.artboardPreviewThumbPng=t.artboardPath+"/preview.mini.png");var f=t.mlConfig;f||(f=t.mlConfig={});var m=f.scalesObj={};if(f.linked=e||{},f.sizeMap=r||{},Object(l["g"])(f.scales)){f.scales.forEach((function(t){m[t]=1}));var p=null;[2,3,1.5,1,4].forEach((function(t){null==p&&1===m[t]&&(p=t)})),f.previewScalePath=p?1===p?"":"@".concat(p,"x"):""}}var $t=function(t){if(t){var e=t.guid;if(e)if(t.markedForExport){var n="".concat(c["globalData"].documentGuid,"_").concat(e),r=Object(c["getLocalStorage"])(n,!1);t.mlCustomName=Object(c["getSafePathName"])(r)}else t.mlCustomName=null}};function Ht(t,e,n){n.mlUserSelectDown=!1,e.push(n);var r=n.mlConfig;r||(r=n.mlConfig={});var i=t.artboardPath;if(Object(c["hadExportPng"])(t)){var a="".concat(n.exportPath).concat(t.mlConfig.previewScalePath,".png");r.pngPreview=Object(c["fixedLinkedResUrl"])(t,"".concat(i,"/png/"),a)}else if(Object(c["hadExportWebP"])(t)){var o="".concat(n.exportPath).concat(t.mlConfig.previewScalePath,".webp");r.pngPreview=Object(c["fixedLinkedResUrl"])(t,"".concat(i,"/png/"),o)}else if(Object(c["hadExportSvg"])(t)){var s="".concat(n.exportPath,".svg");r.svgPreview=Object(c["fixedLinkedResUrl"])(t,"".concat(i,"/svg/"),s)}}function zt(t){if(t){var e=t;while(null!=(e=e.parentNode))if(e.maskGroup)return e}}function Wt(t,e){if(e!==t&&1!==e.types.Artboard&&!e.markedForExport){var n=zt(e);if(n){var r=n.globalBounds,i=e.globalBounds;if(!Object(d["e"])(r,i)){var a=Object(d["d"])(r,i);a||(a=new d["a"]);var o=i.x-a.x,s=i.y-a.y,c=e.boundsInArtboard,l=e.boundsInParent;c&&(c.x-=o,c.y-=s,c.width=a.width,c.height=a.height),l&&(l.x-=o,l.y-=s,l.width=a.width,l.height=a.height),i.x=a.x,i.y=a.y,i.width=a.width,i.height=a.height}}}}function Gt(t,e,n,r){var i,a;void 0===e.markedForExport&&(e.markedForExport=!1),r||(r=t.mlConfig);var s,u,h=null!==(i=null===(a=r)||void 0===a?void 0:a.fileType)&&void 0!==i?i:null;switch(null==h&&(h=o["h"].XD),h){case o["h"].SKETCH:S(t,e,n);break;case o["h"].XD:var f=e.styleRanges;Object(l["g"])(f)&&f.length>0&&f.forEach((function(t){var e=t.fontStyle;if(Object(l["h"])(e)){var n=/(?:\s|^)(thin|hairline|extralight|ultralight|light|regular|book|roman|medium|semibold|demibold|black|heavy|extrabold|ultrabold|bold|bolder|lighter|medium|\d+)(?:\s|$)/i.exec(e);if(n)switch(t.fontWeight=n[1],t.fontWeight.toLowerCase()){case"thin":case"hairline":t.fontWeightCss="100";break;case"ultralight":case"extralight":t.fontWeightCss="200";break;case"light":t.fontWeightCss="300";break;case"regular":case"book":case"roman":case"normal":t.fontWeight="normal",t.fontWeightCss="400";break;case"medium":t.fontWeightCss="500";break;case"semibold":case"demibold":t.fontWeightCss="600";break;case"bold":t.fontWeightCss="700";break;case"extrabold":case"ultrabold":t.fontWeightCss="800";break;case"black":case"heavy":t.fontWeightCss="900";break;default:t.fontWeightCss=t.fontWeight}else t.fontWeight="Normal",t.fontWeightCss="400";n=/(?:\s|^)(italic|oblique)(?:\s|$)/i.exec(e),t.fontItalic=n?n[1].toLowerCase():"normal"}else t.fontWeight="Normal",t.fontWeightCss="400",t.fontItalic="normal"})),Wt(t,e);break}s=t.globalBounds,u=e.markedForExport?e.globalDrawBounds:e.globalBounds;var m=u.x-s.x,p=u.y-s.y,b=u.width,v=u.height;if(c["globalData"].inCloudMode){e.boundsInArtboardOrigin=(new d["a"]).set(m,p,b,v);var g=r?r.artScale:1;(null==g||g<=0)&&(g=1),1!==g&&(m=Object(d["b"])(m,g,!1),p=Object(d["b"])(p,g,!1),b=Object(d["b"])(u.width,g,e.markedForExport),v=Object(d["b"])(u.height,g,e.markedForExport))}e.boundsInArtboard=(new d["a"]).set(m,p,b,v),e.boundSameWithArtboard=t!==e&&e.boundsInArtboard.isSame(t.boundsInArtboard)}function Yt(t,e,n,r,i){var a=n.children||n.layers;a.forEach((function(a){if(a)if(a.parentNode=n,Gt(t,a,n),$t(a),a.markedForExport){if(Ht(t,i,a),e.push(a),r.push(a),Object(l["g"])(a.children||a.layers)){var o=[];Yt(t,e,a,o,i),a.children&&(a.children=o),a.layers&&(a.layers=o)}}else Object(l["g"])(a.children||a.layers)&&Yt(t,e,a,r,i),a.children=a.layers=null}))}function Xt(t,e,n,r){if(!r.markedForExport){var i=r.opacity;if(0!=i){var a=r.types;if(t){if(!Object(d["f"])(e.boundsInArtboard,r.boundsInArtboard))return r.mlIgnoreEvent=!0,void(r.mlIgnoreLeftSide=!0);if((r.type===o["A"].Group||r.type===o["A"].SymbolMaster)&&v(n,r))return void(r.mlIgnoreEvent=!0);if(1===a.Group&&1==i&&null==r.shadow&&null==r.innerShadow&&(null==r.stroke||!r.strokeEnabled)&&(null==r.fill||!r.fillEnabled||r.fill.value))return void(r.mlIgnoreEvent=!0)}(!r.boundSameWithArtboard||1!==a.Group&&(1!==a.Path||null!=r.fill&&r.fillEnabled))&&(1!==i||1!==a.Path&&r.type!==o["A"].HotSpot&&1!==a.RepeatGrid&&(1!==a.Group||r.maskGroup)&&(1!==a.SymbolInstance||r.maskGroup)||null!=r.shadow||null!=r.innerShadow||null!=r.fill&&r.fillEnabled||null!=r.stroke&&r.strokeEnabled)||(r.mlIgnoreEvent=!0)}else r.mlIgnoreEvent=!0}}function Kt(t,e,n,r,i,a){Gt(n,t,i),$t(t);var o=t.markedForExport;o&&Ht(n,r,t);var s=t.children||t.layers;if(Object(l["g"])(s))if(o){var c=[];Yt(n,e,t,c,r),t.children=c}else s.forEach((function(i){i.parentNode=t,e.push(i);try{Kt(i,e,n,r,t,a),Xt(a,n,t,i)}finally{i.mlIgnoreEvent&&!i.mlIgnoreLeftSide&&(i.mlIgnoreLeftSide=!i.children||0===i.children.length)}}))}function Zt(t){var e=0;while(null!=(t=t.parentNode))if(e++,t.types.Artboard)break;return e}var qt=function(t,e){return new Promise((function(n,r){if(t.isLoaded)return n(t);if(t.isFetching)return r(t);var i=t.artboard,s=i.pathData||i.artboardPath+"/data.js";t.isLoaded=!1,t.isFetching=!0,t.isError=!1,Vt(s).then((function(r){var s,u,d=r.artboard,h=r.linked,f=r.sizeMap,p=null!==(s=null===(u=d.mlConfig)||void 0===u?void 0:u.fileType)&&void 0!==s?s:o["h"].XD,b=p===o["h"].SKETCH;b&&m(d),Ut(d,h,i,f);var v=[d],g=[];Kt(d,v,d,g,null,b),t.artboard=d,d.nodeDepthIndex=0;var w=[],x=v.length,y=x-1,C={interactions:[]};if(v.forEach((function(t,e){if(a["a"].set(t,"nodeDepthIndex",Zt(t)),Object(l["g"])(t.interactions)&&C.interactions.push(t),0!==e&&t.markedForExport&&!(e>=y)){for(var n=-1,r=e+1;r<=y;r++){var i=v[r];if(!i)break;if(!i.boundsInArtboard||!i.boundsInArtboard.isSame(t.boundsInArtboard))break;n=r}-1!==n&&w.push({from:e,to:n})}})),c["globalData"].inCloudMode){var k=xt(e);St(C,p,k)}w.length>0&&w.forEach((function(t){var e=t.from,n=t.to,r=v[e],i=v[n];v[e]=i,v[n]=r})),t.childs=v,t.exportNodes=g,t.isLoaded=!0,t.isFetching=!1,t.isError=!1,n(t)})).catch((function(e){t.isLoaded=!0,t.isError=!0,t.isFetching=!1,t.loadErrMsg=e,r(t)}))}))};function Qt(t){t=Object(u["a"])(t);var e={};return t.forEach((function(t){var n=e[t.docGuid];n||(n=e[t.docGuid]=[]),n.push(t)})),Object.keys(e).forEach((function(n){var r=e[n];if(!(r.length<=1)){var i=r[0],a=i.docGuid,o=i.docName,s=i.fileType,c=[];r.forEach((function(t){c.push.apply(c,Object(u["a"])(t.arts))}));var l={arts:c,guid:a,name:o,fileType:s,docFullName:"".concat(o),docGuid:a,docName:o};t.push(l)}})),t.sort((function(t,e){return Object(c["localeCompareString"])(t.docFullName,e.docFullName)})),t}var Jt={count:0,loaded:0,resolve:null,initdata:[],artboards:null,defaultArtboardGuid:"",permission:!0,fileInfo:null,renderMode:o["n"].Normal,folderNotFound:!1,cloudNeedLogin:!1,cloudIsLogin:!1,cloudNickName:null,cloudUserEmail:null,cloudUserKey:null,cloudName:null,cloudKey:null,cloudVersion:null,documents:[]};function te(t){if(Jt.loaded+=1,t&&t({current:Jt.loaded,count:Jt.count}),Jt.loaded>=Jt.count){var e=Jt.resolve;e&&(Jt.resolve=null,re(),e())}}function ee(t,e){var n=t||e||"",r=c["globalData"].docsMinScale[n];return null==r&&(r=1),r}function ne(t){var e,n=ee(t.pageGuid,t.docGuid),r=t.boundsInParent;r&&(e=Object(s["a"])({},r)),e&&1!==n&&n>0&&(e.x=Math.round(e.x*n),e.y=Math.round(e.y*n),e.width=Math.ceil(e.width*n),e.height=Math.ceil(e.height*n)),t.boundsInParentForList=e}function re(){var t=function(t,e){var n=t.artboard,r=e.artboard,i=n.boundsInParent||n.frame,a=r.boundsInParent||r.frame;if(n.updateTimeTimes>0&&r.updateTimeTimes>0){var o=(new d["a"]).set(i.x,i.y,i.width,i.height),s=(new d["a"]).set(a.x,a.y,a.width,a.height);if(o.isOverlap(s)){var c=n.updateTimeTimes-r.updateTimeTimes;if(Math.abs(c)>1500){if(c>0)return 1;if(c<0)return-1}}}var l=i.y,u=a.y,h=Math.round(l/100),f=Math.round(u/100),m=h-f;if(m>0)return 1;if(m<0)return-1;var p=i.x,b=a.x,v=p-b;return v>0?1:-1},e=Jt.documents;if(e.splice(0),c["globalData"].inCloudMode){var n={};return Jt.initdata.forEach((function(t){var r=t.artboard,i=r.docName,a=r.docGuid,o=r.pageGuid,s=r.pageName,c=o||a||"",l=s||i||"",u="".concat(i).concat(s?"/".concat(s):"");ne(r);var d=n[c];d||(d=n[c]={arts:[],guid:c,name:l,fileType:r.fileType,docFullName:u,docGuid:a,docName:i},e.push(d)),d.arts.push(t)})),n=null,e.forEach((function(e){e.arts.sort(t),e.maxRect=Object(c["getArtboardsMaxRect"])(e.arts),e.rect=(new d["a"]).set(0,0,e.maxRect.width,e.maxRect.height)})),void e.sort((function(t,e){return Object(c["localeCompareString"])(t.docFullName,e.docFullName)}))}if(Jt.initdata.forEach((function(t){var e=t.artboard;e.boundsInParentForList=e.boundsInParent})),c["globalData"].fileType==o["h"].SKETCH){var r={};return Jt.initdata.forEach((function(t){var n=t.artboard,i=n.pageGuid||"",a=n.docName,s=n.docGuid,c=n.pageName||n.docName||"",l=r[i],u="".concat(a).concat(o["h"].getFileExt(o["h"].SKETCH)).concat(c?"/".concat(c):"");l||(l=r[i]=[],e.push({arts:l,guid:i,name:c,fileType:o["h"].SKETCH,docFullName:u,docGuid:s,docName:a})),l.push(t)})),r=null,e.forEach((function(e){e.arts.sort(t),e.maxRect=Object(c["getArtboardsMaxRect"])(e.arts),e.rect=(new d["a"]).set(0,0,e.maxRect.width,e.maxRect.height)})),void e.sort((function(t,e){return Object(c["localeCompareString"])(t.docFullName,e.docFullName)}))}e.splice(0,e.length),Jt.initdata.sort(t);var i=Jt.initdata[0],a=i||{},s=a.docName,l=a.docGuid,u=a.pageGuid,h=a.pageName,f=u||l||"",m=h||s||"",p=o["h"].XD,b="".concat(s).concat(o["h"].getFileExt(p)),v={arts:Jt.initdata,guid:f,name:m,fileType:p,docFullName:b,docGuid:l,docName:s};v.arts.sort(t),v.maxRect=Object(c["getArtboardsMaxRect"])(v.arts),v.rect=(new d["a"]).set(0,0,v.maxRect.width,v.maxRect.height),e.push(v)}function ie(t){var e={count:0,loaded:0,resolve:null,artboards:null,defaultArtboardGuid:"",permission:!0,fileInfo:null,folderNotFound:!1,cloudNeedLogin:!1,cloudIsLogin:!1,cloudNickName:null,cloudUserEmail:null,cloudUserKey:null,cloudName:null,cloudKey:null,cloudVersion:null};Jt.documents.splice(0),Jt.initdata.splice(0),Object.keys(e).forEach((function(t){Jt[t]=e[t]})),Object(l["o"])(t)||(t={artboards:[],guid:"No Data",name:"No Data",config:{guid:"",scales:[1,1.5,2,3,4],compressPNG:!0,supportFileProtocol:!1,platform:0}}),null==t.fileType&&(t.fileType=o["h"].XD);var n,r=t.cloudData;if(c["globalData"].docsMinScale={},c["globalData"].initTitle=document.title,c["globalData"].inCloudMode=Object(l["o"])(r),c["globalData"].fileType=t.fileType,c["globalData"].inCloudMode){var i,a;if(c["globalData"].documentGuid=r.folderId.toString(),c["globalData"].documentName=r.folderName,c["globalData"].config={guid:c["globalData"].documentGuid,scales:[1,1.5,2,3,4],compressPNG:!0,supportFileProtocol:!0,platform:0},Jt.defaultArtboardGuid=r.artboardGuid,Jt.parentFolder=r.parent,Jt.currentFolderId=r.folderId,r.fileInfo)r.fileInfo.name="".concat(r.fileInfo.fileName).concat(null!==(a=r.fileInfo.fileExt)&&void 0!==a?a:"");Jt.fileInfo=r.fileInfo,Jt.renderMode=null!==(i=r.renderMode)&&void 0!==i?i:o["n"].Normal,c["globalData"].cloudFolderId=r.folderId,Jt.permission=r.permission,Jt.folderNotFound=r.folderNotFound,Jt.cloudNeedLogin=r.needLogin,Jt.cloudIsLogin=r.isLogin,Jt.cloudNickName=r.nickName,Jt.cloudUserEmail=r.email,Jt.cloudUserKey=r.userKey,Jt.cloudName=r.cloudName,Jt.cloudKey=r.cloudKey,Jt.cloudVersion=r.cloudVersion,Object(l["o"])(r.folderInfo)&&(n=r.folderInfo.artboards,Jt.subFolders=r.folderInfo.folders,Jt.subFiles=r.folderInfo.files)}else switch(c["globalData"].documentGuid=t.guid,c["globalData"].documentName=t.name,c["globalData"].config=t.config,t.fileType){case o["h"].SKETCH:var s=t.pages;n=[],Object(l["g"])(s)&&s.forEach((function(t){t&&Object(l["g"])(t.artboards)&&t.artboards.forEach((function(e){e&&(e.pageGuid=t.guid,e.pageName=t.name,n.push(e))}))}));break;default:n=t.artboards;break}Object(l["g"])(Jt.subFolders)?Jt.subFolders.sort((function(t,e){return Object(c["localeCompareString"])(t.name,e.name)})):Jt.subFolders=[],Object(l["g"])(Jt.subFiles)?(Jt.subFiles.forEach((function(t){t.name=t.fileName+t.fileExt})),Jt.subFiles.sort((function(t,e){return Object(c["localeCompareString"])(t.name,e.name)}))):Jt.subFiles=[],Object(l["g"])(n)||(n=[]),Jt.artboards=n,Jt.count=n.length}var ae={dataInit:ie,get inCloudMode(){return c["globalData"].inCloudMode},get documentName(){return c["globalData"].documentName},get documentGuid(){return c["globalData"].documentGuid},get config(){return c["globalData"].config},get permission(){return Jt.permission},get cloudNeedLogin(){return Jt.cloudNeedLogin},get cloudIsLogin(){return Jt.cloudIsLogin},get cloudNickName(){return Jt.cloudNickName},get cloudUserEmail(){return Jt.cloudUserEmail},get cloudUserKey(){return Jt.cloudUserKey},get cloudName(){return Jt.cloudName},get cloudKey(){return Jt.cloudKey},get cloudVersion(){return Jt.cloudVersion},get documentArtboards(){return Jt.initdata},get documents(){return Jt.documents},cloud:{get folderNotFound(){return Jt.folderNotFound},get defaultArtboardGuid(){return Jt.defaultArtboardGuid},get parentFolder(){return Jt.parentFolder},get currentFolderId(){return Jt.currentFolderId},get subFolders(){return Jt.subFolders},get subFiles(){return Jt.subFiles},get renderMode(){return Jt.renderMode},get fileInfo(){return Jt.fileInfo}},allArtboardLoadChecked:function(t){return new Promise((function(e){0!==Jt.count?(Jt.resolve=e,Jt.artboards.forEach((function(e){Ut(e);var n={artboard:e,childs:[],exportNodes:[],loadErrMsg:null,isLoaded:!1,isFetching:!1,isError:!1,mlUserSelectDown:!0};if(Jt.initdata.push(n),c["globalData"].inCloudMode){var r=e.boundsInParent,i=e.scale,a=e.docGuid,o=e.pageGuid;if(r&&(("number"!==typeof i||i<=0)&&(i=1),1!==i)){var s=o||a,l=c["globalData"].docsMinScale[s];null==l&&(l=1),l>i&&(c["globalData"].docsMinScale[s]=i)}te(t)}else qt(n,[]).catch((function(t){var e=Jt.initdata.findIndex((function(e){return e===t}));-1!==e&&Jt.initdata.splice(e,1)})).finally((function(){te(t)}))}))):e()}))}};l["a"]&&(window.artboardLoadData=Jt,window.marklionData=ae);n("f89d"),n("8c15");var oe,se=n("7736"),ce=n("fe80"),le={device:{android:/([ ;/)(,]|^)Android([ ;/)(,]|$)/i,iphone:/([ ;/)(,]|^)iPhone([ ;/)(,]|$)/i,ipad:/([ ;/)(,]|^)ipad([ ;/)(,]|$)/i,ios:/([ ;/)(,]|^)ios([ ;/)(,]|$)/i,macos:/([ ;/)(,]|^)mac os([ ;/)(,]|$)/i,windows:/([ ;/)(,]|^)Windows([ ;/)(,]|$)/i,linux:/([ ;/)(,]|^)linux([ ;/)(,]|$)/i},maker:{mot:/([ ;/)(,]|^)mot([ ;/)(,]|$)/i},browser:{uc:/([ ;/)(,]|^)(UCBrowser|UCWEB)([ ;/)(,]|$)/i,safria:/([ ;/)(,]|^)Safari([ ;/)(,]|$)/i,aol:/([ ;/)(,]|^)aol([ ;/)(,]|$)/i,arora:/([ ;/)(,]|^)Arora([ ;/)(,]|$)/i,qqbrowser:/([ ;/)(,]|^)QQBrowser([ ;/)(,]|$)/i,mqqbrowser:/([ ;/)(,]|^)mQQBrowser([ ;/)(,]|$)/i,chrome:/([ ;/)(,]|^)(?:chrome|CriOS)([ ;/)(,]|$)/i,qq:/([ ;/)(,]|^)qq([ ;/)(,]|$)/i,microMessenger:/([ ;/)(,]|^)MicroMessenger([ ;/)(,]|$)/i,sogouMobileBrowser:/([ ;/)(,]|^)sogouMobileBrowser([ ;/)(,]|$)/i,baidubrowser:/([ ;/)(,]|^)baidubrowser([ ;/)(,]|$)/i,weibo:/([ ;/)(,]|^)weibo([ ;/)(,]|$)/i,firefox:/([ ;/)(,]|^)Firefox([ ;/)(,]|$)/i,baiduboxapp:/([ ;/)(,]|^)baiduboxapp([ ;/)(,]|$)/i,msie:/(?:[ ;/)(,]|^)(?:msie|rv)\s*:?\s*([\d.]+)/i,Edge:/(?:[ ;/)(,]|^)(?:Edge)\s*:?\s*([\d.]+)/i}},ue={safria:"Safria"},de=function(t){if(!t)return"";var e=le.browser;if(e.uc.test(t))return"UC浏览器";if(e.aol.test(t))return"AOL";if(e.Edge.test(t))return"Edge";if(e.arora.test(t))return"Arora";if(e.sogouMobileBrowser.test(t))return"搜狗浏览器";if(e.baidubrowser.test(t))return"百度浏览器";if(e.baiduboxapp.test(t))return"手机百度";if(e.weibo.test(t))return"微博客户端";if(e.microMessenger.test(t))return le.device.windows.test(t)||e.qqbrowser.test(t)?"微信电脑端":"微信手机端";if(e.qq.test(t))return"手机QQ";if(e.mqqbrowser.test(t))return"QQ浏览器";if(e.firefox.test(t))return"Firefox";if(e.chrome.test(t))return"Chrome";if(e.safria.test(t))return ue.safria;var n=e.msie.exec(t);return n?"IE"+n[1]:"Other"},he={android:"Android",iPhone:"iPhone",iPad:"iPad",iOS:"iOS",macOS:"macOS",windows:"Windows",linux:"Linux",other:"Other"},fe=function(t){if(t){var e=le.device;if(e.android.test(t))return{name:he.android,type:"android"};if(e.iphone.test(t))return{name:he.iPhone,type:"ios"};if(e.ipad.test(t))return{name:he.iPad,type:"ios"};if(e.ios.test(t))return{name:he.iOS,type:"ios"};if(e.macos.test(t))return{name:he.macOS,type:"ios"};if(e.windows.test(t))return{name:he.windows,type:"windows"};if(e.linux.test(t))return{name:he.linux,type:"linux"}}return{name:he.other,type:"other"}},me=function(t){if(void 0!==oe)return t(oe),void(t=null);var e=new Image,n=function(r){e.onerror=e.onload=null;var i=!(!r||"load"!==r.type)&&1==e.width;oe=i?pe.Support:pe.NotSupport,n=e=null,t(oe),t=null};e.onerror=n,e.onload=n,e.src="data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA="},pe={Checking:0,NotSupport:1,Support:2},be=function(){var t=navigator.userAgent,e=fe(t);switch(e.name){case he.macOS:case he.iPhone:case he.iPad:case he.iOS:break;default:return!1}var n=de(t);return n===ue.safria}(),ve=Object(_["a"])((function t(){Object(A["a"])(this,t),Object(I["a"])(this,"X",0),Object(I["a"])(this,"Y",0),Object(I["a"])(this,"Width",0),Object(I["a"])(this,"Height",0),Object(I["a"])(this,"Down",null),Object(I["a"])(this,"Right",null),Object(I["a"])(this,"Used",!1)})),ge=function(){function t(e,n){if(Object(A["a"])(this,t),Object(I["a"])(this,"Root",null),Object(I["a"])(this,"Margin",0),this.Margin=n,null!=e){e=Object(u["a"])(e);var r=0;e.forEach((function(t){r=Math.max(t.rect.width,r)})),e.unshift({rect:(new d["a"]).set(0,0,r,-n)});var i=e.length,a=null,o=null,s=0,c=0,l=2*n;if(!(i>0)){var h=this.Root=new ve;return h.Width=l,h.Height=l,h.X=n,void(h.Y=n)}o=e[0],s=o.rect.width+l,c=o.rect.height+l;var f=this.Root=new ve;f.Width=s,f.Height=c,f.X=n,f.Y=n;for(var m=0;m<i;m++){o=e[m],s=o.rect.width+n,c=o.rect.height+n,a=this.findNode(this.Root,s,c);var p=null;p=null!=a?this.splitNode(a,s,c):this.growNode(s,c),p&&(o.rect.x=p.X-n,o.rect.y=p.Y-n,o.rect.width=p.Width-n,o.rect.height=p.Height-n)}}}return Object(_["a"])(t,[{key:"compareMaxSide",value:function(t,e){var n;return n=this.compareMax_WH(t,e),0!=n?n>0?1:-1:(n=this.compareHeight_Width(t,e),0!=n?n>0?1:-1:1)}},{key:"compareMax_WH",value:function(t,e){var n=Math.max(e.rect.width,e.rect.height)-Math.max(t.rect.width,t.rect.height);return n}},{key:"compareHeight_Width",value:function(t,e){var n=this.compareHeight(t,e);return 0!=n?n>0?1:-1:this.compareWidth(t,e)}},{key:"compareWidth",value:function(t,e){return e.rect.width-t.rect.width}},{key:"compareHeight",value:function(t,e){return e.rect.height-t.rect.height}},{key:"findNode",value:function(t,e,n){if(null==t)return null;if(t.Used){var r=this.findNode(t.Right,e,n);return null!=r?r:this.findNode(t.Down,e,n)}return e<=t.Width&&n<=t.Height?t:null}},{key:"splitNode",value:function(t,e,n){t.Used=!0;var r=t.Right=new ve;r.X=t.X+e,r.Y=t.Y,r.Width=t.Width-e,r.Height=n;var i=t.Down=new ve;return i.X=t.X,i.Y=t.Y+n,i.Width=t.Width,i.Height=t.Height-n,t}},{key:"growNode",value:function(t,e){var n=!1;t<=this.Root.Width&&(n=!0);var r=!1;e<=this.Root.Height&&(r=!0);var i=r&&this.Root.Height>=this.Root.Width+t,a=n&&this.Root.Width>=this.Root.Height+e;return i?this.growRight(t,e):a?this.growDown(t,e):r?this.growRight(t,e):n?this.growDown(t,e):null}},{key:"growRight",value:function(t,e){var n=this.Root,r=this.Root=new ve;r.Used=!0,r.Width=n.Width+t,r.Height=n.Height,r.Y=this.Margin,r.X=this.Margin,r.Down=n;var i=r.Right=new ve;i.X=n.Width,i.Width=t,i.Height=n.Height,i.Y=this.Margin;var a=this.findNode(this.Root,t,e);return null!=a?this.splitNode(a,t,e):null}},{key:"growDown",value:function(t,e){var n=this.Root,r=this.Root=new ve;r.Used=!0,r.Width=n.Width,r.Height=n.Height+e,r.Y=this.Margin,r.X=this.Margin,this.Root.Right=n;var i=this.Root.Down=new ve;i.Y=n.Height,i.Width=n.Width,i.Height=e,i.X=this.Margin;var a=this.findNode(this.Root,t,e);return null!=a?this.splitNode(a,t,e):null}}]),t}(),we=Object(_["a"])((function t(e){var n=e.name,r=void 0===n?null:n,i=e.list,a=void 0===i?null:i;Object(A["a"])(this,t),Object(I["a"])(this,"name",null),Object(I["a"])(this,"list",null),Object(I["a"])(this,"type",xe.Group),this.name=r,this.list=a})),xe={Group:0,Web:1,Mobile:2,Custom:3},ye=Object(_["a"])((function t(e){var n=e.name,r=void 0===n?null:n,i=e.width,a=void 0===i?0:i,o=e.height,s=void 0===o?0:o,c=e.type,l=void 0===c?xe.Mobile:c,u=e.hasBangs,d=void 0!==u&&u;Object(A["a"])(this,t),Object(I["a"])(this,"name",null),Object(I["a"])(this,"type",xe.Mobile),Object(I["a"])(this,"width",0),Object(I["a"])(this,"height",0),Object(I["a"])(this,"hasBangs",!1),this.name=r,this.type=l,this.width=a,this.height=s,this.hasBangs=d})),Ce=[new ye({name:"Web",type:xe.Web}),new we({name:"iPhone",list:[new ye({name:"iPhone 13 Pro Max",width:428,height:926,hasBangs:!0}),new ye({name:"iPhone 13 Pro",width:428,height:844,hasBangs:!0}),new ye({name:"iPhone XR",width:414,height:896,hasBangs:!0}),new ye({name:"iPhone X",width:375,height:812,hasBangs:!0}),new ye({name:"iPhone 8 plus",width:414,height:736}),new ye({name:"iPhone SE",width:375,height:667})]}),new we({name:"Android",list:[new ye({name:"Google Pixel 6 Pro",width:412,height:891}),new ye({name:"OnePlus 9 Pro",width:412,height:919}),new ye({name:"HuaWei Mate40 Pro",width:448,height:924}),new ye({name:"XiaoMi 11",width:412,height:915}),new ye({name:"Oppo 11",width:360,height:780}),new ye({name:"Vivo 11",width:360,height:760})]}),new ye({name:"iPad",width:768,height:1024}),new ye({name:"自定义尺寸",type:xe.Custom})],ke=function(){for(var t="iPhone X",e=0,n=Ce.length;e<n;e++){var r=Ce[e];if(r)switch(r.type){case xe.Group:var i,a=null===(i=r.list)||void 0===i?void 0:i.find((function(e){return(null===e||void 0===e?void 0:e.name)===t}));if(a)return a;break;default:if(r.name===t)return r}}return null}(),Se=function(){function t(){Object(A["a"])(this,t),Object(I["a"])(this,"historyList",[]),Object(I["a"])(this,"historyIndex",0),Object(I["a"])(this,"onpopstate",null),l["f"]&&this.pushState(null)}return Object(_["a"])(t,[{key:"length",get:function(){return l["f"]?Math.min(this.historyList.length,this.historyIndex+1):history.length}},{key:"state",get:function(){if(l["f"]){var t=this.historyList[this.historyIndex];return t?t.state:null}return history.state}},{key:"href",get:function(){if(l["f"]){var t,e=this.historyList[this.historyIndex];return e&&(null!==(t=e.href)&&void 0!==t)?t:""}return location.href}},{key:"pushState",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(l["f"]){var r=this.historyList,i=this.historyIndex,a=r.length;return i!=a-1&&r.splice(i+1),n||(n=location.href),r.push({state:t,href:n}),void(this.historyIndex=r.length-1)}n&&history.pushState(t,e,n)}},{key:"go",value:function(t){if(l["f"]){if(0===t)return;var e=this.historyList,n=this.historyIndex,r=this.onpopstate,i=e.length,a=t>0?Math.min(n+t,i-1):Math.max(0,n+t);if(n===a)return;this.historyIndex=a;var o=e[a];r&&r({state:o.state,marklion_href:o.href})}else history.go(t)}}]),t}(),_e=new Se;a["a"].use(se["a"]);var Ae,Ie=!1;function Te(){if(c["globalData"].inCloudMode&&history.pushState){var t=function(t){var e,n,r,i,a=t.state,o=t.marklion_href;if(l["a"]&&console.log("popstate",t),Object(l["o"])(a))e=a.artboardGuid,n=a.nodeGuid,r=a.filterDocumentGuid,i=a.curArtboardExtral;else{var s=o||window.location.href,u=/\/(?:file|interaction)?viewer\/(\d+)(?:\/([\w-]+)(?:\/([\w-]+)\/)?)?/.exec(s);u?(e=u[2],n=u[3]):(n=null,e=null),r=Object(c["queryString"])("filterDoc")}if("none"===r)r=null;else if(r){var d=Le.state.sortDocumentsWithSketchDocument.find((function(t){return t.guid===r}));if(d){var h=Le.state.documentArtboards.find((function(t){var n=t.artboard;return n.guid===e&&n.docGuid===d.guid||n.pageGuid===d.guid}));e&&!h&&(r=null)}else r=null}var f=null,m=null;e&&(f=Le.state.documentArtboards.find((function(t){return t.artboard.guid===e})),f&&n&&(m=f.childs.find((function(t){return t.guid===n})))),Ie=!0,setTimeout((function(){Ie=!1}),50),f!=Le.state.curArtboard&&Le.commit("curArtboard",{artboard:f,extral:i}),m!=Le.state.curNode&&Le.commit("curNode",m),r!=Le.state.filterDocumentGuid&&Le.commit("setFilterDocumentGuid",r)};_e.onpopstate=t,window.addEventListener("popstate",t)}}function Oe(){var t=Le.state,e="";t.inCloudMode?(t.cloudNeedLogin&&!t.cloudIsLogin||(t.cloud.folderNotFound?e+="链接已失效 - ":t.cloud.renderMode==o["n"].File&&null!=t.cloud.fileInfo?e+="".concat(t.cloud.fileInfo.name," - ").concat(c["globalData"].documentName," - "):t.curArtboard?e+="".concat(t.curArtboard.artboard.name," - ").concat(c["globalData"].documentName," - "):e+="".concat(c["globalData"].documentName," - ")),t.cloudName&&(e+="".concat(t.cloudName," - "))):e+="".concat(c["globalData"].documentName," - "),document.title=e+c["globalData"].initTitle}function Ee(t){t.allArtboardLoadChecked&&(clearTimeout(Ae),Ae=setTimeout((function(){Me(t)}),33))}function Me(t){var e=t.curArtboard,n=t.curNode,r=t.filterDocumentGuid,i=t.curArtboardExtral;if(Oe(),c["globalData"].inCloudMode){if(t.cloudNeedLogin&&!t.cloudIsLogin||!t.permission)return;if(!history.pushState)return;if(Ie)return void(l["a"]&&console.log("inPopState"));var a,s,u;switch(t.cloud.renderMode){case o["n"].File:a="fileviewer";break;case o["n"].Interaction:a="interactionviewer";break;default:a="viewer";break}a="/".concat(a,"/").concat(c["globalData"].cloudFolderId,"/"),e&&(s=e.artboard.guid,a+="".concat(encodeURIComponent(s),"/")),n&&(u=n.guid,a+="".concat(encodeURIComponent(u),"/"));var d=!1,h=function(t,e){a+="".concat(d?"&":"?").concat(t,"=").concat(encodeURIComponent(e)),d=!0};r&&h("filterDoc",r);var f=_e.href;if(f.indexOf(a)===f.length-a.length)return;_e.pushState({artboardGuid:s,nodeGuid:u,filterDocumentGuid:r,curArtboardExtral:i},null,a)}else{var m="#";e&&(m+="/artboard/".concat(e.artboard.guid)),n&&(m+="/node/".concat(n.guid)),location.hash!==m&&(location.hash=m)}}var Le=new se["a"].Store({state:{webViewHidden:Object(c["isWebViewHidden"])(),config:null,allArtboardLoadChecked:!1,artboardLoadProgress:{current:0,count:1},documentGuid:null,documentName:null,curArtboard:null,curArtboardExtral:null,curNode:null,clickedNode:null,enterNode:null,enterArtboard:null,documentArtboards:[],renderDocumentArtboards:[],documents:[],sortDocumentsWithSketchDocument:[],renderDocuments:[],filterDocumentGuid:null,isSupportWebp:pe.Checking,scale:{artboard:1,list:1,resetList:0,resetArtboard:0},setting:{color:{items:["rgba","hex","ahex","hexa","hsla"],current:0},numberAutoRound:!1,exportBoxBackground:o["q"].Transparent},platform:{type:o["b"].WEB,customUnit:o["c"].PX,customDocWidth:0},unitTemplate:{template:"",enable:!1},androidUseMipmap:"1"===Object(c["getLocalStorage"])("androidUseMipmap",!1),textTip:{visible:!1,text:"",handle:0},inMultDownMode:!1,inArtboardMultDownMode:!1,inOutput:!1,artboardMenu:{visible:!1,x:0,y:0,artboard:null},helper:{visible:!1,handle:0},inCloudMode:!1,permission:!0,cloudNeedLogin:!1,cloudIsLogin:!1,cloudNickName:null,cloudUserEmail:null,cloudUserKey:null,cloudName:null,cloudKey:null,cloudVersion:null,cloud:{folderNotFound:!1,defaultArtboardGuid:"",parentFolder:null,currentFolderId:0,subFolders:[],subFiles:[],allFoldersBoxVisible:!1,renderMode:o["n"].Normal,fileInfo:null},resetScaleSceneCenter:null,selectArtboardChanged:null,artboardListUseCanvas:!0,artboardShowInteractionLine:!0,artboardInComment:"1"===Object(c["getLocalStorage"])("artboardInComment",!1),artboardCommentVisible:!1,pointCommentShowAlways:!1,editComment:{drawing:!1,instance:null,drawInfo:{action:E.None,histories:[],historyIndex:-1,historyIndexChanges:0,colorIndex:2,fontSize:L,brushSize:N.Normal,selectItem:null,enterItem:null},pointInfo:{preventPoint:{x:0,y:0,enable:!1},point:{x:0,y:0,enable:!1,pointIndex:0},instance:null}},imageViewer:{visible:!1,imgList:null,scale:0,currentIndex:0,resetScale:0},commentEditorVisibleId:0,userNotify:{cloudList:{},visible:!1,location:{top:120,right:0},sysTipIds:{},commentUpdateStates:{},cloudUsersByCloud:{}},autoIntoInfo:{commentId:0,commentArtboardId:0,isReply:!1},artboardDetail:{leftSideVisible:"1"===Object(c["getLocalStorage"])("leftside.visible",!1),comments:null,commentUsers:null,maxPointIndex:0,selectComment:null,notScrollList:!1,interactionSet:{hoverGuid:"",headerVisible:"0"!==Object(c["getLocalStorage"])("interaction.header.visible",!1),history:[],backgroundColor:Object(c["getLocalStorage"])("interaction.background",!1)||"#e8e9e8",rectAlwaysVisible:"0"!==Object(c["getLocalStorage"])("interaction.rect-always-visible",!1),pcDeviceSet:{name:"Web",type:xe.Web,width:0,height:0,isHorizontal:!1,hasBangs:!1},overlayArtboards:[],gobackArtboard:null,gotoArtboard:null}},mobileInteraction:{listFetchState:c["FetchState"].Normal,listConfig:{sortType:o["f"].Name,orderDesc:!1,renderType:o["g"].All},searchText:"",controlVisible:!1,mobileSize:{width:0,height:0},scrollYCache:{}}},mutations:{setWebViewHidden:function(t,e){t.webViewHidden=e},setMobileInteractionListConfig:function(t,e){var n="m-interaction-list-config",r=t.mobileInteraction.listConfig,i=!1;Object(l["o"])(e)||(Object(c["removeLocalStorage"])(n),i=!0,e={sortType:o["f"].Name,orderDesc:!1,renderType:o["g"].All}),Object.keys(e).forEach((function(t){void 0!==r[t]&&(r[t]=e[t])})),i||Object(c["setLocalStorage"])(n,r)},setPCDeviceSet:function(t,e){if(Object(l["o"])(e)){var n=t.artboardDetail.interactionSet.pcDeviceSet;Object.keys(n).forEach((function(t){var r=e[t];void 0!==r&&(n[t]=r)})),Object(c["setLocalStorage"])("interaction.pcdeviceset",n)}},setInteractionRectAlwaysVisible:function(t,e){t.artboardDetail.interactionSet.rectAlwaysVisible!==e&&(t.artboardDetail.interactionSet.rectAlwaysVisible=e,Object(c["setLocalStorage"])("interaction.rect-always-visible",e?"1":"0"))},setInteractionBackground:function(t,e){t.artboardDetail.interactionSet.backgroundColor!==e&&(t.artboardDetail.interactionSet.backgroundColor=e,Object(c["setLocalStorage"])("interaction.background",e))},setInteractionHeaderVisible:function(t,e){t.artboardDetail.interactionSet.headerVisible!==e&&(t.artboardDetail.interactionSet.headerVisible=e,Object(c["setLocalStorage"])("interaction.header.visible",e?"1":"0"))},setInteractionArtboard:function(t,e){var n=this;return Object(i["a"])(Object(r["a"])().mark((function i(){var a,u,d,h,f,m,p,b,v,g,w,x,y,C,k,S,_,A,I;return Object(r["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:if(a=t.artboardDetail.interactionSet,!a.gotoArtboard&&!a.gobackArtboard){r.next=5;break}return r.abrupt("return");case 5:u=a.overlayArtboards,d=null,h=t.cloud.renderMode===o["n"].Interaction,f=e.type,f!==pt.overlay||h||(f=pt.goToArtboard),m=h&&(l["e"]||a.pcDeviceSet.type!==xe.Web),r.t0=f,r.next=r.t0===pt.goBack?14:r.t0===pt.goToArtboard?41:r.t0===pt.overlay?68:83;break;case 14:if(h){r.next=17;break}return n.commit("Tip_showTextTip",{text:"返回到原型的上一个画板"}),r.abrupt("return");case 17:if(!(u.length>0)){r.next=25;break}if(p=u[u.length-1],!p.visible){r.next=23;break}return p.visible=!1,r.next=23,Object(c["threadSleep"])(1e3*((null===(b=p.renderTapInteraction.transition)||void 0===b?void 0:b.duration)||.3));case 23:return u.splice(0),r.abrupt("return");case 25:if(null!=_e.state){r.next=28;break}return n.commit("Tip_showTextTip",{text:"没有可返回的上一个画板"}),r.abrupt("return");case 28:if(_e.go(-1),v=t.curArtboardExtral,!Object(l["o"])(v)){r.next=40;break}if(g=v.renderTapInteraction,w=v.fromArtboard,!g||!w){r.next=40;break}if(!m){r.next=40;break}return a.gotoArtboard=null,a.gobackArtboard={renderTapInteraction:g,fromArtboard:t.curArtboard},l["a"]&&console.log("goBack",g,w),r.next=39,Object(c["threadSleep"])(1e3*((null===(x=g.transition)||void 0===x?void 0:x.duration)||.3));case 39:a.gobackArtboard=null;case 40:return r.abrupt("break",85);case 41:if(d=e.toArtboardItem,d){r.next=45;break}return n.commit("Tip_showTextTip",{text:"目标画板未上传到私有云"}),r.abrupt("return");case 45:if(k=d.cid,d=t.documentArtboards.find((function(t){var e;return(null===t||void 0===t||null===(e=t.artboard)||void 0===e?void 0:e.cid)===k})),d){r.next=50;break}return n.commit("Tip_showTextTip",{text:"目标画板未上传到私有云"}),r.abrupt("return");case 50:if(d!==t.curArtboard){r.next=53;break}return n.commit("Tip_showTextTip",{text:"目标画板和当前画板是同一个画板"}),r.abrupt("return");case 53:if(S=t.mobileInteraction.scrollYCache,delete S[k],e=Object(s["a"])({},e),delete e.toArtboardItem,l["a"]&&console.log("goArtboard",e,d),!m){r.next=64;break}return a.gobackArtboard=null,a.gotoArtboard={renderTapInteraction:e,fromArtboard:d},r.next=63,Object(c["threadSleep"])(1e3*((null===(_=e.transition)||void 0===_?void 0:_.duration)||.3));case 63:a.gotoArtboard=null;case 64:return A=t.filterDocumentGuid,A&&(null===(y=d.artboard)||void 0===y?void 0:y.docGuid)!==A&&(null===(C=d.artboard)||void 0===C?void 0:C.pageGuid)!==A&&n.commit("setFilterDocumentGuid",null),n.commit("curArtboard",{artboard:d,extral:{renderTapInteraction:e,fromArtboard:t.curArtboard}}),r.abrupt("break",85);case 68:if(d=e.toArtboardItem,!d){r.next=80;break}if(e=Object(s["a"])({},e),delete e.toArtboardItem,!(u.length>0)){r.next=77;break}if(I=u[u.length-1],I.artboard!==d){r.next=76;break}return r.abrupt("return");case 76:I.visible=!1;case 77:u.push({artboard:d,renderTapInteraction:e,visible:!0}),r.next=82;break;case 80:return n.commit("Tip_showTextTip",{text:"目标画板未上传到私有云"}),r.abrupt("return");case 82:return r.abrupt("break",85);case 83:return n.commit("Tip_showTextTip",{text:"未知的原型操作,无法跳转"}),r.abrupt("return");case 85:case"end":return r.stop()}}),i)})))()},setRenderDocuments:function(t){var e,n=t.filterDocumentGuid;e=Object(l["h"])(n)?t.documents.filter((function(t){return t.guid===n||t.docGuid===n})):t.documents,e.forEach((function(t){t.maxRect=Object(c["getArtboardsMaxRect"])(t.arts),t.rect=(new d["a"]).set(0,0,t.maxRect.width,t.maxRect.height)})),e.length>1&&(new ge(e,150),e.forEach((function(t){t.rect.width=t.maxRect.width,t.rect.height=t.maxRect.height}))),t.renderDocuments=e;var r=[];e.forEach((function(t){t&&Object(l["g"])(t.arts)&&t.arts.forEach((function(t){r.push(t)}))})),t.renderDocumentArtboards=r},setFilterDocumentGuid:function(t,e){if(t.filterDocumentGuid!=e){if(t.filterDocumentGuid=e,this.commit("setRenderDocuments"),e){var n=t.curArtboard;if(n){var r=n.artboard,i=r.docGuid,a=r.pageGuid;if(i!=e&&a!=e){var o=t.sortDocumentsWithSketchDocument.find((function(t){return t.guid==e})),s=null===o||void 0===o?void 0:o.arts[0];return void this.commit("curArtboard",{artboard:s})}}}Ee(t)}},setAllFoldersBoxVisible:function(t,e){t.cloud.allFoldersBoxVisible=e,e?Object(c["setSessionStorage"])(o["d"],"1"):Object(c["removeSessionStorage"])(o["d"])},leftSideVisible:function(t,e){t.artboardDetail.leftSideVisible!==e&&(t.artboardDetail.leftSideVisible=e,Object(c["setLocalStorage"])("leftside.visible",e?"1":"0"))},pointCommentShowAlways:function(t,e){t.pointCommentShowAlways=e,Object(c["setLocalStorage"])("point-comment-showalways",e?"1":"0")},artboardCommentVisible:function(t,e){t.artboardCommentVisible=e},setSelectComment:function(t,e){e=e||{};var n=e,r=n.comment,i=n.notScrollList,a=t.artboardDetail;r&&(t.artboardCommentVisible=!0),a.notScrollList=!!i,a.selectComment=r},setCommentEditorVisibleId:function(t,e){t.commentEditorVisibleId=e},setImageViewer:function(t,e){var n=t.imageViewer;Object(l["o"])(e)&&Object(l["g"])(e.imgList)&&e.imgList.length>0?(n.imgList=e.imgList.map((function(t){return{imgSrc:t,width:0,height:0}})),n.currentIndex="number"===typeof e.currentIndex&&e.currentIndex>=0&&e.currentIndex<e.imgList.length?e.currentIndex:0,n.visible=!0):(n.currentIndex=0,n.visible=!1,n.imgList=null)},startDraw:function(t,e){var n=t.editComment;n.drawing||(n.instance=e,n.drawing=!0)},setArtboardInComment:function(t,e){t.artboardInComment=e,Object(c["setLocalStorage"])("artboardInComment",e?"1":"0"),e?t.artboardCommentVisible=!0:t.artboardDetail.selectComment&&(t.artboardDetail.selectComment=null)},artboardShowInteractionLine:function(t,e){Object(c["setLocalStorage"])("list-interaction-line",e?"1":"0"),t.artboardShowInteractionLine=e},artboardListUseCanvas:function(t,e){Object(c["setLocalStorage"])("list-view-mode",e?"1":"0"),c["listImageLoader"].paused=!e,location.reload(!0),setTimeout((function(){t.artboardListUseCanvas=e}),1e3)},selectArtboardChanged:function(t,e){t.selectArtboardChanged=e},resetScaleSceneCenter:function(t,e){t.resetScaleSceneCenter=e},isSupportWebp:function(t,e){t.isSupportWebp=e},artboardLoadProgress:function(t,e){if(Object(l["o"])(e)){var n=e.current,r=e.count;t.artboardLoadProgress.current=n,t.artboardLoadProgress.count=r}},allArtboardLoadChecked:function(t,e){t.allArtboardLoadChecked=e},setHelperVisible:function(t,e){var n=t.helper;clearTimeout(n.handle),e?n.visible=!0:n.handle=setTimeout((function(){n.visible=!1}),50)},setInOutput:function(t,e){t.inOutput=e},setAndroidUseMipmap:function(t,e){t.androidUseMipmap!==e&&(t.androidUseMipmap=e,Object(c["setLocalStorage"])("androidUseMipmap",e?"1":"0"))},setArtboardMenu:function(t,e){if(Object(l["o"])(e)){var n=e.visible,r=e.x,i=e.y,a=e.artboard,o=t.artboardMenu;null!=r&&(o.x=r),null!=i&&(o.y=i),null!=n&&(o.visible=n),!1===n?o.artboard=null:null!=a&&(o.artboard=a)}},setInMultDownMode:function(t,e){t.inMultDownMode=e},setInArtboardMultDownMode:function(t,e){t.inArtboardMultDownMode=e},Tip_showTextTip:function(t,e){var n=e.second,r=void 0===n?5:n,i=e.text,a=t.textTip;a.visible=!0,a.text=i,clearTimeout(a.handle),r>0&&(a.handle=setTimeout((function(t){clearTimeout(t.handle),t.handle=0,t.visible=!1}),1e3*r,a))},Tip_hideTextTip:function(t){var e=t.textTip;e.visible=!1,clearTimeout(e.handle),e.handle=0},setUnitTemplate:function(t,e){var n=e.enable,r=e.template,i=e.fromInited,a=e.guid,o=t.unitTemplate;if((o.enable!=n||o.template!=r)&&(o.enable=n,Object(l["h"])(r)||(r="rem(%num%)"),o.template=r,!i)){var s="unittemplate.".concat(a);o.enable||"rem(%num%)"!=o.template?Object(c["setLocalStorage"])(s,o):Object(c["removeLocalStorage"])(s)}},setPlatform:function(t,e){var n=e.type,r=e.customUnit,i=e.customDocWidth,a=e.fromInited,s=e.guid,l=t.platform,u=!1;if(null!==n){var d;switch(n){case o["b"].ANDROID:case o["b"].IOS:case o["b"].CUSTOM:d=n;break;default:d=o["b"].WEB;break}d!==l.type&&(u=!0,l.type=d)}if(null!=r&&null!=i){switch(u=!0,r){case o["c"].DP:case o["c"].PT:l.customUnit=r;break;default:l.customUnit=o["c"].PX;break}"number"===typeof i&&isFinite(i)&&!isNaN(i)&&i>=1?l.customDocWidth=Math.round(i):l.customDocWidth=0}if(u&&!a){var h="platform.".concat(s);Object(c["setLocalStorage"])(h,l)}},setScale:function(t,e){if(Object(l["o"])(e)){var n=e.artboard,r=e.list,i=e.reset;if(null!=n){var a=.1,o=6;n=Math.min(o,n),n=Math.max(a,n),n=Math.round(100*n),n=ce["a"].div(n,100),t.scale.artboard=n}if(null!=r){var s=.02,c=10;r=Math.min(c,r),r=Math.max(s,r),r=Math.round(100*r),r=ce["a"].div(r,100),t.scale.list=r}!0===i&&(null==t.curArtboard?t.scale.resetList=Date.now():t.scale.resetArtboard=Date.now())}},exportBoxBackgroundType:function(t,e){t.setting.exportBoxBackground=e,Object(c["setLocalStorage"])("export-box-background",e)},setNumberAutoRound:function(t,e){t.setting.numberAutoRound=e,Object(c["setLocalStorage"])("number-auto-round",e?"1":"0")},setSettingColor:function(t,e){var n=t.setting.color;(e<0||e>=n.items.length)&&(e=0),n.current=e,Object(c["setLocalStorage"])("colortype",e)},curArtboard:function(t,e){e||(e={});var n=e,r=n.artboard,i=n.extral;if(Object(l["o"])(r)||(r=null),t.curArtboard!==r&&(t.curArtboard=r,t.curArtboardExtral=null!==i&&void 0!==i?i:null,t.curNode=null,t.artboardDetail.interactionSet.overlayArtboards.splice(0),Ee(t),null!=r&&r.isLoaded)){var a=r.artboard;if(Object(l["o"])(a)){var o=a.mlConfig;if(Object(l["o"])(o)&&"number"===typeof o.platform){var s=Object(c["getCustomPlatform"])(a.docGuid,o.platform);this.commit("setPlatform",s)}var u=Object(c["getUnitTemplate"])(a.docGuid);this.commit("setUnitTemplate",u)}}},curNode:function(t,e){Object(l["o"])(e)||(e=null),t.curNode=e,Ee(t)},clickedNode:function(t,e){t.clickedNode=e},enterNode:function(t,e){t.enterNode=e},enterArtboard:function(t,e){t.enterArtboard=e},setCloudNickName:function(t,e){t.cloudNickName=e},setMyState:function(t,e){Object(l["o"])(e)&&(t.permission=e.permission,t.cloudNeedLogin=e.needLogin,t.cloudIsLogin=e.isLogin,t.cloudNickName=e.nickName,t.cloudUserEmail=e.email,t.cloudUserKey=e.userKey,t.cloudName=e.cloudName,t.cloudVersion=e.cloudVersion)},setUserLogout:function(t){t.cloudIsLogin=!1,t.cloudNickName="",t.cloudUserEmail="",t.cloudUserKey=""},setDocument:function(t,e){var n=e.documentName,r=e.documentArtboards,i=e.documentGuid,a=e.config,o=e.permission,s=e.inCloudMode,u=e.cloud,d=e.documents,h=e.cloudNeedLogin,f=e.cloudIsLogin,m=e.cloudNickName,p=e.cloudUserEmail,b=e.cloudUserKey,v=e.cloudName,g=e.cloudKey,w=e.cloudVersion;t.documentArtboards=r,t.documents=d,t.sortDocumentsWithSketchDocument=Qt(d),t.documentName=n,t.documentGuid=i,t.config=a,t.permission=o,t.cloudNeedLogin=h,t.cloudIsLogin=f,t.cloudNickName=m,t.cloudUserEmail=p,t.cloudUserKey=b,t.cloudName=v,t.cloudKey=g,t.cloudVersion=w,t.inCloudMode=s,c["globalData"].cloudVersion=w;var x=t.cloud;Object(l["o"])(u)&&Object.keys(u).forEach((function(t){x[t]=u[t]})),this.commit("setRenderDocuments");var y=Object(c["getCustomPlatform"])(i,a.platform);this.commit("setPlatform",y);var C=Object(c["getUnitTemplate"])(i);this.commit("setUnitTemplate",C),Oe()}},actions:{}});function Ne(){var t=parseInt(Object(c["getLocalStorage"])("colortype",!1));if(!(isNaN(t)||!isFinite(t)||t<0)){var e=Le.state.setting.color;t<e.items.length&&(e.current=t)}}function De(){var t="1"===Object(c["getLocalStorage"])("number-auto-round",!1);t&&(Le.state.setting.numberAutoRound=!0)}function Fe(){var t=+Object(c["getLocalStorage"])("export-box-background",!1);switch(t){case o["q"].Black:case o["q"].Transparent:break;default:t=o["q"].Transparent}t!==o["q"].Transparent&&(Le.state.setting.exportBoxBackground=t)}function Pe(){var t=Object(c["getLocalStorage"])("list-interaction-line");switch(t){case"0":Le.state.artboardShowInteractionLine=!1;break;default:Le.state.artboardShowInteractionLine=!0;break}}function je(){var t=Object(c["getLocalStorage"])("list-view-mode");switch(t){case"1":Le.state.artboardListUseCanvas=!0;break;case"0":Le.state.artboardListUseCanvas=!1;break;default:Le.state.artboardListUseCanvas=!0;break}}function Re(){var t=Object(c["getLocalStorage"])("interaction.pcdeviceset",!0);if(Object(l["o"])(t)){var e=Le.state.artboardDetail.interactionSet.pcDeviceSet;Object.keys(e).forEach((function(n){var r=t[n];void 0!==r&&(e[n]=r)}))}else{var n=ke;n&&Le.commit("setPCDeviceSet",ke)}}function Be(){var t=Object(c["getLocalStorage"])("point-comment-showalways");switch(t){case"0":Le.state.pointCommentShowAlways=!1;break;default:Le.state.pointCommentShowAlways=!0;break}}function Ve(){var t=Le.state.mobileInteraction.listConfig,e=Object(c["getLocalStorage"])("m-interaction-list-config",!0);Object(l["o"])(e)||(e={}),t.sortType=function(t){switch(t){case o["f"].ArtboardRect:case o["f"].Date:return t;default:return o["f"].Name}}(e.sortType),t.orderDesc=!!e.orderDesc,t.renderType=function(t){switch(t){case o["g"].Artboard:return t;default:return o["g"].All}}(e.renderType)}var Ue=Le;function $e(){Te(),Ne(),De(),Fe(),je(),Re(),Pe(),Be(),Ve()}var He=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{attrs:{id:"main"}},[!t.cloudNeedLogin||t.cloudIsLogin?n("div",{staticClass:"loading",class:{on:!t.allArtboardLoadChecked,local:!t.inCloudMode}},[t._v("正在加载画板数据中("+t._s(t.artboardLoadProgressText)+"),请稍后...")]):t._e(),t.cloudNeedLogin&&!t.cloudIsLogin?n("CloudNeedLoginTip"):t.allArtboardLoadChecked?[n("Header"),n("main",[n("FolderNav"),t.cloudFolderNotFound?n("EmptyData",{attrs:{text:"链接已失效,无法找到对应的文件夹"}}):t.permission?t.isEmptyData?n("EmptyData",{attrs:{text:t.emptyText}}):t.inNetDiskFileMode?n("NetDiskFileMain"):t.inArtboardMode?n("ArtboardInfo"):t._e():n("Authority"),n("keep-alive",[t.cloudFolderNotFound||!t.permission||t.isEmptyData||t.inArtboardMode||t.inNetDiskFileMode?t._e():n("ArtboardList")],1),n("InOutputTip"),n("ArtboardListItemMenu")],1)]:t._e(),n("SafariWebpTip"),t.inNetDiskFileMode?t._e():n("ImageViewer"),n("Tip")],2)},ze=[],We=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"netdiskfile-main"},[t.EnumNetDiskFileType.Pdf===t.fileType?n("ViewPdf"):t.EnumNetDiskFileType.Media===t.fileType?n("ViewMedia"):t.EnumNetDiskFileType.Image===t.fileType?n("ViewImage"):t.EnumNetDiskFileType.Lottie===t.fileType?n("ViewLottie"):n("div",[t._v("当前界面库暂不支持展示文件["+t._s(t.curNetDiskFile.name)+"],请下载到本地查看:"),n("a",{attrs:{href:t.fileDownloadUrl}},[t._v("下载 媒体文件")])])],1)},Ge=[],Ye=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"netdiskfile-pdf"},[n("object",{staticClass:"object",attrs:{data:t.fileViewUrl,type:t.contentType}},[t._v(" 当前浏览器不支持预览PDF文件,请下载PDF到本地查看:"),n("a",{attrs:{href:t.fileDownloadUrl}},[t._v("下载 PDF")])])])},Xe=[],Ke={computed:{},data:function(){return{contentType:be?null:"application/pdf"}}},Ze=Ke,qe=(n("b6d9"),n("cba8")),Qe=Object(qe["a"])(Ze,Ye,Xe,!1,null,"273b8108",null),Je=Qe.exports,tn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"netdiskfile-media"},[n("video",{staticClass:"video",attrs:{src:t.fileViewUrl,autoplay:"",controls:""}},[t._v(" 当前浏览器不支持预览媒体文件,请下载到本地查看:"),n("a",{attrs:{href:t.fileDownloadUrl}},[t._v("下载 媒体文件")])])])},en=[],nn={computed:{}},rn=nn,an=(n("8d92"),Object(qe["a"])(rn,tn,en,!1,null,"20e5bee7",null)),on=an.exports,sn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"netdiskfile-image"},[n("ImageViewer",{attrs:{canClose:!1}})],1)},cn=[],ln=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{staticClass:"image-viewer"},[n("div",{staticClass:"header"},[n("div",{staticClass:"control"},[n("div",{staticClass:"btn-prev",class:{disable:0===t.imgList.length||t.currentIndex<1},on:{click:t.clickPrev}}),n("ScaleControl",{attrs:{type:t.EnumScaleType.ImageViewer}}),n("div",{staticClass:"btn-next",class:{disable:0===t.imgList.length||t.currentIndex>=t.imgList.length-1},on:{click:t.clickNext}}),t.canClose?n("div",{staticClass:"line"}):t._e(),t.canClose?n("div",{staticClass:"btn-close",attrs:{title:"关闭 (Esc)"},on:{click:t.clickHide}}):t._e()],1)]),n("div",{staticClass:"main"},[n("ZoomContainer",{attrs:{type:t.EnumScaleType.ImageViewer}})],1)]):t._e()},un=[],dn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"scale-control",class:{light:t.lightTheme}},[n("a",{staticClass:"btn-zoom btn-zoom-out",attrs:{href:"javascript:;"},on:{click:function(e){return t.setScaleZoomOut()}}}),n("span",{staticClass:"text"},[n("a",{attrs:{href:"javascript:;",title:"设置缩放为100%"},on:{click:function(e){return t.setScale(1)}}},[t._v(t._s(t.scaleText))])]),n("a",{staticClass:"btn-zoom btn-zoom-in",attrs:{href:"javascript:;"},on:{click:function(e){return t.setScaleZoomIn()}}}),n("a",{staticClass:"btn-scene-reset",attrs:{href:"javascript:;",title:"重置场景比例和偏移信息"},on:{click:t.clickResetScene}})])},hn=[],fn={methods:{clickResetScene:function(){switch(this.type){case o["m"].ArtboardList:case o["m"].ArtboardDetail:this.$store.commit("setScale",{reset:!0});break;case o["m"].ImageViewer:this.resetImageViewerScale();break}},quickKey:function(t){var e=t.code||t.key;switch(e){case"-":case"Minus":var n=t.ctrlKey||t.metaKey;n&&(this.setScaleZoomOut(),t.preventDefault());break;case"=":case"Equal":var r=t.ctrlKey||t.metaKey;r&&(this.setScaleZoomIn(),t.preventDefault());break}},setScaleZoomOut:function(){var t=this.scale,e=Math.max(.3*t,.25);e=Math.min(2,e),t-=e,this.setScale(t)},setScaleZoomIn:function(){var t=this.scale,e=Math.max(.3*t,.25);e=Math.min(2,e),t+=e,this.setScale(t)},setScale:function(t){var e=this.scale;switch(this.type){case o["m"].ArtboardList:this.setScaleList(t),this.resetScaleSceneCenter(t,e);break;case o["m"].ArtboardDetail:this.setScaleArtboard(t),this.resetScaleSceneCenter(t,e);break;case o["m"].ImageViewer:this.setScaleImageViewer(t);break}},resetScaleSceneCenter:function(t,e){e!==this.scale&&this.$store.commit("resetScaleSceneCenter",{newScale:t,oldScale:e})}},computed:{lightTheme:function(){return this.type===o["m"].ImageViewer},EnumScaleType:function(){return o["m"]},scale:function(){switch(this.type){case o["m"].ArtboardList:return this.scaleList;case o["m"].ArtboardDetail:return this.scaleArtboard;case o["m"].ImageViewer:return this.scaleImageViewer;default:return 0}},scaleText:function(){var t=ce["a"].mul(this.scale,100).toString();return t.indexOf(".00")&&(t=t.replace(".00","")),t+"%"}},created:function(){window.addEventListener("keydown",this.quickKey)},beforeDestroy:function(){window.removeEventListener("keydown",this.quickKey)},props:{type:Number}},mn=fn,pn=(n("5721"),Object(qe["a"])(mn,dn,hn,!1,null,"434be985",null)),bn=pn.exports,vn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{ref:"$info",staticClass:"zoom-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.clickZoomContainer(e)},mousedown:function(e){return t.mousedownZoomContainer(e)}}},[t.inCloudMode&&t.inArtboardInfoMode?n("DrawView",{attrs:{sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight,sceneX:t.sceneX,sceneY:t.sceneY,sceneOffsetX:t.sceneOffsetX,sceneOffsetY:t.sceneOffsetY,scale:t.scale}}):t._e(),t.cloudArtInfoMode?n("section",{staticClass:"zoom-box info-canvas"},[n("CanvasModeArtboardInfo",{attrs:{dragging:t.dragging,scale:t.scale,sceneX:t.sceneX+t.infoCanvasOffset.x,sceneY:t.sceneY+t.infoCanvasOffset.y,sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight,sceneScaleKeepX:t.sceneScaleKeepX,sceneScaleKeepY:t.sceneScaleKeepY,sceneOffsetX:t.sceneOffsetX,sceneOffsetY:t.sceneOffsetY}})],1):t._e(),n("section",{staticClass:"zoom-box",style:t.zoomBoxOffset,on:{click:function(e){return e.target!==e.currentTarget?null:t.clickZoomContainer(e)}}},[t.cloudArtListMode?n("CanvasModeArtboardList",{ref:"$instance",attrs:{dragging:t.dragging,scale:t.scale,sceneX:t.sceneX,sceneY:t.sceneY,sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight,sceneScaleKeepX:t.sceneScaleKeepX,sceneScaleKeepY:t.sceneScaleKeepY,sceneOffsetX:t.sceneOffsetX,sceneOffsetY:t.sceneOffsetY}}):t.type===t.EnumScaleType.ArtboardList?n("ArtboardList",{ref:"$instance",attrs:{dragging:t.dragging,sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight}}):t.inArtboardInfoMode?n("ArtboardInfo",{ref:"$instance",attrs:{dragging:t.dragging,sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight}}):t.inImageViewerMode?n("ViewerBox",{ref:"$instance",attrs:{sceneX:t.sceneX,sceneY:t.sceneY,sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight},on:{setConfig:t.setConfig}}):t._e()],1),t.inCloudMode&&t.inArtboardInfoMode?n("CommentPoints",{attrs:{sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight,sceneX:t.sceneX,sceneY:t.sceneY,sceneOffsetX:t.sceneOffsetX,sceneOffsetY:t.sceneOffsetY,scale:t.scale*t.calcArtScale},on:{setConfig:t.setConfig}}):t._e()],1)},gn=[],wn=(n("39ad"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{staticClass:"draw-view"},[n("DrawControl"),n("canvas",{ref:"canvas_history",class:{move:t.inElementMoveState},attrs:{width:t.sceneWidth*t.canvasScale,height:t.sceneHeight*t.canvasScale},on:{mousedown:t.onMouseDown,mousemove:t.onMouseMoveInCanvas,dragstart:function(t){t.preventDefault()}}}),n("canvas",{ref:"canvas_current",staticClass:"current",attrs:{width:t.sceneWidth*t.canvasScale,height:t.sceneHeight*t.canvasScale}}),n("div",{staticClass:"input"},[t.isCurrentInTextMode?n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.currentDrawData.text,expression:"currentDrawData.text"}],ref:"input",style:t.textareaStyle,attrs:{spellcheck:"false"},domProps:{value:t.currentDrawData.text},on:{input:[function(e){e.target.composing||t.$set(t.currentDrawData,"text",e.target.value)},t.resetTextareaSize],keydown:t.onInputKeyDown,mousedown:function(t){t.stopPropagation()}}}):t._e()])],1):t._e()}),xn=[],yn=n("182c"),Cn=(n("8e39"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{staticClass:"draw-control-box"},[n("div",{staticClass:"draw-control",class:{black:t.artboardDetailSkin},on:{mousedown:function(t){t.stopPropagation()}}},[n("ul",[n("li",{staticClass:"tool_move",class:{on:t.drawAction===t.EnumDrawAction.Move},attrs:{title:"选择对象"},on:{click:function(e){return t.clickDrawAction(t.EnumDrawAction.Move)}}}),n("li",{staticClass:"tool_pen",class:{on:t.drawAction===t.EnumDrawAction.Brush},attrs:{title:"画笔"},on:{click:function(e){return t.clickDrawAction(t.EnumDrawAction.Brush)}}}),n("li",{staticClass:"tool_text",class:{on:t.drawAction===t.EnumDrawAction.Text},attrs:{title:"文本输入"},on:{click:function(e){return t.clickDrawAction(t.EnumDrawAction.Text)}}}),n("li",{staticClass:"tool_rectangle",class:{on:t.drawAction===t.EnumDrawAction.Rectangle},attrs:{title:"矩形"},on:{click:function(e){return t.clickDrawAction(t.EnumDrawAction.Rectangle)}}}),n("li",{staticClass:"tool_ellipse",class:{on:t.drawAction===t.EnumDrawAction.Ellipse},attrs:{title:"椭圆"},on:{click:function(e){return t.clickDrawAction(t.EnumDrawAction.Ellipse)}}}),n("li",{staticClass:"tool_arrow",class:{on:t.drawAction===t.EnumDrawAction.Arrow},attrs:{title:"箭头"},on:{click:function(e){return t.clickDrawAction(t.EnumDrawAction.Arrow)}}})]),n("ul",[n("li",{staticClass:"his_prev",class:{off:0===t.historyCount||t.historyIndex<0},attrs:{title:"回退到上一步"},on:{click:t.clickHistoryPrev}}),n("li",{staticClass:"his_next",class:{off:0===t.historyCount||t.historyIndex>=t.historyCount-1},attrs:{title:"前进到下一步"},on:{click:t.clickHistoryNext}})]),n("ul",[n("li",{staticClass:"sys_save",attrs:{title:"保存截图"},on:{click:t.clickSave}}),n("li",{staticClass:"sys_cancel",attrs:{title:"取消截图"},on:{click:t.clickCancel}})])]),t.subControlVisible?n("div",{staticClass:"draw-control-sub",class:{black:t.artboardDetailSkin},on:{mousedown:function(t){t.stopPropagation()}}},[n("div",{staticClass:"box"},[t.drawAction===t.EnumDrawAction.Text?n("div",{staticClass:"font-size"},[n("div",{staticClass:"select"},[n("div",{staticClass:"select-text",class:{on:t.fontSizeSelectOpen},on:{click:function(e){t.fontSizeSelectOpen=!t.fontSizeSelectOpen}}},[t._v(t._s(t.drawInfo.fontSize)+"px")]),t.fontSizeSelectOpen?n("ul",{staticClass:"select-list",on:{mousewheel:function(t){t.stopPropagation()},DOMMouseScroll:function(t){t.stopPropagation()}}},t._l(t.DrawFontSize,(function(e,r){return n("li",{key:r,staticClass:"select-item",class:{on:e===t.drawInfo.fontSize},on:{click:function(n){return t.clickFontSize(e)}}},[t._v(t._s(e)+"px")])})),0):t._e()])]):n("ul",{staticClass:"brush-size"},t._l(t.EnumBrushSizeType,(function(e,r){return n("li",{key:r,class:[r,t.drawInfo.brushSize===e?"on":""],on:{click:function(n){t.drawInfo.brushSize=e}}})})),0),n("ul",{staticClass:"colors"},t._l(t.DrawColors,(function(e,r){return n("li",{key:r,class:{on:t.drawInfo.colorIndex===r},on:{click:function(e){t.drawInfo.colorIndex=r}}},[n("span",{style:{borderColor:e.border,backgroundColor:e.color}})])})),0)])]):t._e()]):t._e()}),kn=[],Sn=".webp",_n=[".jpeg",".jpg",".gif",".png",Sn,".bmp"],An=10485760,In=5;function Tn(t,e,n,r,i){if(Object(l["o"])(t)&&r){Object(l["h"])(n)&&En(t,n),0===e.id&&(e.id=t.userId);var a=i[e.id];a?Object.keys(e).forEach((function(t){a[t]=e[t]})):a=i[e.id]=e,t.user=a;var o=0===r.id;return o||(0!=t.replyUserId&&(a=i[t.replyUserId],t.replyUser=a||null),t.parent=r),t.atUsers={},Object(l["g"])(t.atUserIds)&&t.atUserIds.forEach((function(e){t.atUsers[e]=i[e]})),r.comments.push(t),t}}function On(t,e){Object(l["o"])(t)||(t={});var n=t,r=n.list,i=n.users;i||(i={});var a=Object(l["h"])(e);return Object(l["g"])(r)?r.forEach((function(t){Object(l["o"])(t)&&(t.user=i[t.userId],t.replyUser=null,t.atUsers={},Object(l["g"])(t.atUserIds)&&t.atUserIds.forEach((function(e){t.atUsers[e]=i[e]})),Object(l["g"])(t.comments)&&t.comments.forEach((function(n){n.parent=t,n.user=i[n.userId],n.replyUser=i[n.replyUserId],n.atUsers={},Object(l["g"])(n.atUserIds)&&n.atUserIds.forEach((function(t){n.atUsers[t]=i[t]})),a&&En(n,e)})),a&&En(t,e))})):r=[],r}function En(t,e){var n=t.attachMents;if(Object(l["g"])(n))for(var r=0,i=n.length;r<i;r++){var a=n[r];if(a){var o=a.fold;o&&"/"===o[0]&&(a.fold=e+o.substr(1))}}else t.attachMents=[]}var Mn={methods:{clickHistoryPrev:function(){var t=this.historyIndex,e=this.drawInfo;l["a"]&&console.log("clickHistoryPrev",t),t<0||(t-=1,e.historyIndex=t,e.historyIndexChanges=Date.now())},clickHistoryNext:function(){var t=this.historyIndex,e=this.drawInfo,n=this.histories;l["a"]&&console.log("clickHistoryPrev",t),t>=n.length-1||(t+=1,e.historyIndex=t,e.historyIndexChanges=Date.now())},clickCleanHistory:function(){this.histories.splice(0),this.drawInfo.historyIndex=-1},clickFontSize:function(t){this.drawInfo.fontSize=t},clickDrawAction:function(t){var e;switch(this.drawAction===t&&(t=E.None),t){case E.Move:e="进入拖拽模式,可拖动对象,选中后可按delete键删除";break}e&&this.showTextTip(e),this.drawInfo.action=t},clickSave:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i,a,o,s;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!0!==t.saving){e.next=2;break}return e.abrupt("return");case 2:if(-1!==t.historyIndex&&0!==t.histories.length){e.next=5;break}return t.alert({text:"没有修改信息,无法保存"}),e.abrupt("return");case 5:return a=null!==(n=null===(i=t.artboard)||void 0===i?void 0:i.boundsInArtboard)&&void 0!==n?n:new d["a"],a=(new d["a"]).set(0,0,a.width,a.height),e.prev=7,t.saving=!0,e.next=11,ot.save(a,t.pathPreview,t.histories,t.historyIndex);case 11:if(s=e.sent,s&&!(s.size<1)){e.next=15;break}return t.alert({text:"保存信息失败,请联系我们反馈该问题"}),e.abrupt("return");case 15:if(!(s.size>An)){e.next=18;break}return t.alert({text:"保存信息失败,图片大小[".concat(Object(c["transformPcSize"])(s.size),"]太大,不能超过[").concat(Object(c["transformPcSize"])(An),"]")}),e.abrupt("return");case 18:s.name="userdraw.jpg",s.lastModified=Date.now(),s.lastModifiedDate=new Date(s.lastModified),null===(o=t.editComment.instance)||void 0===o||o.addAttachMent(s).then((function(){t.showTextTip("图片已添加到评论附件列表")})).catch((function(e){t.showTextTip(e)})),t.editComment.drawing=!1,e.next=28;break;case 25:e.prev=25,e.t0=e["catch"](7),t.showTextTip(e.t0);case 28:return e.prev=28,t.saving=!1,e.finish(28);case 31:case"end":return e.stop()}}),e,null,[[7,25,28,31]])})))()},clickCancel:function(){this.saving=!1,this.editComment.drawing=!1},hideFontSizeSelectLater:function(){this.fontSizeSelectOpen=!1}},computed:{artboard:function(){var t;return null===(t=this.curArtboard)||void 0===t?void 0:t.artboard},pathPreview:function(){var t,e=this.artboard;return e?(this.isSupportWebp&&(t=e.pathPreviewWebp),t||(t=e.pathPreview),t):null},isSupportWebp:function(){return this.$store.state.isSupportWebp===pe.Support},DrawFontSize:function(){return M},EnumBrushSizeType:function(){return N},DrawColors:function(){return D},artboardDetailSkin:function(){return this.$store.state.artboardDetailSkin},drawInfo:function(){return this.editComment.drawInfo},EnumDrawAction:function(){return E},drawAction:function(){return this.drawInfo.action},historyIndex:function(){return this.drawInfo.historyIndex},historyCount:function(){return this.histories.length},histories:function(){return this.drawInfo.histories},subControlVisible:function(){var t=this.drawAction;return t!==E.None&&t!==E.Move},visible:function(){return this.editComment.drawing}},watch:{fontSizeSelectOpen:function(t){var e=this;clearTimeout(this.fontSizeHandle),t?this.fontSizeHandle=setTimeout((function(){window.addEventListener("click",e.hideFontSizeSelectLater)}),66.67):window.removeEventListener("click",this.hideFontSizeSelectLater)}},beforeDestroy:function(){clearTimeout(this.fontSizeHandle),window.removeEventListener("click",this.hideFontSizeSelectLater)},data:function(){return{fontSizeSelectOpen:!1,fontSizeHandle:0,saving:!1}}},Ln=Mn,Nn=(n("ea6b"),Object(qe["a"])(Ln,Cn,kn,!1,null,"f359379e",null)),Dn=Nn.exports,Fn={components:{DrawControl:Dn},methods:{onCanvasKeyDown:function(t){var e=this,n=t.keyCode,r=t.target;if(r){var i=r.tagName;if("INPUT"!==i&&"TEXTAREA"!==i){var a=r,o=document.documentElement;while(null!=a&&a!=o){if(a.isContentEditable)return;a=a.parentNode}if(46===n||8===n){var s=function(){var t=e.drawInfo,n=e.histories,r=e.historyIndex,i=t.selectItem;if(!i)return{v:void 0};t.selectItem=null;var a=new et;a.action=E.Deleted,a.dragTarget=i,a.drawOffset=new F,a.makePoint(),a.isVaildData(),r<n.length-1&&n.splice(r+1),n.push(a),t.historyIndex=n.length-1;var o=a.dragTarget,s=n.findIndex((function(t){return t===o}));if(-1===s)console.error("异常信息,无法找到原始数据",a);else{var c=0;while(-1!==c){if(c=n.findIndex((function(t){return t.action===E.Move&&t.dragFrom===s})),-1===c)break;var l=n[c];o.dragOn=c,s=c,o=l}a.dragFrom=s,o.dragOn=n.length-1}e.drawAll()}();if("object"===Object(yn["a"])(s))return s.v}}}},getCanvasDrawNum:function(t){return Math.round(t*this.canvasScale)},getLocation:function(t){var e=t.pageX,n=t.pageY,r=t.sceneX,i=t.sceneY,a=t.scale,o=t.sceneWidth,s=t.sceneHeight,c=e,l=n,u=this.sceneOffsetX,d=this.sceneOffsetY,h=this.rect,f=(o-h.width*a)/2,m=(s-h.height*a)/2;return c-=u,l-=d,c-=f,l-=m,c-=r,l-=i,c=Math.round(c/a),l=Math.round(l/a),new F(c,l)},saveTextToHistory:function(){if(this.isCurrentInTextMode){l["a"]&&console.log("saveTextToHistory");var t=this.currentDrawData;if(t.isVaildData()){t.makePoint(this.getCurrentContext(),this.currentSceneInfo);var e=this.histories,n=this.historyIndex;n<e.length-1&&e.splice(n+1),e.push(t),this.drawInfo.historyIndex=e.length-1,this.drawHistories(t)}return this.currentDrawData=null,!0}return!1},getHistoryTagetWithDragFrom:function(t){if(null==t)return null;if(t.action!==E.Move)return null;var e=t.dragFrom;if(-1===e)return null;var n=this.histories;while(-1!==e){var r=n[e];if(!r)return null;if(r.action!==E.Move)return r;if(e=r.dragFrom,-1===e)return null}},getHistoryByPointExact:function(t){for(var e=this.histories,n=Math.min(this.historyIndex+1,e.length),r=(new d["a"]).set(t.x,t.y,1,1),i=n-1;i>=0;i--){var a=e[i],o=this.getRectOverlapDrawData(r,e,a,i);if(null!=o)return o}return null},getHistoryByPoint:function(t){for(var e=this.histories,n=Math.min(this.historyIndex+1,e.length),r=(new d["a"]).set(t.x,t.y,1,1),i=n-1;i>=0;i--){var a=e[i],o=this.getRectOverlapDrawData(r,e,a,i);if(null!=o)return o}return null},getRectOverlapDrawData:function(t,e,n,r){var i,a=n.action,o=null!==(i=n.dragOffset)&&void 0!==i?i:new F;if(a===E.Deleted)return null;if(a===E.Move){if(-1!==n.dragOn){var s=e[n.dragOn];if(s&&(s.action===E.Move||s.action===E.Deleted)&&s.dragFrom===r)return null}var c=this.getHistoryTagetWithDragFrom(n);if(!c)return null;var l=c.eventRect;if(!l)return null;var u=(new d["a"]).set(l.x+o.x,l.y+o.y,l.width,l.height);if(u.isOverlap(t))return{target:c,offset:o}}else{var h=ot.getHistoryTagetWithDragOn(e,n,this.historyIndex);if(h&&h.action===E.Deleted)return null;h||(h=n);var f,m=n.eventRect;if(h===n)return m&&m.isOverlap(t)?{target:h,offset:new F}:null;o=null!==(f=h.dragOffset)&&void 0!==f?f:new F;var p=(new d["a"]).set(m.x+o.x,m.y+o.y,m.width,m.height);if(p.isOverlap(t))return{target:n,offset:o}}return null},onMouseMoveInCanvas:function(t){var e=this.currentDrawData,n=this.drawInfo,r=this.inDrawAndNotMove,i=this.histories,a=this.moveInfo,o=n.action;if(o===E.Move&&!e&&0!==i.length){var s=this.inMacOS?t.metaKey:t.ctrlKey;if(!r||!s){a.pageX=t.pageX,a.pageY=t.pageY,a.scale=this.scale,a.sceneX=this.sceneX,a.sceneY=this.sceneY,a.sceneWidth=this.sceneWidth,a.sceneHeight=this.sceneHeight;var c=this.getLocation(a),l=this.getHistoryByPointExact(c),u=n.enterItem,d=null===l||void 0===l?void 0:l.target;u!=d&&(n.enterItem=d,this.drawAll())}}},onMouseDown:function(t){var e=this.inMacOS?t.metaKey:t.ctrlKey,n=this.startInfo,r=this.inDrawAndNotMove,i=this.drawAction,a=this.drawInfo;if(r){if(e)return;t.stopPropagation()}if(i!==E.Text||!this.saveTextToHistory()){switch(i){case E.Move:case E.Brush:case E.Text:case E.Rectangle:case E.Ellipse:case E.Arrow:n.pageX=t.pageX,n.pageY=t.pageY,n.scale=this.scale,n.sceneX=this.sceneX,n.sceneY=this.sceneY,n.sceneWidth=this.sceneWidth,n.sceneHeight=this.sceneHeight;break;default:return}var o=this.getLocation(n),s=new et;if(i===E.Move){var c=this.getHistoryByPoint(o);if(null==c)return void(a.selectItem&&(a.selectItem=null,this.drawAll()));if(c.action===E.Deleted)return;s.dragTarget=c.target,s.dragOffset=c.offset}switch(this.currentDrawData=s,s.action=i,s.color=this.currentColor.color,i!==E.Move&&this.cleanCurrent(),i){case E.Move:s.startPoint=s.endPoint=o,this.drawHistories(),this.drawCurrent();break;case E.Brush:s.brushSize=this.currentBrushSize,s.points=[o];break;case E.Rectangle:case E.Ellipse:case E.Arrow:s.brushSize=this.currentBrushSize,s.startPoint=o;break;case E.Text:return s.startPoint=o,s.text="",s.fontSize=this.currentFontSize,s.lineHeight=s.fontSize+2,s.textareaSize=new W(Y,s.lineHeight),void(s.family=l["d"]?"-apple-system":"'PingFang SC', 'PingFang TC','Helvetica Neue', sans-serif")}window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp)}},onMouseMove:function(t){var e=this.currentDrawData;if(e){var n=e.action;if(n!==E.Text){var r=this.getCurrentContext();if(r){var i=this.getLocation({pageX:t.pageX,pageY:t.pageY,scale:this.scale,sceneX:this.sceneX,sceneY:this.sceneY,sceneWidth:this.sceneWidth,sceneHeight:this.sceneHeight}),a=this.currentSceneInfo;switch(n){case E.Move:e.endPoint=i,this.drawCurrent();break;case E.Brush:e.points.push(i);var o=!1,s=e.makeBrushHash(a);s===e.brushHash?o=!0:(this.cleanCurrent(r),e.brushHash=s),ot.drawBrush(r,e,a,!1,!1,null,o);break;case E.Rectangle:e.endPoint&&this.cleanCurrent(r),e.endPoint=i,ot.drawRectangle(r,e,a);break;case E.Ellipse:e.endPoint&&this.cleanCurrent(r),e.endPoint=i,ot.drawEllipse(r,e,a);break;case E.Arrow:e.endPoint&&this.cleanCurrent(r),e.endPoint=i,ot.drawArrow(r,e,a);break;default:return}}}}},onMouseUp:function(t){var e=this;window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp);var n=this.currentDrawData;this.currentDrawData=null;var r=this.drawInfo;if(n&&n.isVaildData()){n.makePoint();var i=this.histories,a=this.historyIndex;a<i.length-1&&i.splice(a+1),i.push(n),r.historyIndex=i.length-1,n.action===E.Move&&function(){var a=n.dragTarget,o=i.findIndex((function(t){return t===a}));if(-1===o)console.error("异常信息,无法找到原始数据",n);else{var s=0;while(-1!==s){if(s=i.findIndex((function(t){return t.action===E.Move&&t.dragFrom===o})),-1===s)break;var c=i[s];a.dragOn=s,o=s,a=c}n.dragFrom=o,a.dragOn=i.length-1}r.selectItem=e.getDrawDataFromMouse(t)}(),this.drawHistories(n.action===E.Move?null:n),this.cleanCurrent()}else n.action===E.Move&&(r.selectItem=this.getDrawDataFromMouse(t),this.drawHistories(),this.cleanCurrent())},getDrawDataFromMouse:function(t){var e=this.getLocation({pageX:t.pageX,pageY:t.pageY,scale:this.scale,sceneX:this.sceneX,sceneY:this.sceneY,sceneWidth:this.sceneWidth,sceneHeight:this.sceneHeight}),n=this.getHistoryByPointExact(e);return null===n||void 0===n?void 0:n.target},getDrawTarget:function(){},drawHistories:function(t){var e,n=this.getHistoryContext();if(n){var r,i=!t,a=this.histories,o=this.historyIndex,s=this.drawInfo;if(i){if(n.clearRect(0,0,this.getCanvasDrawNum(this.sceneWidth),this.getCanvasDrawNum(this.sceneHeight)),-1===o)return;if(r=o>=a.length-1?a:a.slice(0,o+1),0===r.length)return}else r=[t];var c=this.currentSceneInfo,l=null===(e=this.currentDrawData)||void 0===e?void 0:e.dragTarget;r.forEach((function(t){if(t!==l){var e,r=s.action===E.Move,i=r&&t==s.enterItem,u=r&&t==s.selectItem,d=t.action;switch(d){case E.Brush:case E.Rectangle:case E.Ellipse:case E.Arrow:case E.Text:var h=ot.getHistoryTagetWithDragOn(a,t,o);if(h){if(h.action===E.Deleted)return;e=h.dragOffset}break}switch(d){case E.Brush:var f=!1;ot.drawBrush(n,t,c,i,u,e,f);break;case E.Rectangle:ot.drawRectangle(n,t,c,i,u,e);break;case E.Ellipse:ot.drawEllipse(n,t,c,i,u,e);break;case E.Arrow:ot.drawArrow(n,t,c,i,u,e);break;case E.Text:ot.drawText(n,t,c,i,u,e);break;default:return}}}))}},cleanCurrent:function(t){(t||(t=this.getCurrentContext(),t))&&t.clearRect(0,0,this.getCanvasDrawNum(this.sceneWidth),this.getCanvasDrawNum(this.sceneHeight))},drawCurrent:function(){var t=this.currentDrawData;if(t){var e=this.getCurrentContext();if(e){this.cleanCurrent(e);var n=this.currentSceneInfo,r=t.action,i=r!==E.Move,a=!i;switch(r){case E.Move:var o=t.dragTarget;if(!o)return;var s=t.startPoint,c=t.endPoint,l=t.dragOffset;if(!s||!c)return;var u=new F(c.x-s.x+l.x,c.y-s.y+l.y);switch(o.action){case E.Brush:var d=!1;ot.drawBrush(e,o,n,i,a,u,d);break;case E.Rectangle:ot.drawRectangle(e,o,n,i,a,u);break;case E.Ellipse:ot.drawEllipse(e,o,n,i,a,u);break;case E.Arrow:ot.drawArrow(e,o,n,i,a,u);break;case E.Text:ot.drawText(e,o,n,i,a,u);break}break;case E.Brush:var h=!1;t.brushHash=t.makeBrushHash(n),ot.drawBrush(e,t,n,!1,!1,null,h);break;case E.Rectangle:ot.drawRectangle(e,t,n);break;case E.Ellipse:ot.drawEllipse(e,t,n);break;case E.Arrow:ot.drawArrow(e,t,n);break;default:return}}}},getHistoryContext:function(){var t=this.$refs.canvas_history;if(t){var e=t.getContext("2d");return e}},getCurrentContext:function(){var t=this.$refs.canvas_current;if(t){var e=t.getContext("2d");return e}},drawAll:function(){var t=this;this.visible&&(cancelAnimationFrame(this.handleDraw),this.handleDraw=requestAnimationFrame((function(){console.time("drawHistories && drawCurrent");try{t.drawCurrent(),t.drawHistories()}finally{console.timeEnd("drawHistories && drawCurrent")}})))},measureTextSize:function(t,e,n){var r,i=this.currentSceneInfo,a=i.scale;a=1;var o=Math.max(12,Math.round(e.fontSize*a*1e3)/1e3);t.font="".concat(o,"px ").concat(null!==(r=e.family)&&void 0!==r?r:"sans-serif");for(var s=e.lineHeight,c=n||e.text,l=new W(0,s),u=0,d=Math.round(K*a),h={},f=0,m=c.length;f<m;f++){var p=c[f];if("\n"!==p){if("\r"!==p){var b=h[p];b||(b=h[p]=Math.ceil(t.measureText(p).width));var v=u+b+1;v>d?(l.width=Math.max(u,l.width),l.height+=s,u=b):u=v}}else l.width=Math.max(u,l.width),u=0,l.height+=s}return l.width=Math.ceil(Math.max(u,l.width)/a),l},resetTextareaSize:function(){var t=this.currentDrawData;if(t&&t.action===E.Text){var e=this.$refs.input;if(e){var n=this.getCurrentContext();if(n){var r=this.measureTextSize(n,t,e.value);r.width=Math.max(r.width,Y),t.textareaSize=r}}}},onInputKeyDown:function(t){var e=t.keyCode;switch(e){case 27:this.isCurrentInTextMode&&(this.currentDrawData=null)}},resetData:function(){this.currentDrawData=null;var t=this.drawInfo,e=this.histories;e.splice(0),t.historyIndex=-1,t.action=E.None}},watch:{inElementSelect:function(t){t?window.addEventListener("keydown",this.onCanvasKeyDown):window.removeEventListener("keydown",this.onCanvasKeyDown)},artboardInComment:function(t){t||(this.editComment.drawing=!1)},historyIndexChanges:function(){this.drawAll()},visible:function(t){t&&this.resetData()},curArtboardId:function(){this.editComment.drawing=!1},currentFontSize:function(t){var e=this;if(this.isCurrentInTextMode){var n=this.currentDrawData;n&&(n.fontSize=t,n.lineHeight=n.fontSize+2,requestAnimationFrame((function(){e.resetTextareaSize();var t=e.$refs.input;t&&t.focus()})))}},scale:function(){var t=this;requestAnimationFrame((function(){t.resetTextareaSize()}))},currentColor:function(t){var e=this;if(this.isCurrentInTextMode){var n=this.currentDrawData;n&&(n.color=t.color,requestAnimationFrame((function(){var t=e.$refs.input;t&&t.focus()})))}},isCurrentInTextMode:function(t){var e=this;t&&this.$nextTick((function(){requestAnimationFrame((function(){var t=e.$refs.input;t&&t.focus()}))}))},drawAction:function(t,e){if(e===E.Text&&this.saveTextToHistory(),e===E.Move||t===E.Move){var n=this.drawInfo;n.enterItem=n.selectItem=null,this.drawAll()}},"histories.length":function(t,e){t<e&&this.drawAll()},currentSceneInfo:function(){this.drawAll()}},computed:{inElementSelect:function(){var t=this.drawInfo,e=t.action;return e===E.Move&&null!=t.selectItem},inElementMoveState:function(){var t=this.drawInfo,e=t.action;return e===E.Move&&null!=t.enterItem},historyIndexChanges:function(){return this.drawInfo.historyIndexChanges},isCurrentInTextMode:function(){var t=this.currentDrawData;return t&&t.action===E.Text},currentSceneInfo:function(){var t=new rt,e=this.sceneX,n=this.sceneY,r=this.scale,i=this.sceneWidth,a=this.sceneHeight,o=this.canvasScale,s=this.sceneOffsetX,c=this.sceneOffsetY,l=this.getLocation({pageX:s,pageY:c,sceneX:e,sceneY:n,scale:r,sceneWidth:i,sceneHeight:a});return t.offset=l,t.scale=r,t.canvasScale=o,t.sceneWidth=i,t.sceneHeight=a,t},currentBrushSize:function(){return this.drawInfo.brushSize},currentFontSize:function(){return this.drawInfo.fontSize},textareaStyleLeft:function(){var t=this.currentSceneInfo,e=this.currentDrawData;return Math.round((e.startPoint.x-t.offset.x-X)*this.scale)},textareaStyle:function(){if(this.isCurrentInTextMode){var t=this.currentDrawData,e=this.currentSceneInfo,n=this.scale,r=Math.max(1,Math.round(t.lineHeight*n)),i=Math.max(1,Math.round(t.fontSize*n*1e3)/1e3),a=1,o=12;return i<o&&(a=i/o,i=o),{backgroundColor:this.currentTextBackgroundColor,borderColor:this.currentColor.color,color:this.currentColor.color,fontSize:i+"px",transform:"scale(".concat(a.toFixed(5),")"),lineHeight:r+"px",left:this.textareaStyleLeft+"px",top:Math.round((t.startPoint.y-e.offset.y-t.lineHeight/2-X+1)*n)+"px",padding:Math.round(X*n)+"px",height:Math.max(1,Math.round(t.textareaSize.height*n))+"px",width:Math.max(1,Math.round((t.textareaSize.width+2)*n/a))+"px"}}},currentTextBackgroundColor:function(){var t=this.currentColor.color,e=this.drawAction;return e===E.Text&&(t=Z(t,.2)),t},currentColor:function(){var t;return null!==(t=D[this.drawInfo.colorIndex])&&void 0!==t?t:D[0]},artboard:function(){var t;return null===(t=this.curArtboard)||void 0===t?void 0:t.artboard},rect:function(){var t,e=this.artboard,n=null!==(t=null===e||void 0===e?void 0:e.boundsInArtboard)&&void 0!==t?t:new d["a"];return(new d["a"]).set(0,0,n.width,n.height)},inDrawAndNotMove:function(){var t=this.drawAction;switch(t){case E.None:return!1;default:return!0}},drawInfo:function(){return this.editComment.drawInfo},EnumDrawAction:function(){return E},drawAction:function(){return this.drawInfo.action},histories:function(){return this.drawInfo.histories},historyIndex:function(){return this.drawInfo.historyIndex},visible:function(){return this.editComment.drawing}},data:function(){return{handleDraw:0,canvasScale:Object(c["getPixelRatio"])(),startInfo:{pageX:0,pageY:0,sceneX:0,sceneY:0,scale:1,sceneWidth:0,sceneHeight:0},moveInfo:{pageX:0,pageY:0,sceneX:0,sceneY:0,scale:1,sceneWidth:0,sceneHeight:0},currentDrawData:null}},props:{sceneWidth:Number,sceneHeight:Number,sceneX:Number,sceneY:Number,sceneOffsetX:Number,sceneOffsetY:Number,scale:Number},created:function(){this.resetData(),l["a"]&&(window.drawViewInstance=this)},beforeDestroy:function(){this.editComment.drawing=!1,cancelAnimationFrame(this.handleDraw),window.removeEventListener("keydown",this.onCanvasKeyDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp)}},Pn=Fn,jn=(n("6f77"),Object(qe["a"])(Pn,wn,xn,!1,null,"780b04bb",null)),Rn=jn.exports,Bn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"box",staticClass:"viewer-box",style:t.style,on:{contextmenu:function(t){t.preventDefault()}}},[t.fetchState===t.FetchState.Fetching?n("div",{staticClass:"loading"},[t._v("图片加载中...")]):t.fetchState===t.FetchState.Error?n("div",{staticClass:"error"},[t._v(" 图片加载失败,"),n("a",{attrs:{href:"javascript:;"},on:{click:t.clickReload}},[t._v("重新加载")])]):t._e(),n("img",{directives:[{name:"show",rawName:"v-show",value:t.fetchState===t.FetchState.Success,expression:"fetchState===FetchState.Success"}],staticClass:"preview",attrs:{src:t.currentImgShowSrc},on:{load:t.onImgLoad,error:t.onImgError}})])},Vn=[],Un={methods:{clickReload:function(){this.fetchState=c["FetchState"].Fetching,this.randomUrl=Date.now()},clickZoomContainer:function(){},canEmitEvent:function(){return this.fetchState===c["FetchState"].Success},onSceneResize:function(t,e,n){var r=this.canScale&&0!==this.scale;if(!r||n){var i=this.rect;if(i&&0!==t&&0!==e){var a=i.width/t,o=i.height/e,s=Math.max(a,o);0!==s&&(s=.92/s,s>2&&(s=2),this.setScaleImageViewer(s))}}},onImgLoad:function(t){var e=this.currentImg;if(e){var n=t.target;if(n){this.fetchState=c["FetchState"].Success;var r=this.currentImgSrcBlobUrl||this.currentImgSrc,i=n.src;-1!==i.indexOf(r)&&(e.width=n.naturalWidth,e.height=n.naturalHeight),this.resetImageViewerScale(),this.disposeBlobUrl()}}},onImgError:function(){this.fetchState=c["FetchState"].Error,this.disposeBlobUrl()},disposeBlobUrl:function(t){var e=this.currentImgSrcBlobUrl;e&&(URL.revokeObjectURL(e),l["a"]&&console.log("revokeObjectURL",e),t&&(this.currentImgSrcBlobUrl=null))},createBlobUrl:function(t){(t instanceof File||t instanceof Blob)&&(this.currentImgSrcBlobUrl=URL.createObjectURL(t),l["a"]&&console.log("createObjectURL",this.currentImgSrcBlobUrl))}},computed:{FetchState:function(){return c["FetchState"]},rect:function(){if(this.canScale){var t=this.currentImg;return(new d["a"]).set(0,0,t.width,t.height)}},canScale:function(){var t=this.currentImg;return!!t&&(0!==t.width||0!==t.height)},imgList:function(){return this.imageViewer.imgList},currentIndex:function(){return this.imageViewer.currentIndex},currentImg:function(){var t=this.imgList;return t?t[this.currentIndex]:null},currentImgSrc:function(){var t,e;return null!==(t=null===(e=this.currentImg)||void 0===e?void 0:e.imgSrc)&&void 0!==t?t:""},currentImgShowSrc:function(){var t=this.currentImgSrcBlobUrl||this.currentImgSrc;if(!t)return t;var e=this.randomUrl;return 0===e?t:"".concat(t,"?r=").concat(e)},imageViewer:function(){return this.$store.state.imageViewer},scale:function(){return this.scaleImageViewer},style:function(){var t=this.scale,e=this.currentImg;return e?this.fetchState!==c["FetchState"].Success?{transform:"translate3d(".concat(-this.sceneX,"px, ").concat(-this.sceneY,"px, 1px)")}:{width:Math.ceil(e.width*t)+"px",height:Math.ceil(e.height*t)+"px"}:null}},watch:{currentImgSrc:function(t){this.disposeBlobUrl(!0),this.fetchState=c["FetchState"].Fetching,this.randomUrl=0,this.$emit("setConfig",{sceneX:0,sceneY:0}),this.createBlobUrl(t)}},data:function(){return{fetchState:c["FetchState"].Normal,randomUrl:0,currentImgSrcBlobUrl:""}},props:{sceneWidth:Number,sceneHeight:Number,sceneX:Number,sceneY:Number},beforeDestroy:function(){this.disposeBlobUrl(!0)},created:function(){l["a"]&&(window.vueViewerBox=this);var t=this.currentImgSrc;t&&(this.fetchState=c["FetchState"].Fetching,this.createBlobUrl(t))}},$n=Un,Hn=(n("627e"),Object(qe["a"])($n,Bn,Vn,!1,null,"b7da3ad8",null)),zn=Hn.exports,Wn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{ref:"commentPoints",staticClass:"comment-points",class:{prevent:t.preventPointEnable,"in-drawing":t.inDrawing},on:{mousedown:t.onMouseDownInScene}},[t._l(t.pointComments,(function(e){return n("CommentPointItem",{key:e.id,attrs:{comment:e,text:e.pointIndex,pointX:e.pointX,pointY:e.pointY,sceneInfo:t.currentSceneInfo,artboardRect:t.rect},on:{onLocationChange:t.onLocationChangeComment,setConfig:t.setConfig}})})),t.pointInfo.point.enable?n("CommentPointItem",{attrs:{comment:null,text:t.nextPointIndex,pointX:t.pointInfo.point.x,pointY:t.pointInfo.point.y,sceneInfo:t.currentSceneInfo,artboardRect:t.rect},on:{onLocationChange:t.onLocationChangeEditor,setConfig:t.setConfig}}):t._e(),t.preventPointEnable?n("CommentPointItem",{attrs:{comment:null,text:t.nextPointIndex,pointX:t.pointInfo.preventPoint.x,pointY:t.pointInfo.preventPoint.y,prevent:!0,artboardRect:t.rect,sceneInfo:t.currentSceneInfo}}):t._e()],2):t._e()},Gn=[],Yn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{staticClass:"comment-point",class:{prevent:t.prevent,on:t.isSelectCurrent,canMove:t.canMove},style:t.style},[n("div",{staticClass:"text",class:{on:t.isSelectCurrent},on:{mousedown:function(e){return e.stopPropagation(),t.onMouseDown.apply(null,arguments)},click:t.onClick}},[t._v(t._s(t.text))]),t.comment&&t.popMsg.visible?n("CommentPointItemCommentContent",{attrs:{comment:t.comment,popMsg:t.popMsg},on:{clickGoComment:t.setSelectComment,clickIgnore:t.ignoreThisClickPopMsg}}):t._e()],1):t._e()},Xn=[],Kn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-detail",on:{"!click":function(e){return t.clickIgnore.apply(null,arguments)}}},[n("div",{staticClass:"content"},[n("div",{staticClass:"summary"},[n("span",{domProps:{innerHTML:t._s(t.summaryHTML)}})]),t.attachMentImgs.length>0?n("ul",{staticClass:"attachments"},t._l(t.attachMentImgs,(function(e,r){return n("li",{key:r,on:{click:function(n){return n.preventDefault(),t.clickAttach(e)}}},[n("BlobImage",{attrs:{image:e.preview}})],1)})),0):t._e(),n("div",{staticClass:"date"},[t._v(t._s(t.comment.dateStr))])]),n("div",{staticClass:"info"},[n("div",{staticClass:"name"},[n("UserFace2",{attrs:{self:t.isSelfComment,title:t.userFaceTitle,text:t.userFaceText}}),n("span",{staticClass:"name-value",attrs:{title:t.userFaceTitle}},[t._v(t._s(t.userNickName))])],1),n("a",{attrs:{href:"javascript:;"},on:{click:t.clickGoComment}},[t._v("回复")])])])},Zn=[],qn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"image"},[t.loadState===t.FetchState.Fetching?n("div",{staticClass:"loading"}):t.loadState===t.FetchState.Error?n("div",{staticClass:"error",attrs:{title:"图片加载失败"}}):t._e(),t.localUrl&&t.loadState!==t.FetchState.Error?n("img",{class:{on:t.loadState===t.FetchState.Success},attrs:{src:t.localUrl},on:{load:t.onImageLoad,error:t.onImgError}}):t._e()])},Qn=[],Jn={methods:{onImageLoad:function(){this.loadState=c["FetchState"].Success,this.disposeBlobUrl()},onImgError:function(){this.loadState=c["FetchState"].Error,this.disposeBlobUrl()},loadImage:function(){var t=this.image;if(t){if(Object(l["h"])(t))return this.localUrl=t,void(this.loadState=c["FetchState"].Fetching);this.loadState=c["FetchState"].Fetching;try{this.localUrl=URL.createObjectURL(t),l["a"]&&console.log("createObjectURL",this.localUrl)}catch(e){this.loadState=c["FetchState"].Error,this.localUrl=""}}},disposeBlobUrl:function(){var t=this.localUrl;t&&0===t.indexOf("blob:")&&(URL.revokeObjectURL(t),l["a"]&&console.log("revokeObjectURL",t))},unloadImage:function(){var t=this.localUrl;t&&0===t.indexOf("blob:")&&(URL.revokeObjectURL(t),l["a"]&&console.log("revokeObjectURL",t),this.localUrl="",this.loadState=c["FetchState"].Normal)}},computed:{FetchState:function(){return c["FetchState"]}},watch:{image:function(){this.unloadImage(),this.loadImage()}},beforeDestroy:function(){this.unloadImage()},created:function(){this.loadImage()},data:function(){return{localUrl:"",loadState:c["FetchState"].Normal}},props:{image:{type:[File,Blob,String]}}},tr=Jn,er=(n("cd55"),Object(qe["a"])(tr,qn,Qn,!1,null,"2accbf04",null)),nr=er.exports,rr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"userface",class:{self:t.self},attrs:{title:t.title}},[t._v(" "+t._s(t.text)+" ")])},ir=[],ar={props:{title:String,text:String,self:Boolean}},or=ar,sr=(n("655b"),Object(qe["a"])(or,rr,ir,!1,null,"4b992dd2",null)),cr=sr.exports,lr=[{name:"solve",text:"确认",enumValue:7},{name:"lookat",text:"看这",enumValue:8},{name:"great",text:"哇",enumValue:9},{name:"compare",text:"对比",enumValue:10},{name:"zhenbang",text:"赞",enumValue:6},{name:"aixin",text:"爱心",enumValue:1},{name:"wenhao",text:"问号",enumValue:4},{name:"666",text:"666",enumValue:11},{name:"tanhao",text:"惊叹",enumValue:3},{name:"zantong",text:"+1",enumValue:5},{name:"haode",text:"OK",enumValue:2},{name:"tuding",text:"图钉",enumValue:12}],ur={};function dr(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(l["h"])(t)?t.replace(/[<>]/g,(function(t){switch(t){case"<":return"&lt;";case">":return"&gt;"}return t})).replace(/\[([^\]]{1,4})\]/g,(function(t,n){var r=ur[n];return r?e?"":'<span class="icon-emoji emoji-'.concat(r.name,'"></span>'):t})):t}function hr(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(l["h"])(t)&&Object(l["o"])(e)?(n||(t=fr(t)),t.replace(/\[@uid:(\d+);\]/g,(function(t,r){var i=e[r];return i?n?"@".concat(i.nickName):'<span class="at-user-item" title="'.concat(i.nickName,"(").concat(i.email,')">@').concat(i.nickName,"</span>"):t}))):t}function fr(t){return t.replace(/https?:\/\/([\w-]+\.)+[\w-]+(:\d+)?(\/[\w-+./?%&=#]*)?/gi,(function(t){return'<a class="out-link" target="_blank" title="'.concat(t,'" href="').concat(t,'">').concat(t,"</a>")}))}function mr(t,e){return hr(dr(t,!0),e,!0)}lr.forEach((function(t){ur[t.text]=t,t.texts&&t.texts.forEach((function(e){ur[e]=t}))}));var pr,br={components:{UserFace2:cr,BlobImage:nr},methods:{clickGoComment:function(){this.$emit("clickGoComment",this.comment)},clickIgnore:function(){this.$emit("clickIgnore")},setCommentEditorVisibleId:function(t){this.$store.commit("setCommentEditorVisibleId",t)},clickAttach:function(t){var e=this.attachMentImgs.map((function(t){return t.imgSrc})),n=e.findIndex((function(e){return e===t.imgSrc}));-1===n&&(n=0),this.$store.commit("setImageViewer",{imgList:e,currentIndex:n})}},computed:{summaryHTML:function(){return hr(dr(this.comment.summary),this.comment.atUsers)},users:function(){var t;return null!==(t=this.$store.state.artboardDetail.commentUsers)&&void 0!==t?t:{}},selectComment:function(){return this.$store.state.artboardDetail.selectComment},attachMentImgs:function(){var t,e=null===(t=this.comment)||void 0===t?void 0:t.attachMents,n=[];return e?(e.forEach((function(t){if(t){var e=t.thumbFileName||t.fileName;e&&n.push({imgSrc:t.fold+t.fileName,preview:t.fold+e})}})),n):n},userFaceTitle:function(){var t=this.comment;if(!t)return null;var e=t.user;return e?"".concat(e.nickName,"(").concat(e.email,")"):null},userNickName:function(){var t=this.comment;if(!t)return"-";var e=t.user;if(!e)return"-";var n=e.nickName;return n||"-"},isSelfComment:function(){var t=this.comment;if(!t)return!1;var e=t.user;return!!e&&e.userKey===this.cloudUserKey},userFaceText:function(){var t=this.userNickName;return t[t.length-1]}},props:{popMsg:Object,comment:Object}},vr=br,gr=(n("88b4"),Object(qe["a"])(vr,Kn,Zn,!1,null,"81e4df62",null)),wr=gr.exports,xr=300,yr=227,Cr=270,kr={components:{CommentPointItemCommentContent:wr},methods:{onMouseDown:function(t){this.moving=!1,window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp);var e=this.moveData;e.startX=t.clientX,e.startY=t.clientY},onMouseMove:function(t){var e=this.moveData;e.endX=t.clientX,e.endY=t.clientY,!this.moving&&(Math.abs(e.endX-e.startX)>=3||Math.abs(e.endY-e.startY)>=3)&&(this.moving=!0,this.canMove||this.showTextTip("只能移动自己发表的评注,请联系评论发布者或管理员")),this.canMove||(e.endX=e.startX,e.endY=e.startY)},onMouseUp:function(t){var e=this;window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp);var n=this.moveData,r=this.moving,i=this.canMove;if(i){if(r&&!this.prevent){n.endX=t.clientX,n.endY=t.clientY;var a=new F(this.pointX,this.pointY);if(!this.prevent){var o=this.moveData;a=ot.getCanvasLocation(this.sceneInfo,a),this.moving&&(a.left+=o.endX-o.startX,a.top+=o.endY-o.startY)}requestAnimationFrame((function(){e.$emit("onLocationChange",e.comment,a.x,a.y)}))}}else requestAnimationFrame((function(){e.moving=!1}))},onClick:function(){var t=this,e=this.comment,n=this.moving;if(!n)if(e){if(this.pointCommentShowAlways&&!this.artboardInComment)return void setTimeout((function(){var e=t.popMsg;e.ignoreThisClick=!1,e.visible=!0,t.pointInView||t.movePointToSceneCenter()}),10);this.setSelectComment(e)}else{this.showTextTip("待提交的评论评注"),this.artboardInComment||this.$store.commit("setArtboardInComment",!0);var r=300;this.artboardCommentVisible&&(r=50),this.$store.commit("artboardCommentVisible",!0),setTimeout((function(){var e=t.pointInfo.instance;e&&e.focus()}),r)}},setSelectComment:function(t){this.artboardInComment||this.$store.commit("setArtboardInComment",!0),this.$store.commit("setSelectComment",{comment:t})},movePointToSceneCenter:function(){var t=this.sceneInfo,e=this.artboardRect,n=this.pointX,r=this.pointY,i=t.scale,a=(e.width/2-n)*i,o=(e.height/2-r)*i;this.$emit("setConfig",{sceneX:a,sceneY:o})},ignoreThisClickPopMsg:function(){var t=this.popMsg;t.ignoreThisClick=!0},hidePopMsg:function(){var t=this.popMsg;this.moving||(clearTimeout(t.handleHide),t.handleHide=setTimeout((function(){t.ignoreThisClick?t.ignoreThisClick=!1:t.visible=!1}),50))}},beforeDestroy:function(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("click",this.popMsg.hidePopMsg,!0),clearTimeout(this.popMsg.handleHide)},computed:{pointCommentShowAlways:function(){return this.$store.state.pointCommentShowAlways},commentVisible:function(){return this.artboardInComment&&this.artboardCommentVisible},artboardCommentVisible:function(){return this.$store.state.artboardCommentVisible},leftVisible:function(){return this.$store.state.artboardDetail.leftSideVisible},pointInfo:function(){return this.$store.state.editComment.pointInfo},isSelectCurrent:function(){var t=this.comment,e=this.selectComment;return e===t&&null!=t},selectComment:function(){return this.$store.state.artboardDetail.selectComment},canMove:function(){return!this.prevent&&this.isSelfComment},isSelfComment:function(){var t=this.comment;if(!t)return!0;var e=t.user;return!!e&&e.userKey===this.cloudUserKey},pointInView:function(){var t=this.location,e=this.pointRadius/2,n=this.sceneInfo,r=n.sceneWidth,i=n.sceneHeight,a=(new d["a"]).set(e,e,r-2*e,i-2*e);this.leftVisible&&(a.x+=yr),this.commentVisible?a.width-=xr:this.artboardInComment||(this.curNode&&(a.width-=xr),a.width-=Cr,a.width+=2*e);var o=(new d["a"]).set(t.x,t.y,1,1);return o.isOverlap(a)},visible:function(){if(this.prevent)return!0;if(this.isSelectCurrent)return!0;if(this.moving)return!0;var t=this.location,e=2*this.pointRadius,n=this.sceneInfo,r=n.sceneWidth,i=n.sceneHeight,a=(new d["a"]).set(0,0,r,i),o=(new d["a"]).set(t.x-e,t.y-e,2*e,2*e);return o.isOverlap(a)},location:function(){var t=new F(this.pointX,this.pointY);if(!this.prevent){var e=this.moveData,n=this.sceneInfo;t=ot.getCanvasLocation(n,t),this.moving&&(t.left+=e.endX-e.startX,t.top+=e.endY-e.startY)}return t},style:function(){var t=this.location,e=this.pointRadius;return{top:t.top-e+"px",left:t.left-e+"px"}}},watch:{"popMsg.visible":function(t){t?window.addEventListener("click",this.hidePopMsg,!0):window.removeEventListener("click",this.hidePopMsg,!0)},artboardInComment:function(t){t&&(this.popMsg.visible=!1)},isSelectCurrent:function(t){t&&(this.pointInView||this.movePointToSceneCenter())},pointX:function(){this.moving=!1},pointY:function(){this.moving=!1}},props:{artboardRect:{type:Object,default:null},sceneInfo:{type:Object,default:null},comment:{type:Object,default:null},text:[String,Number],pointX:Number,pointY:Number,prevent:{type:Boolean,default:!1}},data:function(){return{popMsg:{visible:!1,handleHide:0,ignoreThisClick:!1},pointRadius:15,moving:!1,moveData:{startX:0,startY:0,endX:0,endY:0}}}},Sr=kr,_r=(n("20c0"),Object(qe["a"])(Sr,Yn,Xn,!1,null,"526176ac",null)),Ar=_r.exports,Ir={components:{CommentPointItem:Ar},methods:{setConfig:function(t){this.$emit("setConfig",t)},onLocationChangeComment:function(t,e,n){var a=this;return Object(i["a"])(Object(r["a"])().mark((function i(){var o,s,c,u,d,h,f;return Object(r["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t){r.next=2;break}return r.abrupt("return");case 2:if(o=a.getLocation({pageX:e+a.sceneOffsetX,pageY:n+a.sceneOffsetY}),o.x!==t.pointX||o.y!==t.pointY){r.next=5;break}return r.abrupt("return");case 5:return t.pointX=o.x,t.pointY=o.y,s=t.id,c=t.artboardId,u=t.commentId,d=t.pointX,h=t.pointY,r.prev=8,r.next=11,a.fetchPostCloudApi("setcommentpointbyweb",{body:{id:s,commentId:u,artboardId:c,pointEnable:!0,pointX:d,pointY:h}});case 11:if(f=r.sent,Object(l["o"])(f)){r.next=14;break}return r.abrupt("return");case 14:if(f.success){r.next=16;break}throw new Error(f.errMsg);case 16:r.next=21;break;case 18:r.prev=18,r.t0=r["catch"](8),a.showTextTip("移动评注失败:".concat(r.t0));case 21:case"end":return r.stop()}}),i,null,[[8,18]])})))()},onLocationChangeEditor:function(t,e,n){var r=this.pointInfo.point,i=this.getLocation({pageX:e+this.sceneOffsetX,pageY:n+this.sceneOffsetY});i.x===r.x&&i.y===r.y||(r.x=i.x,r.y=i.y)},getLocation:function(t){var e=t.pageX,n=t.pageY,r=e,i=n,a=this.sceneOffsetX,o=this.sceneOffsetY,s=this.rect,c=this.sceneX,l=this.sceneY,u=this.scale,d=this.sceneWidth,h=this.sceneHeight,f=(d-s.width*u)/2,m=(h-s.height*u)/2;return r-=a,i-=o,r-=f,i-=m,r-=c,i-=l,r=Math.round(r/u),i=Math.round(i/u),new F(r,i)},onMouseMove:function(t){if(this.preventPointEnable){var e=this.pointInfo.preventPoint;e.x=t.clientX,e.y=t.clientY}},onMouseDownInScene:function(t){if(this.preventPointEnable){var e=this.getLocation({pageX:t.clientX,pageY:t.clientY}),n=this.pointInfo,r=n.point,i=n.preventPoint,a=n.instance;i.enable=!1,r.pointIndex=this.nextPointIndex,r.enable=!0,r.x=e.x,r.y=e.y,requestAnimationFrame((function(){a&&a.focus()})),l["a"]&&console.log("onMouseDownInScene",t,e,this.rect)}},onMouseDown:function(){var t=this.pointInfo.preventPoint;t.enable=!1}},watch:{nextPointIndex:function(t){var e=this.pointInfo.point;e.enable&&(e.pointIndex=t)},preventPointEnable:function(t){t?(window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mousedown",this.onMouseDown)):(window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mousedown",this.onMouseDown))}},computed:{currentSceneInfo:function(){var t=new rt,e=this.scale,n=this.sceneWidth,r=this.sceneHeight,i=this.sceneOffsetX,a=this.sceneOffsetY,o=this.getLocation({pageX:i,pageY:a});return t.offset=o,t.scale=e,t.canvasScale=1,t.sceneWidth=n,t.sceneHeight=r,t},artboard:function(){var t;return null===(t=this.curArtboard)||void 0===t?void 0:t.artboard},rect:function(){var t,e=this.artboard,n=null!==(t=null===e||void 0===e?void 0:e.boundsInArtboard)&&void 0!==t?t:new d["a"],r=this.calcArtScale,i=n.width,a=n.height;return r>0&&(i=Math.round(i/r),a=Math.round(a/r)),(new d["a"]).set(0,0,i,a)},preventPointEnable:function(){return this.pointInfo.preventPoint.enable},pointInfo:function(){return this.$store.state.editComment.pointInfo},comments:function(){return this.$store.state.artboardDetail.comments},maxPointIndex:function(){return this.$store.state.artboardDetail.maxPointIndex},nextPointIndex:function(){var t=this.pointComments,e=this.maxPointIndex;if(e>0)return e+1;var n=t[t.length-1];return n?n.pointIndex+1:1},pointComments:function(){var t=[],e=this.comments;return Object(l["g"])(e)?(e.forEach((function(e){Object(l["o"])(e)&&(e.pointEnable&&t.push(e),Object(l["g"])(e.comments)&&e.comments.forEach((function(e){Object(l["o"])(e)&&e.pointEnable&&t.push(e)})))})),t.sort((function(t,e){var n=t.pointIndex,r=e.pointIndex;return n===r&&(n=t.id,r=e.id),n>r?1:-1})),t):t},visible:function(){return this.artboardInComment||this.pointCommentShowAlways},inDrawing:function(){var t=this.$store.state.editComment;return t.drawing},artboardCommentVisible:function(){return this.$store.state.artboardCommentVisible},pointCommentShowAlways:function(){return this.$store.state.pointCommentShowAlways}},props:{sceneWidth:Number,sceneHeight:Number,sceneX:Number,sceneY:Number,sceneOffsetX:Number,sceneOffsetY:Number,scale:Number},beforeDestroy:function(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mousedown",this.onMouseDown)},created:function(){l["a"]&&(window.vue_CommentPoints=this)}},Tr=Ir,Or=(n("f004"),Object(qe["a"])(Tr,Wn,Gn,!1,null,"0380736a",null)),Er=Or.exports,Mr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{ref:"box",staticClass:"art-info",class:{dragging:t.dragging,canvas:t.useCanvasMode},style:t.style,on:{contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)},click:t.clickInfoBox}},[t.useCanvasMode?t._e():[n("div",{staticClass:"name",attrs:{title:t.curArtboard.artboard.name}},[t._v(t._s(t.curArtboard.artboard.name))]),n("img",{staticClass:"preview",class:{loading:t.imgLoading},attrs:{src:t.artboardPreviewPng},on:{load:t.onImgLoad,error:t.onImgError}}),t.imgLoading?n("div",{staticClass:"img-loading"},[n("div",{staticClass:"loading"},[t._v("正在加载画板预览图...")])]):t._e()],t.artboardInComment?t._e():[n("NodeItem",{attrs:{parentRect:t.curArtboard.artboard.boundsInArtboard,item:t.curArtboard.artboard,shiftKey:t.shiftKey}}),t._l(t.exportNodes,(function(t,e){return n("SliceTip",{key:e+"+"+t.guid,attrs:{node:t}})})),n("NodeInfoCurrent"),n("NodeIntersectInfo",{attrs:{width:t.rect.width,height:t.rect.height}})]],2)},Lr=[],Nr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visibleMax?n("div",{staticClass:"node-item-wrap",style:t.style},[t.item.mlIgnoreEvent?t._e():n("div",{staticClass:"node-item",on:{click:function(e){return e.stopPropagation(),t.clickNode.apply(null,arguments)},mouseenter:function(e){return e.stopPropagation(),t.mouseEnterNode.apply(null,arguments)},mouseleave:function(e){return e.stopPropagation(),t.mouseLeaveNode.apply(null,arguments)}}}),t._l(t.children,(function(e,r){return n("NodeItem",{key:r+"_"+e.guid,attrs:{parentRect:t.item.boundsInArtboard,item:e,shiftKey:t.shiftKey}})}))],2):t.visibleMin?n("div",{staticClass:"node-item-wrap on",class:{hotspot:t.isHotSpot},style:t.style,on:{click:function(e){return e.stopPropagation(),t.clickNode.apply(null,arguments)},mouseenter:function(e){return e.stopPropagation(),t.mouseEnterNode.apply(null,arguments)},mouseleave:function(e){return e.stopPropagation(),t.mouseLeaveNode.apply(null,arguments)}}}):t._e()},Dr=[],Fr={name:"NodeItem",methods:{mouseLeaveNode:function(){this.inMultDownMode||this.shiftKey&&null!=this.curNode||this.setEnterNode(null)},mouseEnterNode:function(){this.inMultDownMode||this.shiftKey&&null!=this.curNode||this.setEnterNode(this.item)},getNodesFromPoint:function(t){var e=t.target;if(e){var n,r=t.offsetX;null==r?(r=t.layerX,n=t.layerY):n=t.offsetY;var i=this.scale;r/=i,n/=i;var a="".concat(r,"_").concat(n),o=this.cachePointNodes;if(o.key===a)return o.nodes;var s=this.item.boundsInArtboard,c=(new d["a"]).set(s.x+r,s.y+n,1,1),l=this.curArtboard.childs,u=[];return l.forEach((function(t){if(t&&t.visible&&!t.mlIgnoreEvent){var e=t.boundsInArtboard;if(e.width<=2||e.height<=2){var n=e,r=n.x,i=n.y,a=n.width,o=n.height;e=(new d["a"]).set(r,i,a,o),e.width<=2&&(e.width+=2,e.x-=1),e.height<=2&&(e.height+=2,e.y-=1)}Object(d["f"])(e,c)&&u.push(t)}})),o.key=a,o.nodes=u,u}},clickNode:function(t){var e=this.item;if(this.inMultDownMode)e.markedForExport&&(e.mlUserSelectDown=!e.mlUserSelectDown);else{var n=this.curNode,r=!1;if(null!=n&&this.shiftKey&&(n=this.enterNode,r=!0),null!=n&&this.clickedNode===e&&Math.abs(this.clickPageX-t.pageX)<2&&Math.abs(this.clickPageY-t.pageY)<2){var i=this.getNodesFromPoint(t),a=i.findIndex((function(t){return t===n}));if(-1===a)a=i.length-1;else{var o=n.boundsInArtboard;while(a--&&a>=0){var s=i[a],c=s.boundsInArtboard;if(!Object(d["g"])(c,o)||s.markedForExport||s.renderTapInteraction||1===s.types.Artboard||1!==s.types.GraphicNode&&1!==s.types.Group&&1!==s.types.SymbolMaster&&1!==s.types.SymbolInstance||s.fillEnabled||s.strokeEnable||s.shadow||s.innerShadow)break}a<0&&(a=i.length-1)}var l=i[a];n=l||e}else n=e;this.clickPageX=t.pageX,this.clickPageY=t.pageY,r?this.setEnterNode(n):this.setCurNode(n),this.setClickedNode(e)}}},computed:{children:function(){return this.item.children||[]},visibleMax:function(){return this.visible&&this.children.length>0},visibleMin:function(){return!this.visibleMax&&this.visible&&!this.item.mlIgnoreEvent},visible:function(){var t=this.item;return!!t&&(!!t.visible&&!t.mlIgnoreLeftSide)},isHotSpot:function(){var t=this.item;return!!t&&t.type===o["A"].HotSpot},scale:function(){return this.scaleArtboard},style:function(){var t=this.item.boundsInArtboard,e=this.parentRect,n=this.scale,r=Math.ceil(Math.max(1,t.width*n)),i=Math.ceil(Math.max(1,t.height*n)),a=Math.round((t.y-e.y)*n),o=Math.round((t.x-e.x)*n);return r<3&&(r+=2,o-=1),i<3&&(i+=2,a-=1),{top:a+"px",left:o+"px",width:r+"px",height:i+"px"}}},props:{item:Object,shiftKey:Boolean,parentRect:Object},data:function(){return{clickPageX:0,clickPageY:0,cachePointNodes:{nodes:null,key:""}}}},Pr=Fr,jr=(n("bead"),Object(qe["a"])(Pr,Nr,Dr,!1,null,"0d3375e6",null)),Rr=jr.exports,Br=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{staticClass:"node-info-current",class:{"only-enter":null==t.curNode},style:t.showNodeStyle},[t.curNode?t._l(t.borRadios,(function(e){return n("div",{key:e,class:["bor bor-"+e],style:t.borderStyle})})):t._e(),t.showNodeSize?[n("div",{staticClass:"item width",style:t.nodeWidthStyle},[n("span",[t._v(t._s(t.nodeRect.showWidth))])]),n("div",{staticClass:"item height",style:t.nodeHeightStyle},[n("span",[t._v(t._s(t.nodeRect.showHeight))])])]:t._e()],2):t._e()},Vr=[],Ur={computed:{showNodeSize:function(){var t=this.curNode,e=this.enterNode;return t?!e||e===t:!!e},nodeRect:function(){if(!this.showNodeSize)return{width:0,height:0,top:0,left:0};var t=this.showNode,e=t.boundsInArtboard,n=this.scaleArtboard,r=t.markedForExport,i={width:Math.ceil(e.width*n),height:Math.ceil(e.height*n),left:Math.floor(e.x*n),top:Math.floor(e.y*n),showWidth:this.getCalcPlatformValue(e.width,{markedForExport:r}),showHeight:this.getCalcPlatformValue(e.height,{markedForExport:r})};return i},nodeWidthStyle:function(){var t=this.nodeRect;return{left:Math.ceil(t.width/2)+"px"}},nodeHeightStyle:function(){var t=this.nodeRect;return{left:t.width+1+"px",top:Math.ceil(t.height/2)+"px"}},borderStyle:function(){var t=this.borderWidth;return"width:".concat(t,";height:").concat(t,";")},borderWidth:function(){var t=2.3*this.scaleArtboard+3;return t=Math.round(t),t+"px"},borRadios:function(){return[0,1,2,3]},visible:function(){if(this.inMultDownMode)return!1;var t=this.showNode;return!!t},showNode:function(){var t=this.curNode;return t||(t=this.enterNode),t},showNodeStyle:function(){var t=this.showNode;if(t){var e=t.boundsInArtboard,n=this.scaleArtboard;return{top:Math.floor(e.y*n)+"px",left:Math.floor(e.x*n)+"px",width:Math.ceil(Math.max(1,e.width)*n)+"px",height:Math.ceil(Math.max(1,e.height)*n)+"px"}}}}},$r=Ur,Hr=(n("08ba"),Object(qe["a"])($r,Br,Vr,!1,null,"b0c4333c",null)),zr=Hr.exports,Wr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("section",{staticClass:"node-info"},[n("div",{staticClass:"enter-item-box",style:t.enterNodeStyle}),t._l(t.markLines,(function(e){return n("div",{key:e.id,staticClass:"item",class:{horizintal:e.isHorizintal,vertical:!e.isHorizintal,dashed:e.isDashed},style:t.getMarkStyle(e)},[e.text?n("span",[t._v(t._s(e.text))]):t._e()])}))],2):t._e()},Gr=[],Yr={methods:{getMarkStyle:function(t){var e=this.scale,n=this.markScale;0===n&&(n=1),e/=n;var r,i,a=t.rect,o={top:Math.floor(a.top*e)+"px",left:Math.floor(a.left*e)+"px"};return t.isHorizintal?(r="height",i="width"):(r="width",i="height"),o[r]=a[r]+"px",o[i]=Math.ceil(a[i]*e)+"px",o},getMarkLines:function(){var t=this;if(!this.visible)return[];var e=this.curNode,n=this.enterNode,r=e.boundsInArtboard,i=n.boundsInArtboard,a=(new d["a"]).set(r.x,r.y,r.width,r.height),o=(new d["a"]).set(i.x,i.y,i.width,i.height),s={width:this.getCalcValue(this.width),height:this.getCalcValue(this.height)},c=e.markedForExport;a.x=this.getCalcValue(a.x),a.y=this.getCalcValue(a.y),a.width=this.getCalcValue(a.width,c),a.height=this.getCalcValue(a.height,c);var l=n.markedForExport;return o.x=this.getCalcValue(o.x),o.y=this.getCalcValue(o.y),o.width=this.getCalcValue(o.width,l),o.height=this.getCalcValue(o.height,l),this.markScale=this.getCalcRectScale(),Object(d["c"])(a,o,s,(function(e){return t.getCalcUnitTemplateValue(e)}))}},watch:{curNode:function(){this.markLines=this.getMarkLines()},enterNode:function(){this.markLines=this.getMarkLines()},visible:function(t){t&&(this.markLines=this.getMarkLines())}},computed:{enterNodeStyle:function(){var t=this.enterNode;if(t){var e=t.boundsInArtboard,n=this.scaleArtboard;return{top:Math.floor(e.y*n)+"px",left:Math.floor(e.x*n)+"px",width:Math.ceil(Math.max(1,e.width)*n)+"px",height:Math.ceil(Math.max(1,e.height)*n)+"px"}}},scale:function(){return this.scaleArtboard},visible:function(){return!this.inMultDownMode&&null!=this.curNode&&null!=this.enterNode&&this.enterNode!==this.curNode}},props:{width:Number,height:Number},data:function(){return{markScale:1,markLines:[]}}},Xr=Yr,Kr=(n("aa0d"),Object(qe["a"])(Xr,Wr,Gr,!1,null,"7f720960",null)),Zr=Kr.exports,qr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.inMultDownMode&&t.node.mlUserSelectDown?n("div",{staticClass:"slice-tip",class:{out:!t.inArtboard},style:t.style,on:{click:function(e){e.stopPropagation(),t.node.mlUserSelectDown=!1}}},[n("div",{staticClass:"name",attrs:{title:"点击取消选择\n"+t.nodeName}},[t._v(" "+t._s(t.nodeName)+" ")])]):t.inMultDownMode||t.inArtboard?n("div",{staticClass:"slice-tip-min",class:{off:t.curNode==t.node||t.enterNode==t.node,out:!t.inArtboard},style:t.style,on:{click:t.clickSliceTipMin}}):t._e()},Qr=[],Jr={methods:{clickSliceTipMin:function(){(this.inMultDownMode||this.inArtboard)&&(this.node.mlUserSelectDown=!0)}},computed:{nodeName:function(){return Object(c["getNodeShowName"])(this.node)},style:function(){var t=this.node.boundsInArtboard,e=this.scaleArtboard;return{top:Math.floor(t.y*e)+"px",left:Math.floor(t.x*e)+"px",width:Math.ceil(Math.max(1,t.width)*e)+"px",height:Math.ceil(Math.max(1,t.height)*e)+"px"}},inArtboard:function(){var t=this.node.boundsInArtboard,e=Object(d["f"])(t,this.curArtboard.artboard.boundsInArtboard);return e}},props:{node:Object}},ti=Jr,ei=(n("4973"),Object(qe["a"])(ti,qr,Qr,!1,null,"a981df72",null)),ni=ei.exports,ri={components:{NodeItem:Rr,NodeIntersectInfo:Zr,NodeInfoCurrent:zr,SliceTip:ni},methods:{onImgLoad:function(){this.imgState=c["FetchState"].Success},onImgError:function(){this.imgState=c["FetchState"].Error},setSelectComment:function(t){this.$store.commit("setSelectComment",t)},onContextmenu:function(t){var e=this,n=t.pageX,r=t.pageY,i=this.curArtboard;requestAnimationFrame((function(){e.$store.commit("setArtboardMenu",{visible:!0,x:n,y:r,artboard:i})}))},setArtboardCommentVisible:function(t){this.$store.commit("artboardCommentVisible",t)},clickInfoBox:function(){this.setSelectComment(null),this.setArtboardCommentVisible(!0)},clickZoomContainer:function(){this.artboardInComment?(this.setSelectComment(null),this.setArtboardCommentVisible(!1)):this.setCurNode(null)},onSceneResize:function(t,e,n){if(!this.initScale||n){var r=this.rect;if(r&&0!==t&&0!==e){this.initScale=!0;var i=r.width/t,a=r.height/e,o=Math.max(i,a);0!==o&&this.setScaleArtboard(.92/o)}}},quickKey:function(t){this.shiftKey=t.shiftKey}},computed:{artboardListUseCanvas:function(){return this.$store.state.artboardListUseCanvas},useCanvasMode:function(){return this.inCloudMode&&this.artboardListUseCanvas},imgLoading:function(){return this.imgState===c["FetchState"].Fetching},artboardCommentVisible:function(){return this.$store.state.artboardCommentVisible},exportVisible:function(){return this.inMultDownMode&&this.exportNodes.length>0},exportNodes:function(){var t=this.curArtboard;if(!t)return[];var e=t.exportNodes;return e||[]},rect:function(){var t=this.artboard,e=t.boundsInArtboard,n=e.x+e.width,r=e.y+e.height;return(new d["a"]).set(0,0,n,r)},artboard:function(){return this.curArtboard.artboard},artboardPreviewPng:function(){var t,e=this.inCloudMode,n=this.artboard;return e&&this.isSupportWebp&&(t=n.artboardPreviewWebp,t)?t:(t=n.artboardPreviewPng,e?t:"".concat(t,"?").concat(n.mlOutputTime))},isSupportWebp:function(){return this.$store.state.isSupportWebp===pe.Support},style:function(){var t,e=this.useCanvasMode,n=this.artboard,r=this.scale,i=n.boundsInArtboard;if(!e&&n.fill&&n.fillEnabled){var a=n.fill.value;a&&(t=Object(h["g"])(a).value)}return{backgroundColor:t,width:Math.ceil(i.width*r)+"px",height:Math.ceil(i.height*r)+"px"}},scale:function(){return this.scaleArtboard}},watch:{artboardPreviewPng:function(t){t&&(this.imgState=c["FetchState"].Fetching)},curArtboard:function(){this.initScale=!1},artboardInComment:function(t){t&&this.setCurNode(null)}},data:function(){return{imgState:c["FetchState"].Normal,previewImage:null,shiftKey:!1,initScale:!1}},props:{sceneWidth:Number,sceneHeight:Number,dragging:Boolean},created:function(){window.addEventListener("keydown",this.quickKey),window.addEventListener("keyup",this.quickKey)},beforeDestroy:function(){window.removeEventListener("keydown",this.quickKey),window.removeEventListener("keyup",this.quickKey);var t=this.previewImage;t&&(t.src=null,t=null)}},ii=ri,ai=(n("7820"),Object(qe["a"])(ii,Mr,Lr,!1,null,"72b39579",null)),oi=ai.exports,si=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{ref:"box",staticClass:"art-list",class:{dragging:t.dragging},style:t.style},[n("div",{staticClass:"box-size",style:t.boxSize}),t._l(t.renderDocuments,(function(e){return n("div",{key:e.guid,staticClass:"art-doc"},t._l(e.arts,(function(r){return n("ArtboardListItem",{key:e.guid+r.artboard.guid,attrs:{item:r,maxRect:{x:e.maxRect.x-e.rect.x+t.rect.x,y:e.maxRect.y-e.rect.y+t.rect.y}}})})),1)}))],2)},ci=[],li=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{ref:"$item",staticClass:"item",class:{on:t.selected},style:t.style},[n("div",{staticClass:"info",domProps:{textContent:t._s(t.artboard.name)}}),n("div",{staticClass:"img",style:t.imgStyle,attrs:{title:t.goInfoTip},on:{mouseenter:t.onMouseEnter,dblclick:function(e){return t.dlbClickArtboard()},click:t.clickArtboard,mouseleave:t.onMouseLevel,contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)}}},[t.artboard.flowStart?n("div",{staticClass:"interaction-home"}):t._e(),t.errorText?n("div",{staticClass:"error"},[t._v(t._s(t.errorText))]):n("img",{attrs:{src:t.artboardPreviewPng}})]),t.interactionVisible?n("artboard-item-interactions",{attrs:{renderInteractions:t.renderInteractions,item:t.item}}):t._e()],1)},ui=[],di=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("svg",{staticClass:"artboard-interaction-list",class:{light:t.light}},[t._l(t.arrows,(function(e){return[n("path",{key:e.key+"_rect",class:t.getPathCls(e,"rect"),attrs:{d:e.item.nodeRect}}),n("path",{key:e.key+"_line",class:t.getPathCls(e,"line"),attrs:{d:e.item.curve}}),n("image",{key:e.key+"_arrow_icon",attrs:{x:e.item.arrowIcon.x,y:e.item.arrowIcon.y,width:e.item.arrowIcon.width,height:e.item.arrowIcon.height,href:t.isLightArrow(e)?e.item.arrowIcon.href:e.item.arrowIcon.href_default}})]}))],2):t._e()},hi=[],fi={methods:{isLightArrow:function(t){var e=this.enterArtboard,n=this.light;return!!n||null!=t.toArtboardItem&&null!=e&&e.artboard===t.toArtboardItem},getPathCls:function(t,e){var n=[];e&&(Object(l["g"])(e)||(e=[e]),n.push.apply(n,Object(u["a"])(e)));var r=this.enterArtboard;return null!=t.toArtboardItem&&null!=r&&r.artboard===t.toArtboardItem&&n.push("light"),n}},computed:{light:function(){var t=this.enterArtboard,e=this.item;return t===e},enterArtboard:function(){return this.$store.state.enterArtboard},visible:function(){return!this.inArtboardMultDownMode&&this.arrows.length>0},arrows:function(){var t=[],e=this.item.artboard,n=e.pageGuid||e.docGuid,r=e.boundsInParentForList,i=this.renderDocuments;return this.renderInteractions.forEach((function(e){var a,o=Ot(i,e,r,n);o&&t.push({item:o,key:e.guid,toArtboardItem:null===(a=e.renderTapInteraction)||void 0===a?void 0:a.toArtboardItem})})),t}},props:{renderInteractions:Array,item:Object}},mi=fi,pi=(n("4ff6"),Object(qe["a"])(mi,di,hi,!1,null,"2d025f84",null)),bi=pi.exports,vi={components:{ArtboardItemInteractions:bi},methods:{onMouseEnter:function(){this.$store.commit("enterArtboard",this.item)},onMouseLevel:function(){this.$store.commit("enterArtboard",null)},onContextmenu:function(t){var e=this,n=t.pageX,r=t.pageY,i=this.item;requestAnimationFrame((function(){e.$store.commit("setArtboardMenu",{visible:!0,x:n,y:r,artboard:i})}))},dlbClickArtboard:function(){clearTimeout(this.tipHandle),this.inArtboardMultDownMode||(this.hideTextTip(),this.setCurArtboard(this.item))},clickArtboard:function(){var t=this;clearTimeout(this.tipHandle),this.inArtboardMultDownMode?this.item.mlUserSelectDown=!this.item.mlUserSelectDown:this.tipHandle=setTimeout((function(){t.showTextTip(t.goInfoTip2,7)}),200)},loadedImage:function(t){if(null==t)return this.imgErrored=!0,void(this.imgLoaded=!1);this.imgErrored=!1,this.imgLoaded=!0},loadImage:function(){var t=this.artboardPreviewPng;t&&(this.imgErrored=!1,this.imgLoaded=!1,c["listImageLoader"].add(t,this.loadedImage))}},beforeDestroy:function(){clearTimeout(this.tipHandle),c["listImageLoader"].remove(this.artboardPreviewPng,this.loadedImage)},created:function(){this.loadImage()},watch:{artboardPreviewPng:function(t,e){this.imgErrored=!1,c["listImageLoader"].remove(e,this.loadedImage),this.loadImage()}},computed:{artboardShowInteractionLine:function(){return this.$store.state.artboardShowInteractionLine},renderInteractions:function(){var t;if(!this.inCloudMode)return null;var e=this.item.artboard.interactionInfo;if(!e)return null;if(e.fetchState!==c["FetchState"].Success)return null;var n=null===(t=e.data)||void 0===t?void 0:t.renderInteractions;return Object(l["g"])(n)&&n.length>0?n:null},interactionVisible:function(){return this.artboardShowInteractionLine&&!!this.renderInteractions},errorText:function(){return this.imgErrored?"画板预览图加载失败":this.imgLoaded?null:"预览图加载中..."},outlineWidth:function(){if(this.inArtboardMultDownMode)return Math.ceil(3/this.scaleList)+"px"},selected:function(){return this.inArtboardMultDownMode&&this.item.mlUserSelectDown},goInfoTip2:function(){var t="",e=this.item.artboard;return this.inCloudMode&&(t="".concat(e.updaterName," 提交于 ").concat(e.updateTimeStr,",")),"".concat(t,"双击查看 ").concat(e.name," 标注详情")},goInfoTip:function(){var t="",e=this.item.artboard;return this.inCloudMode&&(t="".concat(e.updaterName," 提交于 ").concat(e.updateTimeStr,", ")),"".concat(t,"双击查看标注详情")},style:function(){var t=40,e=this.artboard.boundsInParentForList,n=this.maxRect,r=Math.floor(e.y-n.y-t),i=Math.floor(e.x-n.x),a=Math.ceil(e.width),o=Math.ceil(e.height+t);return"top:".concat(r,"px;left:").concat(i,"px;width:").concat(a,"px;height:").concat(o,"px;")},imgStyle:function(){var t=this.artboard.boundsInParentForList;return"height:".concat(t.height,"px;outline-width:").concat(this.outlineWidth)},artboardPreviewPng:function(){var t,e=this.inCloudMode,n=this.artboard;return e&&this.isSupportWebp&&(t=n.artboardPreviewWebp,t)?t:(t=n.artboardPreviewPng,e?t:"".concat(t,"?").concat(n.mlOutputTime))},isSupportWebp:function(){return this.$store.state.isSupportWebp===pe.Support},artboard:function(){return this.item.artboard}},data:function(){return{tipHandle:0,imgErrored:!1,imgLoaded:!1}},props:{item:Object,maxRect:Object}},gi=vi,wi=(n("f70e"),Object(qe["a"])(gi,li,ui,!1,null,"1ea1934c",null)),xi=wi.exports,yi={methods:{quickKey:function(t){if(!this.inArtboardMode){var e=t.keyCode||t.which;switch(e){case 112:case 113:case 114:var n=e-111;this.inArtboardMode||this.showTextTip("快捷键[F".concat(n,"]仅在画板详情面板可用,您当前处于画板列表面板,双击画板可进入详情")),t.preventDefault();break}}},onSceneResize:function(t,e,n){if(!this.initScale||n){var r=this.rect;if(r&&0!==t&&0!==e){this.initScale=!0;var i=r.width/t,a=r.height/e,o=Math.max(i,a);if(0!==o){o=.96/o;var s=this.scale;this.setScaleList(o),this.resetScaleSceneCenter(o,s)}}}},resetScaleSceneCenter:function(t,e){e!==this.scale&&this.$store.commit("resetScaleSceneCenter",{newScale:t,oldScale:e})}},created:function(){window.addEventListener("keydown",this.quickKey)},beforeDestroy:function(){window.removeEventListener("keydown",this.quickKey)},data:function(){return{initScale:!1}},computed:{rect:function(){var t=40,e=this.renderDocuments,n=[];e.forEach((function(t){n.push({artboard:{boundsInParent:t.rect}})}));var r=Object(c["getArtboardsMaxRect"])(n);return r.y-=t,r.height+=t,r},scale:function(){return this.scaleList},style:function(){var t=this.rect;if(t)return{transform:"scale(".concat(this.scale,") translate3d(0,0,0)")}},boxSize:function(){var t=this.rect;if(t)return{width:t.width+"px",height:t.height+"px"}}},components:{ArtboardListItem:xi},props:{sceneWidth:Number,sceneHeight:Number,dragging:Boolean}},Ci=yi,ki=(n("12ff"),Object(qe["a"])(Ci,si,ci,!1,null,"1416bbbb",null)),Si=ki.exports,_i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"canvas-box",attrs:{title:t.mouseenterArtboardTitle},on:{mousemove:t.onMouseMove,mouseleave:t.onMouseLeave,dblclick:t.dblClickCanvas,click:t.clickCanvas,contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)}}},[n("canvas",{ref:"canvas",style:t.canvasStyle,attrs:{width:t.sceneWidth*t.canvasScale,height:t.sceneHeight*t.canvasScale}}),t.mouseenterArtboardStyle?n("div",{staticClass:"artboard-hover",style:t.mouseenterArtboardStyle}):t._e()])},Ai=[],Ii={methods:{getInViewerInteractions:function(){var t=[];if(!this.artboardShowInteractionLine)return t;var e=this.sceneX,n=this.sceneY,r=this.scale,i=this.sceneWidth,a=this.sceneHeight,o=this.artboardInteractions,c=this.mouseenterArtboard;if(0===r||0===i||0===a)return t;var u=(new d["a"]).set(-e/r,-n/r,i/r,a/r);return Object.keys(o).forEach((function(e){var n=o[e];Object(l["g"])(n)&&0!==n.length&&n.forEach((function(e){var n,r=Object(s["a"])({},e.canvasData.drawRect);r.x+=e.art.rect.x,r.y+=e.art.rect.y,e.isEnter=null!=c&&(c===e.art||e.toArtboardItem===(null===(n=c.artboard)||void 0===n?void 0:n.artboard));var i=Object(d["f"])(r,u);i&&t.push(e)}))})),t.sort((function(t,e){return t.isEnter&&e.isEnter?0:t.isEnter?1:e.isEnter?-1:0})),t},attachImgs:function(t,e){var n=this;Object(l["g"])(t)&&(e?t.forEach((function(t){c["listImageLoader"].add(t.imgSrc,n.imgLoaded,t),c["listImageLoader"].add(t.miniImgSrc,n.miniImgLoaded,t)})):t.forEach((function(t){c["listImageLoader"].remove(t.imgSrc,n.imgLoaded,t),c["listImageLoader"].remove(t.miniImgSrc,n.miniImgLoaded,t),t.img=null,t.loaded=!1})))},getRenderInteractions:function(t){var e;if(!this.inCloudMode)return null;var n=t.interactionInfo;if(!n)return null;if(n.fetchState!==c["FetchState"].Success)return null;var r=null===(e=n.data)||void 0===e?void 0:e.renderInteractions;return Object(l["g"])(r)&&r.length>0?r:null},onContextmenu:function(t){var e=this,n=this.mouseenterArtboard;if(n){var r=t.pageX,i=t.pageY;requestAnimationFrame((function(){e.$store.commit("setArtboardMenu",{visible:!0,x:r,y:i,artboard:n.artboard})}))}},dblClickCanvas:function(){var t=this.mouseenterArtboard,e=this.inArtboardMultDownMode;!e&&t&&(clearTimeout(this.tipHandle),this.hideTextTip(),this.setCurArtboard(t.artboard))},clickCanvas:function(){var t=this,e=Math.abs(Date.now()-this.draggingTime);if(!(e<66)){clearTimeout(this.tipHandle);var n=this.mouseenterArtboard,r=this.inArtboardMultDownMode;if(n){if(r)return n.artboard.mlUserSelectDown=!n.artboard.mlUserSelectDown,void this.draw(n,!0);var i=n.artboard;this.tipHandle=setTimeout((function(){t.showTextTip(t.goInfoTip2(i),7)}),200)}}},goInfoTip2:function(t){var e="";return t=t.artboard,this.inCloudMode&&(e="".concat(t.updaterName," 提交于 ").concat(t.updateTimeStr,",")),"".concat(e,"双击查看 ").concat(t.name," 标注详情")},onMouseMove:function(t){var e=this.mouseLoc;e.x=t.layerX,e.y=t.layerY,null==e.x&&(e.x=t.pageX-this.sceneOffsetX,e.y=t.pageY-this.sceneOffsetY)},onMouseLeave:function(){var t=this.mouseLoc;t.x=t.y=-10},quickKey:function(t){var e=t.keyCode||t.which;switch(e){case 112:case 113:case 114:var n=e-111;this.inArtboardMode||this.showTextTip("快捷键[F".concat(n,"]仅在画板详情面板可用,您当前处于画板列表面板,双击画板可进入详情")),t.preventDefault();break}},drawAllDelay:function(){var t=this,e=Date.now();e-this.drawAllTime>=100?(this.drawAllTime=e,clearTimeout(this.handleDrawAllDelay),this.draw(null,!0)):(clearTimeout(this.handleDrawAllDelay),this.handleDrawAllDelay=setTimeout((function(){clearTimeout(t.handleDrawAllDelay),t.draw(null,!0)}),66.67))},draw:function(t,e){var n=this;if(t||e)requestAnimationFrame((function(){n._draw(t,e)}));else{var r=this.sceneInfo,i=this.sceneWidth,a=this.sceneHeight,o=this.inArtboardMultDownMode,s=r.sceneWidth!==i||r.sceneHeight!==a?1:0;if(s||o!=r.inArtboardMultDownMode)return clearTimeout(this.sceneDelayHandle),cancelAnimationFrame(this.handle),void(this.handle=requestAnimationFrame((function(){n._draw(t)})));clearTimeout(this.sceneDelayHandle),cancelAnimationFrame(this.handle),this.sceneDelayHandle=setTimeout((function(){cancelAnimationFrame(n.handle),n.handle=requestAnimationFrame((function(){n._draw(t)}))}),83)}},getRectArtboards:function(t){var e=this;l["a"]&&console.log("getRectArtboards",t);var n,r=[],i=null===t||void 0===t?void 0:t.rect;if(!i)return r;i=(new d["a"]).set(i.x,i.y,i.width,i.height),t.artboard.artboard.flowStart&&(n=this.getFlowStartIconRect(t),n=(new d["a"]).set(n.x,n.y,n.width,n.height));var a=this.inViewerArtboards;return a.forEach((function(t){var a=(new d["a"]).set(t.rect.x,t.rect.y,t.rect.width,t.rect.height);if(a.isOverlap(i))r.push(t);else if(n&&n.isOverlap(a))r.push(t);else if(t.artboard.artboard.flowRect){var o=e.getFlowStartIconRect(t);if(o=(new d["a"]).set(o.x,o.y,o.width,o.height),o.isOverlap(i))return void r.push(t);if(n&&n.isOverlap(o))return void r.push(t)}})),r},_draw:function(t,e){var n=this,r=this.sceneX,i=this.sceneY,a=this.scale,o=this.sceneWidth,s=this.sceneHeight,c=this.sceneInfo,u=this.inArtboardMultDownMode;if(c.sceneX=r,c.sceneY=i,c.scale=a,c.sceneWidth=o,c.sceneHeight=s,c.inArtboardMultDownMode=u,0!==a&&0!==o&&0!==s){var h=this.drawInfo,f=!t,m=!(h.scale===a&&h.sceneX===r&&h.sceneY===i&&h.sceneWidth===o&&h.sceneHeight===s&&h.inArtboardMultDownMode===u);if(!f||m||e){var p=this.$refs.canvas;if(p){l["a"]&&console.log("_draw",e),h.scale=a,h.sceneX=r,h.sceneY=i,h.sceneWidth=o,h.sceneHeight=s,h.inArtboardMultDownMode=u;var b,v=p.getContext("2d"),g=!1;f||m?(this.drawAllTime=Date.now(),v.clearRect(0,0,this.getCanvasDrawNum(o),this.getCanvasDrawNum(s)),b=this.inViewerArtboards,g=!0):b=this.getRectArtboards(t);var w=(new d["a"]).set(-r,-i,o,s),x=(new d["a"]).set(w.x/a,w.y/a,w.width/a,w.height/a),y=Math.max(2,Math.min(6,Math.ceil(3*this.scale)));!g&&b.forEach((function(t){n._cleanBackground(v,t,w,a)}));var C=this.artboardShowInteractionLine&&!u;if(b.forEach((function(t){n._drawArtboard(v,w,x,a,t,u,y)})),C){var k=this.getInViewerInteractions();k.forEach((function(t){var e=t.canvasData.drawRect,r=t.art.rect,i=(new d["a"]).set(r.x+e.x,r.y+e.y,e.width,e.height),o=Object(d["f"])(i,x);o&&n._drawInteraction(v,t.art,t,w,x,a)}))}}}}},_cleanBackground:function(t,e,n,r){var i=this._getScaleRect(e.rect.x,e.rect.y,e.rect.width,e.rect.height,n,r),a=Math.round(this.titleHeight*r);t.clearRect(this.getCanvasDrawNum(i.x),this.getCanvasDrawNum(i.y-a),this.getCanvasDrawNum(i.width),this.getCanvasDrawNum(i.height+a));var o=e.artboard.artboard.flowStart;o&&(i=this.getFlowStartIconRect(e),i=this._getScaleRect(i.x,i.y,i.width,i.height,n,r),t.clearRect(this.getCanvasDrawNum(i.x),this.getCanvasDrawNum(i.y),this.getCanvasDrawNum(i.width),this.getCanvasDrawNum(i.height)))},getFlowStartIconRect:function(t){var e=t.rect,n=e.x,r=e.y;n-=16;var i=16,a=26;return{x:n,y:r,width:i,height:a}},_drawArtboardBackground:function(t,e,n,r){var i=Math.round(this.titleHeight*r);t.fillStyle="#fff",t.fillRect(this.getCanvasDrawNum(e.x),this.getCanvasDrawNum(e.y),this.getCanvasDrawNum(e.width),this.getCanvasDrawNum(e.height)),t.fillStyle="#a6a9b4",t.textAlign="left",t.textBaseline="bottom",t.font="".concat(this.getCanvasDrawNum(Math.min(Math.max(2,14*r),24)),"px Arial"),n&&t.fillText(n,this.getCanvasDrawNum(e.x),this.getCanvasDrawNum(Math.round(e.y-Math.min(i/2,8*r))),this.getCanvasDrawNum(e.width))},_drawArtboardText:function(t,e,n){t.textAlign="center",t.font="".concat(this.getCanvasDrawNum(Math.min(Math.max(6,Math.min(n.width,n.height)/15),36)),"px Arial"),t.fillText(e,this.getCanvasDrawNum(Math.floor(n.x+n.width/2)),this.getCanvasDrawNum(Math.ceil(n.y+n.height/2)),this.getCanvasDrawNum(n.width))},_getScaleRect:function(t,e,n,r,i,a){var o={x:t,y:e,width:n,height:r};return o.x=o.x*a-i.x,o.y=o.y*a-i.y,o.width=o.width*a,o.height=o.height*a,o},_drawInteraction:function(t,e,n,r,i,a){var o=e.rect,c="#1886ff",l="#cdcdda",u="rgba(24, 134, 255, 0.05)",h=n.canvasData,f=n.isEnter;t.lineWidth=1,t.lineWidth=.5;var m=Object(s["a"])({},h.nodeRect);m.x+=o.x,m.y+=o.y,Object(d["f"])(m,i)&&(t.setLineDash([5,2]),t.lineDashOffset=2,m=this._getScaleRect(m.x,m.y,m.width,m.height,r,a),f&&(t.fillStyle=u,t.fillRect(this.getCanvasDrawNum(m.x),this.getCanvasDrawNum(m.y),this.getCanvasDrawNum(m.width),this.getCanvasDrawNum(m.height))),t.fillStyle=t.strokeStyle=f?c:l,t.strokeRect(this.getCanvasDrawNum(m.x),this.getCanvasDrawNum(m.y),this.getCanvasDrawNum(m.width),this.getCanvasDrawNum(m.height))),t.strokeStyle=f?c:l,t.lineWidth=Math.max(Math.min(2*a,2),.5),t.setLineDash([]),t.lineDashOffset=0;var p=h.curve;m=(new d["a"]).set(p.start.x+o.x,p.start.y+o.y,1,1),t.beginPath(),m=this._getScaleRect(m.x,m.y,m.width,m.height,r,a),t.moveTo(this.getCanvasDrawNum(m.x),this.getCanvasDrawNum(m.y));var b=this._getScaleRect(p.p1.x+o.x,p.p1.y+o.y,1,1,r,a),v=this._getScaleRect(p.p2.x+o.x,p.p2.y+o.y,1,1,r,a),g=this._getScaleRect(p.end.x+o.x,p.end.y+o.y,1,1,r,a);t.bezierCurveTo(this.getCanvasDrawNum(b.x),this.getCanvasDrawNum(b.y),this.getCanvasDrawNum(v.x),this.getCanvasDrawNum(v.y),this.getCanvasDrawNum(g.x),this.getCanvasDrawNum(g.y)),t.stroke();var w=h.arrowIcon;m=(new d["a"]).set(w.x+o.x,w.y+o.y,w.width,w.height);var x=f?w.img:w.img_default;Object(d["f"])(m,i)&&x&&(m=this._getScaleRect(m.x,m.y,m.width,m.height,r,a),t.drawImage(x,0,0,w.width,w.height,this.getCanvasDrawNum(m.x),this.getCanvasDrawNum(m.y),this.getCanvasDrawNum(m.width),this.getCanvasDrawNum(m.height)))},_drawArtboard:function(t,e,n,r,i,a,o){var s=Object(d["f"])(i.rect,n);if(s){var c=this._getScaleRect(i.rect.x,i.rect.y,i.rect.width,i.rect.height,e,r);this._drawArtboardBackground(t,c,i.artboard.artboard.name,r);var l=i.miniImgSize,u=i.miniImg,h=i.img,f=this.isDrawMiniImg(i);if(f)t.drawImage(u,0,0,l.width,l.height,this.getCanvasDrawNum(c.x),this.getCanvasDrawNum(c.y),this.getCanvasDrawNum(c.width),this.getCanvasDrawNum(c.height));else if(i.loaded)if(h){var m=i.imgSize;t.drawImage(h,0,0,m.width,m.height,this.getCanvasDrawNum(c.x),this.getCanvasDrawNum(c.y),this.getCanvasDrawNum(c.width),this.getCanvasDrawNum(c.height))}else this._drawArtboardText(t,"预览图加载失败",c);else this._drawArtboardText(t,"画板预览图加载中...",c);var p=i.artboard.artboard.flowStart;if(p){var b=Dt.imgs.flowStartIcon,v=Dt.sizes.flowStartIcon;b&&(c=this.getFlowStartIconRect(i),c=this._getScaleRect(c.x,c.y,c.width,c.height,e,r),t.drawImage(b,0,0,v.width,v.height,this.getCanvasDrawNum(c.x),this.getCanvasDrawNum(c.y),this.getCanvasDrawNum(c.width),this.getCanvasDrawNum(c.height)))}if(a&&i.artboard.mlUserSelectDown){var g=Math.round(o/2);t.strokeStyle="#1886ff",t.setLineDash([]),t.lineDashOffset=2,t.lineWidth=this.getCanvasDrawNum(o),t.strokeRect(this.getCanvasDrawNum(c.x+g),this.getCanvasDrawNum(c.y+g),this.getCanvasDrawNum(c.width-o),this.getCanvasDrawNum(c.height-o))}}},getCanvasDrawNum:function(t){return Math.round(t*this.canvasScale)},isDrawMiniImg:function(t){return t.miniLoaded&&t.loaded&&t.miniImg&&t.img&&2*t.miniImgSize.width/3>this.scale*t.rect.width},imgLoaded:function(t,e){if(e.loaded=!0,e.img=t,t){var n=e.imgSize;n.width=t.width,n.height=t.height;var r=this.isDrawMiniImg(e);if(r&&!e.miniLoaded)return}this.drawAllDelay(e)},miniImgLoaded:function(t,e){if(e.miniLoaded=!0,e.miniImg=t,t){var n=e.miniImgSize;n.width=t.width,n.height=t.height;var r=this.isDrawMiniImg(e);if(!r&&e.loaded&&e.img)return}this.drawAllDelay(e)},onSceneResize:function(t,e,n){if(!this.initScale||n){var r=this.rect;if(r&&0!==t&&0!==e){this.initScale=!0;var i=r.width/t,a=r.height/e,o=Math.max(i,a);if(0!==o){o=.96/o;var s=this.scale;this.setScaleList(o),this.resetScaleSceneCenter(o,s)}}}},resetScaleSceneCenter:function(t,e){e!==this.scale&&this.$store.commit("resetScaleSceneCenter",{newScale:t,oldScale:e})}},computed:{artboardInteractions:function(){var t=this;l["a"]&&console.log("artboardInteractions");var e={},n=this.artboards,r=this.renderDocuments;return n.forEach((function(n){var i=n.artboard.artboard,a=i.boundsInParentForList,o=i.pageGuid||i.docGuid,s=t.getRenderInteractions(i),c=[];s&&s.forEach((function(t){var e,i=Tt(r,t,a,o,!0);i&&c.push({art:n,canvasData:i,key:t.guid,toArtboardItem:null===(e=t.renderTapInteraction)||void 0===e?void 0:e.toArtboardItem,isEnter:!1})})),c.length>0&&(e[i.cid]=c)})),e},selectNodeCount:function(){var t=0;return this.renderDocumentArtboards.forEach((function(e){e.mlUserSelectDown&&(t+=1)})),t},mouseenterArtboardTitle:function(){var t=this.mouseenterArtboard;if(t){var e="",n=t.artboard.artboard;return this.inCloudMode&&(e="".concat(n.updaterName," 提交于 ").concat(n.updateTimeStr,", ")),"".concat(e,"双击查看标注详情")}},mouseenterArtboardStyle:function(){var t=this.canvasStyle;if(t)return null;var e=this.mouseenterArtboard;if(!e)return null;var n=this.sceneX,r=this.sceneY,i=this.scale,a=e.rect,o={};o.left=Math.floor(a.x*i+n)+"px",o.top=Math.floor(a.y*i+r)+"px",o.width=Math.ceil(a.width*i)+"px",o.height=Math.ceil(a.height*i)+"px";var s=Math.min(20,Math.max(5,Math.round(20*i)));return o.boxShadow="0 0 ".concat(s,"px #3d7eaf99"),o},canvasStyle:function(){var t=this.sceneInfo;if(0!==t.scale){var e=this.sceneX,n=this.sceneY,r=this.scale,i=this.sceneWidth,a=this.sceneHeight,o=Math.round(e-t.sceneX),s=Math.round(n-t.sceneY),c=r/t.scale;if(0!==o||0!==s||1!==c||t.sceneWidth!==i||t.sceneHeight!==a){var l={transform:""};return 1!==c?(o=t.sceneX/t.scale*r-e,s=t.sceneY/t.scale*r-n,o=-Math.round(o),s=-Math.round(s),l.transform+="translate3d(".concat(o,"px, ").concat(s,"px, 0px) scale(").concat(c.toFixed(5),")")):0===o&&0===s||(l.transform+=" translate3d(".concat(o,"px, ").concat(s,"px, 0px)")),l}}},rect:function(){var t=this.titleHeight,e=this.renderDocuments,n=[];e.forEach((function(t){n.push({artboard:{boundsInParent:t.rect}})}));var r=Object(c["getArtboardsMaxRect"])(n);return r.y-=t,r.height+=t,r},isSupportWebp:function(){return this.$store.state.isSupportWebp===pe.Support},artboardShowInteractionLine:function(){return this.$store.state.artboardShowInteractionLine},mouseenterArtboard:function(){if(this.dragging)return null;var t=this.mouseLoc,e=this.scale,n=this.sceneX,r=this.sceneY,i=this.inViewerArtboards,a=i.length;if(0===a)return null;for(var o=(new d["a"]).set((t.x-n)/e,(t.y-r)/e,1,1),s=a-1;s>=0;s--){var c=i[s];if(Object(d["f"])(c.rect,o))return c}return null},inViewerArtboards:function(){var t=[],e=this.sceneX,n=this.sceneY,r=this.scale,i=this.sceneWidth,a=this.sceneHeight,o=this.artboards;if(0===r||0===i||0===a)return t;var s=(new d["a"]).set(-e/r,-n/r,i/r,a/r);return o.forEach((function(e){var n=Object(d["f"])(e.rect,s);n&&t.push(e)})),t},artboards:function(){var t=[],e=this.renderDocuments;if(!Object(l["g"])(e))return t;var n=this.isSupportWebp;return e.forEach((function(e){var r=e.maxRect.x-e.rect.x,i=e.maxRect.y-e.rect.y,a=e.arts;Object(l["g"])(a)&&a.forEach((function(e){var a=e.artboard;if(a){var o,s=a.boundsInParentForList;n&&(o=a.pathPreviewWebp),o||(o=a.pathPreview);var c=a.pathPreviewMini,l={rect:{x:Math.floor(s.x-r),y:Math.floor(s.y-i),width:Math.ceil(s.width),height:Math.ceil(s.height)},imgSrc:o,imgSize:{width:0,height:0},img:null,miniImgSrc:c,miniImgSize:{width:0,height:0},miniImg:null,miniLoaded:!1,loaded:!1,artboard:e};t.push(l)}}))})),t},selectArtboardChanged:function(){return this.$store.state.selectArtboardChanged}},watch:{mouseenterArtboard:function(t,e){if(!this.dragging&&this.artboardShowInteractionLine){var n=null===t||void 0===t?void 0:t.artboard.artboard.cid,r=null===e||void 0===e?void 0:e.artboard.artboard.cid;n!==r&&this.draw(null,!0)}},artboardShowInteractionLine:function(){this.draw(null,!0)},artboardInteractions:function(){this.artboardShowInteractionLine&&this.drawAllDelay()},selectArtboardChanged:function(t){var e=this;if(t&&0!==t.length)if(t.length>10)this.draw(null,!0);else{var n=this.inViewerArtboards;n.forEach((function(n){var r=n.artboard.artboard.guid;t[r]&&e.draw(n)}))}},dragging:function(){this.draggingTime=Date.now()},artboards:function(t,e){this.attachImgs(e,!1),this.attachImgs(t,!0)},scale:function(){this.draw()},sceneX:function(){this.draw()},sceneY:function(){this.draw()},sceneWidth:function(){this.draw()},sceneHeight:function(){this.draw()},inArtboardMultDownMode:function(){this.draw()}},data:function(){return{handleDrawAllDelay:0,drawAllTime:0,canvasScale:Object(c["getPixelRatio"])(),mouseLoc:{x:-10,y:-10},drawInfo:{sceneX:0,sceneY:0,scale:0,sceneWidth:0,sceneHeight:0},sceneInfo:{sceneX:0,sceneY:0,scale:0,sceneWidth:0,sceneHeight:0,id:0},sceneDelayHandle:-1,titleHeight:40,initScale:!1,handle:0,context:null,useOffscreen:!1,worker:null,workerInited:!1,tipHandle:0,draggingTime:0}},beforeDestroy:function(){l["a"]&&console.log("cloudmode.list.canvas.beforeDestroy"),clearTimeout(this.tipHandle),window.removeEventListener("keydown",this.quickKey),this.attachImgs(this.artboards,!1)},created:function(){l["a"]&&console.log("cloudmode.list.canvas.created"),l["a"]&&(window.vueArtboardListCanvasModeInstance=this),window.addEventListener("keydown",this.quickKey),this.attachImgs(this.artboards,!0)},props:{scale:Number,sceneX:Number,sceneY:Number,sceneWidth:Number,sceneHeight:Number,dragging:Boolean,sceneScaleKeepX:Number,sceneScaleKeepY:Number,sceneOffsetX:Number,sceneOffsetY:Number}},Ti=Ii,Oi=(n("3da5"),Object(qe["a"])(Ti,_i,Ai,!1,null,"a30a071a",null)),Ei=Oi.exports,Mi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"canvas-box"},[n("canvas",{ref:"canvas",style:t.canvasStyle,attrs:{width:t.sceneWidth*t.canvasScale,height:t.sceneHeight*t.canvasScale}})])},Li=[],Ni={methods:{draw:function(t,e){var n=this;if(t||e)requestAnimationFrame((function(){n._draw(t,e)}));else{var r=this.sceneInfo,i=this.sceneWidth,a=this.sceneHeight,o=r.sceneWidth!==i||r.sceneHeight!==a?1:0;if(o)return clearTimeout(this.sceneDelayHandle),cancelAnimationFrame(this.handle),void(this.handle=requestAnimationFrame((function(){n._draw(t)})));clearTimeout(this.sceneDelayHandle),this.sceneDelayHandle=setTimeout((function(){cancelAnimationFrame(n.handle),n.handle=requestAnimationFrame((function(){n._draw(t)}))}),83)}},_draw:function(t,e){var n=this,r=this.sceneX,i=this.sceneY,a=this.scale,o=this.sceneWidth,s=this.sceneHeight,c=this.sceneInfo;if(c.sceneX=r,c.sceneY=i,c.scale=a,c.sceneWidth=o,c.sceneHeight=s,0!==a&&0!==o&&0!==s){var l=this.drawInfo,u=!t,h=!(l.scale===a&&l.sceneX===r&&l.sceneY===i&&l.sceneWidth===o&&l.sceneHeight===s);if(!u||h||e){var f=this.$refs.canvas;if(f){l.scale=a,l.sceneX=r,l.sceneY=i,l.sceneWidth=o,l.sceneHeight=s;var m,p=f.getContext("2d"),b=!1;u||h?(p.clearRect(0,0,this.getCanvasDrawNum(o),this.getCanvasDrawNum(s)),m=this.inViewerArtboards,b=!0):m=[t];var v=(new d["a"]).set(-r,-i,o,s),g=(new d["a"]).set(v.x/a,v.y/a,v.width/a,v.height/a),w=Math.max(2,Math.min(6,Math.ceil(3*this.scale)));p.strokeStyle="#1886ff",p.lineWidth=this.getCanvasDrawNum(w),m.forEach((function(t){n._drawArtboard(p,v,g,a,t,b,w)}))}}}},_drawArtboardBackground:function(t,e,n,r,i){var a,o=r.name,s=Math.round(this.titleHeight*i);if(n||t.clearRect(this.getCanvasDrawNum(e.x),this.getCanvasDrawNum(e.y-s),this.getCanvasDrawNum(e.width),this.getCanvasDrawNum(e.height+s)),r.fill&&r.fillEnabled){var c=r.fill.value;c&&(a=Object(h["g"])(c).value)}a||(a="#fff"),t.fillStyle=a,t.fillRect(this.getCanvasDrawNum(e.x),this.getCanvasDrawNum(e.y),this.getCanvasDrawNum(e.width),this.getCanvasDrawNum(e.height)),t.fillStyle="#a6a9b4",t.textAlign="left",t.textBaseline="bottom",t.font="".concat(this.getCanvasDrawNum(Math.min(Math.max(2,14*i),24)),"px Arial"),o&&t.fillText(o,this.getCanvasDrawNum(e.x),this.getCanvasDrawNum(Math.round(e.y-Math.min(s/2,8*i))),this.getCanvasDrawNum(e.width))},_drawArtboardText:function(t,e,n){t.textAlign="center",t.font="".concat(this.getCanvasDrawNum(Math.min(Math.max(6,Math.min(n.width,n.height)/15),36)),"px Arial"),t.fillText(e,this.getCanvasDrawNum(Math.floor(n.x+n.width/2)),this.getCanvasDrawNum(Math.ceil(n.y+n.height/2)),this.getCanvasDrawNum(n.width))},_drawArtboard:function(t,e,n,r,i,a){var o=Object(d["f"])(i.rect,n);if(o){var s=Object.assign({},i.rect);s.x=Math.round(s.x*r-e.x),s.y=Math.round(s.y*r-e.y),s.width=Math.round(s.width*r),s.height=Math.round(s.height*r),this._drawArtboardBackground(t,s,a,i.artboard.artboard,r);var c=i.miniImgSize,l=i.miniImg,u=i.img,h=this.isDrawMiniImg(i);if(h)t.drawImage(l,0,0,c.width,c.height,this.getCanvasDrawNum(s.x),this.getCanvasDrawNum(s.y),this.getCanvasDrawNum(s.width),this.getCanvasDrawNum(s.height));else if(i.loaded)if(u){var f=i.imgSize;t.drawImage(u,0,0,f.width,f.height,this.getCanvasDrawNum(s.x),this.getCanvasDrawNum(s.y),this.getCanvasDrawNum(s.width),this.getCanvasDrawNum(s.height))}else this._drawArtboardText(t,"预览图加载失败",s);else this._drawArtboardText(t,"画板预览图加载中...",s)}},getCanvasDrawNum:function(t){return Math.round(t*this.canvasScale)},isDrawMiniImg:function(t){return t.miniLoaded&&t.loaded&&t.miniImg&&t.img&&2*t.miniImgSize.width/3>this.scale*t.rect.width},imgLoaded:function(t,e){if(e.loaded=!0,e.img=t,t){var n=e.imgSize;n.width=t.width,n.height=t.height;var r=this.isDrawMiniImg(e);if(r&&!e.miniLoaded)return}this.draw(e)},miniImgLoaded:function(t,e){if(e.miniLoaded=!0,e.miniImg=t,t){var n=e.miniImgSize;n.width=t.width,n.height=t.height;var r=this.isDrawMiniImg(e);if(!r&&e.loaded&&e.img)return}this.draw(e)},attachImgs:function(t,e){var n=this;Object(l["g"])(t)&&(e?t.forEach((function(t){c["listImageLoader"].add(t.imgSrc,n.imgLoaded,t),c["listImageLoader"].add(t.miniImgSrc,n.miniImgLoaded,t)})):t.forEach((function(t){c["listImageLoader"].remove(t.imgSrc,n.imgLoaded,t),c["listImageLoader"].remove(t.miniImgSrc,n.miniImgLoaded,t),t.img=null,t.loaded=!1})))}},computed:{artboard:function(){return this.curArtboard.artboard},canvasStyle:function(){var t=this.sceneInfo;if(0!==t.scale){var e=this.sceneX,n=this.sceneY,r=this.scale,i=this.sceneWidth,a=this.sceneHeight,o=Math.round(e-t.sceneX),s=Math.round(n-t.sceneY),c=r/t.scale;if(0!==o||0!==s||1!==c||t.sceneWidth!==i||t.sceneHeight!==a){var l={transform:""};return 1!==c?(o=t.sceneX/t.scale*r-e,s=t.sceneY/t.scale*r-n,o=-Math.round(o),s=-Math.round(s),l.transform+="translate3d(".concat(o,"px, ").concat(s,"px, 0px) scale(").concat(c.toFixed(5),")")):0===o&&0===s||(l.transform+=" translate3d(".concat(o,"px, ").concat(s,"px, 0px)")),l}}},rect:function(){var t=this.titleHeight,e=this.artboard,n=e.boundsInArtboard;return(new d["a"]).set(0,0-t,n.width,n.height+t)},isSupportWebp:function(){return this.$store.state.isSupportWebp===pe.Support},inViewerArtboards:function(){var t=[],e=this.sceneX,n=this.sceneY,r=this.scale,i=this.sceneWidth,a=this.sceneHeight,o=this.artboards;if(0===r||0===i||0===a)return t;var s=(new d["a"]).set(-e/r,-n/r,i/r,a/r);return o.forEach((function(e){var n=Object(d["f"])(e.rect,s);n&&t.push(e)})),t},artboards:function(){var t=[],e=this.isSupportWebp,n=this.curArtboard;return n?(function(n){var r=n.artboard;if(r){var i=r.boundsInArtboard;if(i){var a;e&&(a=r.pathPreviewWebp),a||(a=r.pathPreview);var o=r.pathPreviewMini,s={rect:{x:0,y:0,width:Math.ceil(i.width),height:Math.ceil(i.height)},imgSrc:a,imgSize:{width:0,height:0},img:null,miniImgSrc:o,miniImgSize:{width:0,height:0},miniImg:null,miniLoaded:!1,loaded:!1,artboard:n};t.push(s)}}}(n),t):t}},watch:{dragging:function(){this.draggingTime=Date.now()},artboards:function(t,e){this.attachImgs(e,!1),this.attachImgs(t,!0)},scale:function(){this.draw()},sceneX:function(){this.draw()},sceneY:function(){this.draw()},sceneWidth:function(){this.draw()},sceneHeight:function(){this.draw()}},data:function(){return{canvasScale:Object(c["getPixelRatio"])(),mouseLoc:{x:-10,y:-10},drawInfo:{sceneX:0,sceneY:0,scale:0,sceneWidth:0,sceneHeight:0},sceneInfo:{sceneX:0,sceneY:0,scale:0,sceneWidth:0,sceneHeight:0,id:0},sceneDelayHandle:-1,titleHeight:40,initScale:!1,handle:0,draggingTime:0}},beforeDestroy:function(){this.attachImgs(this.artboards,!1),l["a"]&&console.log("cloudmode.info.canvas.beforeDestroy")},created:function(){l["a"]&&(console.log("cloudmode.info.canvas.created"),window.vue_canvasModeInfoInstance=this),this.attachImgs(this.artboards,!0)},props:{scale:Number,sceneX:Number,sceneY:Number,sceneWidth:Number,sceneHeight:Number,dragging:Boolean,sceneScaleKeepX:Number,sceneScaleKeepY:Number,sceneOffsetX:Number,sceneOffsetY:Number}},Di=Ni,Fi=(n("e138"),Object(qe["a"])(Di,Mi,Li,!1,null,"6dff7126",null)),Pi=Fi.exports,ji={passive:!1},Ri={passive:!1,capture:!0},Bi={x:0,y:0,sceneX:0,sceneY:0},Vi={components:{ArtboardInfo:oi,ArtboardList:Si,CanvasModeArtboardList:Ei,CanvasModeArtboardInfo:Pi,ViewerBox:zn,DrawView:Rn,CommentPoints:Er},created:function(){var t=this;l["a"]&&(window.vue_ZoomContainer=this),window.addEventListener("mousewheel",this.mouseWheel,ji),window.addEventListener("DOMMouseScroll",this.mouseWheel,ji),window.addEventListener("resize",this.resize,ji),this.$nextTick((function(){(t.type===o["m"].ArtboardDetail||t.allArtboardLoadChecked)&&(t.resize(),t.resetSceneLocation())}))},beforeDestroy:function(){var t=document.documentElement;t.removeEventListener("mousemove",this.mouseMove,Ri),t.removeEventListener("mouseup",this.mouseUp,Ri),window.removeEventListener("mousewheel",this.mouseWheel,ji),window.removeEventListener("DOMMouseScroll",this.mouseWheel,ji),window.removeEventListener("resize",this.resize,ji)},watch:{"imageViewer.resetScale":function(){l["a"]&&console.log("this.inImageViewerMode",this.inImageViewerMode),this.inImageViewerMode&&this.resetSceneLocation()},scale:function(){this.changeInfoCanvasOffset()},sceneWidth:function(){this.changeInfoCanvasOffset()},sceneHeight:function(){this.changeInfoCanvasOffset()},artboardInComment:function(){var t=this;this.$nextTick((function(){t.resize()}))},resetScaleSceneCenter:function(t){var e,n;t&&(e=Math.round(this.sceneOffsetX+this.sceneWidth/2),n=Math.round(this.sceneOffsetY+this.sceneHeight/2),this.resetScaleScene(e,n,t.oldScale,t.newScale))},curArtboard:function(t){null==t?this.type===o["m"].ArtboardList&&this.resetSceneLocation():this.type===o["m"].ArtboardDetail&&this.resetSceneLocation()},resetList:function(){this.type===o["m"].ArtboardList&&this.resetSceneLocation()},resetArtboard:function(){this.type===o["m"].ArtboardDetail&&this.resetSceneLocation()},filterDocumentGuid:function(){this.type===o["m"].ArtboardList&&this.resetSceneLocation()},allArtboardLoadChecked:function(t){this.type===o["m"].ArtboardList&&t&&this.resize()}},computed:{imageViewer:function(){return this.$store.state.imageViewer},inImageViewerMode:function(){return this.type===o["m"].ImageViewer},EnumScaleType:function(){return o["m"]},artboardListUseCanvas:function(){return this.$store.state.artboardListUseCanvas},resetScaleSceneCenter:function(){return this.$store.state.resetScaleSceneCenter},cloudArtListMode:function(){return this.type===o["m"].ArtboardList&&this.useCanvasMode},cloudArtInfoMode:function(){return this.inArtboardInfoMode&&this.useCanvasMode},useCanvasMode:function(){return this.inCloudMode&&this.artboardListUseCanvas},zoomBoxOffset:function(){return this.cloudArtListMode?null:{transform:"translate3d(".concat(this.sceneX,"px,").concat(this.sceneY,"px,1px)")}},allArtboardLoadChecked:function(){return this.$store.state.allArtboardLoadChecked},scale:function(){switch(this.type){case o["m"].ArtboardList:return this.scaleList;case o["m"].ArtboardDetail:return this.scaleArtboard;case o["m"].ImageViewer:return this.scaleImageViewer;default:return 0}},resetList:function(){return this.$store.state.scale.resetList},resetArtboard:function(){return this.$store.state.scale.resetArtboard},inArtboardInfoMode:function(){return this.type===o["m"].ArtboardDetail}},data:function(){return{infoCanvasOffset:{x:0,y:0},sceneX:0,sceneY:0,sceneWidth:0,sceneHeight:0,sceneOffsetX:0,sceneOffsetY:0,dragging:!1,sceneScaleKeepX:0,sceneScaleKeepY:0,draggedNotclick:!1}},props:{type:Number},methods:{changeInfoCanvasOffset:function(){var t=this.cloudArtInfoMode,e=this.infoCanvasOffset;if(t){var n=this.getInfoCanvasOffset();e.x=n.x,e.y=n.y}},getInfoCanvasOffset:function(){var t=this.scale,e=this.childRect(),n={};return e?(n.x=-(e.width/2+e.x/2)*t+this.sceneWidth/2,n.y=-(e.height/2+e.y/2)*t+this.sceneHeight/2):n.x=n.y=0,n},setConfig:function(t){if(Object(l["o"])(t)){var e=t.scale,n=t.sceneX,r=t.sceneY;"number"===typeof e&&this.setScale(e),"number"===typeof n&&(this.sceneX=n),"number"===typeof r&&(this.sceneY=r)}},resetSceneLocation:function(){if(this.resize(!0),this.sceneX=this.sceneY=0,this.cloudArtListMode){var t=this.getInfoCanvasOffset();this.sceneX=t.x,this.sceneY=t.y}else this.cloudArtInfoMode&&this.changeInfoCanvasOffset()},mouseMove:function(t){t.preventDefault();var e=t.clientX-Bi.x,n=t.clientY-Bi.y;this.sceneX=Math.round(Bi.sceneX+e),this.sceneY=Math.round(Bi.sceneY+n),!this.dragging&&(Math.abs(e)>=2||Math.abs(n)>=2)&&(this.dragging=!0,this.draggedNotclick=!0)},mouseUp:function(t){t.preventDefault(),this.dragging=!1;var e=document.documentElement;e.removeEventListener("mousemove",this.mouseMove,Ri),e.removeEventListener("mouseup",this.mouseUp,Ri)},mousedownZoomContainer:function(t){if(0===t.button){this.draggedNotclick=!1,this.dragging=!1,Bi.x=t.clientX,Bi.y=t.clientY,Bi.sceneX=this.sceneX,Bi.sceneY=this.sceneY;var e=document.documentElement;e.addEventListener("mousemove",this.mouseMove,Ri),e.addEventListener("mouseup",this.mouseUp,Ri)}},setScale:function(t){switch(t>.92&&t<1.08&&(t=1),this.type){case o["m"].ArtboardList:this.setScaleList(t);break;case o["m"].ArtboardDetail:this.setScaleArtboard(t);break;case o["m"].ImageViewer:this.setScaleImageViewer(t);break}},clickZoomContainer:function(t){var e=this.$refs.$instance;if(e)if(this.draggedNotclick)this.draggedNotclick=!1;else{var n=e.clickZoomContainer;n&&n(t)}},inBox:function(t){var e=this.$refs.$info;if(!e)return!0;while(null!=t){if(t===e)return!0;t=t.parentNode}return!1},canEmitEvent:function(t,e){var n=t.target;e.target=n;var r=this.$refs.$instance;if(!r)return!1;var i=r.canEmitEvent;return!(i&&!i(e))&&(!!e.isScale||this.inBox(n))},childRect:function(){var t=this.$refs.$instance;if(t){var e=t.rect;return e?e.toJSON():null}},canEmitWindowEvent:function(){switch(this.type){case o["m"].ArtboardList:if(this.inArtboardMode)return!1;break;case o["m"].ArtboardDetail:if(!this.inArtboardMode)return!1;break;case o["m"].ImageViewer:return!0}return!0},resize:function(t){if(this.canEmitWindowEvent()){var e=!0===t,n=this.$refs.$info.getBoundingClientRect();this.sceneWidth=n.width,this.sceneHeight=n.height,this.sceneOffsetX=n.left,this.sceneOffsetY=n.top;var r=this.$refs.$instance;if(r){var i=r.onSceneResize;i&&i(this.sceneWidth,this.sceneHeight,e)}}},getBoxLocation:function(t,e,n,r){var i=0,a=0,o=r.width,s=r.height,c=(new d["a"]).set(this.sceneOffsetX+this.sceneX,this.sceneOffsetY+this.sceneY,this.sceneWidth,this.sceneHeight);if(this.cloudArtListMode)return t-=this.sceneOffsetX,e-=this.sceneOffsetY,i=this.sceneX,a=this.sceneY,t-=i,e-=a,o*=n,s*=n,{x:t/o,y:e/s};o*=n,s*=n,i=c.x,a=c.y,i+=c.width/2,a+=c.height/2,i-=o/2,a-=s/2;var l=(new d["a"]).set(i,a,o,s);return 0!==l.width&&0!==l.height?(t-=l.x,e-=l.y,t/=l.width,e/=l.height,{x:t,y:e}):void 0},resetScaleScene:function(t,e,n,r){var i=this.$refs.$instance;if(i){var a=this.childRect(),o=this.getBoxLocation(t,e,n,a);if(o){var s=this.getBoxLocation(t,e,r,a);if(s){this.sceneScaleKeepX=t-this.sceneOffsetX,this.sceneScaleKeepY=e-this.sceneOffsetY;var c=s.x-o.x,l=s.y-o.y,u=c*a.width*r,d=l*a.height*r;this.sceneX+=Math.round(u),this.sceneY+=Math.round(d)}}}},mouseWheel:function(t){if(this.canEmitWindowEvent()){var e=t.ctrlKey||t.metaKey,n=t.shiftKey;if(this.inBox(t.target))if(this.canEmitEvent(t,{isScale:e,isMove:!e})){t.preventDefault();var r=t.wheelDelta||-t.detail,i=r>0?1:-1,a=t.altKey?5:1;if(e){var o,s=this.scale;o=s<.1?.01:s<=.2?.03:s<=.3?.05:.11;var c=s+i*o*a,l=c-s;if(0===l)return;this.setScale(c),this.resetScaleScene(t.pageX,t.pageY,s,this.scale)}else{var u=t.wheelDeltaX;if("number"===typeof u&&0!==u){var d=t.wheelDeltaY,h=u>0?1:0===u?0:-1,f=d>0?1:0===d?0:-1;0!==h&&(this.sceneX+=Math.round(10*h*a)),0!==f&&(this.sceneY+=Math.round(10*f*a))}else this[n?"sceneX":"sceneY"]+=Math.round(50*i*a)}}else e&&t.preventDefault();else e&&t.preventDefault()}}}},Ui=Vi,$i=(n("a54d"),Object(qe["a"])(Ui,vn,gn,!1,null,"76e5acb6",null)),Hi=$i.exports,zi={components:{ZoomContainer:Hi,ScaleControl:bn},methods:{clickHide:function(){this.canClose&&this.$store.commit("setImageViewer",null)},clickPrev:function(){var t=this.currentIndex-1;t<0&&(t=0),this.imageViewer.currentIndex=t,this.imageViewer.resetScale=Date.now()},clickNext:function(){var t=this.currentIndex+1,e=this.imgList.length-1;t>=e&&(t=e),this.imageViewer.currentIndex=t,this.imageViewer.resetScale=Date.now()},onKeyup:function(t){var e=t.keyCode||t.which;27===e&&this.clickHide()}},computed:{EnumScaleType:function(){return o["m"]},visible:function(){return this.imageViewer.visible&&Object(l["g"])(this.imgList)},imgList:function(){return this.imageViewer.imgList},currentIndex:function(){return this.imageViewer.currentIndex},imageViewer:function(){return this.$store.state.imageViewer}},props:{canClose:{type:Boolean,default:!0}},beforeDestroy:function(){window.removeEventListener("keyup",this.onKeyup,!0)},created:function(){l["a"]&&(window.vueImageviewer=this),window.addEventListener("keyup",this.onKeyup,!0)}},Wi=zi,Gi=(n("34aa"),Object(qe["a"])(Wi,ln,un,!1,null,"d15fbda8",null)),Yi=Gi.exports,Xi={components:{ImageViewer:Yi},methods:{initImage:function(){this.$store.commit("setImageViewer",{imgList:[this.fileViewUrl],currentIndex:0})}},computed:{},created:function(){console.log(this.fileViewUrl),this.initImage()}},Ki=Xi,Zi=(n("fc3e"),Object(qe["a"])(Ki,sn,cn,!1,null,"3afd8555",null)),qi=Zi.exports,Qi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"netdiskfile-lottie"},[t.lottieError||t.lottieIniting?n("div",{staticClass:"error"},[n("NetworkLoading",{attrs:{loadText:"正在加载lottie文件...",errorText:"lottie文件加载失败,请刷新重试",isLoading:t.lottieIniting,isError:t.lottieError,reLoadText:"刷新"},on:{reload:function(e){return t.clickReload()}}})],1):t._e(),n("div",{ref:"lottiebox",staticClass:"lottie-box",class:{off:t.lottieError||t.lottieIniting},style:t.lottieBoxStyle})])},Ji=[],ta=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isLoading?n("div",{staticClass:"n-loading",class:{"in-mobile":t.inMobile}},[n("div",{staticClass:"text"},[t._v(t._s(t.loadText))])]):t.isError?n("div",{staticClass:"n-error",class:{"in-mobile":t.inMobile}},[n("div",{staticClass:"text"},[t._v(t._s(t.errorText))]),t.reLoadText?n("div",[n("a",{staticClass:"button light ",attrs:{href:"javascript:;"},on:{click:t.clickReload}},[t._v(t._s(t.reLoadText))])]):t._e(),t.showCustomService&&t.canShowContactUs?n("div",[n("a",{staticClass:"contactus",attrs:{href:"javascript:;"},on:{click:t.clickContactUS}},[t._v("联系我们")])]):t._e()]):t._e()},ea=[],na={methods:{clickReload:function(){this.$emit("reload")},clickContactUS:function(){this.setContactUsVisible(!0)}},props:{isLoading:Boolean,loadText:{type:String,default:"数据加载中..."},isError:Boolean,errorText:{validator:function(){return!0}},reLoadText:{type:String,default:"重新加载"},showCustomService:{type:Boolean,default:!1}}},ra=na,ia=(n("7d74"),Object(qe["a"])(ra,ta,ea,!1,null,"6bfca491",null)),aa=ia.exports,oa=n("039d"),sa=n("fa7d"),ca=sa.FetchState,la=null,ua=ca.Normal,da=[],ha=null===(pr=document.currentScript)||void 0===pr?void 0:pr.src;function fa(){var t=/^.*\/template\/[\w.]+\/js\//i;if(ha){var e=t.exec(ha);e&&e[0]}for(var n=document.querySelectorAll("script[src]"),r=0;r<n.length;r++){var i=n[r],a=i.src;if(a){var o=t.exec(a);if(o)return o[0]}}return"/template/1.0/js/"}function ma(){return new Promise((function(t,e){var n=function(){try{t()}catch(e){}da.length>0&&(da.forEach((function(t){try{t.resolve()}catch(e){}})),da.splice(0,da.length))},r=function(t){try{e(t)}catch(n){}da.length>0&&(da.forEach((function(e){try{e.reject(t)}catch(n){}})),da.splice(0,da.length))};if(la&&n(),ua!==ca.Fetching)try{ua=ca.Fetching;var i=document.createElement("script"),a=function(t){if(t){var e=t.parentNode;e&&e.removeChild(t)}};i.addEventListener("load",(function(t){var e=t.target;if(setTimeout((function(){a(e)}),100),ua===ca.Fetching){var i=window.bodymovin;if(i){ua=ca.Success,window.bodymovin=window.lottie=void 0;try{delete window.bodymovin,delete window.lottie}catch(o){}la=i,n()}else ua=ca.Error,r("lottie library load but not find the variable")}})),i.addEventListener("error",(function(t){var e=t.target;setTimeout((function(){a(e)}),100),ua===ca.Fetching&&(ua=ca.Error,r("lottie library load failed"))})),i.src="".concat(fa(),"lottie.min.js"),document.body.appendChild(i)}catch(o){ua=ca.Error,r(o)}else da.push({resolve:t,reject:e})}))}var pa=function(t,e,n,r,i){var a=0,o=0,s=e/n,c=r/i;s!==c&&(s>c?(a=Math.ceil((e-c*n)/2),e-=a):s<c&&(o=Math.ceil((n-e/c)/2),n-=o));for(var l=Math.floor(e/6),u=Math.floor(n/6),d=!0,h=a;h<e;h+=l)for(var f=o;f<n;f+=u){var m=Object(oa["a"])(t.getImageData(h,f,1,1).data,4),p=m[0],b=m[1],v=m[2],g=m[3];if(0!==p||255!==b||0!==v||255!==g){d=!1;break}}return d},ba={_data:{},clear:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._data,n=Object.keys(e);t>0&&t>n.length||(l["a"]&&console.log("lottie clear now,count:",n.length),n.forEach((function(t){try{var n=e[t];if(n&&n.lottie){try{n.lottie.pause()}catch(r){}try{n.lottie.destroy()}catch(r){}n.lottie=null}}catch(r){}})),delete this._data,this._data={})},_getId:function(t){var e,n,r=t.viewUrl,i=t.fileName;if(r){var a=/\/fileviewer\/\d+\/(\w+)\//i.exec(r);n=a?a[1]:r}return n=null!==(e=n)&&void 0!==e?e:i,"lottie-".concat(t.parentId,"-").concat(n)},unbind:function(t){var e=this._getId(t),n=this._data[e];if(n){l["a"]&&console.log("lottie unbind",e);var r=n.lottie;try{r.stop(),r.wrapper=null}catch(i){console.log(i);try{r.destroy()}catch(i){}delete this._data[e]}}},remove:function(t){var e=this._getId(t);l["a"]&&console.log("lottie remove",e);var n=this._data[e];if(n){var r=n.lottie;if(r){try{r.pause()}catch(i){}try{r.destroy()}catch(i){}}delete this._data[e]}},get:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas";return new Promise((function(i,a){try{var o=n._getId(e),s=n._data[o];if(s&&s.fetchState!==ca.Error){var c=s.lottie;if(c.container){var u=!1;return c.wrapper!==t&&(c.wrapper=t,t.appendChild(c.container),c.resize(),u=!0),l["a"]&&console.log("lottie from cache",o),c.play(),i({lottie:c,resized:u})}}var d=e.viewUrl;ma().then((function(){var s=la.loadAnimation({container:t,path:"".concat(d,"?type=res"),renderer:r,loop:!0,autoplay:!0,name:o,rendererSettings:{}});s.setSubframe(!1);var c=n._data[o]={lottie:s,fetchState:ca.Fetching},u=function(){if(c){if(u&&(s.removeEventListener("drawnFrame",u),u=null),h&&(s.removeEventListener("data_failed",h),h=null),"canvas"===r){var d=t.querySelector("canvas");if(d){var f=d.width,m=d.height,p=d.getContext("2d"),b=s.animationData,v=pa(p,f,m,b.w,b.h);if(v){try{s.pause()}catch(g){}try{s.destroy()}catch(w){}return s=null,void n.get(t,e,"svg").then(i).catch(a)}}}l["a"]&&console.log("lottie from load",r,e),i({lottie:c.lottie,resized:!0}),c.fetchState=ca.Success,c=o=null}},h=function(){c&&(u&&(s.removeEventListener("drawnFrame",u),u=null),h&&(s.removeEventListener("data_failed",h),h=null),c.fetchState=ca.Error,delete n._data[o],a(new Error("lottie data failed")),c=o=null)};s.addEventListener("drawnFrame",u),s.addEventListener("data_failed",h)})).catch((function(t){a(t)}))}catch(h){a(h)}}))}};l["a"]&&Object.defineProperty(window,"lottieCache",{get:function(){return ba}});var va={components:{NetworkLoading:aa},methods:{clickReload:function(){window.location.reload()},resize:function(){var t=this;this.$nextTick((function(){var e=t.lottie;null===e||void 0===e||e.resize()}))},initLottie:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.lottieIniting&&!t.lottie){e.next=2;break}return e.abrupt("return");case 2:return t.lottieLoadState=c["FetchState"].Fetching,t.lottie=null,e.prev=4,e.next=7,ba.get(t.$refs.lottiebox,t.curNetDiskFile);case 7:n=e.sent,i=n.lottie,t.lottie=i,t.lottieSize=t.getLottieSize(i),t.lottieLoadState=c["FetchState"].Success,e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](4),t.lottieSize=new W,t.lottieLoadState=c["FetchState"].Error;case 18:case"end":return e.stop()}}),e,null,[[4,14]])})))()},getLottieSize:function(t){var e=new W(0,0);if(!t)return e;var n=t.animationData;return n?(e.width=n.w,e.height=n.h,e):e}},computed:{lottieError:function(){return this.lottieLoadState===c["FetchState"].Error},lottieIniting:function(){return this.lottieLoadState===c["FetchState"].Fetching},lottieBoxStyle:function(){var t=this.lottieSize;return{width:t.width>0?t.width+"px":"100%",height:t.height>0?t.height+"px":"100%"}}},watch:{lottieSize:function(){this.resize()},webViewHidden:function(t){var e=this.lottie;e&&(t?e.pause():e.play())}},data:function(){return{lottie:null,lottieLoadState:c["FetchState"].Normal,lottieSize:new W}},beforeDestroy:function(){window.removeEventListener("resize",this.resize),ba.unbind(this.curNetDiskFile),this.lottie=null},mounted:function(){this.initLottie()},created:function(){window.addEventListener("resize",this.resize),l["a"]&&(window.vueViewLottie=this)}},ga=va,wa=(n("2104"),Object(qe["a"])(ga,Qi,Ji,!1,null,"2759310e",null)),xa=wa.exports,ya={components:{ViewPdf:Je,ViewMedia:on,ViewImage:qi,ViewLottie:xa},computed:{EnumNetDiskFileType:function(){return o["k"]},fileType:function(){var t,e=this.curNetDiskFile;return null!==(t=null===e||void 0===e?void 0:e.fileType)&&void 0!==t?t:o["k"].Other}},created:function(){l["a"]&&(window.vue_NetDiskFileMain=this)}},Ca=ya,ka=(n("cbf8"),Object(qe["a"])(Ca,We,Ge,!1,null,"3aeeddf8",null)),Sa=ka.exports,_a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"needlogin-tip",class:{"in-mobile":t.inMobile}},[n("div",{staticClass:"logo"}),n("div",{staticClass:"box"},[n("div",{staticClass:"container"},[n("div",{staticClass:"cloudname"},[t._v("您正在访问"),n("b",[t._v(t._s(t.title))])]),n("div",{staticClass:"text"},[t._v("请先登录验证权限")]),n("div",{staticClass:"btns"},[n("a",{staticClass:"button light",attrs:{href:"javascript:;"},on:{click:t.goCloudLogin}},[t._v("立即登录")])])])])])},Aa=[],Ia={computed:{title:function(){var t=this.cloudName;return t||"标记狮设计协作平台私有云服务"}}},Ta=Ia,Oa=(n("f73c"),Object(qe["a"])(Ta,_a,Aa,!1,null,"3052ed11",null)),Ea=Oa.exports,Ma=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.artboardMenu.visible?n("div",{staticClass:"menu",style:t.menuStyle,on:{contextmenu:function(t){t.preventDefault()}}},[n("a",{attrs:{href:"javascript:;"},on:{click:t.clickGoArtboard}},[t._v("查看画板全部切图")]),n("a",{attrs:{href:"javascript:;"},on:{click:t.clickDownPreview}},[t._v("下载该画板预览图")])]):t._e()},La=[],Na=n("b16b"),Da=function(){function t(){Object(A["a"])(this,t),Object(I["a"])(this,"files",[]),Object(I["a"])(this,"jszip",null),this.jszip=new Na["a"]}return Object(_["a"])(t,[{key:"start",value:function(t,e){var n=this;return new Promise((function(r,i){if(0===n.files.length)return i("文件列表为空");n.fetch(e).then((function(e){Object(c["downloadRes"])(t,e),r("success")})).catch(i)}))}},{key:"fetch",value:function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e){var n,i,a,o;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=this.files.splice(0,1)[0],void 0!==n){t.next=5;break}return t.next=4,this._compress();case 4:return t.abrupt("return",t.sent);case 5:return t.next=7,Object(c["fetchPng"])(n.resSrc,n.base64ResSrc);case 7:if(i=t.sent,a=this.jszip,"string"!==typeof i){t.next=13;break}o={base64:!0},t.next=17;break;case 13:if(!e){t.next=17;break}return t.next=16,e(i);case 16:i=t.sent;case 17:return a.file(n.filename,i,o),t.next=20,this.fetch(e);case 20:return t.abrupt("return",t.sent);case 21:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"_compress",value:function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(){var e;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.jszip,t.next=3,e.generateAsync({type:"blob"});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"addFile",value:function(t,e,n){this.files.push({filename:t,resSrc:e,base64ResSrc:n})}}]),t}(),Fa={ANDROID_MIPMAP:[{name:"mdpi",minname:"mdpi",scale:1,filepath:"mipmap-mdpi/{$name$}.png",resname:"{$name$}.png"},{name:"hdpi",minname:"hdpi",scale:1.5,filepath:"mipmap-hdpi/{$name$}.png",resname:"{$name$}@1.5x.png"},{name:"xhdpi",minname:"xhdpi",scale:2,filepath:"mipmap-xhdpi/{$name$}.png",resname:"{$name$}@2x.png"},{name:"xxhdpi",minname:"xxhdpi",scale:3,filepath:"mipmap-xxhdpi/{$name$}.png",resname:"{$name$}@3x.png"},{name:"xxxhdpi",minname:"xxxhdpi",scale:4,filepath:"mipmap-xxxhdpi/{$name$}.png",resname:"{$name$}@4x.png"}],ANDROID:[{name:"mdpi",minname:"mdpi",scale:1,filepath:"drawable-mdpi/{$name$}.png",resname:"{$name$}.png"},{name:"hdpi",minname:"hdpi",scale:1.5,filepath:"drawable-hdpi/{$name$}.png",resname:"{$name$}@1.5x.png"},{name:"xhdpi",minname:"xhdpi",scale:2,filepath:"drawable-xhdpi/{$name$}.png",resname:"{$name$}@2x.png"},{name:"xxhdpi",minname:"xxhdpi",scale:3,filepath:"drawable-xxhdpi/{$name$}.png",resname:"{$name$}@3x.png"},{name:"xxxhdpi",minname:"xxxhdpi",scale:4,filepath:"drawable-xxxhdpi/{$name$}.png",resname:"{$name$}@4x.png"}],IOS:[{name:"标准尺寸 @1x",scale:1,filepath:"{$name$}.png"},{name:"视网膜 @2x",scale:2,filepath:"{$name$}@2x.png"},{name:"高清视网膜 @3x",scale:3,filepath:"{$name$}@3x.png"}],WEB:[{name:"Web @1x",scale:1,filepath:"{$name$}.png"},{name:"Web @2x",scale:2,filepath:"{$name$}@2x.png"},{name:"Web @3x",scale:3,filepath:"{$name$}@3x.png"}]},Pa={name:"SVG",scale:1,filepath:"{$name$}.svg"},ja=[{scale:1,ext:".png"},{scale:1,ext:".svg"},{scale:2,ext:"@2x.png"},{scale:3,ext:"@3x.png"},{scale:4,ext:"@4x.png"},{scale:1.5,ext:"@1.5x.png"}],Ra=function(t,e,n,r,i){if(r)return[{value:Pa,enabled:!0}];var a;switch(e){case o["b"].ANDROID:a=n?Fa.ANDROID_MIPMAP:Fa.ANDROID;break;case o["b"].IOS:a=Fa.IOS;break;default:a=Fa.WEB;break}var s=t.artboard.mlConfig.scalesObj;return a.map((function(t){return{value:t,enabled:i&&1===t.scale||!i&&1===s[t.scale]}}))},Ba=function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e,n){var i,a,o,s,u,d,h,f,m,p,b,v,g;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(Object(c["checkSupportFileProtocol"])(n.artboard)){t.next=2;break}return t.abrupt("return");case 2:if(Object(l["g"])(e)&&0!==e.length){t.next=4;break}throw"至少需要选中一个节点才能激活下载";case 4:if(i=Object(c["hadExportSvg"])(n.artboard),i){t.next=7;break}throw"设计狮没有为该画板导出[SVG]格式的切图";case 7:if(a=0,o={},s=[],e.forEach((function(t){if(Object(l["o"])(t)&&t.markedForExport){var e=Object(c["getNodeShowName"])(t);if(Object(l["h"])(e)){var n=Object(c["getSafePathName"])(e),r=Pa.filepath;r=r.replace("{$name$}",n);var i=o[r];if(i){var u=++i.index;r=Pa.filepath,r=r.replace("{$name$}","".concat(n,"(").concat(u,")"))}else o[r]={index:0};s.push({filepath:r,node:t,nodeName:e}),a+=1}}})),0!==s.length){t.next=15;break}throw"至少需要选中一个节点才能激活下载";case 15:if(1!==s.length){t.next=24;break}return u=s[0],d=u.node,h=u.nodeName,f=Ka(n.artboard,d),m=f.png,p=f.base64Png,b="".concat(h,".svg"),t.next=21,Object(c["downloadOnePng"])(b,m,p);case 21:return t.abrupt("return",t.sent);case 24:return v=new Da,s.forEach((function(t){var e=t.node,r=t.filepath,i=Ka(n.artboard,e),a=i.png,o=i.base64Png;v.addFile(r,a,o)})),g=1===a?s[0].nodeName:n.artboard.name,t.next=29,v.start("svg_".concat(g,".zip"));case 29:return t.abrupt("return",t.sent);case 30:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();function Va(t,e,n,r){return Ua.apply(this,arguments)}function Ua(){return Ua=Object(i["a"])(Object(r["a"])().mark((function t(e,n,i,a){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(Object(c["checkSupportFileProtocol"])(a)){t.next=2;break}return t.abrupt("return");case 2:return t.abrupt("return",Object(c["downloadOnePng"])(e,n,i));case 3:case"end":return t.stop()}}),t)}))),Ua.apply(this,arguments)}function $a(t,e){return Ha.apply(this,arguments)}function Ha(){return Ha=Object(i["a"])(Object(r["a"])().mark((function t(e,n){var i,a,o,s,u,d,h;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(Object(l["g"])(n)&&0!==n.length){t.next=2;break}throw"至少需要选中一个画板才能激活下载";case 2:if(i=[],a={},n.forEach((function(t){if(Object(c["checkSupportFileProtocol"])(t)){var e=Object(c["getSafePathName"])(t.name),n=e,r=a[n],o=t.artboardPreviewPng,s=Object(l["h"])(o)&&/\.webp$/i.test(o)?".webp":".png",u=t.artboardPreviewJS;if(r){var d=++r.index;n="".concat(e,"(").concat(d,")")}else a[n]={index:0};n+=s,i.push({filename:n,pngurl:o,jsurl:u})}})),0!==i.length){t.next=9;break}throw"至少需要选中一个画板才能激活下载";case 9:if(1!==i.length){t.next=16;break}return o=i[0],s=o.filename,u=o.pngurl,d=o.jsurl,t.next=13,Object(c["downloadOnePng"])(s,u,d);case 13:return t.abrupt("return",t.sent);case 16:return h=new Da,i.forEach((function(t){var e=t.filename,n=t.pngurl,r=t.jsurl;h.addFile(e,n,r)})),t.next=20,h.start(e+".zip");case 20:return t.abrupt("return",t.sent);case 21:case"end":return t.stop()}}),t)}))),Ha.apply(this,arguments)}function za(t,e,n,r,i){return Wa.apply(this,arguments)}function Wa(){return Wa=Object(i["a"])(Object(r["a"])().mark((function t(e,n,i,a,o){var s,c,l;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,B(e);case 2:if(s=t.sent,c=s.naturalWidth||s.width,l=s.naturalHeight||s.height,n.width=c,n.height=s.height,i.fillStyle="#fff",i.fillRect(0,0,c,l),i.drawImage(s,0,0,c,l,0,0,c,l),!a||!n.convertToBlob){t.next=14;break}return t.next=13,n.convertToBlob({type:"image/jpeg",quality:o});case 13:return t.abrupt("return",t.sent);case 14:return t.next=16,at(n,"image/jpeg",o);case 16:return t.abrupt("return",t.sent);case 17:case"end":return t.stop()}}),t)}))),Wa.apply(this,arguments)}var Ga=function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e,n,a,s,u,d){var h,f,m,p,b,v,g,w,x,y,C,k,S,_,A,I,T,O,E,M,L,N,D,F;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(c["globalData"].inCloudMode){t.next=2;break}throw"导出到本地的标注信息不支持导出JPG的节点切图";case 2:if(Object(l["g"])(s)&&0!==s.length){t.next=4;break}throw"至少需要选中一个节点才能激活下载";case 4:if(Object(l["o"])(a)){t.next=6;break}throw"至少需要选中一个图片规格才能激活下载";case 6:if(!Object(c["hadExportPng"])(u.artboard)){t.next=10;break}h=o["t"].PNG,t.next=19;break;case 10:if(!Object(c["hadExportWebP"])(u.artboard)){t.next=14;break}h=o["t"].WEBP,t.next=19;break;case 14:if(!Object(c["hadExportSvg"])(u.artboard)){t.next=18;break}h=o["t"].SVG,t.next=19;break;case 18:throw"设计狮没有为该画板导出任何格式的切图";case 19:if(f=h===o["t"].SVG,m=[],f?a[1]&&m.push(1):(p=u.artboard.mlConfig.scalesObj,Object.keys(a).forEach((function(t){p[t]&&a[t]&&m.push(t)}))),0!==m.length){t.next=24;break}throw"至少需要选中一个图片规格才能激活下载";case 24:if(b=Ra(u,e,n,!1,f),v=[],g={},w={},m.forEach((function(t){var e=b.find((function(e){return e.enabled&&e.value.scale==t}));if(null==e)throw"意外的程序性异常,丢失downloadType";g[t]=e.value.filepath})),x=!f&&h===o["t"].WEBP,y=0,s.forEach((function(t){if(Object(l["o"])(t)&&t.markedForExport){var e=Object(c["getNodeShowName"])(t);if(Object(l["h"])(e)){var n=Object(c["getSafePathName"])(e);m.forEach((function(r){var i=g[r];i=i.replace("{$name$}",n).replace(/\.(png|svg)$/i,".jpg");var a=w[i];if(a){var o=++a.index;i=g[r],i=i.replace("{$name$}","".concat(n,"(").concat(o,")")).replace(/\.(png|svg)$/i,".jpg")}else w[i]={index:0};v.push({filepath:i,node:t,scale:r,nodeName:e})})),y+=1}}})),0!==v.length){t.next=34;break}throw"至少需要选中一个节点才能激活下载";case 34:if(k="function"===typeof window.OffscreenCanvas,t.prev=35,C=k?new window.OffscreenCanvas(10,10):document.createElement("canvas"),k||(C.style.cssText="top:-10000px;left:0;width:1px;height:1px;opacity:0;pointer-events:none;position: absolute;overflow:hidden;z-index:-1;",document.body.appendChild(C)),S=C.getContext("2d"),1!==v.length){t.next=48;break}return _=v[0],A=_.node,I=_.scale,T=_.nodeName,O=f?Ka(u.artboard,A):Xa(u.artboard,A,I,x),E=O.png,M=Object(c["getDownloadName"])(I,T,o["t"].JPG),t.next=45,Object(c["downloadOnePngAndCloverJpg"])(M,E,function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,za(e,C,S,k,d);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 45:return t.abrupt("return",t.sent);case 48:L=new Da,v.forEach((function(t){var e=t.node,n=t.scale,r=t.filepath,i=f?Ka(u.artboard,e):Xa(u.artboard,e,n,x),a=i.png;L.addFile(r,a)})),N=1===y?v[0].nodeName:u.artboard.name,t.t0=e,t.next=t.t0===o["b"].ANDROID?54:t.t0===o["b"].IOS?56:58;break;case 54:return D="android_",t.abrupt("break",60);case 56:return D="ios_",t.abrupt("break",60);case 58:return D="web_",t.abrupt("break",60);case 60:return t.next=62,L.start(D+N+".zip",function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,za(e,C,S,k,d);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 62:return t.abrupt("return",t.sent);case 63:return t.prev=63,C&&(F=C.parentNode,F&&F.removeChild(C)),C=null,t.finish(63);case 67:case"end":return t.stop()}}),t,null,[[35,,63,67]])})));return function(e,n,r,i,a,o){return t.apply(this,arguments)}}(),Ya=function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e,n,i,a,s,u){var d,h,f,m,p,b,v,g,w,x,y,C,k,S,_,A,I,T,O;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(Object(c["checkSupportFileProtocol"])(s.artboard)){t.next=2;break}return t.abrupt("return");case 2:if(Object(l["g"])(a)&&0!==a.length){t.next=4;break}throw"至少需要选中一个节点才能激活下载";case 4:if(Object(l["o"])(i)){t.next=6;break}throw"至少需要选中一个图片规格才能激活下载";case 6:if(!u){t.next=12;break}if(d=Object(c["hadExportWebP"])(s.artboard),d){t.next=10;break}throw"设计狮没有为该画板导出[WEBP]格式的切图";case 10:t.next=15;break;case 12:if(d=Object(c["hadExportPng"])(s.artboard),d){t.next=15;break}throw"设计狮没有为该画板导出[PNG]格式的切图";case 15:if(h=[],f=s.artboard.mlConfig.scalesObj,Object.keys(i).forEach((function(t){f[t]&&i[t]&&h.push(t)})),0!==h.length){t.next=20;break}throw"至少需要选中一个图片规格才能激活下载";case 20:if(m=Ra(s,e,n,!1,!1),p=[],b={},v={},h.forEach((function(t){var e=m.find((function(e){return e.enabled&&e.value.scale==t}));if(null==e)throw"意外的程序性异常,丢失downloadType";b[t]=e.value.filepath})),g=0,a.forEach((function(t){if(Object(l["o"])(t)&&t.markedForExport){var e=Object(c["getNodeShowName"])(t);if(Object(l["h"])(e)){var n=Object(c["getSafePathName"])(e);h.forEach((function(r){var i=b[r];i=i.replace("{$name$}",n),u&&(i=i.replace(/\.png$/i,".webp"));var a=v[i];if(a){var o=++a.index;i=b[r],i=i.replace("{$name$}","".concat(n,"(").concat(o,")")),u&&(i=i.replace(/\.png$/i,".webp"))}else v[i]={index:0};p.push({filepath:i,node:t,scale:r,nodeName:e})})),g+=1}}})),0!==p.length){t.next=31;break}throw"至少需要选中一个节点才能激活下载";case 31:if(1!==p.length){t.next=40;break}return w=p[0],x=w.node,y=w.scale,C=w.nodeName,k=Xa(s.artboard,x,y,u),S=k.png,_=k.base64Png,A=Object(c["getDownloadName"])(y,C,u?o["t"].WEBP:o["t"].PNG),t.next=37,Object(c["downloadOnePng"])(A,S,_);case 37:return t.abrupt("return",t.sent);case 40:I=new Da,p.forEach((function(t){var e=t.node,n=t.scale,r=t.filepath,i=Xa(s.artboard,e,n,u),a=i.png,o=i.base64Png;I.addFile(r,a,o)})),T=1===g?p[0].nodeName:s.artboard.name,t.t0=e,t.next=t.t0===o["b"].ANDROID?46:t.t0===o["b"].IOS?48:50;break;case 46:return O="android_",t.abrupt("break",52);case 48:return O="ios_",t.abrupt("break",52);case 50:return O="web_",t.abrupt("break",52);case 52:return t.next=54,I.start(O+T+".zip");case 54:return t.abrupt("return",t.sent);case 55:case"end":return t.stop()}}),t)})));return function(e,n,r,i,a,o){return t.apply(this,arguments)}}(),Xa=function(t,e,n,r){if(!t||!e)return{};var i,a=t.artboardPath,o=e.exportPath,s=Object(c["getScalePathKey"])(n),l=r?".webp":".png",u=Object(c["fixedLinkedResUrl"])(t,"".concat(a,"/png/"),"".concat(o).concat(s).concat(l));return i=r?u.replace(/\/png\/(.*)\.webp$/,"/base64/$1.webp.js"):u.replace(/\/png\/(.*)\.png$/,"/base64/$1.js"),{png:u,base64Png:i}},Ka=function(t,e){if(!t||!e)return{};var n=t.artboardPath,r=e.exportPath,i=Object(c["fixedLinkedResUrl"])(t,"".concat(n,"/svg/"),"".concat(r,".svg")),a=i.replace(/\/svg\/(.*)\.svg$/,"/base64/$1@svg.js");return{png:i,base64Png:a}},Za={methods:{clickDownPreview:function(){var t=this,e=this.artboard;e&&(e=e.artboard,e&&(this.setInOutput(!0),Va("".concat(e.name,".png"),e.artboardPreviewPng,e.artboardPreviewJS,e).catch((function(e){t.showTextTip(e)})).finally((function(){t.setInOutput(!1)}))))},clickGoArtboard:function(){this.$store.commit("setArtboardInComment",!1),this.setCurArtboard(this.artboardMenu.artboard),this.inMultDownMode||this.setInMultDownMode(!0)},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),this.handle=setTimeout((function(){e.$store.commit("setArtboardMenu",{visible:!1})}),150))}},watch:{"artboardMenu.x":function(){clearTimeout(this.handle)},"artboardMenu.y":function(){clearTimeout(this.handle)},"artboardMenu.artboard":function(t){null!=t&&clearTimeout(this.handle)},"artboardMenu.visible":function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))}},beforeDestroy:function(){clearTimeout(this.handle),window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0)},data:function(){return{needOpen:!1,handle:0}},computed:{artboard:function(){return this.artboardMenu.artboard},menuStyle:function(){return{top:this.artboardMenu.y+"px",left:this.artboardMenu.x+"px"}},artboardMenu:function(){return this.$store.state.artboardMenu}}},qa=Za,Qa=(n("3ee8"),Object(qe["a"])(qa,Ma,La,!1,null,"aad9d946",null)),Ja=Qa.exports,to=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.tipVisible?n("div",{staticClass:"pop-tip-text"},[n("p",[t._v(t._s(t.tipText)),n("a",{staticClass:"btn-close",attrs:{href:"javascript:;"},on:{click:function(e){return t.hideTextTip()}}},[t._v("我知道了")])])]):t._e()},eo=[],no={computed:{tipText:function(){return this.$store.state.textTip.text},tipVisible:function(){return this.$store.state.textTip.visible}}},ro=no,io=(n("96e6"),Object(qe["a"])(ro,to,eo,!1,null,"707f0de8",null)),ao=io.exports,oo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible&&t.useMiniList?n("folder-nav-mini",{attrs:{isSupportNetDiskFile:t.isSupportNetDiskFile,miniFoldersOpen:t.miniFoldersOpen},on:{clickMiniFoldersOpen:t.clickMiniFoldersOpen}}):t.visible?n("folder-nav-max",{attrs:{isSupportNetDiskFile:t.isSupportNetDiskFile,subFilesOpen:t.subFilesOpen,subFoldersOpen:t.subFoldersOpen},on:{clickSubFoldersOpen:t.clickSubFoldersOpen,clickSubFilesOpen:t.clickSubFilesOpen}}):t._e()},so=[],co=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cloud-folders",class:{allfolders:t.allFoldersBoxVisible}},[n("div",{staticClass:"header"},[n("div",{staticClass:"name"}),n("div",{staticClass:"search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],ref:"searchInput",attrs:{type:"text",placeholder:"搜索当前文件夹",maxlength:"50",spellcheck:"false"},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),t.searchText?n("a",{staticClass:"btn-clear",attrs:{href:"javascript:;"},on:{click:t.clickClearSearchText}}):t._e()])]),n("div",{ref:"$list",staticClass:"list",class:{usetab:t.needShowFile},on:{scroll:t.onListScroll}},[t.needShowFile?n("div",{staticClass:"list-tab",class:{on:t.subFoldersOpen}},[n("span",{on:{click:t.clickSubFoldersOpen}},[t._v("文件夹("+t._s(t.renderCloudSubFolders.length)+")")])]):t._e(),t.hasSubFolders?n("div",{ref:"$folders",staticClass:"list-item",class:{off:!t.subFoldersOpen&&t.needShowFile},style:{height:t.renderFolderHeight+"px"}},[n("div",{staticClass:"list-box",class:{scrolling:t.scrolling},style:{"padding-top":t.renderFolderLazyList.paddingTop}},t._l(t.renderFolderLazyList.items,(function(e){return n("FoldNavFolderItem",{key:e.id,attrs:{isSupportNetDiskFile:t.isSupportNetDiskFile,folder:e}})})),1)]):t._e(),t.needShowFile&&!t.hasSubFolders?n("div",{directives:[{name:"show",rawName:"v-show",value:t.subFoldersOpen,expression:"subFoldersOpen"}],staticClass:"empty"},[t._v(t._s(t.hasSearchText?"未找到包含 “"+t.searchText+"” 的文件夹":"没有文件夹"))]):t._e(),t.needShowFile?n("div",{staticClass:"list-tab",class:{on:t.subFilesOpen}},[n("span",{on:{click:t.clickSubFilesOpen}},[t._v("文件("+t._s(t.renderCloudSubFiles.length)+")")])]):t._e(),t.needShowFile&&t.hasSubFiles?n("div",{ref:"$files",staticClass:"list-item",class:{off:!t.subFilesOpen},style:{height:t.renderFileHeight+"px"}},[n("div",{staticClass:"list-box",class:{scrolling:t.scrolling},style:{"padding-top":t.renderFileLazyList.paddingTop}},t._l(t.renderFileLazyList.items,(function(e){return n("FoldNavFileItem",{key:e.viewUrl,attrs:{file:e},on:{contextMenuFile:t.contextMenuFile}})})),1)]):t.needShowFile?n("div",{directives:[{name:"show",rawName:"v-show",value:t.subFilesOpen,expression:"subFilesOpen"}],staticClass:"empty"},[t._v(t._s(t.hasSearchText?"未找到包含 "+t.searchText+" 的文件":"没有文件"))]):t._e()]),n("FileItemContextMenu",{attrs:{fileContextMenuData:t.fileContextMenuData}})],1)},lo=[],uo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.fileContextMenuData.visible?n("div",{staticClass:"fileitem-contextmenu",style:t.menuStyle,on:{contextmenu:function(t){t.preventDefault()}}},[t.canOnlineView?n("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickNetDiskFile(t.file)}}},[t._v("在线查看")]):t._e(),n("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.copyViewUrl(t.file)}}},[t._v("复制链接")]),n("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickDownloadNetDiskFile(t.file)}}},[t._v("下载文件")])]):t._e()},ho=[],fo={methods:{copyViewUrl:function(t){var e=t.viewUrl;0===e.indexOf("/")&&(e=location.origin+e),Object(c["copyValueFromText"])(e)?this.showTextTip("链接已复制到剪切板"):this.showTextTip("链接复制到剪切板失败")},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),this.handle=setTimeout((function(){e.fileContextMenuData.visible=!1}),200))}},watch:{x:function(){clearTimeout(this.handle)},y:function(){clearTimeout(this.handle)},file:function(t){null!=t&&clearTimeout(this.handle)},visible:function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))}},beforeDestroy:function(){clearTimeout(this.handle),window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0)},props:{fileContextMenuData:Object},data:function(){return{needOpen:!1,handle:0}},computed:{canOnlineView:function(){var t;return o["k"].isSupportOnlineViewType(null===(t=this.file)||void 0===t?void 0:t.fileType)},visible:function(){return this.fileContextMenuData.visible&&this.file},file:function(){return this.fileContextMenuData.file},x:function(){return this.fileContextMenuData.x},y:function(){return this.fileContextMenuData.y},menuStyle:function(){return{top:this.y+"px",left:this.x+"px"}}}},mo=fo,po=(n("f414"),Object(qe["a"])(mo,uo,ho,!1,null,"075ee3ff",null)),bo=po.exports,vo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"item max",class:{private:1===t.folder.shareMode},attrs:{title:t.title},on:{click:function(e){return t.clickGoFolder(t.folder)}}},[t.hasMultPreview?n("div",{staticClass:"imgs"},t._l(t.folder.pathPreviews,(function(t,e){return n("FolderItemIcon",{key:e,attrs:{pathPreview:t,mini:!0}})})),1):t.hasPreview?n("div",{staticClass:"img"},[n("FolderItemIcon",{attrs:{pathPreview:t.folder.pathPreviews[0],mini:!1}})],1):t._e(),n("div",{staticClass:"text"},[n("div",{staticClass:"name"},[n("span",[t._v(t._s(t.folder.name))]),1===t.folder.shareMode?n("div",{staticClass:"lock-max"}):t._e()])])])},go=[],wo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isNetDiskIcon?n("div",{staticClass:"preview folder-fileicon",class:{max:!t.mini}},[n("div",{staticClass:"img icon-netdiskfile",class:t.iconCls})]):n("ArtboardPreviewImg",{attrs:{pathPreview:t.pathPreview,imgHeight:0}})},xo=[],yo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preview"},[t.imgSrc?n("img",{directives:[{name:"show",rawName:"v-show",value:!t.errored,expression:"!errored"}],staticClass:"img",attrs:{src:t.imgSrc},on:{error:t.onError,load:t.onLoad}}):t._e()])},Co=[],ko={methods:{onLoad:function(t){var e=t.target;this.width=e.naturalWidth,this.height=e.naturalHeight,this.$emit("resize",this.width,this.height)},onError:function(){this.errored||(this.errored=!0)}},watch:{pathPreview:function(){this.errored=!1}},computed:{imgSrc:function(){var t=this.pathPreview;return t}},data:function(){return{errored:!1,width:0,height:0}},props:{pathPreview:String}},So=ko,_o=(n("8c49"),Object(qe["a"])(So,yo,Co,!1,null,"4b255b51",null)),Ao=_o.exports,Io={components:{ArtboardPreviewImg:Ao},computed:{iconCls:function(){return o["k"].getName(this.netdiskFileType,this.mini?o["l"].Normal:o["l"].Big)},netdiskFileType:function(){var t=this.pathPreview;if(!Object(l["h"])(t))return null;var e=/^netdisk:\/\/(\d+)\//.exec(t);return e?+e[1]:null},isNetDiskIcon:function(){return"number"===typeof this.netdiskFileType}},props:{pathPreview:String,mini:Boolean}},To=Io,Oo=(n("7bcb"),Object(qe["a"])(To,wo,xo,!1,null,"4628005e",null)),Eo=Oo.exports,Mo={components:{FolderItemIcon:Eo},methods:{clickGoFolder:function(t){Object(c["goCloudFolderUrl"])(t.id)}},computed:{title:function(){var t=this.folder,e=this.isSupportNetDiskFile,n="".concat(t.artboardCount," 个画板，").concat(e?"".concat(t.fileCount," 个文件，"):"").concat(t.folderCount," 个文件夹");return n},hasPreview:function(){var t=this.folder;return Object(l["g"])(t.pathPreviews)&&t.pathPreviews.length>0},hasMultPreview:function(){var t=this.folder;return this.hasPreview&&0===t.previewArtboardId&&t.pathPreviews.length>1}},props:{folder:Object,isSupportNetDiskFile:Boolean}},Lo=Mo,No=(n("c0ee"),Object(qe["a"])(Lo,vo,go,!1,null,"3357f499",null)),Do=No.exports,Fo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"item max",class:{"non-mask":t.isLottieFile},attrs:{title:t.itemTitle},on:{contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)},mouseenter:function(e){t.mouseenter=!0},mouseleave:t.onMouseOutImg}},[n("div",{ref:"img",staticClass:"img",class:{mini:t.isMiniImage,lottie:t.isLottieFile,mouseenter:t.mouseenter,lottieloading:t.lottieLoading},on:{click:function(e){return t.clickNetDiskFile(t.file)}}},[0===t.imgSize.width&&0===t.imgSize.height?n("div",{staticClass:"icon-netdiskfile",class:t.iconCls}):t._e(),t.imgVisible?n("ArtboardPreviewImg",{attrs:{imgHeight:0,pathPreview:t.file.previewImage},on:{resize:t.onPreviewImgResize}}):t._e(),t.isLottieFile?n("div",{ref:"lottiebox",staticClass:"lottie-box"}):t._e()],1),t.imgVisible&&t.thumbImgVisible?n("div",{directives:[{name:"show",rawName:"v-show",value:t.mouseenter,expression:"mouseenter"}],staticClass:"thumbimg",style:t.thumbImgStyle,on:{mouseenter:function(e){t.mouseInThumb=!0},mouseleave:function(e){t.mouseInThumb=!1},mousemove:t.onMouseMoveImg}},[n("ArtboardPreviewImg",{attrs:{imgHeight:0,pathPreview:t.file.previewImage}})],1):t._e(),n("div",{staticClass:"text"},[n("div",{staticClass:"name"},[t._v(t._s(t.file.fileName))]),n("div",{staticClass:"info"},[t._v(t._s(t.fileExt))])])])},Po=[],jo={components:{ArtboardPreviewImg:Ao},methods:{onPreviewImgResize:function(t,e){var n=this.imgSize;n.width=t,n.height=e},onMouseOutImg:function(){this.imgScrollTop=0,this.mouseenter=!1},onMouseMoveImg:function(t){var e=this.file;if(e&&this.viewHeight>0&&this.viewHeight<this.viewRealHeight){var n=t.layerY,r=n/this.thumbViewHeight,i=.2,a=.2;r=r<=i?0:r>=1-a?1:(r-i)/(1-a-i);var o=this.viewRealHeight-this.viewHeight,s=Math.round(r*o);this.imgScrollTop=s}},onContextmenu:function(t){this.$emit("contextMenuFile",t,this.file)},initLottie:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isLottieFile){e.next=2;break}return e.abrupt("return");case 2:if(!t.lottieLoading&&!t.lottie){e.next=4;break}return e.abrupt("return");case 4:return t.lottieLoadState=c["FetchState"].Fetching,e.prev=5,e.next=8,ba.get(t.$refs.lottiebox,t.file);case 8:n=e.sent,i=n.lottie,t.lottie=i,t.lottieLoadState=c["FetchState"].Success,e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](5),t.lottieLoadState=c["FetchState"].Error;case 17:case"end":return e.stop()}}),e,null,[[5,14]])})))()}},watch:{"file.updateTimeTimes":function(t){if(t){console.log("file.updateTimeTimes",t),ba.remove(this.file);var e=this.lottie;e&&(e.destroy(),this.lottie=null),this.lottieLoadState=c["FetchState"].Normal,this.mouseenter&&this.initLottie()}},mouseenter:function(t){var e=this.lottie;t?e?e.play():this.initLottie():null===e||void 0===e||e.stop()},imgScrollTop:function(t){var e=this.$refs.img;e&&e.scrollTo({top:t,behavior:0===t?"smooth":"instant"})}},computed:{lottieLoading:function(){return this.lottieLoadState===c["FetchState"].Fetching},lottieLoadSuccess:function(){return this.lottieLoadState===c["FetchState"].Success},isLottieFile:function(){var t=this.file,e=t.fileType;return e===o["k"].Lottie},imgVisible:function(){var t=this.fileRect,e=this.viewRect;return!!window||!(!t||!e)&&t.isOverlap(e)},fileExt:function(){var t,e,n=this.file;if(!n)return null;var r=null!==(t=null===(e=n.fileExt)||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"";return"."===r[0]&&(r=r.substr(1)),r},iconCls:function(){var t=this.file;return t?o["k"].getName(t.fileType,o["l"].Big):null},isMiniImage:function(){var t=this.imgSize,e=this.boxWidth,n=this.boxHeight,r=this.isLottieFile;if(r)return!0;if(0===t.width)return!0;if(t.width<=e)return!0;if(t.height<=n)return!0;var i=e/t.width*t.height;return i<=n},viewWidth:function(){var t=this.imgSize.width,e=this.boxWidth;return this.isMiniImage?Math.min(e,t):e},viewHeight:function(){if(this.isMiniImage)return this.imgSize.height;var t=1,e=this.viewWidth,n=this.viewRealHeight,r=Math.round(e/t);return Math.min(r,n)},viewRealHeight:function(){var t=this.viewWidth,e=this.imgSize;return 0==e.width||0==e.height?0:Math.round(t/e.width*e.height)},thumbViewHeight:function(){var t=this.viewRealHeight;if(0==t)return 0;var e=375/812,n=this.viewWidth/t;n=Math.max(e,n);var r=this.thumbViewWidth,i=Math.round(r/n);return i},thumbImgStyle:function(){return{width:this.thumbViewWidth+"px",height:this.thumbViewHeight+"px"}},thumbImgVisible:function(){if(!this.imgVisible)return!1;if(this.isMiniImage)return!1;var t=this.file;if(!t)return!1;var e=this.viewHeight,n=this.boxHeight;return e>0&&e<this.imgSize.height&&n<this.viewRealHeight},itemTitle:function(){var t=this.file;return t?"".concat(t.name,"\n提交于: ").concat(t.updateTimeStr,"\n提交者: ").concat(t.updaterName,"\n文件大小: ").concat(Object(c["transformPcSize"])(t.fileSize)).concat(this.isUrl?"\n链接到: ".concat(t.webLoc):""):null},isUrl:function(){var t=this.file;return(null===t||void 0===t?void 0:t.fileType)===o["k"].Url}},beforeDestroy:function(){this.isLottieFile&&(ba.unbind(this.file),this.lottie=null)},data:function(){return{mouseenter:!1,imgScrollTop:0,mouseInThumb:!1,imgSize:{width:0,height:0},thumbViewWidth:36,boxWidth:185,boxHeight:185,lottie:null,lottieLoadState:c["FetchState"].Normal}},props:{file:Object}},Ro=jo,Bo=(n("ad0e"),Object(qe["a"])(Ro,Fo,Po,!1,null,"7d62d537",null)),Vo=Bo.exports,Uo=200,$o={folderMax:{margin:{top:20,right:20,bottom:20,left:2},width:192,height:192},fileMax:{margin:{top:20,right:23,bottom:20,left:6},width:185,height:213}},Ho={components:{FoldNavFolderItem:Do,FoldNavFileItem:Vo,FileItemContextMenu:bo},methods:{onListScroll:function(t){this.scrollY=t.target.scrollTop},getRenderLazyList:function(t,e,n,r,i){var a={items:[],rects:[],startIndex:-1,paddingTop:"0px"};if(!r||!t)return a;if(e.length!==n.length)return a;for(var o=-1,s=0,c=n.length;s<c;s++){var l=e[s],u=t.isOverlap(l);if(-1===a.startIndex&&u)a.startIndex=s;else if(i&&-1!==a.startIndex&&!u)break;u&&(o=s)}var d=e[a.startIndex];if(d&&a.startIndex>0)for(var h=a.startIndex-1;h>=0;h--){var f=e[h];if(d.y!=f.y)break;a.startIndex=h}var m=$o.folderMax;if(-1!=a.startIndex){a.items=n.slice(a.startIndex,o+1),a.rects=e.slice(a.startIndex,o+1);var p=a.rects[0];a.paddingTop=p.y-m.margin.top+"px"}return a},onResize:function(){this.resetArtboardsBoundingClientRect("onResize")},resetArtboardsBoundingClientRectDelay:function(t){var e=this;cancelAnimationFrame(this.handle_resetArtboardsBoundingClientRect),this.handle_resetArtboardsBoundingClientRect=requestAnimationFrame((function(){e.resetArtboardsBoundingClientRect(t+".delay")}))},resetArtboardsBoundingClientRect:function(t){var e=this;cancelAnimationFrame(this.handle_resetArtboardsBoundingClientRect);var n=this.viewRect;n.width=window.innerWidth,n.height=window.innerHeight,this.$nextTick((function(){l["a"]&&console.log("+++++++++++++resetArtboardsBoundingClientRect:".concat(t));var n=e.$refs.$list,r=e.$refs.$files,i=e.$refs.$folders;if(n){var a=n.getBoundingClientRect().y;if(i){var o=i.getBoundingClientRect();if(0!==o.height||0!==o.width){var s=e.foldersBoundingClientRect;s.x=o.x,s.y=o.y,s.width=o.width,s.height=o.height,s.marginTop=o.y-a}}if(r){var c=r.getBoundingClientRect();if(0!==c.height||0!==c.width){var u=e.filesBoundingClientRect;u.x=c.x,u.y=c.y,u.width=c.width,u.height=c.height,u.marginTop=c.y-a}}}}))},clickClearSearchText:function(){this.searchText=""},contextMenuFile:function(t,e){var n=t.pageX,r=t.pageY,i=this.fileContextMenuData;l["a"]&&console.log("contextMenuFile",e),requestAnimationFrame((function(){i.x=n,i.y=r,i.file=e,i.visible=!0}))},clickSubFoldersOpen:function(){this.$emit("clickSubFoldersOpen",!this.subFoldersOpen)},clickSubFilesOpen:function(){this.$emit("clickSubFilesOpen",!this.subFilesOpen)}},watch:{renderFolderHeight:function(){this.resetArtboardsBoundingClientRectDelay("renderFolderHeight")},renderArtboardHeight:function(){this.resetArtboardsBoundingClientRectDelay("renderArtboardHeight")},subFoldersOpen:function(){this.resetArtboardsBoundingClientRect("subFoldersOpen")},subFilesOpen:function(){this.resetArtboardsBoundingClientRect("subFilesOpen")},allFoldersBoxVisible:function(){this.resetArtboardsBoundingClientRect("allFoldersBoxVisible")},"renderCloudSubFolders.length":function(){this.resetArtboardsBoundingClientRectDelay("renderCloudSubFolders.length")},"renderCloudSubFiles.length":function(){this.resetArtboardsBoundingClientRectDelay("'renderCloudSubFiles.length")},renderFolderViewRect:function(){var t=this.foldersBoundingClientRect.height;0==t&&this.resetArtboardsBoundingClientRectDelay("renderFolderViewRect")},renderFileViewRect:function(){var t=this.filesBoundingClientRect.height;0==t&&this.resetArtboardsBoundingClientRectDelay("renderFileViewRect")},scrollY:function(){var t=this;this.resetArtboardsBoundingClientRectDelay("scrollY"),clearTimeout(this.scrollingHandle),this.scrolling=!0,this.scrollingHandle=setTimeout((function(){t.scrolling=!1}),100)}},computed:{renderFileHeight:function(){var t=this.renderFileRects,e=t.length;if(0==e)return 0;for(var n=t[e-1],r=n.y,i=n.bottom,a=e-2;a>=0;a--){var o=t[a];if(o.y!==r)break;i=Math.max(i,o.bottom)}var s=$o.fileMax;return i+s.margin.bottom},renderFolderHeight:function(){var t=this.renderFolderRects,e=t.length;if(0==e)return 0;for(var n=t[e-1],r=n.y,i=n.bottom,a=e-2;a>=0;a--){var o=t[a];if(o.y!==r)break;i=Math.max(i,o.bottom)}var s=$o.folderMax;return i+s.margin.bottom},renderFolderViewRect:function(){var t=this.viewRect,e=this.foldersBoundingClientRect,n=Object(d["d"])(t,e);return n&&(n.x=0,e.y>0?n.y-=e.y:n.y-=e.marginTop),n},renderFileViewRect:function(){var t=this.viewRect,e=this.filesBoundingClientRect,n=Object(d["d"])(t,e);return n&&(n.x=0,e.y>0?n.y-=e.y:n.y-=e.marginTop),n},renderFolderLazyList:function(){var t=this.renderFolderViewRect,e=this.renderFolderRects,n=this.renderCloudSubFolders,r=this.subFoldersOpen;return this.getRenderLazyList(t,e,n,r,!0)},renderFileLazyList:function(){var t=this.renderFileViewRect,e=this.renderFileRects,n=this.renderCloudSubFiles,r=this.subFilesOpen;return this.getRenderLazyList(t,e,n,r,!0)},renderFolderRects:function(){var t=this.renderCloudSubFolders,e=this.foldersBoundingClientRect;if(0===e.width)return[];var n={x:0,y:0,width:e.width,height:e.height},r=[],i=$o.folderMax,a=i.margin.left,o=a,s=i.margin.top,c=Math.floor(n.width/Uo);return t.forEach((function(t,e){var n=new d["a"];n.set(o,s,i.width,i.height),r.push((new d["a"]).set(n.x,n.y,n.width,n.height)),n.x=n.right+i.margin.left+i.margin.right,1===c||e>0&&(e+1)%c===0?(s+=i.height,s+=i.margin.top+i.margin.bottom,o=a):o=n.x})),r},renderFileRects:function(){var t=this.renderCloudSubFiles,e=this.filesBoundingClientRect;if(0===e.width)return[];var n={x:0,y:0,width:e.width,height:e.height},r=[],i=$o.fileMax,a=i.margin.left,o=a,s=i.margin.top,c=Math.floor(n.width/Uo);return t.forEach((function(t,e){var n=new d["a"];n.set(o,s,i.width,i.height),r.push((new d["a"]).set(n.x,n.y,n.width,n.height)),n.x=n.right+i.margin.left+i.margin.right,1===c||e>0&&(e+1)%c===0?(s+=i.height,s+=i.margin.top+i.margin.bottom,o=a):o=n.x})),r},hasSearchText:function(){return Object(l["h"])(this.searchText)},needShowFile:function(){return this.inCloudMode&&this.cloudCurrentFolderId>0},renderCloudSubFolders:function(){var t=this.cloudSubFolders,e=this.hasSearchText,n=this.searchText;return t&&0!==t.length?e?(n=n.toLowerCase(),t.filter((function(t){var e,r,i=null!==(e=null===(r=t.name)||void 0===r?void 0:r.toLowerCase())&&void 0!==e?e:"";return-1!==i.indexOf(n)}))):t:[]},renderCloudSubFiles:function(){var t=this.cloudSubFiles,e=this.hasSearchText,n=this.searchText;return t&&0!==t.length?e?(n=n.toLowerCase(),t.filter((function(t){var e,r,i=null!==(e=null===(r=t.name)||void 0===r?void 0:r.toLowerCase())&&void 0!==e?e:"";return-1!==i.indexOf(n)}))):t:[]},hasSubFolders:function(){return this.renderCloudSubFolders.length>0},hasSubFiles:function(){return this.renderCloudSubFiles.length>0}},data:function(){return{scrollY:0,scrolling:!1,scrollingHandle:0,handle_resetArtboardsBoundingClientRect:0,viewRect:{x:0,y:0,width:0,height:0},foldersBoundingClientRect:{x:0,y:0,width:0,height:0,marginTop:0},filesBoundingClientRect:{x:0,y:0,width:0,height:0,marginTop:0},fileContextMenuData:{visible:!1,x:0,y:0,file:null},searchText:""}},props:{subFoldersOpen:Boolean,subFilesOpen:Boolean,isSupportNetDiskFile:Boolean},created:function(){window.addEventListener("resize",this.onResize)},mounted:function(){this.resetArtboardsBoundingClientRect("mounted"),l["a"]&&(window.vueFolderNavMax=this)},beforeDestroy:function(){cancelAnimationFrame(this.handle_resetArtboardsBoundingClientRect),clearTimeout(this.scrollingHandle),window.removeEventListener("resize",this.onResize)}},zo=Ho,Wo=(n("5f9e"),Object(qe["a"])(zo,co,lo,!1,null,"b151e392",null)),Go=Wo.exports,Yo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"folder-nav",class:{on:t.miniFoldersOpen,allfolders:t.allFoldersBoxVisible}},[n("dl",{staticClass:"subfolders",class:{on:t.miniFoldersOpen}},[n("dt",[n("div",{staticClass:"title",on:{click:t.clickMiniFoldersOpen}},[t._v("文件夹/文件"),n("span",{staticClass:"count"},[t._v(t._s(t.totalCount))])]),t.miniFoldersOpen?n("div",{staticClass:"search",class:{on:t.inSearchMode}},[n("div",{staticClass:"btn-search",attrs:{title:"搜索当前文件夹"},on:{click:t.showSearch}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],ref:"searchInput",attrs:{type:"text",maxlength:"50",spellcheck:"false"},domProps:{value:t.searchText},on:{blur:t.onSearchInputBlur,input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),t.hasSearchText?n("div",{staticClass:"btn-clear",on:{click:t.clickClearSearchText}}):t._e()]):t._e()]),n("dd",{ref:"box",on:{scroll:t.onScroll,mousewheel:t.onMouseWheel}},[t.hasSearchText&&0===t.miniRenderList.length?n("div",{staticClass:"empty"},[t._v("未找到包含 “"+t._s(t.searchText)+"” 的子文件夹或文件")]):t._e(),n("div",{staticClass:"brace",class:{off:t.miniListOpt.mousewheelTimes>0},style:{height:t.miniBoxRealHeight}},[n("div",{staticClass:"front",style:{paddingTop:t.miniFrontMarginTop}},[t._l(t.lazyMiniRenderList,(function(e){return[e.isFolder?n("FolderNavSubFolderItem",{key:e.key,attrs:{folder:e.item,isSupportNetDiskFile:t.isSupportNetDiskFile}}):t._e(),e.isFile?n("FolderNavSubFileItem",{key:e.key,attrs:{file:e.item},on:{contextMenuFile:t.contextMenuFile}}):t._e()]}))],2)])])]),n("FileItemContextMenu",{attrs:{fileContextMenuData:t.fileContextMenuData}})],1)},Xo=[],Ko=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"folder-item",class:{private:1===t.folder.shareMode},attrs:{title:t.title},on:{click:function(e){return t.clickGoFolder()}}},[n("div",{staticClass:"icon"}),n("div",{staticClass:"info"},[n("div",{staticClass:"name"},[t._v(t._s(t.folder.name))]),n("span",{staticClass:"art-count"},[t._v("共 "+t._s(t.countText)+" 项")])])])},Zo=[],qo={methods:{clickGoFolder:function(){Object(c["goCloudFolderUrl"])(this.folder.id)}},computed:{countText:function(){var t,e=this.folder;return e.artboardCount+(null!==(t=e.fileCount)&&void 0!==t?t:0)+e.folderCount},title:function(){var t=this.folder,e=this.isSupportNetDiskFile,n="".concat(t.artboardCount," 个画板，").concat(e?"".concat(t.fileCount," 个文件，"):"").concat(t.folderCount," 个文件夹");return n}},props:{folder:Object,isSupportNetDiskFile:Boolean}},Qo=qo,Jo=(n("eba2"),Object(qe["a"])(Qo,Ko,Zo,!1,null,"a2e0bbfc",null)),ts=Jo.exports,es=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"file-item",attrs:{title:t.title},on:{click:function(e){return t.clickNetDiskFile(t.file)},contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)}}},[n("div",{ref:"img",staticClass:"img"},[0===t.imgSize.width&&0===t.imgSize.height?n("div",{staticClass:"icon-netdiskfile",class:t.iconCls}):t._e(),n("ArtboardPreviewImg",{attrs:{imgHeight:0,pathPreview:t.file.previewImage},on:{resize:t.onPreviewImgResize}})],1),n("div",{staticClass:"info"},[n("div",{staticClass:"name"},[t._v(t._s(t.file.fileName))]),n("div",{staticClass:"ext"},[t._v(t._s(t.fileExt))])])])},ns=[],rs={components:{ArtboardPreviewImg:Ao},methods:{onPreviewImgResize:function(t,e){var n=this.imgSize;n.width=t,n.height=e},onContextmenu:function(t){this.$emit("contextMenuFile",t,this.file)}},computed:{fileExt:function(){var t,e,n=this.file;if(!n)return null;var r=null!==(t=null===(e=n.fileExt)||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"";return"."===r[0]&&(r=r.substring(1)),r},iconCls:function(){var t=this.file;return t?o["k"].getName(t.fileType,o["l"].Normal):null},title:function(){var t=this.file;return t?"".concat(t.name,"\n提交于: ").concat(t.updateTimeStr,"\n提交者: ").concat(t.updaterName,"\n文件大小: ").concat(Object(c["transformPcSize"])(t.fileSize)).concat(this.isUrl?"\n链接到: ".concat(t.previewPath):""):null}},props:{file:Object},data:function(){return{imgSize:{width:0,height:0}}}},is=rs,as=(n("f7a7"),Object(qe["a"])(is,es,ns,!1,null,"089ee6de",null)),os=as.exports,ss={components:{FileItemContextMenu:bo,FolderNavSubFolderItem:ts,FolderNavSubFileItem:os},methods:{contextMenuFile:function(t,e){var n=t.pageX,r=t.pageY,i=this.fileContextMenuData;l["a"]&&console.log("contextMenuFile",e),requestAnimationFrame((function(){i.x=n,i.y=r,i.file=e,i.visible=!0}))},onMouseWheel:function(t){var e;this.miniListOpt.mousewheelTimes=null!==(e=t.timeStamp)&&void 0!==e?e:Date.now()},onScroll:function(t){this.miniListOpt.scrollTop=t.target.scrollTop},resize:function(){if(this.useMiniList){var t=this.$refs.box;if(t){var e=this.miniListOpt;e.boxHeight=t.offsetHeight}}},onSearchInputBlur:function(){var t=this;clearTimeout(this.searchHandle),this.searchHandle=setTimeout((function(){t.searchInputfocus=!1}),100)},clickClearSearchText:function(){this.searchText="",this.showSearch()},showSearch:function(){var t=this;clearTimeout(this.searchHandle),this.searchInputfocus=!0,this.$nextTick((function(){var e;null===(e=t.$refs.searchInput)||void 0===e||e.focus()}))},clickMiniFoldersOpen:function(){this.$emit("clickMiniFoldersOpen",!this.miniFoldersOpen)}},computed:{totalCount:function(){var t,e,n,r,i=null!==(t=null===(e=this.cloudSubFolders)||void 0===e?void 0:e.length)&&void 0!==t?t:0,a=null!==(n=null===(r=this.cloudSubFiles)||void 0===r?void 0:r.length)&&void 0!==n?n:0;return"(".concat(i+a,")")},lazyMiniRenderList:function(){var t=this.miniRenderList,e=this.lazyMiniStartIndex,n=this.lazyMiniLength;return t.slice(e,e+n)},lazyMiniStartIndex:function(){var t=this.miniRenderList,e=this.miniListOpt,n=e.scrollTop,r=e.itemHeight,i=e.boxHeight,a=t.length-Math.floor(i/r);return Math.max(0,Math.min(a,Math.floor(n/r)-1))},lazyMiniLength:function(){var t=this.miniRenderList,e=this.lazyMiniStartIndex,n=this.miniListOpt,r=n.boxHeight,i=n.itemHeight;return Math.min(t.length-e,Math.ceil(r/i)+2)},miniFrontMarginTop:function(){return this.lazyMiniStartIndex*this.miniListOpt.itemHeight+"px"},miniBoxRealHeight:function(){return this.miniListOpt.itemHeight*this.miniRenderList.length+"px"},useMiniList:function(){return 0!==this.renderDocumentArtboards.length},miniRenderList:function(){var t=this.cloudSubFolders,e=this.cloudSubFiles,n=this.hasSearchText,r=this.searchText,i=[];return r=n?r.toLowerCase():null,t&&t.forEach((function(t){var e,a;n&&-1==(null!==(e=null===(a=t.name)||void 0===a?void 0:a.toLowerCase())&&void 0!==e?e:"").indexOf(r)||i.push({isFolder:!0,item:t,key:"ml_folder_".concat(t.id)})})),e&&e.forEach((function(t){var e,a,o;n&&-1==(null!==(e=null===(a=t.name)||void 0===a?void 0:a.toLowerCase())&&void 0!==e?e:"").indexOf(r)||i.push({isFile:!0,item:t,key:"ml_file_".concat(null!==(o=t.id)&&void 0!==o?o:t.viewUrl)})})),i},inSearchMode:function(){return this.searchInputfocus||this.hasSearchText},hasSearchText:function(){return Object(l["h"])(this.searchText)}},watch:{"miniListOpt.mousewheelTimes":function(t){var e=this;clearTimeout(this.miniListOpt.mousewheelHandle),t&&(this.miniListOpt.mousewheelHandle=setTimeout((function(){e.miniListOpt.mousewheelTimes=!1}),200))},miniFoldersOpen:function(t){var e=this;t||(this.searchText=""),this.$nextTick((function(){e.resize()}))}},props:{isSupportNetDiskFile:Boolean,miniFoldersOpen:Boolean},data:function(){return{searchHandle:0,fileContextMenuData:{visible:!1,x:0,y:0,file:null},searchText:"",searchInputfocus:!1,miniListOpt:{scrollTop:0,boxHeight:0,mousewheelTimes:0,mousewheelHandle:0,itemHeight:68}}},beforeDestroy:function(){clearTimeout(this.searchHandle),clearTimeout(this.miniListOpt.mousewheelHandle),window.removeEventListener("resize",this.resize)},created:function(){window.addEventListener("resize",this.resize)},mounted:function(){var t=this;this.$nextTick((function(){t.resize()}))}},cs=ss,ls=(n("32f4"),Object(qe["a"])(cs,Yo,Xo,!1,null,"55634383",null)),us=ls.exports,ds={components:{FolderNavMini:us,FolderNavMax:Go},methods:{clickSubFoldersOpen:function(){this.subFoldersOpen=!this.subFoldersOpen,Object(c["setLocalStorage"])("subfolderopen",this.subFoldersOpen?"1":"0")},clickSubFilesOpen:function(){this.subFilesOpen=!this.subFilesOpen,Object(c["setLocalStorage"])("subFilesOpen",this.subFilesOpen?"1":"0")},clickMiniFoldersOpen:function(t){this.miniFoldersOpen=t}},computed:{useMiniList:function(){return 0!==this.renderDocumentArtboards.length},isSupportNetDiskFile:function(){return this.inCloudMode&&!Object(l["l"])(this.cloudVersion)},visible:function(){return this.inCloudMode&&!this.inArtboardMode&&!this.cloudFolderNotFound&&(this.hasSubFolders||this.hasSubFiles)},hasSubFolders:function(){var t=this.cloudSubFolders;return t&&t.length>0},hasSubFiles:function(){var t=this.cloudSubFiles;return t&&t.length>0}},watch:{visible:function(t){t||(this.miniFoldersOpen=!1)}},data:function(){var t="0"!==Object(c["getLocalStorage"])("subfolderopen",!1),e="0"!==Object(c["getLocalStorage"])("subFilesOpen",!1),n=!1;return{subFoldersOpen:t,subFilesOpen:e,miniFoldersOpen:n}}},hs=ds,fs=(n("3009"),Object(qe["a"])(hs,oo,so,!1,null,"1b11d875",null)),ms=fs.exports,ps=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.tipVisible?n("div",{staticClass:"pop-tip-text"},[n("p",[n("span",{staticClass:"loading"}),t._v(" "+t._s(t.tipText)+" ")])]):t._e()},bs=[],vs={computed:{tipText:function(){return"正在导出切图资源中,请稍后..."},tipVisible:function(){return this.$store.state.inOutput}}},gs=vs,ws=(n("53f8"),Object(qe["a"])(gs,ps,bs,!1,null,"960b11d8",null)),xs=ws.exports,ys=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",[n("PathNav"),t.inArtboardMode?n("div",{staticClass:"view-mode"},[n("div",{staticClass:"view-mode-comment",class:{on:t.artboardInComment},domProps:{textContent:t._s("评论("+t.curArtboardCommentCount+")")},on:{click:function(e){return t.clickSetArtboardInComment(!0)}}},[t._v("评论")]),n("div",{staticClass:"view-mode-mark",class:{on:!t.artboardInComment},on:{click:function(e){return t.clickSetArtboardInComment(!1)}}},[t._v("标注")])]):n("div"),n("div",{staticClass:"set",class:{zoom:t.propertyVisible}},[t.setVisible?[n("ScaleControl",{attrs:{type:t.inArtboardMode?1:0}}),n("div",{staticClass:"line"}),t.inCloudMode?n("BtnGoInteraction"):t._e(),t.inArtboardMode?t._e():n("a",{staticClass:"btn-download",class:{on:t.inArtboardMultDownMode},attrs:{href:"javascript:;",title:"批量下载画板预览图"},on:{click:function(e){return t.setInArtboardMultDownMode(!t.inArtboardMultDownMode)}}}),n("div",{staticClass:"helper",class:{on:t.helperVisible,inright:!t.inCloudMode},on:{click:function(e){return e.target!==e.currentTarget?null:t.clickHelper(!t.helperVisible)}}},[n("Helper")],1)]:t._e(),t.curNetDiskFile&&t.fileDownloadUrl?n("a",{staticClass:"btn-download",attrs:{href:"javascript:;",title:"下载文件"},on:{click:function(e){return t.clickDownloadNetDiskFile(t.curNetDiskFile)}}}):t._e(),t.inCloudMode&&t.cloudIsLogin?n("UserNotifyButton"):t._e(),t.inCloudMode?n("UserInfo",{attrs:{setVisible:t.setVisible}}):t._e()],2),t.commentSupportTip?n("div",{staticClass:"comment-support-tip"},[n("div",{staticClass:"box"},[n("a",{staticClass:"btn-close",attrs:{href:"javascript:;"},on:{click:function(e){t.commentSupportTip=!1}}}),n("div",{staticClass:"tip"},[t._v("本地标注包无法使用评论功能")]),n("div",{staticClass:"text"},[t._v("试用标记狮私有云服务，体验画板评论功能")]),n("div",{staticClass:"img"}),n("a",{staticClass:"button light",attrs:{href:t.cloudPage,target:"_blank"}},[t._v("前往官网了解更多")])])]):t._e(),t.inCloudMode?n("UserNotify"):t._e()],1)},Cs=[],ks=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.supportInteraction?n("div",{staticClass:"go-interaction-viewer"},[t.inCloudViewerMode?n("div",{staticClass:"btn-go-interaction",attrs:{title:"在新窗口预览原型"},on:{click:t.clickGoWebInteraction}}):t._e(),n("div",{staticClass:"btn-go-interaction-mobile",class:{on:t.menuVisible},attrs:{title:"在手机上预览原型"},on:{click:t.clickShowMenu}}),t.menuVisible?n("div",{staticClass:"box"},[n("div",{staticClass:"img"},[t.qrcodeImage?n("img",{attrs:{src:t.qrcodeImage}}):t._e()]),n("div",{staticClass:"text"},[t._v("扫描二维码在手机上预览原型"),n("div",{staticClass:"btn-question",attrs:{title:"了解更多"},on:{click:t.clickInteractionViewLink}})])]):t._e()]):t._e()},Ss=[],_s=function(){function t(t){this.mode=n.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,r=this.data.length;e<r;e++){var i=[],a=this.data.charCodeAt(e);a>65536?(i[0]=240|(1835008&a)>>>18,i[1]=128|(258048&a)>>>12,i[2]=128|(4032&a)>>>6,i[3]=128|63&a):a>2048?(i[0]=224|(61440&a)>>>12,i[1]=128|(4032&a)>>>6,i[2]=128|63&a):a>128?(i[0]=192|(1984&a)>>>6,i[1]=128|63&a):i[0]=a,this.parsedData.push(i)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function e(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}t.prototype={getLength:function(){return this.parsedData.length},write:function(t){for(var e=0,n=this.parsedData.length;e<n;e++)t.put(this.parsedData[e],8)}},e.prototype={addData:function(e){var n=new t(e);this.dataList.push(n),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[r][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,n),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(t,e){for(var n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(var r=-1;r<=7;r++)e+r<=-1||this.moduleCount<=e+r||(this.modules[t+n][e+r]=0<=n&&n<=6&&(0==r||6==r)||0<=r&&r<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=r&&r<=4)},getBestMaskPattern:function(){for(var t=0,e=0,n=0;n<8;n++){this.makeImpl(!0,n);var r=a.getLostPoint(this);(0==n||t>r)&&(t=r,e=n)}return e},createMovieClip:function(t,e,n){var r=t.createEmptyMovieClip(e,n),i=1;this.make();for(var a=0;a<this.modules.length;a++)for(var o=a*i,s=0;s<this.modules[a].length;s++){var c=s*i,l=this.modules[a][s];l&&(r.beginFill(0,100),r.moveTo(c,o),r.lineTo(c+i,o),r.lineTo(c+i,o+i),r.lineTo(c,o+i),r.endFill())}return r},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=a.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var r=t[e],i=t[n];if(null==this.modules[r][i])for(var o=-2;o<=2;o++)for(var s=-2;s<=2;s++)this.modules[r+o][i+s]=-2==o||2==o||-2==s||2==s||0==o&&0==s}},setupTypeNumber:function(t){for(var e=a.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var r=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=r}for(var i=0;i<18;i++){var o=!t&&1==(e>>i&1);this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=o}},setupTypeInfo:function(t,e){for(var n=this.errorCorrectLevel<<3|e,r=a.getBCHTypeInfo(n),i=0;i<15;i++){var o=!t&&1==(r>>i&1);i<6?this.modules[i][8]=o:i<8?this.modules[i+1][8]=o:this.modules[this.moduleCount-15+i][8]=o}for(var s=0;s<15;s++){var c=!t&&1==(r>>s&1);s<8?this.modules[8][this.moduleCount-s-1]=c:s<9?this.modules[8][15-s-1+1]=c:this.modules[8][15-s-1]=c}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var n=-1,r=this.moduleCount-1,i=7,o=0,s=this.moduleCount-1;s>0;s-=2){6==s&&s--;while(1){for(var c=0;c<2;c++)if(null==this.modules[r][s-c]){var l=!1;o<t.length&&(l=1==(t[o]>>>i&1));var u=a.getMask(e,r,s-c);u&&(l=!l),this.modules[r][s-c]=l,i--,-1==i&&(o++,i=7)}if(r+=n,r<0||this.moduleCount<=r){r-=n,n=-n;break}}}}},e.PAD0=236,e.PAD1=17,e.createData=function(t,n,r){for(var i=d.getRSBlocks(t,n),o=new h,s=0;s<r.length;s++){var c=r[s];o.put(c.mode,4),o.put(c.getLength(),a.getLengthInBits(c.mode,t)),c.write(o)}for(var l=0,u=0;u<i.length;u++)l+=i[u].dataCount;if(o.getLengthInBits()>8*l)throw new Error("code length overflow. ("+o.getLengthInBits()+">"+8*l+")");o.getLengthInBits()+4<=8*l&&o.put(0,4);while(o.getLengthInBits()%8!=0)o.putBit(!1);while(1){if(o.getLengthInBits()>=8*l)break;if(o.put(e.PAD0,8),o.getLengthInBits()>=8*l)break;o.put(e.PAD1,8)}return e.createBytes(o,i)},e.createBytes=function(t,e){for(var n=0,r=0,i=0,o=new Array(e.length),s=new Array(e.length),c=0;c<e.length;c++){var l=e[c].dataCount,d=e[c].totalCount-l;r=Math.max(r,l),i=Math.max(i,d),o[c]=new Array(l);for(var h=0;h<o[c].length;h++)o[c][h]=255&t.buffer[h+n];n+=l;var f=a.getErrorCorrectPolynomial(d),m=new u(o[c],f.getLength()-1),p=m.mod(f);s[c]=new Array(f.getLength()-1);for(var b=0;b<s[c].length;b++){var v=b+p.getLength()-s[c].length;s[c][b]=v>=0?p.get(v):0}}for(var g=0,w=0;w<e.length;w++)g+=e[w].totalCount;for(var x=new Array(g),y=0,C=0;C<r;C++)for(var k=0;k<e.length;k++)C<o[k].length&&(x[y++]=o[k][C]);for(var S=0;S<i;S++)for(var _=0;_<e.length;_++)S<s[_].length&&(x[y++]=s[_][S]);return x};for(var n={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},r={L:1,M:0,Q:3,H:2},i={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},a={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){var e=t<<10;while(a.getBCHDigit(e)-a.getBCHDigit(a.G15)>=0)e^=a.G15<<a.getBCHDigit(e)-a.getBCHDigit(a.G15);return(t<<10|e)^a.G15_MASK},getBCHTypeNumber:function(t){var e=t<<12;while(a.getBCHDigit(e)-a.getBCHDigit(a.G18)>=0)e^=a.G18<<a.getBCHDigit(e)-a.getBCHDigit(a.G18);return t<<12|e},getBCHDigit:function(t){var e=0;while(0!=t)e++,t>>>=1;return e},getPatternPosition:function(t){return a.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case i.PATTERN000:return(e+n)%2==0;case i.PATTERN001:return e%2==0;case i.PATTERN010:return n%3==0;case i.PATTERN011:return(e+n)%3==0;case i.PATTERN100:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case i.PATTERN101:return e*n%2+e*n%3==0;case i.PATTERN110:return(e*n%2+e*n%3)%2==0;case i.PATTERN111:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new u([1],0),n=0;n<t;n++)e=e.multiply(new u([1,o.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case n.MODE_NUMBER:return 10;case n.MODE_ALPHA_NUM:return 9;case n.MODE_8BIT_BYTE:return 8;case n.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case n.MODE_NUMBER:return 12;case n.MODE_ALPHA_NUM:return 11;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case n.MODE_NUMBER:return 14;case n.MODE_ALPHA_NUM:return 13;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,r=0;r<e;r++)for(var i=0;i<e;i++){for(var a=0,o=t.isDark(r,i),s=-1;s<=1;s++)if(!(r+s<0||e<=r+s))for(var c=-1;c<=1;c++)i+c<0||e<=i+c||0==s&&0==c||o==t.isDark(r+s,i+c)&&a++;a>5&&(n+=3+a-5)}for(var l=0;l<e-1;l++)for(var u=0;u<e-1;u++){var d=0;t.isDark(l,u)&&d++,t.isDark(l+1,u)&&d++,t.isDark(l,u+1)&&d++,t.isDark(l+1,u+1)&&d++,0!=d&&4!=d||(n+=3)}for(var h=0;h<e;h++)for(var f=0;f<e-6;f++)t.isDark(h,f)&&!t.isDark(h,f+1)&&t.isDark(h,f+2)&&t.isDark(h,f+3)&&t.isDark(h,f+4)&&!t.isDark(h,f+5)&&t.isDark(h,f+6)&&(n+=40);for(var m=0;m<e;m++)for(var p=0;p<e-6;p++)t.isDark(p,m)&&!t.isDark(p+1,m)&&t.isDark(p+2,m)&&t.isDark(p+3,m)&&t.isDark(p+4,m)&&!t.isDark(p+5,m)&&t.isDark(p+6,m)&&(n+=40);for(var b=0,v=0;v<e;v++)for(var g=0;g<e;g++)t.isDark(g,v)&&b++;var w=Math.abs(100*b/e/e-50)/5;return n+=10*w,n}},o={glog:function(t){if(t<1)throw new Error("glog("+t+")");return o.LOG_TABLE[t]},gexp:function(t){while(t<0)t+=255;while(t>=256)t-=255;return o.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},s=0;s<8;s++)o.EXP_TABLE[s]=1<<s;for(var c=8;c<256;c++)o.EXP_TABLE[c]=o.EXP_TABLE[c-4]^o.EXP_TABLE[c-5]^o.EXP_TABLE[c-6]^o.EXP_TABLE[c-8];for(var l=0;l<255;l++)o.LOG_TABLE[o.EXP_TABLE[l]]=l;function u(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);var n=0;while(n<t.length&&0==t[n])n++;this.num=new Array(t.length-n+e);for(var r=0;r<t.length-n;r++)this.num[r]=t[r+n]}function d(t,e){this.totalCount=t,this.dataCount=e}function h(){this.buffer=[],this.length=0}u.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var r=0;r<t.getLength();r++)e[n+r]^=o.gexp(o.glog(this.get(n))+o.glog(t.get(r)));return new u(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=o.glog(this.get(0))-o.glog(t.get(0)),n=new Array(this.getLength()),r=0;r<this.getLength();r++)n[r]=this.get(r);for(var i=0;i<t.getLength();i++)n[i]^=o.gexp(o.glog(t.get(i))+e);return new u(n,0).mod(t)}},d.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],d.getRSBlocks=function(t,e){var n=d.getRsBlockTable(t,e);if(void 0==n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var r=n.length/3,i=[],a=0;a<r;a++)for(var o=n[3*a+0],s=n[3*a+1],c=n[3*a+2],l=0;l<o;l++)i.push(new d(s,c));return i},d.getRsBlockTable=function(t,e){switch(e){case r.L:return d.RS_BLOCK_TABLE[4*(t-1)+0];case r.M:return d.RS_BLOCK_TABLE[4*(t-1)+1];case r.Q:return d.RS_BLOCK_TABLE[4*(t-1)+2];case r.H:return d.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},h.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var f=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function m(){var t=!1,e=navigator.userAgent;if(/android/i.test(e)){t=!0;var n=e.toString().match(/android ([0-9](?:\.[0-9])?)/i);n&&n[1]&&(t=parseFloat(n[1]))}return t}var p=function(){function t(){return this._elCanvas.toDataURL("image/png")}if(this._android&&this._android<=2.1){var e=1/window.devicePixelRatio,n=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(t,r,i,a,o,s,c,l){if("nodeName"in t&&/img/i.test(t.nodeName))for(var u=arguments.length-1;u>=1;u--)arguments[u]=arguments[u]*e;else"undefined"==typeof l&&(arguments[1]*=e,arguments[2]*=e,arguments[3]*=e,arguments[4]*=e);n.apply(this,arguments)}}var r=function(t){this._bIsPainted=!1,this._android=m(),this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._bSupportDataURI=null};return r.prototype.draw=function(t){var e=this._oContext,n=this._htOption,r=3,i=t.getModuleCount(),a=(n.width-2*r)/i,o=(n.height-2*r)/i,s=Math.round(a),c=Math.round(o);this.clear(),e.fillStyle=n.colorLight,e.fillRect(0,0,n.width,r),e.fillRect(0,n.height-r,n.width,r),e.fillRect(0,0,r,n.height),e.fillRect(n.width-r,0,r,n.height);for(var l=0;l<i;l++)for(var u=0;u<i;u++){var d=t.isDark(l,u),h=u*a+r,f=l*o+r;e.strokeStyle=d?n.colorDark:n.colorLight,e.lineWidth=1,e.fillStyle=d?n.colorDark:n.colorLight,e.fillRect(h,f,a,o),e.strokeRect(Math.floor(h)+.5,Math.floor(f)+.5,s,c),e.strokeRect(Math.ceil(h)-.5,Math.ceil(f)-.5,s,c)}var m=n.icon;if(m&&m.complete){var p=m.naturalWidth||m.width,b=p,v=.1578*n.width,g=v;e.drawImage(m,0,0,p,b,(n.width-v)/2,(n.height-g)/2,v,g)}this._bIsPainted=!0},r.prototype.makeImage=function(){if(this._bIsPainted)return t.call(this)},r.prototype.isPainted=function(){return this._bIsPainted},r.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},r.prototype.round=function(t){return t?Math.floor(1e3*t)/1e3:t},r}.call(window);function b(t,e){for(var n=1,i=v(t),a=0,o=f.length;a<=o;a++){var s=0;switch(e){case r.L:s=f[a][0];break;case r.M:s=f[a][1];break;case r.Q:s=f[a][2];break;case r.H:s=f[a][3];break}if(i<=s)break;n++}if(n>f.length)throw new Error("Too long data");return n}function v(t){var e=encodeURI(t).toString().replace(/%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)}var g=function(t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:r.H,icon:null},"string"===typeof t&&(t={text:t}),t)for(var e in t)this._htOption[e]=t[e];this._android=m(),this._oQRCode=null,this._oDrawing=new p(this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)};return g.prototype.makeCode=function(t){this._oQRCode=new e(b(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._oDrawing.draw(this._oQRCode);var n=this.makeImage();return this._oDrawing.clear(),n},g.prototype.makeImage=function(){if("function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3))return this._oDrawing.makeImage()},g.prototype.clear=function(){this._oDrawing.clear()},g.CorrectLevel=r,g}(),As=new _s({width:256,height:256,colorDark:"#000000",colorLight:"#ffffff",correctLevel:_s.CorrectLevel.Q}),Is=function(t){try{return As.makeCode(t)}catch(e){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAMFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABaPxwLAAAAD3RSTlMAu0R3Ee4iZjPdmcxViKrphPWWAAARlUlEQVR42u2dZ4gzRRjHx9ya5M6cd2svaNa1F0y82FtiBRW7WEDJ2kAseFYQ0Yv9g6gnCoIIsQsiREVB8ENEsYLeiVhRFAvipzN3xpic+nd2Zqdsibcppyj5w5tstsz+duaZ2WfmmbmXjDTSSCONNNJII43Uu0rk39Lr/Ou6Zyok/TSJq8T95iZDAqg9YLlfRbQz9T9CRw25EQAAvh8SQBnstlk8mAKc0JNi1XRVbog96f3ZF2CRoSgNLPIEZynEo3znuPlRwZU5n4AnmTlj+NEZJsAkmiX2pG1CcljmO6fg6WcJsEI8TdDtfgDStq2VrG0Lqx9Hiz9Xy91e6QZAD8sLkO8HYAPoUpffh3n3ayP3a+x0JwiQvHo3fvUy8XQlzbJhAtQwyznoYxklUc52ZQyrNNfcZ2V8CqBIs2mIAEa54XG8YHJtLoq6Q5Sm8LPYrOOMYQKk6KNlLGJASdpGJEASyEuAhG3bVj9GmJRGOI5pskHj+jEoCdv4lZ+6k/uZw/OyFvpFrx9Ic7Dovf44Bg3T3BoNVQRFzIsbViiAvM/40ACUCdTwTdHN4jH3QxX1ogfQZjiPCuLhAmxMTSCJ5tFlCaCK2vEAVhiAqA9Vz1rBvrcdFKBGr59EawIBALrdEBstdl5e/GyWhvguoAVcBTB/XwhgXFT8MbaRFbe7mGbIEAEMr0rWQwBzmHYri+MB1GEJ03hwmABkCVSNSTRkLajneVF7aBTgF3a7kvfqwuxQAW78aDfaFI3hEUjl9drukAmWLYDImAYZKgDVcbSGzb0eALhPNkobuABpNHmR7YPfhg5QpI+ZSWDZtvdwP3Z10zXqLP0iA6BtYEI++FH5YQMY5Y7rj/iNcAIKwLXGFAW4oEKkhusR/RoGqKEsAYJNXqJhbkO9NeAJ6rKZpw8MkEM+BGAAC2GAvAcAXSsDl0C1WYrIgT+mBMDUOgNsTJMIAyy8JAE22L7AVFwfAGMJp+16eNZKyIZoW/c+4xUBIDUlWqDkAfZuwghte2ZAgIvBpD+WC5AkEQDW8GuBMLFGEICEAe5bH4AUXP1JAVYKhX3cj4NnowFy6wOQxP0fzVh+I/QAZmy7BrLjoTZVYYYCrE9D9Jr7EQnARIrC2BdABgG48GrbVk/A/OkdeWHHBSgOBpBDSLoHuuO/CpB+P9vQAXQjLO14tU31xgxZWieAC954zH1AHcBSANpNsuyFfEkY4AKnbwDp+FCAAFgYAAygCKyamltedRuOAYzQAFPz20gAXWkBEFZ+UKe08aVD1gTYGH+sCwB1Mme8/k9BiDkeJ+sAk08cVkVrXQAufk50P34OlFnB0VsJqjNYfS3Y9F2odAFtJQdqEQ2iAXRXDW5/YD218d8DLACbkHXVpPm3ndwNt9+fjDTSSCONNNL/Q3eSf1lfY5U6IfvGDTEUrq5EOTGW7Fu3Oz0Pyf1Okk+p+Oitu+gJ2ztpP7gn9hrFIAFdd6YEwK89A/xMr4Klfvu0rHrNjxExPLnRQ/649mX4UwH83AdAEni+C8Av8v415EVnJBcYB5qg+dI3QM69ooiW+h3dXTXqOFsAZPGK3wRY2Cxrmt8VDnKd+Q/NrVd6AzgGHfW7YUrVtee5A6slDpBgW1TasYaLpalHgImO4/vt/yEDI7McYCOcEY5y5PsAUOG/pEPWBCBb7+sVQRGhqlinxnKNbTvcBhIxxuqmTDq866rIemD7mOZpfwdQoONCbFgAq7Zd7tAR9ELBl4+NSo9GOIWglv8OABHy1QPLbY0UwAXxw7ZhAF2xAFR38VRzc9eGy8DQAZpmQOUIAKk4ACLpSXbnhL3X/pEAv8nBkICyA+fAzyoI6Em1A0pbGWsAeGV/e482oAAyQYCAGb8tABJE6ciSBpBQRaXSjQ+QYG3Gvl0BfrA4gN9qSBjgWH+6F8UFMFyAZHP/LgBptK04ANOu8bxgchsws9SmYwAo+8oA30cD3A04kQAfmpLxu0KRAyjFBUjbr5HsKmvLZyVAx5GjPTvuA/6asncTyJE1YKoPAFnPa3B/NdSUnIA8Z2dNgAtt29LGHPePC8BeLSfjt64t1GxMgB6lABYwS//Ny1r9FHzahKwXwM+sGXye5vmjtBgW1aFbC1SH2q4s/QrVQpWjAY4wpaZjAfAo8IZ43iijEp5Jmb7a6vb2iAaYCnty3TWOeQ5A//2S8re0uRdMHjrFuWonBdVUGhiAXuIBjKG1AVr+Y7+JCVJdm49ogGl1VnyANP7M4ZQokwKs9QM4mZ28kTsZqYqsqGtOFIATH+BFm2nPGAA5fMMuybOuSFv2Sk5lLfmpKgJS9RJ73dEBjrQHtYEF5AUAbftaEqBrJAt+NUIA6d4AigpgApgeAsBB9POBAtNBMQCWYIm5EmOA5SuCul4E9ZgAKcz2ZIRllPYuHMamhdwBag9cjiiesBECetIKIOEBzOHBWADKz2BNW7NE0mXgd1rr9WDIa6FqGA1gmOUGB9gUeHLKyzlz87UBJtEhGTDru4NzJB7Vpu2VYgIkgBXRzenENUI1PbSMTsXNgDPLNO9Sf4rm9QSaVkwAaj6/Cici3xPAnNvB3fZLes/r0KwsYIXmiTf/x6jh17UAkh7ABPA8Tw6tnlpCowovx08CzmYe2bh47suA/N8D3Gof4gGM0wt5cs3XegFQNS9VRrviVsrOErVEV0eVPZLuADlZDU/m5pIp06fQADZaEyAnjCgLvMSKnYo5RfeUgUfXAJiQAxALHuwdmFUAJaO4JsDnWOaPC3RKfJCHZXxyc23WfoLuigTIAM1FPsjopZNqEQUwF8cIb5gWxpjnls+qIquTbSsKwCgUJIDR+E7M5hS+ZIXlKwfYKM7EXsNzwSZOEwOmPFPT5WaeKADlKWoz2pUM5TNrACmgGTt4nCyJu2X5ze6+lkiAQmE25JCYWxGllJttSreYiwyrvc0/FVSdoNn2r2pD2pz9q3rXtMhII4000v9cSStyr0P+KaVx/yba2E1FOHSrZD10OwkLmNdd6T/lWrDha8efWpEAed3h+F5Odx2ujF0PrwPtSABLB7B0gIzYfwSNF0rtE/sNafBlljsWPtzWNwswsRsv8Nc4gGZw9/kBrtwiOv4UFyCBoH7zD2FyAL0T7geo4dtBAAKRzgZdVPtEHIAEzG3p2fVpdxRvMIA5cNWxIpYahgHaYQCu6Y1kAHdKrxU9AJxPbedQuxKMEEzw9RPm86oXnC5FABRpn2oAACUOEFamwAOlhcO3hpYDSdtxbcDepdysrC/AGIRYw5cqvJ7DTGFRGOFGtDP7jwE01M9pAVBE3g9w4YztrBfAH2GABDrED3AlYPUIcKTtSACDRseDNnC1XeLzFVbCABfjJR2Afa72WgQ5rLU+yFAAyZ1cIzyyclPh9R2xbNebr9tvFL7yAawMBeByr024dS/2rH8IADW9XlPDB7A8FAC1U4RVE1heJ4ALCzM2VZHmqDslYiYMkHEBUgEAOn6b5fGjchhg8FqgAMQC3zEdoKTW54eM8NehAFxgOwZQ4jZA7+0HOGqRtdaUKwLg52E1RBlZxzcOALxRXvQyYF0BJvC7HqGhq3y9G3ntwEnUMsIA9w0PYEPMy62fGYUKKz/PxvQet11dU9ABcpjuCeBI29IBEjTBQuFTFS8wvJE/CZA+BGh+wobyhBqDAOQQoRXPxh2S2sYLbQmA98TynVQ5GqCI/JAADNf9r6PEExUAc563ZdTQMPmC/+y6AHhWP4e8iJ2M4xQ+Ll1z094d1BGpNUshI8zC6gngFubMHyBbQmYDM15Y2fug+eCoIOuLbkN0ItyB8XInVAsMYFgOSc6t5Sm3rUmiTQTA5AqhAKkqVh2Swa8hgBRWhwWQbYq/RDGGjgQYs+jGTlngSRZyDgGMY4WewzpzgwDIN+DhZVg00d85gGyK53AWszfWF3tW9pgoQJHmytyfDrFtZ0CAE3DGkftw52eBmV9OA0jRW9CS4erIt+r+buxrOgMedxoMwFjCq2IiThWL7PiiBOBRzJqqMwobVqYMbDEwwHFw1X7mCnQmAIfHdxUA05ubut1g/OabV/sHi4A18wMAKGd4UxpPbM/O0WeMBCjx2OfPvgx4ySUDGs6gRUDTYEELK8UTJUUdQGkjrSqkqzx0kay7PdYBjbB2niOiOLzzVYUVBXClFtDZjzZPIpJJ62mPmvMDfFCSAcyWu5j+IMCJAigqr2QHoF0RiWGVbsZWcjeSqFKAsMbKwCxfi99mZ5Lk1zqAURZc5FIAm4nCKIM2FT2o2iXUnKEHWp5N0m+v8otnu+Zq+yA5VneV13mTGYfFnvKf6pSIaIyYxlYVkdQlbRgrpzUD17ndZ0uvkM1KT3Gn0NJNke7Znik+IFF/942iPOjF7gKV/3h6YTwJs218FnXAeIEb494HSqt/2FF+s2ZrXzf9C0SeqvQCkJjZJeYfBxx7iyjh1E3VspLAApU0GWmkkUYaaaT/sozXyL+qC7Oh9ZKT73gbl5dIbyo2zV4fJxkxYj0FLIr0YngaGmWuj1lGtXBU+GTh4i1pEYI0HdjQaAw6Yibc8uZ2quMQdnZ3i4hP+zob0vENP0dVCyMnEJIlTj9D5V0YAFQvmEr1gE++gXCBlRbwi5y4Fgtgeg0AvwIAKSBohUUvxYweQjQQUskrscEACB5wQlOw87w2+EwK7YJPVYi7DggwE+46eVYx7uVN9Oq7bEwANxbpqOCC+BtEYwiuJ6wCeTZ2fyya7nooh9rn6QWqg7cZCCAy1MgAwsrro5mWDNU0dIDbuwAcZxacoQCcrEysDq6ODrDEJpceZgUA6OcfQ8kBFZgnaXhaEQCZEqFUefb40zoAjzP0BJC07V04h9ihbMWmAmgl+MPd2kMCpKp5kRH1pjMgAImeniPToADH8EowJgEm6Y4Efk/RFwXN764AF+zVE0CjK0CRL4LYWAIY1Qa9YL7uYvzmASRmdqIAR+4oAJi6AhihwaSJ7gBGmS962EDZwAKsDfBo8U+KcQoF0G0pHsAJoYEMmno3gEm0iR+Abj4/hdfGGUY/AEYdrfgAObS8U5YFQBKthSbN/+mT8Vo0gBte7Q6QUdPoFUDb5No8HwBI1+eDAOTrdq1D6+DyXJMIALNQxAOHbavXgmQ3AHc4q1EKjBdJBQHI8bOGFQA4hs08yq0uUYx+qqFRA14K7JWyggBGsuaOpY1LAJbh8/ReFKMvAJaA3w6vjADw5I5YttgOBUBrRp75Js/3CUDm4B9RywmnC6gEAShu2w9AjYCdVsdsvwAplgVh5ycNBAuFOQavBQCyyLOrSH8AIgvCzk9CAKh3AbvRvA7ATjtjoBwIWUGZuZ08t4NG6Bp9i+2QABuAza/o3waoavpqkIz6y+yNCIAJtEs+gByWKOg4sNw/wAZ8kQ0Vv4O3EQmQdluHnAZQb5xMs6zYXGr0D2DUF/U+UIcIrBAAVbXj6AApLE+4S5ZXroTTNwC5S68EYicNgkYBfOEQHeAYTCexPIkz3JWzw3BIkmXMi6NhAC4dwI2fvJzPIZ/CGX6Am/sD2BjIixbx97UBEq4Z7GRU28RAywdwQ6M/gDm5aCiH5bUBjmM+2oR7am1VBzgH/QGkyzLjFxSAbIhUY+kB1Nz84p7am/t6AJ4j3+4L4Dh98e/PwaY4DLBfu0SpWa4dLathmkW9t+wNQMWaHNEkxwEwvmXL9c7Ve0Y7AGymTT8Ad6uQVBo4pRtAVgL4h2SykPm/b1/VMFX26sBtV9sf08KIMsJjCbnXO5QM+s9leBGw9iztYu+iAdjXxwFIZoGO1ktbFCYlACreIQ8z4QO4iFzBETPs/gQ+LccB2BnSQ82CyvHXOs9DqnuHFIDypJrMkGgAMR7AyUEHfD90tNRaJBJgQR5S70sv572lD/uSmAC5IEC6LHJ9I5qYJcPiJity77+5GQcaVhiA9ZxPI0rA/abQ1jEByBuyg3gqXQ4drY1PfcIRU34P8Jlgc1OHKDlE19HRU+l2I0PUrWSkkUYaaaSRRhpppJFi6C8fDRp5d6pE1AAAAABJRU5ErkJggg=="}},Ts={methods:{clickInteractionViewLink:function(){var t=window.open("https://ui.marklion.cn/article/tools/marklion-interaction-mobile-view-intro.shtml");t.opener=null},clickGoWebInteraction:function(){var t=window.open(this.interactionUrl);t.opener=null},clickShowMenu:function(){var t=this,e=!this.menuVisible;e&&(this.url=this.interactionUrl),setTimeout((function(){t.menuVisible=e}),0)},hideMenu:function(){var t=this;clearTimeout(this.menuHandler),this.menuHandler=setTimeout((function(){t.menuVisible=!1}),50)}},watch:{url:function(t){t&&(this.qrcodeImage=Is(t))},menuVisible:function(t){t?window.addEventListener("click",this.hideMenu,!1):window.removeEventListener("click",this.hideMenu,!1)}},computed:{supportInteraction:function(){return!Object(l["k"])(this.cloudVersion)},interactionUrl:function(){return this.getCurrentInteractionUrl()}},data:function(){return{qrcodeImage:null,url:"",menuVisible:!1,menuHandler:0}},beforeDestroy:function(){clearTimeout(this.menuHandler),window.removeEventListener("click",this.hideMenu,!1)},created:function(){l["a"]&&(window.vue_BtnGoInteraction=this)}},Os=Ts,Es=(n("078d"),Object(qe["a"])(Os,ks,Ss,!1,null,"45113f38",null)),Ms=Es.exports,Ls=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{staticClass:"pop-helper",on:{click:function(e){t.notClickClose=!0}}},[n("div",{staticClass:"box"},[t.inInteractionMode?n("div",{staticClass:"scene"},[n("h5",[t._v("原型预览快捷键")]),t._m(0),t._m(1),t._m(2),n("dl",{staticClass:"text"},[n("dt",[t._v("切换到上1个画板")]),n("dd",[n("span",{staticClass:"key"},[t._v(t._s(t.commandKey))]),n("span",[t._v("+")]),n("span",{staticClass:"key"},[t._v("↑")])])]),n("dl",{staticClass:"text"},[n("dt",[t._v("切换到下1个画板")]),n("dd",[n("span",{staticClass:"key"},[t._v(t._s(t.commandKey))]),n("span",[t._v("+")]),n("span",{staticClass:"key"},[t._v("↓")])])])]):n("div",{staticClass:"scene"},[n("h5",[t._v("场景快捷键")]),t._m(3),t._m(4),n("dl",{staticClass:"text"},[n("dt",[t._v("缩放视图")]),n("dd",[n("span",{staticClass:"key"},[t._v("鼠标滚轮")]),n("span",[t._v("+")]),n("span",{staticClass:"key"},[t._v(t._s(t.commandKey))])])]),t._m(5),n("h5",[t._v("画板详情快捷键")]),t._m(6),t._m(7),t._m(8),n("dl",{staticClass:"text"},[n("dt",[t._v("切换到上1个画板")]),n("dd",[n("span",{staticClass:"key"},[t._v(t._s(t.commandKey))]),n("span",[t._v("+")]),n("span",{staticClass:"key"},[t._v("↑")])])]),n("dl",{staticClass:"text"},[n("dt",[t._v("切换到下1个画板")]),n("dd",[n("span",{staticClass:"key"},[t._v(t._s(t.commandKey))]),n("span",[t._v("+")]),n("span",{staticClass:"key"},[t._v("↓")])])]),n("h5",[t._v("获取指定2个节点坐标关系")]),n("div",{staticClass:"text"},[t._v("1.左键单击选择1个节点.")]),t._m(9),n("div",{staticClass:"text"},[t._v("*多次单击可穿透选中下方被遮挡节点")])]),n("div",{staticClass:"home"},[n("b",[t._v("@标记狮")]),t._v(" "),n("a",{attrs:{href:t.homepage,target:"_blank"}},[t._v("www.marklion.cn")])])])]):t._e()},Ns=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"text"},[n("dt",[t._v("屏幕全屏切换")]),n("dd",[n("span",{staticClass:"key"},[t._v("F1")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"text"},[n("dt",[t._v("网页全屏切换")]),n("dd",[n("span",{staticClass:"key"},[t._v("F2")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"text"},[n("dt",[t._v("显隐左侧边栏")]),n("dd",[n("span",{staticClass:"key"},[t._v("F3")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"text"},[n("dt",[t._v("上下视图平移")]),n("dd",[n("span",{staticClass:"key"},[t._v("鼠标滚轮")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"text"},[n("dt",[t._v("左右视图平移")]),n("dd",[n("span",{staticClass:"key"},[t._v("鼠标滚轮")]),n("span",[t._v("+")]),n("span",{staticClass:"key"},[t._v("shift")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text"},[n("span",[t._v("缩放/平移视图时同时按下")]),n("span",{staticClass:"key"},[t._v("alt")]),n("span",[t._v("键可加速操作")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"text"},[n("dt",[t._v("切换到画板列表")]),n("dd",[n("span",{staticClass:"key"},[t._v("F1")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"text"},[n("dt",[t._v("切换到图层列表")]),n("dd",[n("span",{staticClass:"key"},[t._v("F2")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"text"},[n("dt",[t._v("显隐左侧边栏")]),n("dd",[n("span",{staticClass:"key"},[t._v("F3")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text"},[n("span",[t._v("2.按住")]),n("span",{staticClass:"key"},[t._v("shift")]),n("span",[t._v(",左键单击需要比对的节点.")])])}],Ds={methods:{clickHelper:function(t){this.$store.commit("setHelperVisible",t)},closeSelf:function(){var t=this;clearTimeout(this.closeHandle),this.closeHandle=setTimeout((function(){t.notClickClose?t.notClickClose=!1:t.clickHelper(!1)}),50)}},computed:{homepage:function(){var t;return this.curArtboard&&(t=this.curArtboard.artboard.mlConfig.softVersion),t||(t=this.$store.state.config.softVer),"https://www.marklion.cn/?invoke=MarkLion.Output".concat(Object(l["h"])(t)?"&ver=".concat(t):"")},commandKey:function(){return this.inMacOS?"command":"ctrl"},visible:function(){return this.$store.state.helper.visible}},data:function(){return{closeHandle:0,notClickClose:!1}},watch:{visible:function(t){t?window.addEventListener("click",this.closeSelf,!0):(this.notClickClose=!1,clearTimeout(this.closeHandle),window.removeEventListener("click",this.closeSelf,!0))}},beforeDestroy:function(){window.removeEventListener("click",this.closeSelf,!0),clearTimeout(this.closeHandle)}},Fs=Ds,Ps=(n("7851"),Object(qe["a"])(Fs,Ls,Ns,!1,null,"f69564b6",null)),js=Ps.exports,Rs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"path-nav"},[t.inCloudMode?n("CloudFolders"):t._e(),n("div",{staticClass:"navs"},t._l(t.navs,(function(e,r){return n("div",{key:r,staticClass:"nav-item",class:{"no-link":!e.link}},[n("div",{staticClass:"name",attrs:{title:e.name},on:{click:function(n){return t.clickNav(e)}}},[t._v(t._s(e.name))]),t.showArtboardPages&&e.selectPages?n("PathNavArtboardPages"):t._e()],1)})),0)],1)},Bs=[],Vs=(n("5208"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cloud-folders"},[n("div",{staticClass:"nav-home"},[n("div",{staticClass:"btn-home",on:{click:function(e){return t.clickGoHome()}}}),n("div",{staticClass:"line"}),n("div",{staticClass:"btn-cloud-folders",class:{on:t.allFoldersBoxVisible},on:{click:function(e){return t.setAllFoldersBoxVisible(!t.allFoldersBoxVisible,!0)}}})]),n("CloudFoldersBox",{on:{hideBox:t.hideBox}})],1)}),Us=[],$s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.allFoldersBoxVisible,expression:"allFoldersBoxVisible"}],staticClass:"cloud-folders-box",class:{"search-tip":!t.isSupportWebItemSearch},on:{click:function(e){t.notAutoHideThisTime=!0}}},[n("div",{staticClass:"head"},[t.isSupportWebItemSearch?t._e():n("div",{staticClass:"update-tip"},[n("a",{attrs:{target:"_blank",href:t.cloudPageUrl}},[t._v("升级私有云部署包")]),t._v("可全局搜索画板、文件")]),n("div",{staticClass:"search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],attrs:{autocomplete:"off",type:"text",placeholder:t.searchInputDefaultText,maxlength:"20",spellcheck:"false"},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),t.inSearchMode?n("a",{staticClass:"btn-clear",attrs:{href:"javascript:;"},on:{click:t.cleanSearchText}}):t._e()])]),n("div",{ref:"box",staticClass:"box",on:{scroll:t.onBoxScroll}},[n("div",{staticClass:"real-height",class:{"in-search":t.inSearchMode},style:{height:t.boxRealHeight}},[t.fetchState===t.FetchState.Fetching||t.fetchState===t.FetchState.Error?n("div",{staticClass:"error"},[n("NetworkLoading",{attrs:{loadText:"正在获取文件夹信息...",errorText:t.errorText,isLoading:t.fetchState===t.FetchState.Fetching,isError:t.fetchState===t.FetchState.Error,reLoadText:"刷新"},on:{reload:function(e){return t.clickReload()}}})],1):t.isSupportWebItemSearch&&t.inSearchMode&&(t.searchState===t.FetchState.Fetching||t.searchState===t.FetchState.Error)?n("div",{staticClass:"error"},[n("NetworkLoading",{attrs:{loadText:"正在搜索关键词 "+t.searchText,errorText:t.searchErrorText,isLoading:t.searchState===t.FetchState.Fetching,isError:t.searchState===t.FetchState.Error,reLoadText:"刷新"},on:{reload:function(e){return t.goSearch()}}})],1):0===t.showList.length?n("div",{staticClass:"empty",domProps:{textContent:t._s(t.emptyText)}}):n("div",{staticClass:"front",style:t.frontStyle},[t._l(t.showList,(function(e){return[e.isArtboard?n("CloudArtboardItem",{key:e.key,attrs:{artboard:e.folder,searchText:t.searchText,inSearchMode:t.inSearchMode},on:{hideBoxNotClean:t.hideBoxNotClean,cleanSearchText:t.cleanSearchText,onContextMenu:t.onContextMenu,clickGoParentFolder:t.clickGoParentFolder}}):e.isFile?n("CloudFileItem",{key:e.key,attrs:{file:e.folder,searchText:t.searchText,inSearchMode:t.inSearchMode},on:{hideBoxNotClean:t.hideBoxNotClean,cleanSearchText:t.cleanSearchText,onContextMenu:t.onContextMenu,clickGoParentFolder:t.clickGoParentFolder}}):n("CloudFolderItem",{key:e.key,attrs:{folder:e.folder,inSearchMode:t.inSearchMode,searchText:t.searchText,isSupportNetDiskFile:t.isSupportNetDiskFile},on:{hideBoxNotClean:t.hideBoxNotClean,cleanSearchText:t.cleanSearchText,onContextMenu:t.onContextMenu,clickGoParentFolder:t.clickGoParentFolder}})]}))],2)])]),t.contextMenu.visible?n("CloudItemMenu",{attrs:{x:t.contextMenu.x,y:t.contextMenu.y,item:t.contextMenu.item},on:{close:t.hideContextMenu,cleanSearchText:t.cleanSearchText,clickGoParentFolder:t.clickGoParentFolder}}):t._e()],1)},Hs=[],zs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cloud-item cloud-folder-item",class:{on:t.currentSelect,open:t.folder.childsVisible&&t.hasChild,max:t.inSearchMode},attrs:{title:t.title},on:{contextmenu:function(e){return e.preventDefault(),t.onContextMenu.apply(null,arguments)}}},[n("div",{staticClass:"info",on:{click:function(e){return e.target!==e.currentTarget?null:t.clickGoFold.apply(null,arguments)}}},[n("div",{staticClass:"triangle",class:{on:!t.inSearchMode&&t.hasChild},style:t.style,attrs:{title:"展开/收起子文件夹"},on:{click:t.clickChildVisible}}),n("div",{staticClass:"icon",class:{private:1===t.folder.shareMode},on:{click:t.clickChildVisible}}),n("div",{staticClass:"name",on:{click:t.clickGoFold}},[t._l(t.texts,(function(e,r){return n("span",{key:r,class:{light:e.light}},[t._v(t._s(e.text))])})),n("span",{staticClass:"art-count"},[t._v(t._s(t.countText))])],2)]),t.inSearchMode?n("ItemFolderParents",{attrs:{item:t.folder},on:{clickItem:t.clickGoFold,clickGoParentFolder:t.clickGoParentFolder}}):t._e()],1)},Ws=[],Gs=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.showAllParents||t.showOnlyParent?n("div",{staticClass:"parents",on:{click:function(e){return e.target!==e.currentTarget?null:t.clickItem(t.item)}}},[t.showAllParents?t._l(t.item.parents,(function(e,r){return n("div",{key:r},[n("span",{on:{click:function(n){return n.target!==n.currentTarget?null:t.clickGoParentFolder({parentId:e.id})}}},[t._v(t._s(e.name))])])})):t.showOnlyParent?[t.item.parentId>0?n("span",[t._v("...")]):t._e(),n("div",[n("span",{on:{click:function(e){return t.clickGoParentFolder(t.item)}}},[t._v(t._s(t.item.parent.name))])])]:t._e()],2):t._e()},Ys=[],Xs={methods:{clickItem:function(t){this.$emit("clickItem",t)},clickGoParentFolder:function(t){this.$emit("clickGoParentFolder",t)}},computed:{showAllParents:function(){return!!this.item.parents},showOnlyParent:function(){return!this.showAllParents&&!!this.item.parent}},props:{item:Object}},Ks=Xs,Zs=(n("61df"),Object(qe["a"])(Ks,Gs,Ys,!1,null,"4e0cf502",null)),qs=Zs.exports,Qs={components:{ItemFolderParents:qs},methods:{clickGoParentFolder:function(t){this.$emit("clickGoParentFolder",t)},onContextMenu:function(t){this.inSearchMode&&this.$emit("onContextMenu",t,{item:this.folder,isFolder:!0})},clickChildVisible:function(){var t,e,n=this.folder,r=this.inSearchMode,i=this.hasChild;if(!r&&i){var a=!n.childsVisible;if(n.childsVisible=a,0!==(null!==(t=null===(e=n.childs)||void 0===e?void 0:e.length)&&void 0!==t?t:0)&&0!==n.id){var s=Object(c["getSessionStorage"])(o["a"],!0);Object(l["o"])(s)||(s={});var u=n.id;a?s[u]=1:delete s[u],Object(c["setSessionStorage"])(o["a"],s)}}},clickGoFold:function(){var t=this.folder.id,e=this.inArtboardMode,n=this.cloudCurrentFolderId;if(n===t)return e&&this.setCurArtboard(null),void this.$emit("cleanSearchText");Object(c["goCloudFolderUrl"])(t)}},computed:{texts:function(){var t=this.folder.name;return this.inSearchMode?Object(c["splitKeywordText"])(t,this.searchText):[{light:!1,text:t}]},countText:function(){var t,e=this.folder;return"(".concat(e.artboardCount+(null!==(t=e.fileCount)&&void 0!==t?t:0)+e.folderCount,")")},title:function(){var t=this.folder,e=this.isSupportNetDiskFile,n="".concat(t.artboardCount," 个画板，").concat(e?"".concat(t.fileCount," 个文件，"):"").concat(t.folderCount," 个文件夹");return n},hasChild:function(){var t,e=this.folder.childs;return(null!==(t=null===e||void 0===e?void 0:e.length)&&void 0!==t?t:0)>0},style:function(){var t=this.folder.deepCount;return null==t&&(t=0),this.inSearchMode&&(t=0),{"padding-left":t*this.deepPadding+"px"}},currentSelect:function(){var t=this.cloudCurrentFolderId,e=this.folder;return t===e.id}},data:function(){return{deepPadding:16}},props:{folder:Object,inSearchMode:Boolean,searchText:String,isSupportNetDiskFile:Boolean}},Js=Qs,tc=(n("1c5e"),Object(qe["a"])(Js,zs,Ws,!1,null,"7d23a1b8",null)),ec=tc.exports,nc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cloud-item cloud-artboard-item",class:{on:t.currentSelect,max:t.inSearchMode},attrs:{title:t.title},on:{contextmenu:function(e){return e.preventDefault(),t.onContextMenu.apply(null,arguments)}}},[n("div",{staticClass:"info",on:{click:t.clickGoArtboard}},[n("div",{staticClass:"icon"}),n("div",{staticClass:"name"},t._l(t.texts,(function(e,r){return n("span",{key:r,class:{light:e.light}},[t._v(t._s(e.text))])})),0)]),t.inSearchMode?n("ItemFolderParents",{attrs:{item:t.artboard},on:{clickItem:t.clickGoArtboard,clickGoParentFolder:t.clickGoParentFolder}}):t._e()],1)},rc=[],ic={components:{ItemFolderParents:qs},methods:{clickGoParentFolder:function(t){this.$emit("clickGoParentFolder",t)},onContextMenu:function(t){this.inSearchMode&&this.$emit("onContextMenu",t,{item:this.artboard,isArtboard:!0})},clickGoArtboard:function(){var t=this.artboard,e=t.parentId,n=t.guid,r=t.viewUrl,i=this.cloudCurrentFolderId,a=this.curArtboardGuid;if(i!==e)location.href=r;else if(a!=n){var o=this.documentArtboards.find((function(t){var e;return(null===(e=t.artboard)||void 0===e?void 0:e.guid)===n}));if(o)return this.setCurArtboard(o),void this.$emit("cleanSearchText");location.href=r}}},computed:{texts:function(){return Object(c["splitKeywordText"])(this.artboard.name,this.searchText)},title:function(){var t=this.artboard;return"".concat(t.name,"\n").concat(t.updaterName," 提交于 ").concat(t.updateTimeStr)},currentSelect:function(){var t=this.cloudCurrentFolderId,e=this.artboard,n=this.curArtboardGuid;return t===e.parentId&&n===e.guid}},props:{artboard:Object,inSearchMode:Boolean,searchText:String}},ac=ic,oc=(n("d1e7"),Object(qe["a"])(ac,nc,rc,!1,null,"1fe6bf49",null)),sc=oc.exports,cc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cloud-item cloud-file-item",class:{max:t.inSearchMode,on:t.currentSelect},attrs:{title:t.title},on:{click:function(e){return e.target!==e.currentTarget?null:t.clickGoFile.apply(null,arguments)},contextmenu:function(e){return e.preventDefault(),t.onContextMenu.apply(null,arguments)}}},[n("div",{staticClass:"info",on:{click:t.clickGoFile}},[n("span",{staticClass:"icon-netdiskfile",class:t.iconCls}),n("div",{staticClass:"name"},t._l(t.texts,(function(e,r){return n("span",{key:r,class:{light:e.light}},[t._v(t._s(e.text))])})),0)]),t.inSearchMode?n("ItemFolderParents",{attrs:{item:t.file},on:{clickItem:t.clickGoFile,clickGoParentFolder:t.clickGoParentFolder}}):t._e()],1)},lc=[],uc={components:{ItemFolderParents:qs},methods:{clickGoParentFolder:function(t){this.$emit("clickGoParentFolder",t)},onContextMenu:function(t){this.inSearchMode&&this.$emit("onContextMenu",t,{item:this.file,isFile:!0})},clickGoFile:function(){this.clickNetDiskFile(this.file)}},computed:{texts:function(){return Object(c["splitKeywordText"])(this.file.name,this.searchText)},iconCls:function(){var t=this.file;return t?o["k"].getName(t.fileType,o["l"].Small):null},title:function(){var t=this.file;return"".concat(t.name,"\n").concat(t.updaterName," 提交于 ").concat(t.updateTimeStr,"\n文件大小: ").concat(Object(c["transformPcSize"])(t.fileSize))},currentSelect:function(){var t=this.cloudCurrentFolderId,e=this.file,n=this.curNetDiskFile;return t===e.parentId&&(null===n||void 0===n?void 0:n.viewUrl)===e.viewUrl}},props:{file:Object,inSearchMode:Boolean,searchText:String}},dc=uc,hc=(n("cc8f"),Object(qe["a"])(dc,cc,lc,!1,null,"5140d6ce",null)),fc=hc.exports,mc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.item?n("div",{staticClass:"cloud-item-menu",style:t.menuStyle,on:{contextmenu:function(t){t.preventDefault()}}},[t.item.isFile?[t.canOnlineView?n("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickNetDiskFile(t.item.item)}}},[t._v("在线查看")]):t._e(),n("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.copyViewUrl(t.item.item)}}},[t._v("复制链接")]),n("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickDownloadNetDiskFile(t.item.item)}}},[t._v("下载文件")])]:t._e(),t.item.isArtboard?n("a",{attrs:{href:"javascript:;"},on:{click:t.clickGoArtboard}},[t._v("查看画板")]):t._e(),n("a",{attrs:{href:"javascript:;"},on:{click:t.clickGoParentFolder}},[t._v("前往所在文件夹")])],2):t._e()},pc=[],bc={methods:{close:function(){this.$emit("close")},copyViewUrl:function(t){var e=t.viewUrl;0===e.indexOf("/")&&(e=location.origin+e),Object(c["copyValueFromText"])(e)?this.showTextTip("链接已复制到剪切板"):this.showTextTip("链接复制到剪切板失败")},clickGoArtboard:function(){var t=this.item.item,e=t.parentId,n=t.guid,r=t.viewUrl,i=this.cloudCurrentFolderId,a=this.curArtboardGuid;if(i!==e)location.href=r;else if(a!=n){var o=this.documentArtboards.find((function(t){var e;return(null===(e=t.artboard)||void 0===e?void 0:e.guid)===n}));if(o)return this.setCurArtboard(o),void this.$emit("cleanSearchText");location.href=r}},clickGoParentFolder:function(){this.$emit("clickGoParentFolder",this.item.item)},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),this.handle=setTimeout((function(){e.close()}),150))},initEvent:function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))}},computed:{canOnlineView:function(){var t,e=this.item;return!!e&&(!!e.isFile&&o["k"].isSupportOnlineViewType(null===(t=e.item)||void 0===t?void 0:t.fileType))},menuStyle:function(){return{top:this.y+"px",left:this.x+"px"}}},watch:{item:function(t){this.initEvent(!!t)}},data:function(){return{handle:0}},props:{item:Object,x:Number,y:Number},beforeDestroy:function(){this.initEvent(!1)},created:function(){this.initEvent(!!this.item)}},vc=bc,gc=(n("e5cd"),Object(qe["a"])(vc,mc,pc,!1,null,"29be844c",null)),wc=gc.exports,xc={components:{CloudFolderItem:ec,NetworkLoading:aa,CloudArtboardItem:sc,CloudFileItem:fc,CloudItemMenu:wc},methods:{clickGoParentFolder:function(t){var e=t.parentId,n=this.inArtboardMode,r=this.cloudCurrentFolderId,i=this.inCloudViewerMode;if(i&&r===e)return n&&this.setCurArtboard(null),void this.cleanSearchText();Object(c["goCloudFolderUrl"])(e)},hideContextMenu:function(){this.contextMenu.visible=!1},onContextMenu:function(t,e){if(e){var n=this.contextMenu,r=t.pageX,i=t.pageY;n.x=r,n.y=i,n.visible=!0,n.item=e}},cleanSearchText:function(){this.searchText=""},clickReload:function(){Object(l["j"])(this.cloudVersion)?document.location.reload():this.getFoldersData()},hideBoxNotClean:function(){this.$emit("hideBox")},getFoldersData:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i,a,o,s,l;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.allFoldersBoxVisible){e.next=2;break}return e.abrupt("return");case 2:if(t.fetchState!==c["FetchState"].Fetching){e.next=4;break}return e.abrupt("return");case 4:return t.fetchState=c["FetchState"].Fetching,t.errorText=null,e.prev=6,e.next=9,t.getAllFolders(!1,!0);case 9:n=e.sent,t.fetchState=c["FetchState"].Success,t.rootFolder=n.root,t.folders=n.folders,i=t.renderList,a=t.cloudCurrentFolderId,o=t.lineHeight,s=t.boxHeight,l=i.findIndex((function(t){return t.id===a})),-1!==l&&t.$nextTick((function(){var e=t.$refs.box;e&&(e.scrollTop=Math.round(l*o-s/2))})),e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](6),t.fetchState=c["FetchState"].Error,t.errorText=e.t0;case 22:case"end":return e.stop()}}),e,null,[[6,18]])})))()},getFolderVisible:function(t){if(!t)return!1;if(!(t.id>=0))return!1;if(t.id>0&&!t.parent)return!1;while(null!=(t=t.parent))if(!t.childsVisible)return!1;return!0},resetBoxData:function(){var t=this;this.allFoldersBoxVisible&&this.$nextTick((function(){var e=t.$refs.box;e&&(t.boxHeight=e.offsetHeight,t.boxScrollTop=e.scrollTop)}))},onResize:function(){this.resetBoxData()},onBoxScroll:function(){var t=this.$refs.box;t&&(this.boxScrollTop=t.scrollTop)},goSearch:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i,a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isSupportWebItemSearch){e.next=2;break}return e.abrupt("return");case 2:return n=t.searchText,i=t.searchStatus=Object(c["rndHexString"])(),t.searchState=c["FetchState"].Fetching,e.prev=5,e.next=8,t.searchWebItem(n);case 8:if(a=e.sent,i==t.searchStatus){e.next=11;break}return e.abrupt("return");case 11:if(Object(l["g"])(a)){e.next=13;break}throw new Error("返回值格式异常");case 13:t.searchState=c["FetchState"].Success,t.searchData=a,e.next=23;break;case 17:if(e.prev=17,e.t0=e["catch"](5),i==t.searchStatus){e.next=21;break}return e.abrupt("return");case 21:t.searchErrorText=e.t0,t.searchState=c["FetchState"].Error;case 23:case"end":return e.stop()}}),e,null,[[5,17]])})))()}},computed:{cloudPageUrl:function(){return"https://www.marklion.cn/cloud.shtml?invoke=MarkLion.WebSearch&ver=".concat(this.cloudVersion,"&deploy=1")},searchInputDefaultText:function(){return this.isSupportWebItemSearch?"搜索文件夹、文件和画板":"搜索文件夹"},isSupportWebItemSearch:function(){return this.inCloudMode&&!Object(l["n"])(this.cloudVersion)},isSupportNetDiskFile:function(){return this.inCloudMode&&!Object(l["l"])(this.cloudVersion)},emptyText:function(){return this.isSupportWebItemSearch?this.inSearchMode?'未找到包含 "'.concat(this.searchText,'" 的文件夹、文件或画板'):"没有找到文件夹、文件或画板":this.inSearchMode?'未找到文件夹名包含 "'.concat(this.searchText,'" 的文件夹'):"没有找到文件夹"},boxRealHeight:function(){return this.renderList.length*this.lineHeight+2+"px"},inSearchMode:function(){return this.searchText.length>0},frontStyle:function(){var t=this.showList,e=this.lineHeight,n=0;if(t.length>0){var r=t[0].index;n=r*e}return{"margin-top":n+"px"}},showList:function(){var t=this.renderList,e=this.preloadCount,n=this.lineHeight,r=this.boxScrollTop,i=this.boxHeight,a=e*n,s=new d["a"],c=(new d["a"]).set(0,r-a,100,i+2*a),l=[];return t.forEach((function(t,e){var r;(s.set(0,e*n,100,n),Object(d["f"])(s,c))&&l.push({folder:t,index:e,key:null!==(r=t.id)&&void 0!==r?r:t.url,isArtboard:t.localSearchType===o["p"].Artboard,isFile:t.localSearchType===o["p"].File})})),l},renderList:function(){var t=this,e=this.fetchState,n=this.inSearchMode;if(e!==c["FetchState"].Success)return[];var r,i=this.folders;if(n){if(this.isSupportWebItemSearch){var a=this.searchState,o=this.searchData;return a==c["FetchState"].Success?o:[]}var s=this.searchText;s=s.toLowerCase(),r=i.filter((function(t){return-1!==t.nameLower.indexOf(s)}))}else r=i.filter((function(e){return t.getFolderVisible(e)}));return r},lineHeight:function(){return this.inSearchMode?46:32}},watch:{searchText:function(){this.goSearch()},allFoldersBoxVisible:function(){this.resetBoxData(),this.getFoldersData()}},data:function(){return{notAutoHideThisTime:!1,FetchState:c["FetchState"],folders:null,rootFolder:null,fetchState:c["FetchState"].Normal,errorText:null,searchText:"",boxHeight:0,boxScrollTop:0,preloadCount:1,searchState:c["FetchState"].Normal,searchErrorText:null,searchData:null,searchHandle:0,searchStatus:null,contextMenu:{visible:!1,x:0,y:0,item:null}}},created:function(){window.addEventListener("resize",this.onResize),l["a"]&&(window.vue_CloudFoldersBox=this)},beforeDestroy:function(){clearTimeout(this.autoHideHandle),window.removeEventListener("resize",this.onResize)},mounted:function(){this.resetBoxData(),this.getFoldersData()}},yc=xc,Cc=(n("ae0f"),Object(qe["a"])(yc,$s,Hs,!1,null,"106320f0",null)),kc=Cc.exports,Sc={components:{CloudFoldersBox:kc},methods:{clickGoHome:function(){Object(c["goCloudFolderUrl"])(0)},hideBox:function(){this.setAllFoldersBoxVisible(!1,!1)},setAllFoldersBoxVisible:function(t,e){this.$store.commit("setAllFoldersBoxVisible",t),e&&Object(c["removeSessionStorage"])(o["a"])}},computed:{allFoldersBoxVisible:function(){return this.$store.state.cloud.allFoldersBoxVisible}},watch:{inArtboardMode:function(){this.hideBox()}}},_c=Sc,Ac=(n("486e"),Object(qe["a"])(_c,Vs,Us,!1,null,"6f4b835f",null)),Ic=Ac.exports,Tc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"select-artboard-page",attrs:{title:"点击切换显示的页面"}},[n("div",{staticClass:"page-current",on:{click:function(e){t.visible=!t.visible}}},[t._v(t._s(t.currentPageName))]),t.visible?n("ul",{staticClass:"page-list"},[n("li",{class:{on:!t.filterDocumentGuid},on:{click:function(e){return t.clickItem(null)}}},[t._v(" "+t._s(t.allPageName)),n("span",{staticClass:"art-count"},[t._v("("+t._s(t.documentArtboards.length)+")")])]),t._l(t.sortDocumentsWithSketchDocument,(function(e){return n("li",{key:e.guid,class:{on:t.filterDocumentGuid===e.guid},on:{click:function(n){return t.clickItem(e)}}},[t._v(" "+t._s(e.docFullName)),n("span",{staticClass:"art-count"},[t._v("("+t._s(e.arts.length)+")")])])}))],2):t._e()])},Oc=[],Ec={methods:{clickItem:function(t){var e,n=null!==(e=null===t||void 0===t?void 0:t.guid)&&void 0!==e?e:null;this.$store.commit("setFilterDocumentGuid",n)},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),this.handle=setTimeout((function(){e.visible=!1}),100))}},computed:{sortDocumentsWithSketchDocument:function(){return this.$store.state.sortDocumentsWithSketchDocument},currentPageName:function(){var t,e,n,r=this.filterDocumentGuid;return r&&(n=this.sortDocumentsWithSketchDocument.find((function(t){return t.guid===r}))),null!==(t=null===(e=n)||void 0===e?void 0:e.name)&&void 0!==t?t:this.allPageName}},watch:{visible:function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))}},data:function(){return{allPageName:"全部页面",visible:!1,handle:0}},beforeDestroy:function(){clearTimeout(this.handle),window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0)}},Mc=Ec,Lc=(n("a2e0"),Object(qe["a"])(Mc,Tc,Oc,!1,null,"5a1c2a8a",null)),Nc=Lc.exports,Dc={components:{CloudFolders:Ic,PathNavArtboardPages:Nc},methods:{clickNav:function(t){t.link&&setTimeout((function(){t.link()}),100)}},computed:{showArtboardPages:function(){return this.inCloudMode&&!this.inNetDiskFileMode&&this.documents.length>0},navs:function(){var t=this,e=[],n=this.inCloudMode,r=this.inArtboardMode,i=this.curArtboard,a=this.cloudCurrentFolderId,o=this.curNetDiskFile,s=this.inNetDiskFileMode;if(n){var l=this.cloudName,u=this.cloudParentFolder;r||(0===a?e.push({name:l||"私有云根目录",link:null}):u&&e.push({name:0===u.id&&l||u.name,id:u.id,link:function(){Object(c["goCloudFolderUrl"])(this.id)}}))}if(n&&this.cloudFolderNotFound?e.push({name:"链接已失效",link:null}):n&&0==a||e.push({name:this.documentName,selectPages:!0,link:r?function(){t.setCurArtboard(null)}:s?function(){Object(c["goCloudFolderUrl"])(a)}:null}),r){var d,h,f=null!==(d=null===i||void 0===i||null===(h=i.artboard)||void 0===h?void 0:h.name)&&void 0!==d?d:"";f&&e.push({name:f,link:null})}else if(s){var m,p=null!==(m=null===o||void 0===o?void 0:o.name)&&void 0!==m?m:"";p&&e.push({name:p,link:null})}return e}}},Fc=Dc,Pc=(n("d7d3"),Object(qe["a"])(Fc,Rs,Bs,!1,null,"e401d976",null)),jc=Pc.exports,Rc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-info"},[n("div",{staticClass:"nickname",class:{on:t.menuVisible},attrs:{title:t.showTitle},on:{click:t.clickShowMenu}},[n("UserFace",{attrs:{canClick:!1}})],1),t.menuVisible?n("menu",{on:{click:t.clickMenu}},[t.cloudIsLogin?[n("div",{staticClass:"u-info",attrs:{title:t.showTitle}},[n("div",{staticClass:"name"},[t._v(t._s(t.showName))]),n("div",{staticClass:"email"},[t._v(t._s(t.showEmail))])]),n("div",{staticClass:"line"}),n("a",{staticClass:"item btn-nickname",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickSetNickName()}}},[t._v("修改昵称")])]:t._e(),t.inCloudViewerMode?[n("div",{staticClass:"item",attrs:{title:"开启极速渲染模式,画板再多也不卡顿更流畅"},on:{click:t.clickArtboardListUseCanvas}},[t._v(" 极速模式 "),n("Checkbox2",{attrs:{text:"",selected:t.artboardListUseCanvas},on:{click:t.clickEmpty}})],1),t.inArtboardMode?t._e():n("div",{staticClass:"item",attrs:{title:"在列表页场景中显示从XD/Sketch导出的原型连线"},on:{click:t.clickArtboardShowInteractionLine}},[t._v(" 显示原型连线 "),n("Checkbox2",{attrs:{text:"",selected:t.artboardShowInteractionLine},on:{click:t.clickEmpty}})],1),t.inArtboardMode?n("div",{staticClass:"item",attrs:{title:"开启后详情页带评注的评论将在标注模式下展示"},on:{click:t.clickPointCommentShowAlways}},[t._v(" 标注显示评注 "),n("Checkbox2",{attrs:{text:"",selected:t.pointCommentShowAlways},on:{click:t.clickEmpty}})],1):t._e()]:t._e(),t.inInteractionMode?[n("div",{staticClass:"item",attrs:{title:"开启后,热区将一直显示在原型所在节点上"},on:{click:t.clickInteractionRectAlwaysVisible}},[t._v(" 原型热区常显 "),n("Checkbox2",{attrs:{text:"",selected:t.interactionRectAlwaysVisible},on:{click:t.clickEmpty}})],1)]:t._e(),t.inNetDiskFileMode?t._e():n("div",{staticClass:"line"}),t.cloudIsLogin?n("a",{staticClass:"item btn-logout",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickLogout()}}},[t._v("退出登录")]):n("a",{staticClass:"button light login",attrs:{href:"javascript:;"},on:{click:t.clickLogin}},[t._v("登录")])],2):t._e()])},Bc=[],Vc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"userface",class:{on:t.canClick},attrs:{title:t.title},on:{click:function(e){return e.stopPropagation(),t.clickUserFace.apply(null,arguments)}}},[t.showIcon?n("div",{staticClass:"icon"}):n("div",{staticClass:"user"},[t._v(t._s(t.iconText))])])},Uc=[],$c={methods:{clickUserFace:function(){this.$emit("click")}},computed:{showIcon:function(){return!this.cloudIsLogin},iconText:function(){if(!this.cloudIsLogin)return"";var t=this.cloudNickName;return Object(l["h"])(t)||(t=this.cloudUserEmail),t[t.length-1]}},props:{title:String,canClick:Boolean}},Hc=$c,zc=(n("5bbf"),Object(qe["a"])(Hc,Vc,Uc,!1,null,"3586583b",null)),Wc=zc.exports,Gc=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"checkbox2",class:{on:t.selected},on:{click:t.click}},[t.text?n("i",{staticClass:"text"},[t._v(t._s(t.text))]):t._e(),t._m(0)])},Yc=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"rect-icon"},[n("i")])}],Xc={props:{text:String,selected:Boolean},methods:{click:function(){this.$emit("click",!this.selected)}}},Kc=Xc,Zc=Object(qe["a"])(Kc,Gc,Yc,!1,null,null,null),qc=Zc.exports,Qc={components:{UserFace:Wc,Checkbox2:qc},methods:{clickEmpty:function(){},clickInteractionRectAlwaysVisible:function(){this.$store.commit("setInteractionRectAlwaysVisible",!this.interactionRectAlwaysVisible)},clickPointCommentShowAlways:function(){this.$store.commit("pointCommentShowAlways",!this.pointCommentShowAlways)},clickArtboardShowInteractionLine:function(){var t=this.cloudVersion,e=this.artboardShowInteractionLine;Object(l["k"])(t)&&this.showTextTip("当前私有云版本(".concat(t,")过低,不支持交互原型相关功能,请先升级部署包")),this.$store.commit("artboardShowInteractionLine",!e)},clickMenu:function(t){var e=t.target;"A"!==(null===e||void 0===e?void 0:e.tagName)&&(this.ignoreThisClick=!0)},clickArtboardListUseCanvas:function(){this.$store.commit("artboardListUseCanvas",!this.artboardListUseCanvas)},clickSetNickName:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.prompt({title:"修改昵称",text:t.cloudNickName,placeholder:"昵称;方便其他成员认识你",beforeYes:function(e){if(e=e.trim(),!Object(c["isVaildNickName"])(e))return t.showTextTip("请输入正确的昵称,由5-20个字符组成,其中1个中文=2个字符."),!1}});case 3:n=e.sent,e.next=9;break;case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return");case 9:if(n=n.trim(),n!==t.cloudNickName){e.next=12;break}return e.abrupt("return");case 12:return t.nickSetting=!0,e.prev=13,e.next=16,t.cryptoMarklionWeb2("setusernickname",{nickName:n},1e4);case 16:i=e.sent,t.$store.commit("setCloudNickName",i.data),t.showTextTip("昵称已修改"),e.next=24;break;case 21:e.prev=21,e.t1=e["catch"](13),t.showTextTip(e.t1);case 24:case"end":return e.stop()}}),e,null,[[0,6],[13,21]])})))()},clickLogout:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.logoutting){e.next=2;break}return e.abrupt("return");case 2:return t.logoutting=!0,e.prev=3,e.next=6,t.goCloudLogout();case 6:return e.prev=6,t.logoutting=!1,e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[3,,6,9]])})))()},clickLogin:function(){this.goCloudLogin()},clickShowMenu:function(){var t=this;setTimeout((function(){var e=!t.menuVisible;t.menuVisible=e,e&&(t.ignoreThisClick=!1)}),0)},hideMenu:function(){var t=this;clearTimeout(this.menuHandler),this.ignoreThisClick?this.ignoreThisClick=!1:this.menuHandler=setTimeout((function(){t.menuVisible=!1}),50)}},computed:{interactionRectAlwaysVisible:function(){return this.$store.state.artboardDetail.interactionSet.rectAlwaysVisible},pointCommentShowAlways:function(){return this.$store.state.pointCommentShowAlways},artboardShowInteractionLine:function(){return this.$store.state.artboardShowInteractionLine},artboardListUseCanvas:function(){return this.$store.state.artboardListUseCanvas},showTitle:function(){return this.cloudIsLogin?"".concat(this.cloudNickName,"(").concat(this.cloudUserEmail,")"):"点击登录"},showName:function(){return this.cloudIsLogin?this.cloudNickName:"未登录"},showEmail:function(){return this.cloudIsLogin?this.cloudUserEmail:""}},watch:{menuVisible:function(t){t?window.addEventListener("click",this.hideMenu,!1):window.removeEventListener("click",this.hideMenu,!1)}},beforeDestroy:function(){clearTimeout(this.menuHandler),window.removeEventListener("click",this.hideMenu,!1)},data:function(){return{menuVisible:!1,menuHandler:0,logoutting:!1,nickSetting:!1,ignoreThisClick:!1}},props:{setVisible:Boolean}},Jc=Qc,tl=(n("dd35"),Object(qe["a"])(Jc,Rc,Bc,!1,null,"79ba1060",null)),el=tl.exports,nl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"btn",staticClass:"btn-user-notify",class:{news:t.hasNotReadNotify,on:t.notifyListVisible},on:{click:t.clickNotify}},[n("i")])},rl=[],il={methods:{clickNotify:function(){var t=this;setTimeout((function(){var e=t.userNotify;if(e.visible=!e.visible,e.visible){var n=t.$refs.btn;if(!n)return;var r=n.getBoundingClientRect(),i=e.location;i.top=r.bottom,i.right=window.innerWidth-r.right}}),0)}},computed:{userNotify:function(){return this.$store.state.userNotify},notifyListVisible:function(){return this.userNotify.visible},hasNotReadNotify:function(){return-1!==this.notifyList.findIndex((function(t){return!t.readed}))},notifyList:function(){var t,e;return null!==(t=null===(e=this.userNotify.cloudList[this.cloudKey])||void 0===e?void 0:e.list)&&void 0!==t?t:[]}}},al=il,ol=(n("6f34"),Object(qe["a"])(al,nl,rl,!1,null,"09b05e2e",null)),sl=ol.exports,cl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"user-notify",style:t.styleLocation,on:{mousedown:function(t){t.stopPropagation()},click:function(e){t.notClickClose=!0}}},[n("div",{staticClass:"header"},[n("nav",[n("a",{class:{on:t.showType===t.EnumNotifyShowType.ALL},attrs:{href:"javascript:;"},on:{click:function(e){t.showType=t.EnumNotifyShowType.ALL}}},[t._v("全部("+t._s(t.list.length)+")")]),n("a",{class:{on:t.showType===t.EnumNotifyShowType.NotRead},attrs:{href:"javascript:;"},on:{click:function(e){t.showType=t.EnumNotifyShowType.NotRead}}},[t._v("未读("+t._s(t.notReadList.length)+")")]),n("a",{class:{on:t.showType===t.EnumNotifyShowType.Readed},attrs:{href:"javascript:;"},on:{click:function(e){t.showType=t.EnumNotifyShowType.Readed}}},[t._v("已读("+t._s(t.readedList.length)+")")])]),n("menu",[t.showType!==t.EnumNotifyShowType.Readed?n("a",{staticClass:"btn-setread",attrs:{href:"javascript:;"},on:{click:t.clickSetAllNotifyReaded}},[t._v(t._s(t.btnFetching?"请求处理中":"全部标记为已读"))]):t.showType===t.EnumNotifyShowType.Readed?n("a",{staticClass:"btn-setread",attrs:{href:"javascript:;"},on:{click:t.clickAllReadedNotify}},[t._v(t._s(t.btnFetching?"请求处理中":"清空已读消息"))]):t._e(),n("a",{staticClass:"btn-refresh",attrs:{href:"javascript:;",title:"刷新消息列表"},on:{click:function(e){return t.clickReload(!0)}}})])]),n("div",{ref:"list",staticClass:"list",on:{scroll:t.onListScroll}},[t.listFetchState===t.FetchState.Fetching||t.listFetchState===t.FetchState.Error?n("NetworkLoading",{attrs:{loadText:"正在获取消息列表...",errorText:t.errorText,isLoading:t.listFetchState===t.FetchState.Fetching,isError:t.listFetchState===t.FetchState.Error,reLoadText:"刷新"},on:{reload:function(e){return t.clickReload(!0)}}}):0===t.showList.length?n("div",{staticClass:"empty"},[t._v("暂无消息")]):n("div",{staticClass:"pad",style:{height:t.styleListRealHeight}},[n("ul",{style:{top:t.styleListOffsetTop}},t._l(t.renderList,(function(t){return n("UserNotifyItem",{key:"notify-"+t.id,attrs:{item:t}})})),1)])],1)])},ll=[],ul=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible&&t.unknowNotifyType?n("li",{staticClass:"unknow"},[t._v("不支持的消息类型(id:"+t._s(t.item.id)+",type:"+t._s(t.item.type)+"),请升级客户端后查看")]):t.visible?n("li",{staticClass:"item",class:{notread:!t.item.readed},on:{click:t.clickNotify}},[n("div",{staticClass:"info"},[n("div",{staticClass:"title",attrs:{title:t.title}},[t._v(t._s(t.title))]),n("div",{staticClass:"date"},[t._v(t._s(t.item.dateStr))])]),n("div",{staticClass:"text"},[n("a",{attrs:{href:"javascript:;",title:t.commentSummary},on:{click:t.clickSummary}},[t._v(t._s(t.commentSummary))])])]):t._e()},dl=[],hl={methods:{clickSummary:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.item,e.prev=1,i=n.msg,e.next=5,t.goCloudPath({folderId:i.folderId,artboardId:i.artboardId,artboardGuid:i.artboardGuid,commentId:i.commentId,isReply:n.type===o["o"].Artboard_Reply||n.type===o["o"].Artboard_Reply_At});case 5:t.$store.commit("setAllFoldersBoxVisible",!1),t.$store.state.userNotify.visible=!1,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),t.showTextTip(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},clickNotify:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i,a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.item,n){e.next=3;break}return e.abrupt("return");case 3:if(n.readed){e.next=26;break}if(t.fetchState!==c["FetchState"].Fetching){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,t.fetchState=c["FetchState"].Fetching,i=new FormData,i.append("id",n.id),e.next=12,t.fetchPostCloudApi("setnotifyreadedbyweb",{body:i});case 12:if(a=e.sent,Object(l["o"])(a)){e.next=15;break}throw new Error("返回值异常,无法设置消息为已读");case 15:if(a.success){e.next=17;break}throw new Error(a.errMsg);case 17:n.readed=!0,e.next=23;break;case 20:e.prev=20,e.t0=e["catch"](6),t.showTextTip(e.t0);case 23:return e.prev=23,t.fetchState=c["FetchState"].Success,e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[6,20,23,26]])})))()}},computed:{visible:function(){return!!this.item},commentSummary:function(){var t,e=null===(t=this.item)||void 0===t?void 0:t.msg;if(!e)return"";var n=e.commentAttachCount,r=e.commentSummary;return n>0&&(r=new Array(n).fill("[图片]").join("")+" "+r),r},title:function(){var t,e,n,r=this.item;if(!r)return"";var i=r.msg;switch(r.type){case o["o"].Artboard_Comment:return"".concat(null===(t=i.commentUser)||void 0===t?void 0:t.nickName," 评论了您的画板“").concat(i.artboardName,"” :");case o["o"].Artboard_Reply:return"".concat(null===(e=i.commentUser)||void 0===e?void 0:e.nickName," 回复了您在画板“").concat(i.artboardName,"”的评论 :");case o["o"].Artboard_Comment_At:case o["o"].Artboard_Reply_At:return"".concat(null===(n=i.commentUser)||void 0===n?void 0:n.nickName," 在画板“").concat(i.artboardName,"”@了您:");default:return null}},unknowNotifyType:function(){var t=this.item;if(!t)return!0;switch(t.type){case o["o"].Artboard_Comment:case o["o"].Artboard_Reply:case o["o"].Artboard_Comment_At:case o["o"].Artboard_Reply_At:return!1;default:return!0}}},props:{item:Object},data:function(){return{fetchState:c["FetchState"].Normal}}},fl=hl,ml=(n("8729"),Object(qe["a"])(fl,ul,dl,!1,null,"b38f969e",null)),pl=ml.exports,bl={ALL:-1,NotRead:0,Readed:1},vl={components:{UserNotifyItem:pl,NetworkLoading:aa},methods:{clickSetAllNotifyReaded:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i,a,o;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.notReadList,0!==n.length){e.next=4;break}return t.showTextTip("没有需要标记为已读的消息"),e.abrupt("return");case 4:if(t.btnFetchState!==c["FetchState"].Fetching){e.next=6;break}return e.abrupt("return");case 6:return t.btnFetchState=c["FetchState"].Fetching,e.prev=7,i=n[0].id,a=new FormData,a.append("minNotifyId",i),e.next=13,t.fetchPostCloudApi("setnotifyreadedbyweb",{body:a});case 13:if(o=e.sent,Object(l["o"])(o)){e.next=16;break}throw new Error("返回值异常,无法设置消息为已读");case 16:if(o.success){e.next=18;break}throw new Error(o.errMsg);case 18:t.list.forEach((function(t){!t.readed&&t.id<=i&&(t.readed=!0)})),t.showTextTip("已将所有未读消息标记为已读"),e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](7),t.showTextTip(e.t0);case 25:return e.prev=25,t.btnFetchState=c["FetchState"].Success,e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[7,22,25,28]])})))()},clickAllReadedNotify:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i,a,o,s,u;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.readedList,0!==n.length){e.next=4;break}return t.showTextTip("没有需要清理的已读消息"),e.abrupt("return");case 4:if(t.btnFetchState!==c["FetchState"].Fetching){e.next=6;break}return e.abrupt("return");case 6:return t.btnFetchState=c["FetchState"].Fetching,e.prev=7,i=n[0].id,a=new FormData,a.append("minNotifyId",i),e.next=13,t.fetchPostCloudApi("removenotifiesbyweb",{body:a});case 13:if(o=e.sent,Object(l["o"])(o)){e.next=16;break}throw new Error("返回值异常,消息未被清理");case 16:if(o.success){e.next=18;break}throw new Error(o.errMsg);case 18:s=[],u=t.list,u.forEach((function(t,e){t.readed&&t.id<=i&&s.unshift(e)})),s.length===u.length?u.splice(0):s.forEach((function(t){u.splice(t,1)})),t.showTextTip("已清空已读的消息"),e.next=28;break;case 25:e.prev=25,e.t0=e["catch"](7),t.showTextTip(e.t0);case 28:return e.prev=28,t.btnFetchState=c["FetchState"].Success,e.finish(28);case 31:case"end":return e.stop()}}),e,null,[[7,25,28,31]])})))()},clickReload:function(t){var e=this;return Object(i["a"])(Object(r["a"])().mark((function n(){var i,a,o,s;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.listFetchState!==c["FetchState"].Fetching){n.next=2;break}return n.abrupt("return");case 2:return e.errorText="",e.listFetchState=c["FetchState"].Fetching,n.prev=4,a=e.list,o=0,!t&&a.length>0&&(o=a[0].id),s=null!==(i=e.curArtboardId)&&void 0!==i?i:0,n.next=11,e.getCloudNotifies(o,s);case 11:e.listFetchState=c["FetchState"].Success,n.next=18;break;case 14:n.prev=14,n.t0=n["catch"](4),e.listFetchState=c["FetchState"].Error,e.isNotSupportCloudVersion?e.errorText="私有云版本过低(".concat(e.cloudVersion,"),请先升级私有云部署包"):e.errorText=n.t0;case 18:case"end":return n.stop()}}),n,null,[[4,14]])})))()},onListScroll:function(t){this.scrollTop=t.target.scrollTop},getBoxHeight:function(){if(this.visible){var t=this.$refs.list;t&&(this.boxHeight=t.offsetHeight)}},resetTimeFormat:function(){this.showList.forEach((function(t){try{t.dateStr=Object(l["c"])(t.date)}catch(e){t.dateStr=t.date}}))},closeSelf:function(){var t=this;clearTimeout(this.closeHandle),this.closeHandle=setTimeout((function(){t.notClickClose?t.notClickClose=!1:t.userNotify.visible=!1}),50)},needReloadOnOpen:function(){var t=this.currentCloudNotify;if(!t)return!0;var e=t.updateTime;return Math.abs(Date.now()-e)>5e3}},computed:{isNotSupportCloudVersion:function(){var t=this.cloudVersion;return t&&Object(l["i"])(t)},FetchState:function(){return c["FetchState"]},btnFetching:function(){return this.btnFetchState===c["FetchState"].Fetching},styleLocation:function(){var t=this.userNotify.location,e={top:13,right:-9};return"top:".concat(t.top+e.top,"px;right:").concat(t.right+e.right,"px;")},EnumNotifyShowType:function(){return bl},userNotify:function(){return this.$store.state.userNotify},visible:function(){return this.userNotify.visible},currentCloudNotify:function(){return this.userNotify.cloudList[this.cloudKey]},list:function(){var t;return(null===(t=this.currentCloudNotify)||void 0===t?void 0:t.list)||[]},readedList:function(){var t=this.list,e=[];return t.forEach((function(t){t.readed&&e.push(t)})),e},notReadList:function(){var t=this.list,e=[];return t.forEach((function(t){t.readed||e.push(t)})),e},showList:function(){switch(this.showType){case bl.Readed:return this.readedList;case bl.NotRead:return this.notReadList;default:return this.list}},renderStartIndex:function(){var t=this.scrollTop,e=this.lineHeight;return Math.max(Math.floor(t/e)-2,0)},renderLength:function(){var t=this.showList,e=this.boxHeight,n=this.lineHeight,r=this.scrollTop;return Math.min(t.length,Math.floor(r/n)+Math.ceil(e/n)+2)},renderList:function(){var t=this.showList;return t.slice(this.renderStartIndex,this.renderLength)},styleListRealHeight:function(){return this.showList.length*this.lineHeight+"px"},styleListOffsetTop:function(){return this.renderStartIndex*this.lineHeight+"px"}},watch:{showType:function(){var t=this;this.$nextTick((function(){var e=t.$refs.list;e&&(e.scrollTop=0),t.resetTimeFormat()}))},visible:function(t){var e=this;t?(this.$nextTick((function(){e.getBoxHeight()})),window.addEventListener("click",this.closeSelf,!0),this.needReloadOnOpen()?this.clickReload():this.resetTimeFormat()):(this.notClickClose=!1,clearTimeout(this.closeHandle),window.removeEventListener("click",this.closeSelf,!0))}},data:function(){return{scrollTop:0,boxHeight:0,lineHeight:65,showType:bl.ALL,closeHandle:0,notClickClose:!1,listFetchState:c["FetchState"].Normal,btnFetchState:c["FetchState"].Normal,errorText:""}},beforeDestroy:function(){window.removeEventListener("click",this.closeSelf,!0),clearTimeout(this.closeHandle)},mounted:function(){this.getBoxHeight()}},gl=vl,wl=(n("4e01"),Object(qe["a"])(gl,cl,ll,!1,null,"20f090b1",null)),xl=wl.exports,yl=1e4,Cl={components:{BtnGoInteraction:Ms,PathNav:jc,UserNotifyButton:sl,UserNotify:xl,ScaleControl:bn,Helper:js,UserInfo:el},methods:{clickSetArtboardInComment:function(t){var e=this;return Object(i["a"])(Object(r["a"])().mark((function n(){return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t||e.inCloudMode){n.next=3;break}return e.commentSupportTip=!0,n.abrupt("return");case 3:if(t||!e.inCommentDrawing){n.next=8;break}return n.next=6,e.confirm({text:"正在编辑画板截图,是否清理截图信息并切换到标注?"});case 6:if(n.sent){n.next=8;break}return n.abrupt("return");case 8:e.$store.commit("setArtboardInComment",t);case 9:case"end":return n.stop()}}),n)})))()},clickMultDownArtboard:function(){this.setInArtboardMultDownMode(!0)},clickGoParentFolder:function(){var t=this;setTimeout((function(){Object(c["goCloudFolderUrl"])(t.cloudParentFolder.id)}),100)},clickGoHome:function(){var t=this;setTimeout((function(){t.setCurArtboard(null)}),100)},clickHelper:function(t){this.$store.commit("setHelperVisible",t)},autoCheckCloudNotify:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i,a,o,s,c,u,d,h,f;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(clearTimeout(t.autoCheckCloudNotifyHandler),t.inCloudMode&&t.cloudIsLogin){e.next=3;break}return e.abrupt("return");case 3:if(e.prev=3,!t.webViewHidden){e.next=6;break}return e.abrupt("return");case 6:return a=t.cloudKey,o=t.userNotifyCloudList[a],s=0,c=null!==(n=t.sysTipIds[a])&&void 0!==n?n:0,u=null!==(i=t.curArtboardId)&&void 0!==i?i:0,o&&(s=null!==(d=null===(h=o.list[0])||void 0===h?void 0:h.id)&&void 0!==d?d:0),t.lastAutoGetTime=Date.now(),e.prev=13,e.next=16,t.getCloudNotifies(s,u);case 16:if(f=e.sent,Object(l["g"])(f)){e.next=19;break}return e.abrupt("return");case 19:if(f=f.filter((function(t){return t.id>c&&!t.readed})),0!==f.length){e.next=22;break}return e.abrupt("return");case 22:l["a"]&&console.log("需要系统通知",f),e.next=27;break;case 25:e.prev=25,e.t0=e["catch"](13);case 27:e.next=31;break;case 29:e.prev=29,e.t1=e["catch"](3);case 31:return e.prev=31,t.checkUpdateCloudUsers(),t.autoCheckCloudNotifyHandler=setTimeout((function(){t.autoCheckCloudNotify()}),yl),e.finish(31);case 35:case"end":return e.stop()}}),e,null,[[3,29,31,35],[13,25]])})))()},checkUpdateCloudUsers:function(){var t=this;clearTimeout(this.checkUpdateCloudUsersHandle);var e=this.cloudUsersByCloudData,n=e.userListState,a=e.needUpdate;if(a){var o=Object(c["getLocalStorage"])("getcloudusers",!0);Object(l["o"])(o)||(o={});var s=o,u=s.time,d=s.state;d===n&&u>0&&Math.abs(Date.now()-u)<18e4||(this.checkUpdateCloudUsersHandle=setTimeout(Object(i["a"])(Object(r["a"])().mark((function e(){var i,a,o,s,u;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return Object(c["setLocalStorage"])("getcloudusers",{time:Date.now(),state:n}),e.prev=1,e.next=4,t.cryptoMarklionWeb2("getcloudusers",{userListState:n},1e4);case 4:i=e.sent,Object(l["o"])(i.data)&&(a=i.data,o=a.cloudUserListNeedUpdate,s=a.cloudUserListState,u=a.cloudUserListTimes,t.updateCloudUsersByCloud({needUpdate:o,userListState:s,times:u})),e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](1);case 10:case"end":return e.stop()}}),e,null,[[1,8]])}))),100))}}},computed:{cloudUsersByCloudData:function(){var t;return null!==(t=this.$store.state.userNotify.cloudUsersByCloud[this.cloudKey])&&void 0!==t?t:{}},curArtboardCommentCount:function(){var t,e=null===(t=this.curArtboard)||void 0===t?void 0:t.artboard;if(!e)return 0;var n=e.comments+e.replies;return isNaN(n)?0:n},userNotifyCloudList:function(){return this.$store.state.userNotify.cloudList},sysTipIds:function(){return this.$store.state.userNotify.sysTipIds},helperVisible:function(){return this.$store.state.helper.visible},cloudPage:function(){var t;return this.curArtboard&&(t=this.curArtboard.artboard.mlConfig.softVersion),t||(t=this.$store.state.config.softVer),"https://www.marklion.cn/cloud.shtml?invoke=MarkLion.Output".concat(Object(l["h"])(t)?"&ver=".concat(t):"")},cloudParentFolderName:function(){var t=this.cloudParentFolder;if(!t)return null;if(0!==t.id)return t.name;var e=this.cloudName;return e||t.name},setVisible:function(){var t=!this.cloudFolderNotFound&&this.permission&&this.documentArtboards.length>0;return t}},watch:{webViewHidden:function(t){if(!t){var e=Date.now()-this.lastAutoGetTime;e>=yl&&this.autoCheckCloudNotify()}},cloudIsLogin:function(){this.autoCheckCloudNotify()}},data:function(){return{checkUpdateCloudUsersHandle:0,commentSupportTip:!1,autoCheckCloudNotifyHandler:0,lastAutoGetTime:0}},beforeDestroy:function(){clearTimeout(this.autoCheckCloudNotifyHandler)},created:function(){this.autoCheckCloudNotifyHandler=setTimeout(this.autoCheckCloudNotify,1e3)}},kl=Cl,Sl=(n("be43"),Object(qe["a"])(kl,ys,Cs,!1,null,"751d75f1",null)),_l=Sl.exports,Al=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"authority",class:{"in-mobile":t.inMobile,include:t.include}},[n("div",{staticClass:"box"},[n("div",{staticClass:"logo"}),n("form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[n("div",{staticClass:"container"},[t.inMobile?n("div",{staticClass:"cloudname"},[t._v(t._s(t.documentName))]):t._e(),n("div",{staticClass:"text"},[t._v("需要输入分享码后才能访问")]),n("div",{staticClass:"input",class:{focused:t.inputFocused}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],ref:"input",attrs:{type:"text",placeholder:"请输入分享码",maxlength:"6",spellcheck:"false"},domProps:{value:t.code},on:{focus:function(e){t.inputFocused=!0},blur:function(e){t.inputFocused=!1},input:function(e){e.target.composing||(t.code=e.target.value)}}})]),n("div",{staticClass:"btns"},[n("a",{staticClass:"button light",attrs:{href:"javascript:;"},on:{click:t.onSubmit}},[t._v(" 确定 "),n("input",{attrs:{type:"submit"}})])])])])])])},Il=[],Tl={methods:{onSubmit:function(){var t=this,e=this.code.trim();if(!/^[a-zA-Z\d]{1,6}$/.test(e))return this.showTextTip("分享码不正确,分享码由1-6位的数字或字母组合而成"),void this.$refs.input.focus();var n="".concat(c["OUTPU_CLOUD_API_DEVPATH"],"/api/previewer");fetch(n,{method:"post",body:"code=".concat(e,"&folderid=").concat(this.cloudCurrentFolderId),cache:"reload",credentials:"include",headers:{"content-type":"application/x-www-form-urlencoded"}}).then((function(e){e.text().then((function(n){if(200!=e.status)throw n;if(n=JSON.parse(n),Object(l["o"])(n))return n.success?(t.cleanFoldersCache(),void(t.inInteractionMode?t.goCloudFolderInteractionUrl(t.cloudCurrentFolderId,t.curArtboardGuid):window.location.reload())):void t.showTextTip(n.errMsg);t.showTextTip("返回值格式异常")})).catch((function(e){t.showTextTip(e)}))})).catch((function(e){t.showTextTip(e)}))}},data:function(){return{inputFocused:!1,code:""}},props:{include:{type:Boolean,default:!1}}},Ol=Tl,El=(n("0c49"),Object(qe["a"])(Ol,Al,Il,!1,null,"2c2b99f3",null)),Ml=El.exports,Ll=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"error-data",class:{"in-mobile":t.inMobile}},[n("div",{staticClass:"box"},[t._v(t._s(t.text))])])},Nl=[],Dl={props:{text:String}},Fl=Dl,Pl=(n("4025"),Object(qe["a"])(Fl,Ll,Nl,!1,null,"a3317ca8",null)),jl=Pl.exports,Rl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"p-index"},[n("ZoomContainer",{attrs:{type:t.EnumScaleType.ArtboardList}}),n("MultArtboardDownload")],1)},Bl=[],Vl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.inArtboardMultDownMode&&t.exportNodeCount?n("section",{staticClass:"mult-download"},[n("div",{staticClass:"text"},[0!==t.exportNodeCount?n("Radio",{attrs:{text:"全选",selected:t.allSelected},on:{click:t.clickAllSelectBtn}}):t._e(),n("div",{staticClass:"info"},[t._v("已选中"+t._s(t.selectNodeCount)+"/"+t._s(t.exportNodeCount)+"个画板")])],1),n("div",{staticClass:"btns"},[n("a",{staticClass:"button light",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickDownSelectAll()}}},[t._v("下载")]),n("a",{staticClass:"btn-close",attrs:{href:"javascript:;"},on:{click:function(e){return t.setInArtboardMultDownMode(!1)}}})])]):t._e()},Ul=[],$l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"radio",class:{on:t.selected},on:{click:t.click}},[t.text?n("i",[t._v(t._s(t.text))]):t._e()])},Hl=[],zl={props:{text:String,selected:Boolean},methods:{click:function(){this.$emit("click",!this.selected)}}},Wl=zl,Gl=Object(qe["a"])(Wl,$l,Hl,!1,null,null,null),Yl=Gl.exports,Xl={methods:{clickAllSelectBtn:function(t){t=!this.allSelected&&(this.exportNodeCount,!0);var e={length:0};this.renderDocumentArtboards.forEach((function(n){n.mlUserSelectDown!==t&&(n.mlUserSelectDown=t,e[n.artboard.guid]=1,e.length++)})),this.$store.commit("selectArtboardChanged",e)},clickDownSelectAll:function(){var t=this;0!==this.exportNodeCount?(this.setInOutput(!0),$a(this.documentName,this.selectArtboards).catch((function(e){t.showTextTip(e)})).finally((function(){t.setInOutput(!1)}))):this.showTextTip("当前文件夹不存在画板")}},computed:{allSelected:function(){return 0!==this.exportNodeCount&&this.exportNodeCount===this.selectNodeCount},selectNodeCount:function(){var t=0;return this.renderDocumentArtboards.forEach((function(e){e.mlUserSelectDown&&(t+=1)})),t},selectArtboards:function(){var t=this.renderDocumentArtboards,e=[];return t.forEach((function(t){t.mlUserSelectDown&&e.push(t.artboard)})),e},exportNodeCount:function(){return this.renderDocumentArtboards.length}},components:{Radio:Yl}},Kl=Xl,Zl=(n("2903"),Object(qe["a"])(Kl,Vl,Ul,!1,null,"9c46a31e",null)),ql=Zl.exports,Ql={components:{ZoomContainer:Hi,MultArtboardDownload:ql},computed:{EnumScaleType:function(){return o["m"]}},created:function(){l["a"]&&(window.vue_ArtboardList=this)}},Jl=Ql,tu=(n("463d"),Object(qe["a"])(Jl,Rl,Bl,!1,null,"9ccb512e",null)),eu=tu.exports,nu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"p-info"},[n("keep-alive",[n("LeftSide")],1),t.isError?n("div",{staticClass:"error"},[n("div",{staticClass:"box"},[n("div",{staticClass:"text"},[t._v(t._s(t.curArtboard.loadErrMsg))]),n("div",{staticClass:"btns"},[n("a",{staticClass:"button light",attrs:{href:"javascript:;"},on:{click:t.clickReload}},[t._v("重新加载")])])])]):t.isFetching?n("div",{staticClass:"loading"},[n("div",{staticClass:"box"},[t._v("正在加载画板详情...")])]):t.isLoaded?[n("ZoomContainer",{attrs:{type:t.EnumScaleType.ArtboardDetail}}),n("Properties"),n("MultDownload"),t.inCloudMode?n("CommentMain"):t._e()]:t._e()],2)},ru=[],iu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"left-side",class:{on:t.visible}},[n("a",{staticClass:"btn-visible",class:{on:t.visible},attrs:{href:"javascript:;",title:t.visible?"收起左侧(F3)":"展开左侧(F3)"},on:{click:function(e){return t.setVisible(!t.visible)}}}),n("nav",[n("a",{staticClass:"btn-showart",class:{on:t.showArtboardList},attrs:{href:"javascript:;",title:"切换到画板列表(F1)"},on:{click:function(e){t.showArtboardList=!0,t.setVisible(!0)}}},[t._v("画板")]),n("a",{staticClass:"btn-shownode",class:{on:!t.showArtboardList},attrs:{href:"javascript:;",title:"切换到图层列表(F2)"},on:{click:function(e){t.showArtboardList=!1,t.setVisible(!0)}}},[t._v("图层")])]),t.showArtboardList?n("div",{staticClass:"search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText.artboard,expression:"searchText.artboard"}],attrs:{type:"text",placeholder:"搜索画板名",spellcheck:"false"},domProps:{value:t.searchText.artboard},on:{input:function(e){e.target.composing||t.$set(t.searchText,"artboard",e.target.value)}}}),t.searchText.artboard?n("a",{staticClass:"btn-clear",attrs:{href:"javascript:;"},on:{click:function(e){t.searchText.artboard=""}}}):t._e()]):t.artboardInComment?t._e():n("div",{staticClass:"search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText.node,expression:"searchText.node"}],attrs:{type:"text",placeholder:"搜索节点名",spellcheck:"false"},domProps:{value:t.searchText.node},on:{input:function(e){e.target.composing||t.$set(t.searchText,"node",e.target.value)}}}),t.searchText.node?n("a",{staticClass:"btn-clear",attrs:{href:"javascript:;"},on:{click:function(e){t.searchText.node=""}}}):t._e()]),t.showArtboardList||!t.artboardInComment?n("div",{staticClass:"filter"},[n("div",{staticClass:"filters"},[t.artboardInComment?n("div",{staticClass:"filter-item filter-item-comment",class:{on:t.commentFilterOpen},on:{click:t.clickCommentFilter}}):[n("div",{staticClass:"filter-item filter-item-slice",class:{on:t.sliceFilterOpen},attrs:{title:t.showArtboardList?"筛选有切图的画板":"筛选有切图的节点"},on:{click:t.clickSliceFilter}}),t.showArtboardList?t._e():n("div",{staticClass:"filter-item filter-item-interaction",class:{on:t.interactionFilterOpen},attrs:{title:"筛选有原型跳转的节点"},on:{click:t.clickInteractionFilter}})]],2),t.showArtboardList?n("a",{staticClass:"artlist-mode",class:{min:!t.artlistModeMin},attrs:{href:"javascript:;",title:t.artlistModeMinTitle},on:{click:t.clickArtlistModeMin}}):t._e()]):t._e(),n("section",{staticClass:"box"},[!t.showArtboardList&&t.artboardInComment?n("section",{staticClass:"on incomment"},[t._v("评论模式下无法查看标注图层信息")]):t._e(),n("ArtboardList",{attrs:{artlistModeMin:t.artlistModeMin,visible:t.showArtboardList,list:t.renderDocumentArtboards,renderArtboardList:t.renderArtboardList,sliceFilterOpen:t.sliceFilterOpen,interactionFilterOpen:t.interactionFilterOpen}}),n("section",{ref:"nodeList",staticClass:"nodelist",class:{on:!t.showArtboardList&&!t.artboardInComment},on:{scroll:t.onNodeListScroll,mousewheel:t.onNodeListMouseWheel}},[n("div",{staticClass:"container",class:{"slice-filter":t.sliceFilterOpen||t.nodeInSearch||t.interactionFilterOpen,off:t.nodeListMousewheelTimes>0}},[0===t.nodeList.length?n("div",{staticClass:"empty"},[t._v(t._s(t.emptyNodeListText))]):t._e(),n("div",{staticClass:"brace",style:t.braceStyle},[n("div",{staticClass:"front",style:t.frontStyle},t._l(t.renderList,(function(e){return n("NodeListNew",{key:e.index+":"+e.node.guid,attrs:{nodeListHeight:t.nodeListHeight,nodeListScrollTop:t.nodeListScrollTop,nodeLineHeight:t.nodeLineHeight,shiftKey:t.shiftKey,sliceFilterOpen:t.sliceFilterOpen,interactionFilterOpen:t.interactionFilterOpen,nodeInSearch:t.nodeInSearch,item:e.node}})})),1)])])])],1)])},au=[],ou=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"item",class:{hover:t.enterNode===t.item,focused:t.curNode===t.item}},[t.sliceFilterOpen||t.nodeInSearch||t.interactionFilterOpen?t._e():n("div",{staticClass:"prex",class:{first:t.isFirstChild,last:t.isLastChild,"has-child":t.hasChild},style:{width:t.depthWidth}}),n("div",{ref:"$item_name",staticClass:"name",class:{export:t.item.markedForExport},style:{paddingLeft:t.paddingLeft},on:{mouseenter:t.mouseEnterNode,mouseleave:t.mouseLeaveNode,click:t.clickNode}},[t.item.renderTapInteraction?n("span",{staticClass:"interaction-node"}):t._e(),t._v(t._s(t.name))])])},su=[],cu=10,lu={name:"NodeList",methods:{clickNode:function(){var t=this.item;l["a"]&&console.log("NodeItem.clickNode",t.guid,t),this.inMultDownMode?t.markedForExport&&(t.mlUserSelectDown=!t.mlUserSelectDown):this.setCurNode(t)},mouseLeaveNode:function(){this.inMultDownMode||this.shiftKey&&null!=this.curNode||this.setEnterNode(null)},mouseEnterNode:function(){this.inMultDownMode||this.shiftKey&&null!=this.curNode||this.setEnterNode(this.item)}},computed:{itemStyle:function(){return{top:this.index*this.nodeLineHeight+"px"}},isFirstChild:function(){var t=this.item;if(t.types.Artboard)return!0;var e=t.parentNode.children;return!!e&&e[0]==t},isLastChild:function(){var t=this.item;if(t.types.Artboard)return!0;var e=t.parentNode.children;return!!e&&e[e.length-1]==t},hasChild:function(){var t=this.item.children;if(!t)return!1;if(0===t.length)return!1;var e=t.find((function(t){return!t.mlIgnoreLeftSide}));return!!e},depthWidth:function(){var t=this.nodeDepthIndex*cu;return t<0&&(t=0),t+"px"},paddingLeft:function(){return this.nodeDepthIndex*cu+6+"px"},nodeDepthIndex:function(){return this.item.nodeDepthIndex},name:function(){var t=30,e=Object(c["getNodeShowName"])(this.item);return Object(l["h"])(e)?(e=e.trim(),e.length>t&&(e=e.substr(0,t)),e):this.item.guid}},props:{item:Object,sliceFilterOpen:Boolean,interactionFilterOpen:Boolean,nodeInSearch:Boolean,shiftKey:Boolean,nodeListScrollTop:Number,nodeListHeight:Number,index:Number,nodeLineHeight:Number}},uu=lu,du=(n("276f"),Object(qe["a"])(uu,ou,su,!1,null,"2aa02736",null)),hu=du.exports,fu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{ref:"artList",staticClass:"art-list",class:{on:t.visible},on:{scroll:t.onScroll,mousewheel:t.onMouseWheel}},[n("div",{staticClass:"brace",class:{off:t.mousewheelTimes>0},style:{height:t.boxRealHeight}},[n("div",{staticClass:"front",style:{marginTop:t.frontMarginTop}},t._l(t.lazyRenderArtboardList,(function(e){return n("ArtboardListItem",{key:e.artboard.docGuid+"-"+e.artboard.guid,attrs:{item:e,artlistModeMin:t.artlistModeMin}})})),1)]),0===t.lazyRenderArtboardList.length?n("div",{staticClass:"empty"},[t._v(t._s(t.emptyNodeListText))]):t._e()])},mu=[],pu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{ref:"$item",staticClass:"item",class:{on:t.focused,min:t.artlistModeMin},on:{click:function(e){return t.clickArtboard()},contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)}}},[n("div",{staticClass:"name",attrs:{title:t.artboard.name},domProps:{textContent:t._s(t.artboard.name)}}),n("div",{staticClass:"img"},[n("img",{attrs:{src:t.artboardReviewImg,alt:""},on:{error:t.errPreviewImage}}),t.inInteractionMode&&t.artboard.flowStart?n("div",{staticClass:"flow-start"}):t._e(),!t.inInteractionMode&&!t.artboardInComment&&t.exportNodeCount>0?n("div",{staticClass:"slice-total"},[t._v(t._s(t.exportNodeCount))]):t._e(),!t.inInteractionMode&&t.artboardInComment&&t.commentReplyCount&&"0"!==t.commentReplyCount?n("div",{staticClass:"comment-total"},[t._v(t._s(t.commentReplyCount))]):t._e()])])},bu=[],vu={methods:{errPreviewImage:function(){this.userMiniPreviewImg&&(this.userMiniPreviewImg=!1)},onContextmenu:function(t){var e=this,n=t.pageX,r=t.pageY,i=this.item;requestAnimationFrame((function(){e.$store.commit("setArtboardMenu",{visible:!0,x:n,y:r,artboard:i})}))},clickArtboard:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.inCommentDrawing){e.next=5;break}return e.next=3,t.confirm({text:"正在编辑画板截图,是否清理截图信息并切换画板?"});case 3:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:t.setCurArtboard(t.item);case 6:case"end":return e.stop()}}),e)})))()},scrollIntoView:function(t){if(this.focused){var e=this.$refs.$item;e&&e.scrollIntoView({block:"center",behavior:null===t?"auto":"smooth"})}}},watch:{curArtboard:function(t,e){this.scrollIntoView(e)}},computed:{commentReplyCount:function(){var t=this.artboard,e=this.artlistModeMin;if(!t)return"";var n=t.comments+t.replies;return e?n>999?"99+":n>0?n:"":n.toString()},exportNodeCount:function(){if(this.inCloudMode)return this.artboard.resNodeCount;var t=this.item.exportNodes;return t.length},artboardReviewImg:function(){var t=this.artboard,e=this.userMiniPreviewImg?t.artboardPreviewThumbPng:t.artboardPreviewPng;return this.inCloudMode?e:"".concat(e,"?").concat(t.mlOutputTime)},focused:function(){return this.curArtboard===this.item},artboard:function(){return this.item.artboard}},data:function(){return{userMiniPreviewImg:!0}},props:{item:Object,artlistModeMin:Boolean,searchText:String}},gu=vu,wu=(n("354d"),Object(qe["a"])(gu,pu,bu,!1,null,"b6cedd54",null)),xu=wu.exports,yu={methods:{onMouseWheel:function(t){var e;this.mousewheelTimes=null!==(e=t.timeStamp)&&void 0!==e?e:Date.now()},onScroll:function(t){this.scrollTop=t.target.scrollTop},onResize:function(){var t=this.$refs.artList;t&&(this.boxHeight=t.offsetHeight)},goFocusItem:function(){var t=this.curArtboard;if(t){var e=this.$refs.artList;if(e){var n=this.renderArtboardList.findIndex((function(e){return e===t}));if(-1!==n){var r=this.itemHeight*n;r-=Math.floor((this.boxHeight-this.itemHeight)/2),e.scrollTop=r}}}}},props:{visible:Boolean,artlistModeMin:Boolean,list:Array,renderArtboardList:Array,sliceFilterOpen:Boolean,interactionFilterOpen:Boolean},components:{ArtboardListItem:xu},watch:{mousewheelTimes:function(t){var e=this;clearTimeout(this.mousewheelHandle),t&&(this.mousewheelHandle=setTimeout((function(){e.mousewheelTimes=!1}),200))},filterDocumentGuid:function(){var t=this;this.$nextTick((function(){t.goFocusItem()}))},sliceFilterOpen:function(){var t=this;this.$nextTick((function(){t.goFocusItem()}))},artlistModeMin:function(){var t=this;this.$nextTick((function(){t.goFocusItem()}))}},computed:{emptyNodeListText:function(){var t=this.sliceFilterOpen;return"未找到".concat(t?"包含切图的":"相关","画板")},lazyRenderArtboardList:function(){var t=this.renderArtboardList,e=this.lazyStartIndex,n=this.lazyLength;return t.slice(e,e+n)},lazyStartIndex:function(){var t=this.scrollTop,e=this.itemHeight,n=this.renderArtboardList.length-Math.floor(this.boxHeight/this.itemHeight);return Math.max(0,Math.min(n,Math.floor(t/e)-1))},lazyLength:function(){var t=this.boxHeight,e=this.itemHeight,n=this.renderArtboardList,r=this.lazyStartIndex;return Math.min(n.length-r,Math.ceil(t/e)+2)},frontMarginTop:function(){return this.lazyStartIndex*this.itemHeight+"px"},boxRealHeight:function(){return this.itemHeight*this.renderArtboardList.length+"px"},itemHeight:function(){return this.artlistModeMin?68:235}},data:function(){return{scrollTop:0,boxHeight:0,mousewheelTimes:0,mousewheelHandle:0}},mounted:function(){var t,e,n=this;this.scrollTop=null!==(t=null===(e=this.$refs.artList)||void 0===e?void 0:e.scrollTop)&&void 0!==t?t:0,this.onResize(),window.addEventListener("resize",this.onResize),this.$nextTick((function(){n.goFocusItem()}))},beforeDestroy:function(){window.removeEventListener("resize",this.onResize),clearTimeout(this.mousewheelHandle)}},Cu=yu,ku=(n("7a8d"),Object(qe["a"])(Cu,fu,mu,!1,null,"cb81dbb4",null)),Su=ku.exports,_u={components:{ArtboardList:Su,NodeListNew:hu},methods:{onNodeListResize:function(){var t=this.$refs.nodeList;t&&(this.nodeListHeight=t.offsetHeight)},onNodeListMouseWheel:function(t){var e;this.nodeListMousewheelTimes=null!==(e=t.timeStamp)&&void 0!==e?e:Date.now()},onNodeListScroll:function(){var t=this.$refs.nodeList;t&&(this.nodeListScrollTop=t.scrollTop)},clickArtlistModeMin:function(){this.artlistModeMin=!this.artlistModeMin,Object(c["setLocalStorage"])("leftside.artlistmodemin",this.artlistModeMin?"1":"0")},clickSliceFilter:function(){this.sliceFilterOpen=!this.sliceFilterOpen,Object(c["setLocalStorage"])("sliceFilterOpen",this.sliceFilterOpen?"1":"0")},clickCommentFilter:function(){this.commentFilterOpen=!this.commentFilterOpen,Object(c["setLocalStorage"])("commentFilterOpen",this.commentFilterOpen?"1":"0")},clickInteractionFilter:function(){this.interactionFilterOpen=!this.interactionFilterOpen,Object(c["setLocalStorage"])("interactionFilterOpen",this.interactionFilterOpen?"1":"0")},quickKeyShift:function(t){this.shiftKey=t.shiftKey},quickKey:function(t){var e=this;return Object(i["a"])(Object(r["a"])().mark((function n(){var i,a,o,s,c;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.quickKeyShift(t),i=t.keyCode||t.which,n.t0=i,n.next=112===n.t0||113===n.t0?5:114===n.t0?9:38===n.t0||40===n.t0?12:46;break;case 5:return e.showArtboardList=112===i,e.setVisible(!0),t.preventDefault(),n.abrupt("break",46);case 9:return e.setVisible(!e.visible),t.preventDefault(),n.abrupt("break",46);case 12:if(!e.keydownConfirming){n.next=14;break}return n.abrupt("return");case 14:if(!e.imageViewer.visible){n.next=16;break}return n.abrupt("return");case 16:if(a=38===i?-1:1,o=t.ctrlKey||t.metaKey,o){n.next=20;break}return n.abrupt("break",46);case 20:if(s=e.renderArtboardList,0!==s.length){n.next=24;break}return e.showTextTip(1===a?"已经到达最后一个画板":"已经到达第一个画板"),n.abrupt("return");case 24:if(c=s.findIndex((function(t){return e.curArtboard===t})),-1===c?c=0:c+=a,!(c<0)){n.next=31;break}return e.showTextTip("已经到达第一个画板"),n.abrupt("return");case 31:if(!(c>=s.length)){n.next=34;break}return e.showTextTip("已经到达最后一个画板"),n.abrupt("return");case 34:if(!e.inCommentDrawing){n.next=44;break}return e.keydownConfirming=!0,n.prev=36,n.next=39,e.confirm({text:"正在编辑画板截图,是否清理截图信息并切换画板?"});case 39:if(n.sent){n.next=41;break}return n.abrupt("return");case 41:return n.prev=41,e.keydownConfirming=!1,n.finish(41);case 44:return e.setCurArtboard(s[c]),n.abrupt("break",46);case 46:case"end":return n.stop()}}),n,null,[[36,,41,44]])})))()},getArtboardExportNodeCount:function(t){if(this.inCloudMode)return t.artboard.resNodeCount;var e=t.exportNodes;return e.length},setVisible:function(t){this.$store.commit("leftSideVisible",t)}},computed:{emptyNodeListText:function(){var t=this.sliceFilterOpen,e=this.interactionFilterOpen;return"未找到".concat(t&&e?"包含切图和原型的":t?"包含切图的":e?"包含原型的":"相关","图层信息")},imageViewer:function(){return this.$store.state.imageViewer},renderArtboardList:function(){var t=this,e=this.commentFilterOpen,n=this.artboardInComment,r=this.artboardSearchText,i=this.sliceFilterOpen,a=this.renderDocumentArtboards,o=""!==r,s=[];return a.forEach((function(a){if(a&&a.artboard){if(n){var c=a.artboard.comments+a.artboard.replies;if(e&&!(c>0))return}else if(i&&0===t.getArtboardExportNodeCount(a))return;if(o){var l=a.artboard.name;if(!l)return;if(-1===l.toLowerCase().indexOf(r))return}s.push(a)}})),s},artboardSearchText:function(){return this.searchText.artboard.toLowerCase()},nodeInSearch:function(){return""!==this.searchText.node},frontStyle:function(){var t=this.renderList,e=0;if(t.length>0){var n=t[0].index;e=n*this.nodeLineHeight}return{marginTop:e+"px"}},braceStyle:function(){return{height:this.nodeList.length*this.nodeLineHeight+"px"}},renderList:function(){var t=this.nodeList,e=[],n=new d["a"],r=new d["a"],i=this.nodeLineHeight,a=this.preloadCount*i,o=this.nodeListHeight,s=this.nodeListScrollTop;return r.set(0,s-a,100,o+2*a),t.forEach((function(t,a){n.set(0,a*i,100,i),Object(d["f"])(n,r)&&e.push({node:t,index:a})})),e},interactionNodeList:function(){var t=this.curArtboard;if(!t)return[];var e=t.childs;return e&&0!==e.length?e.filter((function(t){return!!t.renderTapInteraction})):[]},nodeList:function(){var t,e=this.sliceFilterOpen,n=this.curArtboard,r=this.interactionFilterOpen;if(e||r){var i,a;if(t=[],e&&n.exportNodes)(i=t).push.apply(i,Object(u["a"])(n.exportNodes));if(r)(a=t).push.apply(a,Object(u["a"])(this.interactionNodeList))}else t=n.childs;var o=[],s=this.nodeInSearch,c=s?this.searchText.node.toLowerCase():"";return t.forEach((function(t){if(t.visible&&!t.mlIgnoreLeftSide){if(s){var e=t.name;if(!e)return;if(-1==e.toLowerCase().indexOf(c))return}o.push(t)}})),o},artlistModeMinTitle:function(){return this.artlistModeMin?"单击切换到大图模式":"单击切换到小图模式"},visible:function(){return this.$store.state.artboardDetail.leftSideVisible}},data:function(){return{keydownConfirming:!1,preloadCount:2,nodeLineHeight:24,nodeListScrollTop:0,nodeListMousewheelTimes:0,nodeListMousewheelHandle:0,nodeListHeight:0,shiftKey:!1,showArtboardList:!1,artlistModeMin:"1"===Object(c["getLocalStorage"])("leftside.artlistmodemin",!1),sliceFilterOpen:"1"===Object(c["getLocalStorage"])("sliceFilterOpen",!1),commentFilterOpen:"1"===Object(c["getLocalStorage"])("commentFilterOpen",!1),interactionFilterOpen:"1"===Object(c["getLocalStorage"])("interactionFilterOpen",!1),searchText:{artboard:"",node:""}}},watch:{nodeListMousewheelTimes:function(t){var e=this;clearTimeout(this.nodeListMousewheelHandle),t>0&&(this.nodeListMousewheelHandle=setTimeout((function(){e.nodeListMousewheelTimes=0}),200))},artboardInComment:function(t){t&&this.visible&&!this.showArtboardList&&(this.showArtboardList=!0)},"editComment.drawing":function(t){t&&this.setVisible(!1)},visible:function(t){t&&this.artboardInComment&&(this.showArtboardList=!0)},curNode:function(t,e){if(t){var n=this.nodeList.findIndex((function(e){return t===e}));if(-1!==n){var r=n*this.nodeLineHeight-this.nodeListHeight/2,i=this.$refs.nodeList;i&&i.scrollTo({top:r,behavior:null===e?"auto":"smooth"})}}},curArtboard:function(t){t&&(this.onNodeListResize(),this.onNodeListScroll())}},mounted:function(){this.onNodeListResize(),this.onNodeListScroll()},created:function(){window.addEventListener("keydown",this.quickKey),window.addEventListener("keyup",this.quickKeyShift),window.addEventListener("resize",this.onNodeListResize),this.visible&&this.artboardInComment&&(this.showArtboardList=!0)},beforeDestroy:function(){window.removeEventListener("keydown",this.quickKey),window.removeEventListener("keyup",this.quickKeyShift),window.removeEventListener("resize",this.onNodeListResize),clearTimeout(this.nodeListMousewheelHandle)}},Au=_u,Iu=(n("ea6e"),Object(qe["a"])(Au,iu,au,!1,null,null,null)),Tu=Iu.exports,Ou=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"node-properties",class:{on:t.hasValue}},[t.hasValue?[n("Header"),n("main",{class:{export:t.curNode.markedForExport}},[n("PropertyInfo",{attrs:{nodeStyle:t.nodeStyle}}),t.nodeStyle.fill?n("PropertyFill",{attrs:{nodeStyle:t.nodeStyle}}):t._e(),t.curNode.types.GraphicNode?n("PropertiesGraphicNode",{attrs:{nodeStyle:t.nodeStyle}}):t._e(),t.curNode.markedForExport?n("PropertyExport"):t.curNode.types.Text?n("PropertyText",{attrs:{sketchGroupFillColor:t.sketchGroupFillColor}}):t._e(),t.cssVisible?n("PropertyCss",{attrs:{sketchGroupFillColor:t.sketchGroupFillColor,nodeStyle:t.nodeStyle}}):t._e()],1),t.curNode.markedForExport?n("footer",[n("a",{staticClass:"button download-all",attrs:{href:"javascript:;"},on:{click:function(e){return t.setInMultDownMode(!0)}}},[t._v("查看当前画板全部切图")])]):t._e()]:t._e()],2)},Eu=[],Mu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._l(t.nodeStyle.borders,(function(e,r){return n("section",{key:"border-"+r,staticClass:"prop-box"},[n("h5",[0===e.position||1===e.position||2===e.position?n("span",{domProps:{textContent:t._s(t.SketchEnumBorderPositionNumber[e.position])}}):t._e(),t._v("边框 ")]),n("dl",{staticClass:"item"},[n("dt",[t._v("粗细")]),n("dd",[n("PropertyShowValue",{attrs:{value:e.width}}),n("div",{staticClass:"inp empty"})],1)]),n("dl",{staticClass:"item"},[n("dt",[t._v("线条类型")]),n("dd",[n("PropertyShowValue",{attrs:{value:e.style}}),n("div",{staticClass:"inp empty"})],1)]),n("PropertyColor",{attrs:{fill:e}})],1)})),t._l(t.nodeStyle.shadows,(function(e,r){return n("section",{key:"shadow-"+r,staticClass:"prop-box"},[n("h5",[t._v("外阴影")]),n("dl",{staticClass:"item loc"},[n("dt",[t._v("偏移")]),n("dd",[n("span",{staticClass:"loc-name"},[t._v("X")]),n("PropertyShowValue",{attrs:{value:e.x}}),n("span",{staticClass:"loc-name"},[t._v("Y")]),n("PropertyShowValue",{attrs:{value:e.y,cls:{m2:1}}})],1)]),n("dl",{staticClass:"item"},[n("dt",[t._v("模糊距离")]),n("dd",[n("PropertyShowValue",{attrs:{value:e.blur}}),n("div",{staticClass:"inp empty"})],1)]),e.spread?n("dl",{staticClass:"item"},[n("dt",[t._v("阴影大小")]),n("dd",[n("PropertyShowValue",{attrs:{value:e.spread}}),n("div",{staticClass:"inp empty"})],1)]):t._e(),n("PropertyShowColor",{attrs:{name:"颜色",value:e.color}})],1)})),t._l(t.nodeStyle.innerShadows,(function(e,r){return n("section",{key:"innerShadow-"+r,staticClass:"prop-box"},[n("h5",[t._v("内阴影")]),n("dl",{staticClass:"item loc"},[n("dt",[t._v("偏移")]),n("dd",[n("span",{staticClass:"loc-name"},[t._v("X")]),n("PropertyShowValue",{attrs:{value:e.x}}),n("span",{staticClass:"loc-name"},[t._v("Y")]),n("PropertyShowValue",{attrs:{value:e.y,cls:{m2:1}}})],1)]),n("dl",{staticClass:"item"},[n("dt",[t._v("模糊距离")]),n("dd",[n("PropertyShowValue",{attrs:{value:e.blur}}),n("div",{staticClass:"inp empty"})],1)]),e.spread?n("dl",{staticClass:"item"},[n("dt",[t._v("阴影大小")]),n("dd",[n("PropertyShowValue",{attrs:{value:e.spread}}),n("div",{staticClass:"inp empty"})],1)]):t._e(),n("PropertyShowColor",{attrs:{name:"颜色",value:e.color}})],1)}))],2)},Lu=[],Nu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.fill.type===t.EnumFillShowType.FillColor?n("PropertyShowColor",{attrs:{name:"纯色",value:t.fill.color}}):t.fill.type===t.EnumFillShowType.LinearGradientFill?n("div",[n("dl",{staticClass:"item"},[n("dt",[t._v("线性渐变")]),n("dd",[n("PropertyShowValue",{attrs:{value:"linear"}}),n("PropertyShowValue",{attrs:{cls:{m2:1},value:t.fill.angle}})],1)]),n("ul",{staticClass:"fill-list"},t._l(t.fill.colorStops,(function(e,r){return n("li",{key:"line-colorStop-"+r},[n("div",{staticClass:"title"},[t._v(t._s(e.stop))]),n("PropertyShowColor",{attrs:{name:"",value:e.color,"non-swatch":!0}})],1)})),0)]):t.fill.type===t.EnumFillShowType.RadialGradientFill?n("div",[n("dl",{staticClass:"item"},[n("dt",[t._v("径向渐变")]),n("dd",[n("PropertyShowValue",{attrs:{value:"radial"}}),n("PropertyShowValue",{attrs:{cls:{m2:1},value:t.fill.angle}})],1)]),n("dl",{staticClass:"item loc"},[n("dd",[n("span",{staticClass:"loc-name start"},[t._v("圆心")]),n("span",{staticClass:"loc-name"},[t._v("X")]),n("PropertyShowValue",{attrs:{value:t.fill.startX}}),n("span",{staticClass:"loc-name"},[t._v("Y")]),n("PropertyShowValue",{attrs:{value:t.fill.startY,cls:{m2:1}}})],1)]),n("dl",{staticClass:"item loc"},[n("dd",[n("span",{staticClass:"loc-name start"},[t._v("半径")]),n("span",{staticClass:"loc-name"},[t._v("X")]),n("PropertyShowValue",{attrs:{value:t.fill.scaleX}}),n("span",{staticClass:"loc-name"},[t._v("Y")]),n("PropertyShowValue",{attrs:{value:t.fill.scaleY,cls:{m2:1}}})],1)]),n("ul",{staticClass:"fill-list"},t._l(t.fill.colorStops,(function(e,r){return n("li",{key:"radial-colorStop-"+r},[n("div",{staticClass:"title"},[t._v(t._s(e.stop))]),n("PropertyShowColor",{attrs:{name:"",value:e.color,"non-swatch":!0}})],1)})),0)]):t._e()},Du=[],Fu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"inp",class:t.cls,on:{click:function(e){return t.clickCopy(t.value)}}},[n("span",{attrs:{title:t.value},domProps:{textContent:t._s(t.value)}})])},Pu=[],ju={methods:{clickCopy:function(t){!1!==this.doNotAutoCopy&&(Object(c["copyValueFromSelect"])(t)?this.showTextTip("已复制文本: ".concat(t),2):this.showTextTip("复制到剪切板失败",2))}},props:{value:null,cls:Object,doNotAutoCopy:{type:Boolean,default:!0}}},Ru=ju,Bu=Object(qe["a"])(Ru,Fu,Pu,!1,null,null,null),Vu=Bu.exports,Uu=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"item",class:{"in-swatch":t.hasSwatch}},[t.name?n("dt",[t._v(t._s(t.name))]):t._e(),n("dd",[n("div",{staticClass:"container"},[n("div",{staticClass:"color"},[n("i",{style:{backgroundColor:t.rgba.value},attrs:{title:"点击切换颜色类型"},on:{contextmenu:function(e){return e.preventDefault(),t.showColorSelect.apply(null,arguments)},click:t.clickColorTypeNext}}),n("span",{staticClass:"inp",class:[this.currentColorType],on:{click:function(e){return t.clickCopy(t.showValue.value)}}},[n("span",{attrs:{title:t.showValue.value},domProps:{textContent:t._s(t.showValue.value)}})])]),"hex"===this.currentColorType?n("div",{staticClass:"inp opacity",on:{click:function(e){return t.clickCopy(t.opacity)}}},[n("span",{staticClass:"opacity",attrs:{title:t.opacity},domProps:{textContent:t._s(t.opacity)}})]):t._e(),t.colors.visible?n("ul",{staticClass:"colors"},t._l(t.colorTypes,(function(e,r){return n("li",{key:e,class:{on:t.currentColorTypeIndex===r},on:{click:function(e){return t.onColorSelectChanged(r)}}},[t._v(t._s(e.toUpperCase()))])})),0):t._e()]),t.hasSwatch?n("div",{staticClass:"container"},[n("div",{staticClass:"swatch",attrs:{title:"颜色变量: "+t.swatch}},[n("span",{staticClass:"swatch-text",on:{click:function(e){return t.clickCopy(t.swatch)}}},[t._v(t._s(t.swatch))])])]):t._e()])])},$u=[],Hu={computed:{colorTypes:function(){return this.$store.state.setting.color.items},currentColorType:function(){return this.colorTypes[this.$store.state.setting.color.current]},currentColorTypeIndex:function(){return this.$store.state.setting.color.current}},methods:{getSweach:function(t){var e;if(null!=t){var n=null===(e=this.curArtboard)||void 0===e?void 0:e.artboard.swatches;if(!n)return null;var r=n[t];if(Object(l["o"])(r)){var i=r.doc,a=r.lib;return Object(l["g"])(i)&&i.length>0?i[i.length-1]:Object(l["g"])(a)&&a.length>0?a[a.length-1]:null}}},setSettingColor:function(t){this.$store.commit("setSettingColor",t)},getColorRGBAValue:function(t){return Object(h["g"])(t)},getCssShowColor:function(t,e){var n=Object(h["g"])(t),r=this.getSweach(n.hexa);return t=1===n.opacity?Object(h["e"])(n).value:n.value,r&&(r="".concat(t," : ").concat(r)),{value:t,swatch:r,name:e}},getColorValue:function(t){var e=this.getColorRGBAValue(t);switch(this.currentColorType){case"hex":e=Object(h["e"])(e);break;case"ahex":e=Object(h["c"])(e);break;case"hexa":e=Object(h["f"])(e);break;case"hsla":e=Object(h["d"])(e);break}return e}}},zu={props:{value:null,name:String,nonSwatch:{type:Boolean,default:!1}},methods:{clickCopy:function(t){Object(c["copyValueFromSelect"])(t)?this.showTextTip("已复制文本: ".concat(t),2):this.showTextTip("复制到剪切板失败",2)},showColorSelect:function(){this.colors.visible=!0},clickColorTypeNext:function(){this.setSettingColor(this.currentColorTypeIndex+1)},onColorSelectChanged:function(t){this.setSettingColor(t)},hideColorSelect:function(){var t=this;requestAnimationFrame((function(){t.colors.visible=!1}))}},computed:{rgba:function(){return this.getColorRGBAValue(this.value)},showValue:function(){return this.getColorValue(this.value)},hasSwatch:function(){return!!this.swatch},swatch:function(){return this.nonSwatch?null:this.getSweach(this.rgba.hexa)},opacity:function(){var t=this.showValue.opacity;return ce["a"].mul(t,100)+"%"}},mixins:[Hu],watch:{"colors.visible":function(t){t?(window.addEventListener("click",this.hideColorSelect,!0),window.addEventListener("contextmenu",this.hideColorSelect,!0)):(window.removeEventListener("click",this.hideColorSelect,!0),window.removeEventListener("contextmenu",this.hideColorSelect,!0))}},beforeDestroy:function(){window.removeEventListener("click",this.hideColorSelect,!0),window.removeEventListener("contextmenu",this.hideColorSelect,!0)},data:function(){return{colors:{visible:!1}}}},Wu=zu,Gu=(n("3e80"),Object(qe["a"])(Wu,Uu,$u,!1,null,"566803c6",null)),Yu=Gu.exports,Xu={computed:{EnumFillShowType:function(){return o["i"]}},components:{PropertyShowColor:Yu,PropertyShowValue:Vu},props:{fill:Object}},Ku=Xu,Zu=(n("98bd"),Object(qe["a"])(Ku,Nu,Du,!1,null,"0e857b80",null)),qu=Zu.exports,Qu={components:{PropertyShowColor:Yu,PropertyShowValue:Vu,PropertyColor:qu},props:{nodeStyle:Object},computed:{SketchEnumBorderPositionNumber:function(){return{0:"中心",1:"内",2:"外"}}}},Ju=Qu,td=Object(qe["a"])(Ju,Mu,Lu,!1,null,null,null),ed=td.exports,nd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"prop-box"},[n("dl",{staticClass:"item node-name"},[n("dt",[t._v("图层")]),n("dd",{staticClass:"cur-node-name"},[n("NodeName",{attrs:{node:t.curNode}})],1)]),t.renderTapInteraction?n("PropertyInfoInteraction",{attrs:{renderTapInteraction:t.renderTapInteraction}}):t._e(),n("h5",[t._v("比例")]),n("dl",{staticClass:"item loc"},[n("dd",[n("span",{staticClass:"loc-name mid"},[t._v("X")]),n("PropertyShowValue",{attrs:{value:t.nodeStyle.left}}),n("span",{staticClass:"loc-name"},[t._v("Y")]),n("PropertyShowValue",{attrs:{value:t.nodeStyle.top,cls:{m2:1}}})],1)]),n("dl",{staticClass:"item loc"},[n("dd",[n("span",{staticClass:"loc-name mid"},[t._v("W")]),n("PropertyShowValue",{attrs:{value:t.nodeStyle.width}}),n("span",{staticClass:"loc-name"},[t._v("H")]),n("PropertyShowValue",{attrs:{value:t.nodeStyle.height,cls:{m2:1}}})],1)]),n("dl",{staticClass:"item"},[n("dt",[t._v("不透明度")]),n("dd",[n("PropertyShowValue",{attrs:{value:t.nodeStyle.opacity}}),t.shortCornerRadiiValue?n("div",{staticClass:"inp empty"}):t._e()],1)]),t.nodeStyle.cornerRadiiValue?n("dl",{staticClass:"item"},[n("dt",[t._v("圆角")]),n("dd",[n("PropertyShowValue",{attrs:{value:t.nodeStyle.cornerRadiiValue}}),t.shortCornerRadiiValue?n("div",{staticClass:"inp empty"}):t._e()],1)]):t._e(),t.curNode.boxTransform?[0!==t.curNode.boxTransform.rotation?n("dl",{staticClass:"item"},[n("dt",[t._v("旋转")]),n("dd",[n("PropertyShowValue",{attrs:{value:t.curNode.boxTransform.rotation+"deg"}}),n("div",{staticClass:"inp empty"})],1)]):t._e(),t.flippedText?n("dl",{staticClass:"item"},[n("dt",[t._v("翻转")]),n("dd",[n("PropertyShowValue",{attrs:{value:t.flippedText}}),n("div",{staticClass:"inp empty"})],1)]):t._e()]:t._e()],2)},rd=[],id=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"item"},[n("dt",[t._v(t._s(t.typeName))]),n("dd",[n("a",{staticClass:"interaction-link",attrs:{href:"javascript:;"},on:{click:t.clickGoArtboard}},[t._v(t._s(t.toArtboardName))])])])},ad=[],od={methods:{clickGoArtboard:function(){this.$store.commit("setInteractionArtboard",this.renderTapInteraction)}},computed:{typeName:function(){return pt.getTypeName(this.renderTapInteraction.type)},toArtboardName:function(){var t,e;switch(this.renderTapInteraction.type){case pt.goBack:return"上一个画板";default:return null!==(t=null===(e=this.toArtboardItem)||void 0===e?void 0:e.name)&&void 0!==t?t:"目标画板未上传"}},toArtboardItem:function(){var t,e;return null!==(t=null===(e=this.renderTapInteraction)||void 0===e?void 0:e.toArtboardItem)&&void 0!==t?t:null}},props:{renderTapInteraction:Object}},sd=od,cd=(n("d1af"),Object(qe["a"])(sd,id,ad,!1,null,"1be0ce74",null)),ld=cd.exports,ud=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node-name",class:{focused:t.focused,"non-export":!t.node.markedForExport}},[this.node.markedForExport?n("input",{attrs:{type:"text","max-length":"50",spellcheck:"false"},domProps:{value:t.nodeShowName},on:{focus:t.inputFocus,blur:function(e){return t.inputBlur(e)},compositionstart:t.compositionstart,compositionend:t.compositionend,keyup:t.inputKeyup}}):n("div",{attrs:{title:t.nodeShowName}},[t._v(t._s(t.nodeShowName))])])},dd=[],hd={methods:{inputKeyup:function(t){var e=t.keyCode||t.which;13==e&&(t.target.blur(),t.preventDefault())},compositionstart:function(){this.inComposition=!0},compositionend:function(){this.inComposition=!1},inputFocus:function(){this.focused=!0},inputBlur:function(t){this.focused=!1;var e=t.target.value.trim();if(e!==this.nodeShowName){var n=this.node;n.markedForExport?Object(c["setNodeCustomName"])(this,n,e):this.showTextTip("只有切图资源才可以进行重命名操作")}}},computed:{nodeShowName:function(){var t=this.node,e=Object(c["getNodeShowName"])(t);if(!t.markedForExport&&Object(l["h"])(e)){e=e.trim();var n=e.length;n>33&&(e=e.substr(0,30)+"...")}return e}},data:function(){return{focused:!1,inComposition:!1}},props:{node:Object}},fd=hd,md=(n("2fe9"),Object(qe["a"])(fd,ud,dd,!1,null,"58a95a4a",null)),pd=md.exports,bd={props:{nodeStyle:Object},components:{PropertyShowValue:Vu,NodeName:pd,PropertyInfoInteraction:ld},computed:{renderTapInteraction:function(){var t=this.curNode;if(!t)return null;var e=t.renderTapInteraction;if(e)return e;var n=t.parentNode,r=t.boundsInArtboard;while(n){if(r.isSame(n.boundsInArtboard)&&(e=n.renderTapInteraction,e))return e;n=n.parentNode}return null},flippedText:function(){var t=this.curNode.boxTransform;if(t){var e="";return t.flippedHorizontally&&(e="水平"),t.flippedVertically&&(e?e+=" & 垂直":e="垂直"),e}},shortCornerRadiiValue:function(){var t=this.nodeStyle.cornerRadiiValue;return!t||-1===t.indexOf(" ")}},created:function(){l["a"]&&(window.vue_PropertyInfo=this)}},vd=bd,gd=(n("ed17"),Object(qe["a"])(vd,nd,rd,!1,null,"43bca361",null)),wd=gd.exports,xd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("section",{staticClass:"prop-box"},[n("h5",{staticClass:"fill-title"},[n("span",[t._v("填充")]),t.nodeStyle.blendMode?n("div",{staticClass:"blend-mode"},[n("span",[t._v("混合模式")]),n("PropertyShowValue",{attrs:{value:t.nodeStyle.blendMode}})],1):t._e()]),t._l(t.fills,(function(t,e){return n("PropertyColor",{key:"fill-"+e,attrs:{fill:t}})})),t.objectEffect>0?n("dl",{staticClass:"item"},[n("dt",[t._v("高斯模糊")]),n("dd",[n("PropertyShowValue",{attrs:{value:t.objectEffect}}),n("span",{staticClass:"inp empty"})],1)]):t._e()],2):t._e()},yd=[],Cd={props:{nodeStyle:Object},computed:{objectEffect:function(){return this.nodeStyle.objectEffect},blur:function(){return this.curNode.blur},fills:function(){return this.nodeStyle.fills},visible:function(){return this.fills.length>0}},components:{PropertyShowValue:Vu,PropertyColor:qu},data:function(){return{EnumFillShowType:o["i"]}}},kd=Cd,Sd=(n("cae1"),Object(qe["a"])(kd,xd,yd,!1,null,"88ab6618",null)),_d=Sd.exports,Ad=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("section",{staticClass:"prop-box"},[n("h5",[t._v("文本")]),t._l(t.combineStyles,(function(e,r){return[e.color?n("PropertyShowColor",{key:r,attrs:{name:e.name,value:t.tintColor(t.styles[0].fill.value)}}):e.hideDefault&&t.styles[0][e.field]===e.default?t._e():n("dl",{key:r,staticClass:"item"},[n("dt",{domProps:{textContent:t._s(e.name)}}),n("dd",[n("PropertyShowValue",{attrs:{value:e.extendValue(t.styles[0][e.field],"fontWeight"===e.field?t.calcPlatformShowType:t.getCalcPlatformValue)}}),"fontWeight"===e.field?n("PropertyShowValue",{attrs:{value:t.styles[0].fontWeightCss,cls:t.fontWeightCls}}):e.halfWidth?n("div",{staticClass:"inp m2 empty"}):t._e()],1)])]})),t.paragraphSpacing?n("dl",{staticClass:"item"},[n("dt",[t._v("段落间距")]),n("dd",[n("PropertyShowValue",{attrs:{value:t.paragraphSpacing}}),n("div",{staticClass:"inp m2 empty"})],1)]):t._e(),t.lineSpacing?n("dl",{staticClass:"item"},[n("dt",[t._v("行高")]),n("dd",[n("PropertyShowValue",{attrs:{value:t.lineSpacing}}),n("div",{staticClass:"inp m2 empty"})],1)]):t._e(),n("dl",{staticClass:"item"},[n("dt",[t._v("对齐方式")]),n("dd",[n("PropertyShowValue",{attrs:{value:t.curNode.textAlign}}),n("div",{staticClass:"inp m2 empty"})],1)]),t.curNode.textVerticalAlign?n("dl",{staticClass:"item"},[n("dt",[t._v("垂直对齐")]),n("dd",[n("PropertyShowValue",{attrs:{value:t.curNode.textVerticalAlign}}),n("div",{staticClass:"inp m2 empty"})],1)]):t._e()],2),t.unCombineStyles.length>0?n("div",[t._l(t.styles,(function(e,r){return[""!=t.subTexts[r]?n("section",{key:r,staticClass:"prop-box uncombine"},[n("h5",[t._v("文本"+t._s(r+1))]),t._l(t.unCombineStyles,(function(r,i){return[r.color?n("PropertyShowColor",{key:r.field,attrs:{name:r.name,value:t.tintColor(e.fill.value)}}):r.hideDefault&&e[r.field]===r.default?t._e():n("dl",{key:i,staticClass:"item"},[n("dt",{domProps:{textContent:t._s(r.name)}}),n("dd",[n("PropertyShowValue",{attrs:{value:r.extendValue(e[r.field],"fontWeight"===r.field?t.calcPlatformShowType:t.getCalcPlatformValue)}}),"fontWeight"===r.field?n("PropertyShowValue",{attrs:{value:e.fontWeightCss,cls:t.fontWeightCls}}):r.halfWidth?n("div",{staticClass:"inp m2 empty"}):t._e()],1)])]}))],2):t._e()]}))],2):t._e(),n("h5",{staticClass:"mult-h5"},[t._v(" 文本内容 "),n("a",{staticClass:"copy",attrs:{href:"javascript:;"},on:{click:function(e){return t.copyText(t.text)}}},[t._v("复制文本")])]),n("dl",{staticClass:"item mult"},[n("dd",[n("PropertyShowValue",{attrs:{doNotAutoCopy:!1,value:t.text,cls:{multiple:1}}})],1)])])},Id=[],Td=[{name:"字体",field:"fontFamily"},{name:"字重",field:"fontWeight",halfWidth:!1,hideDefault:!1,default:"normal",extendValue:function(t,e){if("number"===typeof t){var n=o["r"][t];n&&(t=n.toLowerCase())}return e===o["b"].IOS&&t&&"normal"===t.toLowerCase()&&(t="Regular"),t}},{name:"斜体",field:"fontItalic",halfWidth:!0,hideDefault:!0,default:"normal"},{name:"前景色",field:"fill",color:!0},{name:"字号",field:"fontSize",halfWidth:!0,extendValue:function(t,e){return e(t,{fontSize:!0,needArtScale:!0})}},{name:"字间距",field:"charSpacing",hideDefault:!0,default:null,halfWidth:!0,extendValue:function(t,e){return e(t,{needArtScale:!0})}}];Td.forEach((function(t){t.extendValue||(t.extendValue=function(t){return t})}));var Od={methods:{tintColor:function(t){return Object(c["getTintColor"])(this.sketchGroupFillColor,t)},copyText:function(t){null!=t&&(Object(c["copyValueFromText"])(t)?this.showTextTip("已复制文本到剪切板",2):this.showTextTip("复制到剪切板失败",2))}},computed:{fontWeightCls:function(){return{m2:1}},paragraphSpacing:function(){var t=this.curNode,e=t.paragraphSpacing;return 0===e||null==e?"":this.getCalcPlatformValue(e,{needArtScale:!0})},lineSpacing:function(){var t=this.curNode,e=t.lineSpacing;return 0===e||null==e?"":this.getCalcPlatformValue(e,{needArtScale:!0})},unCombineStyles:function(){var t=[],e=this.combineStyles;return Td.forEach((function(n){e[n.field]||t.push(n)})),t},combineStyles:function(){var t={},e=this.styles,n=e.length;return n<=1?(1===n&&Td.forEach((function(e){t[e.field]=e})),t):(Td.forEach((function(r){var i=!0,a=e[0][r.field];r.color&&(a=a.value);for(var o=1;o<n;o++){var s=e[o];if(s){var c=s[r.field];if(r.color&&(c=c.value),c!==a){i=!1;break}}}i&&(t[r.field]=r)})),t)},subTexts:function(){var t=this.text,e=[],n=this.styles;if(0===n.length||1===n.length&&0===n[0].length)return e.push(t),e;var r=0;return n.forEach((function(i,a){var o;a===n.length-1?o=t.substr(r).trim():(o=t.substr(r,i.length).trim(),r+=i.length),e.push(o)})),e},text:function(){return this.curNode.text||""},styles:function(){return this.curNode.styleRanges||[]}},props:{sketchGroupFillColor:{type:Object,validator:function(){return!0}}},components:{PropertyShowValue:Vu,PropertyShowColor:Yu}},Ed=Od,Md=Object(qe["a"])(Ed,Ad,Id,!1,null,null,null),Ld=Md.exports,Nd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("section",{staticClass:"prop-box css-box"},[n("h5",{staticClass:"mult-h5"},[t._v(" CSS "),n("a",{staticClass:"copy",attrs:{href:"javascript:;"},on:{click:function(e){return t.copyText(t.propertyText)}}},[t._v("复制样式")])]),n("dl",{staticClass:"item mult"},[n("dd",[n("ul",{staticClass:"css"},t._l(t.properties,(function(e,r){return n("li",{key:"property-"+r},[e.name?[e.swatch?n("span",{staticClass:"desc desc-swatch"},[t._v("/* "+t._s(e.swatch)+" */")]):t._e(),n("span",{staticClass:"name"},[t._v(t._s(e.name)+":")]),n("span",{staticClass:"value"},[t._v(t._s(e.value)+";")])]:e.desc?[n("span",{staticClass:"desc"},[t._v(t._s(e.desc))])]:t._e()],2)})),0)])])]):t._e()},Dd=[],Fd={mixins:[Hu],props:{nodeStyle:Object,sketchGroupFillColor:{type:Object,validator:function(){return!0}}},methods:{copyText:function(t){Object(c["copyValueFromText"])(t)?this.showTextTip("已复制样式到剪切板",2):this.showTextTip("复制到剪切板失败",2)}},computed:{visible:function(){return this.properties.length>0},properties:function(){var t,e,n=this,r=this.curNode,i=[],a=this.nodeStyle;e="opacity",t=a[e],t&&"100%"!==t&&i.push({name:e,value:t}),e="width",t=a[e],t&&i.push({name:e,value:t}),e="height",t=a[e],t&&i.push({name:e,value:t}),a.blendMode&&(e="mix-blend-mode",t=a.blendMode,t&&i.push({name:e,value:t}));var s=r.boxTransform;if(s&&(e="transform",t=0!==s.rotation?"rotate(".concat(s.rotation,"deg)"):"",s.flippedHorizontally&&(t+=" scaleX(-1)"),s.flippedVertically&&(t+=" scaleY(-1)"),t&&i.push({name:e,value:t})),a.fill){var u=a.fill;switch(u.type){case o["i"].FillColor:e="background-color",t=this.getCssShowColor(u.color,e),t&&i.push(t);break;case o["i"].RadialGradientFill:e="background-image",t="radial-gradient(ellipse ".concat(u.scaleX," ").concat(u.scaleY," at ").concat(u.startX," ").concat(u.startY," ,").concat(u.colorStops.map((function(t){return"".concat(n.getCssShowColor(t.color).value," ").concat(t.stop)})).join(","),")"),"0deg"!==u.angle&&i.push({desc:"/*径向渐变不支持旋转角度,可结合:before或:after配合transform实现*/"}),i.push({name:e,value:t});break;case o["i"].LinearGradientFill:e="background-image",t="linear-gradient(".concat(u.angle,",").concat(u.colorStops.map((function(t){return"".concat(n.getCssShowColor(t.color).value," ").concat(t.stop)})).join(","),")"),i.push({name:e,value:t})}}var d=a.border;if(d)switch(e="border",t="".concat(d.width," ").concat(d.style),i.push({name:e,value:t}),d.type){case o["i"].FillColor:e="border-color",t=this.getCssShowColor(d.color,e),t&&i.push(t);break;case o["i"].RadialGradientFill:case o["i"].LinearGradientFill:e="border-image-source",t="linear-gradient(".concat(d.angle,",").concat(d.colorStops.map((function(t){return"".concat(n.getCssShowColor(t.color).value," ").concat(t.stop)})).join(","),")"),i.push({name:e,value:t}),e="border-image-slice",t="1",i.push({name:e,value:t})}e="border-radius",t=a.cornerRadiiValue,t&&i.push({name:e,value:t}),a.objectEffect&&(e="filter",t="blur(".concat(this.getCalcPlatformValue(a.objectEffect,{needArtScale:!0}),")"),i.push({name:e,value:t}));var h=[],f=[];if(a.shadows.forEach((function(t){if(t){var e=n.getCssShowColor(t.color);e.swatch&&f.push(e.swatch),h.push("".concat(t.x," ").concat(t.y," ").concat(t.blur).concat(t.spread?" "+t.spread:""," ").concat(e.value))}})),a.innerShadows.forEach((function(t){if(t){var e=n.getCssShowColor(t.color);e.swatch&&f.push(e.swatch),h.push("".concat(t.x," ").concat(t.y," ").concat(t.blur).concat(t.spread?" "+t.spread:""," ").concat(e.value," inset"))}})),h.length>0&&(e=r.types.Text?"text-shadow":"box-shadow",t=h.join(","),i.push({name:e,value:t,swatch:f.join("\n    ")})),!r.markedForExport&&r.types.Text){var m=r.styleRanges;Object(l["g"])(m)&&m.length>0&&(m=m[0],m&&(m.fontFamily&&(e="font-family",t=m.fontFamily,i.push({name:e,value:t})),m.fontWeightCss&&"400"!==m.fontWeightCss&&(e="font-weight",t=m.fontWeightCss,i.push({name:e,value:t})),m.fontItalic&&"normal"!==m.fontItalic&&(e="font-style",t=m.fontItalic,i.push({name:e,value:t})),m.fill&&null!=m.fill.value&&(e="color",t=this.getCssShowColor(Object(c["getTintColor"])(this.sketchGroupFillColor,m.fill.value),e),i.push(t)),null!=m.fontSize&&(e="font-size",t=this.getCalcPlatformValue(m.fontSize,{fontSize:!0,needArtScale:!0}),i.push({name:e,value:t})),0!==m.charSpacing&&null!=m.charSpacing&&(e="letter-spacing",t=this.getCalcPlatformValue(m.charSpacing,{needArtScale:!0}),i.push({name:e,value:t})),m.underline?(e="text-decoration",t="underline",i.push({name:e,value:t})):m.strikethrough&&(e="text-decoration",t="line-through",i.push({name:e,value:t})))),0!=r.paragraphSpacing&&null!=r.paragraphSpacing&&(e="padding-bottom",t=this.getCalcPlatformValue(r.paragraphSpacing,{needArtScale:!0}),i.push({name:e,value:t})),0!=r.lineSpacing&&null!=r.lineSpacing&&(e="line-height",t=this.getCalcPlatformValue(r.lineSpacing,{needArtScale:!0}),i.push({name:e,value:t})),r.textAlign&&(e="text-align",t=r.textAlign,"left"!=t&&i.push({name:e,value:t})),r.textVerticalAlign&&(e="vertical-align",t=r.textVerticalAlign,i.push({name:e,value:t}))}return i},propertyText:function(){var t=this.properties;return t.map((function(t){return"".concat(t.swatch?"/* ".concat(t.swatch," */\n"):"").concat(t.name,": ").concat(t.value,";")})).join("\n").trim()}}},Pd=Fd,jd=(n("f4c4"),Object(qe["a"])(Pd,Nd,Dd,!1,null,"fc756486",null)),Rd=jd.exports,Bd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"prop-box prop-export"},[n("h5",[n("span",[t._v("切图")]),n("span",{staticClass:"export-bg"},[n("span",{class:{on:t.ExportBoxBackgroundType.Black===t.exportBoxBackground,black:1},attrs:{title:"深色背景填充"},on:{click:function(e){return t.clickExportBoxBackgroundType(t.ExportBoxBackgroundType.Black)}}}),n("span",{class:{on:t.ExportBoxBackgroundType.Transparent===t.exportBoxBackground,transparent:1},attrs:{title:"浅色背景填充"},on:{click:function(e){return t.clickExportBoxBackgroundType(t.ExportBoxBackgroundType.Transparent)}}})])]),n("section",{staticClass:"preview",class:["type"+t.exportBoxBackground]},[n("img",{class:{jpg:t.currentResInJpg},attrs:{src:t.exportPreviewSrc}})]),n("section",{staticClass:"download-box"},[n("PropertyDownloadOptions",{ref:"downOptions",attrs:{currentResInSvg:t.currentResInSvg,currentResInJpg:t.currentResInJpg,exportSvgOnly:t.exportSvgOnly,jpgQuality:t.jpgQuality,downloadPlatform:t.calcPlatformUse,node:t.curNode},on:{setJpgQuality:t.setJpgQuality,clickDownSelect:t.clickDownSelect}}),n("div",{staticClass:"btns"},[n("Select",{attrs:{options:t.resTypeSelectOptions,checkShowUpFixedHeight:48},on:{changed:t.onResTypeSelectChanged}}),t.currentResInSvg?n("a",{staticClass:"button light download",attrs:{href:"javascript:;"},on:{click:t.clickDownSelect}},[t._v("下载切图")]):n("a",{staticClass:"button light download",attrs:{href:"javascript:;"},on:{click:t.clickDownSelectAll}},[t._v("下载切图")])],1)],1)])},Vd=[],Ud=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"down-options-box"},[t.downloadPlatform===t.CALC_PLATFORM_TYPE.ANDROID?n("Select",{attrs:{options:t.androidUseMipmapSelectOptions},on:{changed:t.onAndroidUseMipmapSelectChanged}}):t._e(),n("div",{staticClass:"down-options",class:t.optionsClass},[t._l(t.downloadPlatformItems,(function(e){return n("PropertyDownloadItem",{key:e.value.name,attrs:{config:e.value,node:t.node,enabled:e.enabled,selected:t.currentResInSvg||1==t.checkSetting[e.value.scale]},on:{clickItemSelect:t.clickItemSelect,clickDownSelect:t.clickDownSelect}})})),t.currentResInJpg?n("div",{staticClass:"jpg-quality"},[n("div",{staticClass:"text"},[t._v("JPG质量")]),n("div",{staticClass:"quality-num"},[t._v(t._s(t.jpgQuality))]),n("div",{staticClass:"pullrod"},[n("div",{staticClass:"line",on:{click:t.clickPullrodLine}}),n("span",{style:{left:t.jpgQualityCssLeft},on:{mousedown:t.onPullrodMouseDown}})]),n("div",{staticClass:"button",on:{click:t.clickResetQuality}},[t._v("重置")])]):t._e()],2)],1)},$d=[],Hd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"item",class:{disabled:!t.enabled},attrs:{title:t.title}},[n("Checkbox",{attrs:{text:t.name,selected:t.selected&&t.enabled},on:{click:t.clickItemSelect}}),null!=t.node?n("section",[n("span",{staticClass:"size"},[t._v(t._s(t.size))]),n("a",{staticClass:"btn-down-current",attrs:{href:"javascript:;",title:"下载该项切图"},on:{click:t.clickDownSelect}})]):t._e()],1)},zd=[],Wd=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"checkbox",class:{on:t.selected},on:{click:t.click}},[t.text?n("i",[t._v(t._s(t.text))]):t._e()])},Gd=[],Yd={props:{text:String,selected:Boolean},methods:{click:function(){this.$emit("click",!this.selected)}}},Xd=Yd,Kd=Object(qe["a"])(Xd,Wd,Gd,!1,null,null,null),Zd=Kd.exports,qd={methods:{clickDownSelect:function(){var t={};t[this.config.scale]=1,this.$emit("clickDownSelect",t)},clickItemSelect:function(t){!t||this.enabled?this.$emit("clickItemSelect",this.config.scale,t):this.showTextTip("您无法导出该规格切图,因为设计狮没有为该画板导出该规格切图")}},computed:{inMultMode:function(){return null==this.node},title:function(){var t=this.config,e=t.name;return e},name:function(){var t,e=this.config;return t=e.name,t},originWidth:function(){return this.inMultMode?0:this.node.boundsInArtboard.width},originHeight:function(){return this.inMultMode?0:this.node.boundsInArtboard.height},size:function(){if(this.inMultMode)return"";if(!this.enabled)return"--";var t,e=this.node,n=this.curArtboard;if(n&&(t=n.artboard.mlConfig),t){var r=t.sizeMap;if(r){var i=(this.config.resname||this.config.filepath).replace("{$name$}",e.exportPath).toLowerCase(),a=r[i];if(a)return"".concat(a.width,"x").concat(a.height)}}var o=this.config.scale;return"".concat(Math.ceil(this.originWidth*o),"x").concat(Math.ceil(this.originHeight*o))}},props:{config:Object,node:Object,selected:Boolean,enabled:Boolean},components:{Checkbox:Zd}},Qd=qd,Jd=(n("946c"),Object(qe["a"])(Qd,Hd,zd,!1,null,"0c22fd6a",null)),th=Jd.exports,eh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dl",{staticClass:"select",class:{expandUp:t.expandUp||t.showDDInTop}},[n("dt",{class:{on:t.visible},attrs:{title:t.title},on:{click:function(e){e.stopPropagation(),t.visible=!t.visible}}},[t._v(t._s(t.selectName))]),t.visible?n("dd",[n("ul",{ref:"ul"},t._l(t.options,(function(e,r){return n("li",{key:r,class:{on:t.selected===e,disabled:e.disabled},on:{click:function(n){return t.clickOption(e)}}},[t._v(t._s(e.name))])})),0)]):t._e()])},nh=[],rh={methods:{checkRect:function(){var t=this,e=this.visible,n=this.expandUp;e&&(n||(this.showDDInTop=!1,this.$nextTick((function(){var e=t.$refs.ul;if(e){var n=e.getBoundingClientRect(),r=window.innerHeight-t.checkShowUpFixedHeight,i=n.bottom;i>r&&(t.showDDInTop=!0)}}))))},clickOption:function(t){if(Object(l["o"])(t)){var e=this.selected;e!==t&&(null!=e&&(e.selected=!1),t.selected=!0,this.visible=!1,this.$emit("changed",t))}},onVisibleClick:function(){var t=this;requestAnimationFrame((function(){t.visible=!1}))}},watch:{visible:function(t){t?(this.checkRect(),window.addEventListener("click",this.onVisibleClick,!0)):window.removeEventListener("click",this.onVisibleClick,!0)}},computed:{title:function(){var t=this.selected;return t&&t.title||""},selectName:function(){var t=this.selected;return t?t.name:""},selected:function(){var t=this.options,e=t.find((function(t){return Object(l["o"])(t)&&t.selected}));return null==e&&(e=t[0]),e}},beforeDestroy:function(){window.removeEventListener("click",this.onVisibleClick,!0)},data:function(){return{visible:!1,showDDInTop:!1}},props:{options:Array,expandUp:{default:!1,type:Boolean},checkShowUpFixedHeight:{default:0,type:Number}}},ih=rh,ah=(n("53d7"),Object(qe["a"])(ih,eh,nh,!1,null,null,null)),oh=ah.exports,sh={methods:{clickPullrodLine:function(t){var e=Math.round(t.layerX/1.06);isNaN(e)||(e=Math.max(1,e),e=Math.min(100,e),this.$emit("setJpgQuality",e))},onPullrodMouseDown:function(t){this.mouseDownStartQuality=this.jpgQuality,this.mouseDownStartX=t.pageX,window.addEventListener("mouseup",this.onPullrodMouseUp),window.addEventListener("mousemove",this.onPullrodMouseMove)},onPullrodMouseMove:function(t){var e=t.pageX-this.mouseDownStartX,n=Math.round(this.mouseDownStartQuality+e/1.06);n=Math.max(1,n),n=Math.min(100,n),this.$emit("setJpgQuality",n)},onPullrodMouseUp:function(){window.removeEventListener("mouseup",this.onPullrodMouseUp),window.removeEventListener("mousemove",this.onPullrodMouseMove)},clickResetQuality:function(){this.$emit("setJpgQuality",T)},onAndroidUseMipmapSelectChanged:function(t){Object(l["o"])(t)&&this.clickSetAndroidUseMipmap(t.value)},clickSetAndroidUseMipmap:function(t){this.$store.commit("setAndroidUseMipmap",t)},clickDownSelect:function(t){this.$emit("clickDownSelect",t)},clickItemSelect:function(t,e){if(!this.currentResInSvg){var n=this.checkSetting;this.$set(n,t,e?1:0),this.setLocalCheckSetting(n)}},initCheckSetting:function(){var t=this.getLocalCheckSetting();this.checkSetting=t},setLocalCheckSetting:function(t){var e=this.downloadPlatform;Object(c["setLocalStorage"])("reschecked.".concat(e),t)},getLocalCheckSetting:function(){var t=this.downloadPlatform,e=Object(c["getLocalStorage"])("reschecked.".concat(t),!0);if(!Object(l["o"])(e))switch(t){case o["b"].WEB:e={2:1};break;case o["b"].IOS:e={1:1,2:1,3:1};break;case o["b"].ANDROID:e={1:1,1.5:1,2:1,3:1,4:1};break}return[1,2,3,4,1.5].forEach((function(t){e[t]||(e[t]=0)})),e}},created:function(){this.initCheckSetting()},watch:{downloadPlatform:function(){this.initCheckSetting()}},computed:{jpgQualityCssLeft:function(){var t=this.jpgQuality;return Math.round(1.06*t)+"px"},optionsClass:function(){var t={};switch(this.currentResInSvg&&(t.svg=1),this.inMultMode&&(t.mult=1),this.downloadPlatform){case o["b"].ANDROID:t.android=1;break;case o["b"].WEB:t.web=1;break;case o["b"].IOS:t.ios=1;break}return t},inMultMode:function(){return null==this.node},androidUseMipmapSelectOptions:function(){return[{name:"drawable-...",value:!1,selected:!this.androidUseMipmap,title:"Android目录前缀"},{name:"mipmap-...",value:!0,selected:this.androidUseMipmap,title:"Android目录前缀"}]},downloadPlatformItems:function(){return Ra(this.curArtboard,this.downloadPlatform,this.androidUseMipmap,this.currentResInSvg,this.currentResInJpg&&this.exportSvgOnly)}},data:function(){return{mouseDownStartX:0,mouseDownStartQuality:0,CALC_PLATFORM_TYPE:o["b"],checkSetting:{}}},components:{PropertyDownloadItem:th,Select:oh},props:{jpgQuality:Number,currentResInJpg:Boolean,exportSvgOnly:Boolean,currentResInSvg:Boolean,downloadPlatform:Number,node:Object,bottomPosition:Boolean}},ch=sh,lh=(n("8625"),Object(qe["a"])(ch,Ud,$d,!1,null,"cee9389a",null)),uh=lh.exports,dh={methods:{setJpgQuality:function(t){t>0&&t<=100&&(this.jpgQuality=t,Object(c["setLocalStorage"])(O,t))},clickExportBoxBackgroundType:function(t){this.$store.commit("exportBoxBackgroundType",t)},onResTypeSelectChanged:function(t){Object(l["o"])(t)&&this.clickCurrentResType(t.value)},clickCurrentResType:function(t){switch(t){case o["t"].PNG:if(!this.exportPng)return void this.showTextTip("设计狮没有为该画板导出[PNG]格式的切图");break;case o["t"].WEBP:if(!this.exportWebP)return void this.showTextTip("设计狮没有为该画板导出[WEBP]格式的切图");break;case o["t"].SVG:if(!this.exportSvg)return void this.showTextTip("设计狮没有为该画板导出[SVG]格式的切图");break;case o["t"].JPG:if(!this.inCloudMode)return void this.showTextTip("导出到本地的标注信息不支持导出JPG的节点切图");break}this.currentResType=t,Object(c["setLocalStorage"])("resType",t)},clickDownSelectAll:function(){this.clickDownSelect(this.$refs.downOptions.checkSetting)},clickDownSelect:function(t){var e=this;return Object(i["a"])(Object(r["a"])().mark((function n(){return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.setInOutput(!0),n.prev=1,!e.currentResInSvg){n.next=7;break}return n.next=5,Ba([e.curNode],e.curArtboard);case 5:n.next=14;break;case 7:if(!e.currentResInJpg){n.next=12;break}return n.next=10,Ga(e.calcPlatformUse,e.androidUseMipmap,t,[e.curNode],e.curArtboard,e.jpgQuality/100);case 10:n.next=14;break;case 12:return n.next=14,Ya(e.calcPlatformUse,e.androidUseMipmap,t,[e.curNode],e.curArtboard,e.currentResInWebP);case 14:n.next=19;break;case 16:n.prev=16,n.t0=n["catch"](1),e.showTextTip(n.t0);case 19:return n.prev=19,e.setInOutput(!1),n.finish(19);case 22:case"end":return n.stop()}}),n,null,[[1,16,19,22]])})))()},initJpgQuality:function(){var t=this.curArtboard;if(t){var e=parseInt(Object(c["getLocalStorage"])(O,!1));(isNaN(e)||e<1||e>=100)&&(e=T),this.jpgQuality=e}},initCurrentResType:function(){var t=this.curArtboard;if(t){var e=parseInt(Object(c["getLocalStorage"])("resType",!1));(isNaN(e)||!isFinite(e)||e!==o["t"].SVG&&e!==o["t"].WEBP&&e!==o["t"].JPG)&&(e=o["t"].PNG);var n=this.curArtboard.artboard.mlConfig.resType;n||(n=o["t"].PNG);var r=this.exportPng,i=this.exportSvg,a=this.exportWebP;switch(e){case o["t"].PNG:r||(a?e=o["t"].WEBP:i&&(e=o["t"].SVG));break;case o["t"].SVG:i||(r?e=o["t"].PNG:a&&(e=o["t"].WEBP));break;case o["t"].WEBP:a||(r?e=o["t"].PNG:i&&(e=o["t"].SVG));break;case o["t"].JPG:this.inCloudMode||(r?e=o["t"].PNG:a?e=o["t"].WEBP:i&&(e=o["t"].SVG));break}this.currentResType=e}}},created:function(){this.initCurrentResType(),this.initJpgQuality()},watch:{inMultDownMode:function(){this.initCurrentResType(),this.initJpgQuality()},curArtboard:function(){this.initCurrentResType(),this.initJpgQuality()}},data:function(){return{currentResType:o["t"].PNG,jpgQuality:T}},computed:{ExportBoxBackgroundType:function(){return o["q"]},resTypeSelectOptions:function(){var t=this.currentResType,e={value:o["t"].PNG,name:"PNG",selected:t===o["t"].PNG,disabled:!this.exportPng},n={value:o["t"].WEBP,name:"WEBP",selected:t===o["t"].WEBP,disabled:!this.exportWebP},r={value:o["t"].SVG,name:"SVG",selected:t===o["t"].SVG,disabled:!this.exportSvg},i={value:o["t"].JPG,name:"JPG",selected:t===o["t"].JPG,disabled:!this.inCloudMode};return[e,n,r,i]},exportWebP:function(){return Object(c["hadExportWebP"])(this.curArtboard.artboard)},exportPng:function(){return Object(c["hadExportPng"])(this.curArtboard.artboard)},exportSvg:function(){return Object(c["hadExportSvg"])(this.curArtboard.artboard)},exportSvgOnly:function(){return this.exportSvg&&!this.exportPng&&!this.exportWebP},currentResInSvg:function(){return this.currentResType===o["t"].SVG},currentResInJpg:function(){return this.currentResType===o["t"].JPG},currentResInWebP:function(){return this.currentResType===o["t"].WEBP},exportPreviewSrc:function(){var t=this.curNode.mlConfig.pngPreview||this.curNode.mlConfig.svgPreview;return this.inCloudMode?t:t+"?"+this.curArtboard.artboard.mlOutputTime}},components:{PropertyDownloadOptions:uh,Select:oh}},hh=dh,fh=(n("37cd"),Object(qe["a"])(hh,Bd,Vd,!1,null,"656e8a06",null)),mh=fh.exports,ph=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"header"},[n("div",{staticClass:"platform"},[n("a",{staticClass:"btn-set-platform",class:{on:t.setting},attrs:{href:"javascript:;"},on:{click:function(e){t.setting=!t.setting}}},[t._v(t._s(t.size)+" ")]),n("span",{staticClass:"size"},[n("span",{staticClass:"round-num",class:{on:t.numberAutoRound},on:{click:t.clickRoundNum}},[t._v("数值取整")])])]),t.setting?n("div",{staticClass:"set"},[n("SetPlatform",{attrs:{showCustom:!0},on:{clickCalcPlatform:t.clickCalcPlatform,hideSetting:t.hideSetting}})],1):t._e()])},bh=[],vh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"set-platform"},[n("ul",[n("li",{class:{on:t.calcPlatformType2===t.CALC_PLATFORM_TYPE.WEB}},[n("a",{staticClass:"name",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickCalcPlatform({type:t.CALC_PLATFORM_TYPE.WEB})}}},[t._v("Web")])]),n("li",{class:{on:t.calcPlatformType2===t.CALC_PLATFORM_TYPE.ANDROID}},[n("a",{staticClass:"name",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickCalcPlatform({type:t.CALC_PLATFORM_TYPE.ANDROID})}}},[t._v("Android")])]),n("li",{class:{on:t.calcPlatformType2===t.CALC_PLATFORM_TYPE.IOS}},[n("a",{staticClass:"name",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickCalcPlatform({type:t.CALC_PLATFORM_TYPE.IOS})}}},[t._v("iOS")])]),n("li",{staticClass:"custom"},[n("dl",{class:{on:t.calcPlatformType2===t.CALC_PLATFORM_TYPE.CUSTOM}},[n("dt",{staticClass:"name",attrs:{title:"无视文档设计尺寸,强制指定当前画板的宽度"}},[t._v(" 自定义宽度 ")]),n("dd",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.calcPlatformCustomDocWidth2,expression:"calcPlatformCustomDocWidth2"}],ref:"inpWidth",staticClass:"inp",attrs:{type:"text",spellcheck:"false"},domProps:{value:t.calcPlatformCustomDocWidth2},on:{input:function(e){e.target.composing||(t.calcPlatformCustomDocWidth2=e.target.value)}}})]),n("dd",[n("Select",{attrs:{options:t.unitSelectOptions},on:{changed:t.onUnitSelectChanged}})],1),n("dd",[n("a",{staticClass:"button light btn-save",attrs:{href:"javascript:;"},on:{click:t.clickCalcPlatformCustom}},[t._v("保存")])])]),n("div",{staticClass:"tip"},[t._v("注:填0则自动取对应画板设计尺寸")])]),n("li",{staticClass:"template"},[n("dl",[n("dt",[n("span",{staticClass:"name"},[t._v("自定义单位模板"),n("Checkbox2",{attrs:{text:"",selected:t.calcUnitTemplateEnable},on:{click:function(e){return t.clickTemplateEnable()}}})],1),n("a",{staticClass:"help",attrs:{href:"https://www.zhaixiaowai.com/Article/article-1058.shtml",target:"_blank"}},[t._v("帮助")])]),n("dd",{staticClass:"input",class:{off:!t.calcUnitTemplateEnable}},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.calcUnitTemplateValue2,expression:"calcUnitTemplateValue2"}],attrs:{autocomplete:"off",spellcheck:"false"},domProps:{value:t.calcUnitTemplateValue2},on:{input:function(e){e.target.composing||(t.calcUnitTemplateValue2=e.target.value)}}}),n("a",{staticClass:"button light btn-save",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickTemplateEnable(!0)}}},[t._v("保存")])]),t._m(0)])])])])},gh=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("dd",{staticClass:"tip"},[n("div",[t._v("注:")]),n("ul",[n("li",[n("span",{staticClass:"t"},[t._v("%num%")]),t._v("当前数值")]),n("li",[n("span",{staticClass:"t"},[t._v("%W%")]),t._v("画板宽度")]),n("li",[n("span",{staticClass:"t"},[t._v("%H%")]),t._v("画板高度")]),n("li",[n("span",{staticClass:"t"},[t._v("%VW%")]),t._v("当前数值和画板宽度的百分比(1-100)")]),n("li",[n("span",{staticClass:"t"},[t._v("%VH%")]),t._v("当前数值和画板高度的百分比(1-100)")])])])}],wh={methods:{clickTemplateEnable:function(t){var e=t?this.calcUnitTemplateEnable:!this.calcUnitTemplateEnable,n=this.curArtboard.artboard,r={guid:n.docGuid,enable:e,template:t?this.calcUnitTemplateValue2:this.calcUnitTemplateValue};this.$store.commit("setUnitTemplate",r),this.calcUnitTemplateValue2=this.calcUnitTemplateValue,t?this.$emit("hideSetting"):e||this.$emit("hideSetting")},onUnitSelectChanged:function(t){this.calcPlatformCustomUnit2=t.value},clickCalcPlatformCustom:function(){var t={type:o["b"].CUSTOM,customUnit:this.calcPlatformCustomUnit2,customDocWidth:parseInt(this.calcPlatformCustomDocWidth2)};if(isNaN(t.customDocWidth)||!isFinite(t.customDocWidth)||t.customDocWidth<0)return this.showTextTip("指定宽度不合法,请正确输入"),void this.$refs.inpWidth.focus();this.clickCalcPlatform(t)},clickCalcPlatform:function(t){this.$emit("clickCalcPlatform",t)}},data:function(){return{calcPlatformType2:0,calcPlatformCustomUnit2:0,calcPlatformCustomDocWidth2:0,calcUnitTemplateValue2:"",CALC_PLATFORM_TYPE:o["b"],CALC_PLATFORM_UNIT:o["c"],unitSelectOptions:[{name:"px",value:o["c"].PX},{name:"dp",value:o["c"].DP},{name:"pt",value:o["c"].PT}]}},components:{Select:oh,Checkbox2:qc},computed:{calcUnitTemplateEnable:function(){return this.$store.state.unitTemplate.enable}},created:function(){var t=this;this.calcPlatformType2=this.calcPlatformType,this.calcPlatformCustomUnit2=this.calcPlatformCustomUnit,this.unitSelectOptions.forEach((function(e){t.$set(e,"selected",e.value===t.calcPlatformCustomUnit2)})),this.calcPlatformCustomDocWidth2=this.calcPlatformCustomDocWidth,this.calcUnitTemplateValue2=this.calcUnitTemplateValue}},xh=wh,yh=(n("c817"),Object(qe["a"])(xh,vh,gh,!1,null,"4b73cb01",null)),Ch=yh.exports,kh={methods:{clickRoundNum:function(){this.$store.commit("setNumberAutoRound",!this.numberAutoRound)},clickCalcPlatform:function(t){if(Object(l["o"])(t)&&!t.guid){var e=this.curArtboard.artboard;t.guid=e.docGuid}this.$store.commit("setPlatform",t),this.setting=!1},hideSetting:function(){this.setting=!1}},computed:{size:function(){if(!this.inArtboardMode)return"";var t=this.curArtboard.artboard.boundsInArtboard;return"".concat(this.getCalcPlatformValue(t.width,{noUnitTemplate:!0}),"*").concat(this.getCalcPlatformValue(t.height,{noUnitTemplate:!0}))},calcPlatformTypeText2:function(){switch(this.calcPlatformType){case o["b"].CUSTOM:return"".concat(this.calcPlatformCustomDocWidthShow).concat(this.getCalcPlatformCustomUnitText(!1));default:return""}},calcPlatformTypeText:function(){switch(this.calcPlatformType){case o["b"].ANDROID:return"Android";case o["b"].IOS:return"iOS";case o["b"].CUSTOM:return"自定义";default:return"Web"}}},data:function(){return{setting:!1,CALC_PLATFORM_TYPE:o["b"]}},components:{SetPlatform:Ch}},Sh=kh,_h=(n("a031"),Object(qe["a"])(Sh,ph,bh,!1,null,"5c2038cd",null)),Ah=_h.exports,Ih={methods:{getLinearGradientAngle:function(t,e){var n=0,r=t.width,i=t.height;if(0===r||0===i)return n;var a=e[0],o=e[1],s=e[2],l=e[3],u=Object(c["calculateTriangleAngle"])({y:a,x:o},{y:s,x:l});return u+"deg"},parseColor:function(t){if(t){var e=this.sketchGroupFillColor,n=this.curNode;if(t.value){if(!n.types.Text&&(!this.isSketchArtboard||!n.types.Group))return{type:o["i"].FillColor,color:Object(c["getTintColor"])(e,t.value)}}else if(Object(l["g"])(t.colorStops)&&Object(l["g"])(t.endPoints)){var r=t.gradientTransform;if(r){var i=[];t.colorStops.forEach((function(t){var n=Math.round(1e4*t.stop)/100+"%",r=Object(c["getTintColor"])(e,t.color.value);i.push({stop:n,color:r})}));var a=t.endR-t.startR||1;return{type:o["i"].RadialGradientFill,colorStops:i,angle:Object(c["decimalNumber"])(Object(c["getNumberOrDefault"])(r.rotate,0))+"deg",startX:Object(c["decimalNumber"])(100*Object(c["getNumberOrDefault"])(t.startX,.5),2)+"%",startY:Object(c["decimalNumber"])(100*Object(c["getNumberOrDefault"])(t.startY,.5),2)+"%",scaleX:Object(c["decimalNumber"])(100*Math.abs(Object(c["getNumberOrDefault"])(r.scaleX,.5)*a),2)+"%",scaleY:Object(c["decimalNumber"])(100*Math.abs(Object(c["getNumberOrDefault"])(r.scaleY,.5)*a),2)+"%"}}var s=[];return t.colorStops.forEach((function(t){var n=Math.round(1e4*t.stop)/100+"%",r=Object(c["getTintColor"])(e,t.color.value);s.push({stop:n,color:r})})),{type:o["i"].LinearGradientFill,colorStops:s,endPoints:t.endPoints,angle:this.getLinearGradientAngle(n.boundsInArtboard,t.endPoints)}}}}},computed:{cssVisible:function(){return this.calcPlatformUse===o["b"].WEB},hasValue:function(){return null!=this.curNode},borderStyle:function(){var t=this.curNode.strokeDashArray;if(!t||0===t.length)return"solid";var e,n=t[0];return e=1===t.length?n:t[1],n===e?"dashed":"dotted"},isSketchArtboard:function(){var t=this.curArtboard;if(!t)return!1;var e=t.artboard;return!(!e||!e.mlConfig)&&e.mlConfig.fileType===o["h"].SKETCH},sketchGroupFillColor:function(){if(this.isSketchArtboard){var t=this.curNode;if(t){var e=t.types;if(e&&1!==e.Group)return Object(c["getRootGroupFillColor"])(t)}}},nodeStyle:function(){var t=this;if(!this.hasValue)return{borders:[],shadows:[],innerShadows:[],fills:[]};var e=this.opacity,n=this.top,r=this.left,i=this.width,a=this.height,o=this.cornerRadiiValue,s={opacity:e,top:n,left:r,width:i,height:a,cornerRadiiValue:o,borders:[],shadows:[],innerShadows:[],fills:[]},l=this.curNode;if(l.types.GraphicNode){var u,d,h,f,m=l.blur;if(m&&m.visible&&!m.isBackgroundEffect&&m.blurAmount>0?s.objectEffect=m.blurAmount:s.objectEffect=0,l.strokeEnabled&&l.stroke)u=l.strokeArr?l.strokeArr:[{stroke:l.stroke,strokeEnabled:l.strokeEnabled,strokeWidth:l.strokeWidth,strokePosition:l.strokePosition}],u.forEach((function(e){if(e){var n=t.parseColor(e.stroke);n&&(n.style=function(t){if(!t||0===t.length)return"solid";var e,n=t[0];return e=1===t.length?n:t[1],n===e?"dashed":"dotted"}(e.strokeDashArray),n.width=t.getCalcPlatformValue(e.strokeWidth,{needArtScale:!0}),n.position=e.strokePosition,0===s.borders.length&&(s.border=n),s.borders.push(n))}}));if(l.shadow&&l.shadow.visible)d=l.shadowArr?l.shadowArr:[l.shadow],d.forEach((function(e){if(e){var n={x:t.getCalcPlatformValue(e.x,{needArtScale:!0}),y:t.getCalcPlatformValue(e.y,{needArtScale:!0}),blur:t.getCalcPlatformValue(e.blur,{needArtScale:!0}),color:e.color.value};"number"===typeof e.spread&&0!==e.spread&&(n.spread=t.getCalcPlatformValue(e.spread,{needArtScale:!0})),0===s.shadows.length&&(s.shadow=n),s.shadows.push(n)}}));if(l.innerShadow&&l.innerShadow.visible)h=l.innerShadowArr?l.innerShadowArr:[l.innerShadow],h.forEach((function(e){if(e){var n={x:t.getCalcPlatformValue(e.x,{needArtScale:!0}),y:t.getCalcPlatformValue(e.y,{needArtScale:!0}),blur:t.getCalcPlatformValue(e.blur,{needArtScale:!0}),color:e.color.value};"number"===typeof e.spread&&0!==e.spread&&(n.spread=t.getCalcPlatformValue(e.spread,{needArtScale:!0})),0===s.innerShadows.length&&(s.innerShadow=n),s.innerShadows.push(n)}}));if(l.blendMode&&l.blendMode!==c["SCENENODE_BLEND_MODE"].PASSTHROUGH&&l.blendMode!==c["SCENENODE_BLEND_MODE"].NORMAL&&(s.blendMode=l.blendMode),l.fillEnabled&&l.fill)f=l.fillArr?l.fillArr:[{fillEnabled:!0,fill:l.fill}],f.forEach((function(e){if(e){var n=t.parseColor(e.fill);0==s.fills.length&&(s.fill=n),s.fills.push(n)}}))}return s},cornerRadiiValue:function(){var t=this.curNode.cornerRadii;return t?Object(l["g"])(t)?null:t.bottomLeft!==t.bottomRight||t.bottomLeft!==t.topLeft||t.bottomLeft!==t.topRight?"".concat(this.getCalcPlatformValue(t.topLeft,{needArtScale:!0})," ").concat(this.getCalcPlatformValue(t.topRight,{needArtScale:!0})," ").concat(this.getCalcPlatformValue(t.bottomRight,{needArtScale:!0})," ").concat(this.getCalcPlatformValue(t.bottomLeft,{needArtScale:!0})):0!==t.topLeft?this.getCalcPlatformValue(t.topLeft,{needArtScale:!0}):void 0:null},width:function(){var t=this.curNode,e=t.markedForExport;return this.getCalcPlatformValue(t.boundsInArtboard.width,{markedForExport:e})},height:function(){var t=this.curNode,e=t.markedForExport;return this.getCalcPlatformValue(t.boundsInArtboard.height,{markedForExport:e})},top:function(){return this.curNode.types.Artboard?0:this.getCalcPlatformValue(this.curNode.boundsInArtboard.y)},left:function(){return this.curNode.types.Artboard?0:this.getCalcPlatformValue(this.curNode.boundsInArtboard.x)},opacity:function(){return Math.round(100*this.curNode.opacity)+"%"}},components:{PropertiesGraphicNode:ed,PropertyInfo:wd,PropertyFill:_d,PropertyText:Ld,PropertyExport:mh,Header:Ah,PropertyCss:Rd}},Th=Ih,Oh=(n("70b8"),Object(qe["a"])(Th,Ou,Eu,!1,null,null,null)),Eh=Oh.exports,Mh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-main",class:{on:t.artboardInComment&&t.artboardCommentVisible}},[t.commentDetailVisible?n("DetailComment",{attrs:{errorText:t.errorText,fetchDetailState:t.fetchDetailState,listNeedRefresh:t.listNeedRefresh,notSupportCommentCloudVersion:t.notSupportCommentCloudVersion},on:{clickReload:t.clickRefresh,commentAdded:t.commentAdded,onCommentUpdateTime:t.onCommentUpdateTime}}):n("div",{staticClass:"login-tip"},[n("div",{staticClass:"box"},[n("div",{staticClass:"icon"}),n("div",{staticClass:"text"},[t._v("需要登录查看评论内容")]),n("div",{staticClass:"button light",on:{click:t.goCloudLogin}},[t._v("去登录")]),n("div",{staticClass:"text"},[t._v("还没有标记狮账号？去"),n("a",{attrs:{href:"javascript:;"},on:{click:t.goCloudLogin}},[t._v("注册")])])])])],1)},Lh=[],Nh={};function Dh(t,e,n,r){var i=Nh[t];i||(i=Nh[t]={});var a={diff:r,time:Date.now(),value:n};i[e]=a}function Fh(t,e){var n=Nh[t];if(!n)return null;var r=n[e];if(!r)return null;var i=r.time,a=Date.now(),o=a-i;return o<=0||o>=r.diff?(delete n[e],null):r.value}l["a"]&&(window.globalCache=Nh);var Ph=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{staticClass:"detail-comment"},[t.listNeedRefresh&&t.fetchDetailState===t.FetchState.Success?n("div",{staticClass:"comment-refresh"},[n("a",{staticClass:"btn-refresh",attrs:{href:"javascript:;"},on:{click:function(e){t.setSelectComment(null),t.clickReload()}}},[t._v("评论有更新，点击刷新")])]):t._e(),n("div",{staticClass:"comments"},[t.fetchDetailState===t.FetchState.Fetching||t.fetchDetailState===t.FetchState.Error?n("div",{staticClass:"error"},[n("NetworkLoading",{attrs:{loadText:"正在获取评论信息...",errorText:t.errorText,isLoading:t.fetchDetailState===t.FetchState.Fetching,isError:t.fetchDetailState===t.FetchState.Error,reLoadText:"刷新"},on:{reload:function(e){return t.clickReload()}}})],1):t.notSupportCommentCloudVersion?n("div",{staticClass:"feature"},[t._v(" 私有云部署包版本过低,"),n("br"),t._v("请先联系管理员升级私有云部署包 ")]):t.comments&&0===t.comments.length?n("div",{staticClass:"feature"},[t._v("暂无评论，快去添加吧！")]):t.comments?n("div",{ref:"commentList",staticClass:"comment-list"},t._l(t.comments,(function(e,r){return n("CommentItem",{key:0===e.id?"index_"+r:e.id,attrs:{users:t.users,comment:e},on:{commentAdded:t.commentAdded,commentRemove:t.commentRemove,onCommentUpdateTime:t.onCommentUpdateTime}})})),1):t._e()]),t.notSupportCommentCloudVersion?t._e():n("div",{staticClass:"art-editor"},[t.cloudIsLogin?n("Editor",{attrs:{commentId:0,replyId:0,parent:{id:0,comments:t.comments},users:t.users,initSummary:""},on:{commentAdded:t.commentAdded,onCommentUpdateTime:t.onCommentUpdateTime}}):n("div",{staticClass:"login-tip"},[n("div",{staticClass:"box"},[n("div",{staticClass:"text"},[t._v("需要登录才可进行评论")]),n("div",{staticClass:"button light",on:{click:t.goCloudLogin}},[t._v("去登录")]),n("div",{staticClass:"text"},[t._v("还没有标记狮账号？去"),n("a",{attrs:{href:"javascript:;"},on:{click:t.goCloudLogin}},[t._v("注册")])])])])],1)]):t._e()},jh=[],Rh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor"},[t.attachLoading?n("div",{staticClass:"attach-loading"},[n("p",[t._v("附件添加中...")])]):t._e(),t.attachFetching?n("div",{staticClass:"attach-fetching"},[t._v("评论数据提交中...")]):t._e(),n("EditorTextarea",{ref:"customInput",attrs:{initValue:t.initSummary,maxlength:t.maxLength,placeholder:"留下你的评论,支持@成员"},on:{setValue:t.setValue,submit:t.submit}}),t.attachments.length>0?n("ul",{staticClass:"attachments"},t._l(t.attachments,(function(e){return n("li",{key:e.id,on:{click:function(n){return n.preventDefault(),t.clickAttach(e)}}},[n("span",{staticClass:"btn-remove",attrs:{title:"移除"},on:{click:function(n){return n.stopPropagation(),t.clickRemove(e)}}}),n("BlobImage",{attrs:{image:e.thumbBlob||e.blob}})],1)})),0):t._e(),n("div",{ref:"btns",staticClass:"btns"},[n("ul",{staticClass:"menu"},[0===t.replyId?n("li",{staticClass:"point",class:{on:t.pointEnable,pointed:this.pointed},attrs:{title:"添加评注"},on:{click:t.startPoint}},[t.pointed?n("span",[t._v(t._s(t.pointIndex))]):t._e()]):t._e(),n("li",{staticClass:"localimage",attrs:{title:"上传本地图片"},on:{click:function(e){return e.target!==e.currentTarget?null:t.clickLocalFile.apply(null,arguments)}}},[n("input",{ref:"file",attrs:{type:"file",accept:t.supportFileExt},on:{change:t.onLocalFileChange}})]),n("li",{staticClass:"drawimage",class:{on:t.inDrawingSelf},attrs:{title:"画板截图"},on:{click:t.startDraw}}),n("li",{staticClass:"emoji",class:{on:t.emojiListVisible},on:{click:function(e){return e.target!==e.currentTarget?null:t.openEmojiList.apply(null,arguments)}}},[t.emojiListVisible?n("div",{staticClass:"emoji-list"},t._l(t.EnumEmojiSupportList,(function(e){return n("div",{key:e.name,class:["icon-emoji","emoji-"+e.name],on:{click:function(n){return t.clickEmojiItem(e)}}})})),0):t._e()])]),n("div",{staticClass:"button light submit",class:{off:!t.canSubmit},on:{click:t.submit}},[t._v("评论")])])],1)},Bh=[],Vh=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor-textarea-container"},[n("div",{ref:"input",staticClass:"editor-textarea",attrs:{contenteditable:"true",placeholder:t.placeholder,autocomplete:"off",spellcheck:"false"},on:{click:t.clickInput,paste:function(e){return e.preventDefault(),t.onInputPaste.apply(null,arguments)},focus:t.onInputFocus,blur:t.onInputBlur,compositionstart:t.onCompositionStart,compositionend:t.onCompositionEnd,input:t.onInput,keyup:t.onInputKeyup}},[t._v(t._s(t.initValue))]),n("EditorUsers",{ref:"users",on:{clickUser:t.clickAtUser}})],1)},Uh=[],$h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{ref:"box",staticClass:"at-users",class:{"in-top":t.showInTop}},[t.fetchState===t.FetchState.Fetching||t.fetchState===t.FetchState.Error?n("div",{staticClass:"error"},[n("NetworkLoading",{attrs:{loadText:"正在获取用户列表信息...",errorText:t.errorText,isLoading:t.fetchState===t.FetchState.Fetching,isError:t.fetchState===t.FetchState.Error,reLoadText:""},on:{reload:function(e){return t.clickReload()}}})],1):0===t.list.length?n("div",{staticClass:"empty"},[t._v('未检索到 "'+t._s(t.searchText)+'" 相关的用户')]):n("ul",t._l(t.list,(function(e){return n("li",{key:e.id,attrs:{title:e.nickName+"("+e.email+")"},on:{click:function(n){return t.clickUser(e)}}},[n("div",{staticClass:"name"},[t._v(t._s(e.nickName))]),n("div",{staticClass:"email"},[t._v("("+t._s(e.email)+")")])])})),0)]):t._e()},Hh=[],zh={components:{NetworkLoading:aa},methods:{clickUser:function(t){this.$emit("clickUser",t),this.visible=!1},searchUser:function(t){var e=this;this.searchText=Object(l["h"])(t)?t.trim().toLowerCase():"",this.visible=!0,this.clickReload(),this.showInTop=!0,this.$nextTick((function(){var t=e.$refs.box;if(t){var n=t.getBoundingClientRect();n.top<144&&(e.showInTop=!1)}}))},hide:function(){this.visible=!1},clickReload:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i,a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.fetchState!==c["FetchState"].Fetching){e.next=2;break}return e.abrupt("return");case 2:if(t.visible){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,t.errorText=null,t.fetchState=c["FetchState"].Fetching,n=t.searchText,e.next=10,t.getAllUsers();case 10:i=e.sent,a=n.length>0,i=i.filter((function(t){if(t){if(!a)return!0;var e=(t.nickName||"").toLowerCase();return-1!==e.indexOf(n)}})),t.list=i,t.fetchState=c["FetchState"].Success,e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](4),t.errorText=e.t0,t.fetchState=c["FetchState"].Error;case 21:case"end":return e.stop()}}),e,null,[[4,17]])})))()}},data:function(){return{FetchState:c["FetchState"],fetchState:c["FetchState"].Normal,errorText:null,list:[],searchText:"",visible:!1,showInTop:!1}}},Wh=zh,Gh=(n("aa35"),Object(qe["a"])(Wh,$h,Hh,!1,null,"26289ab6",null)),Yh=Gh.exports,Xh="marklion-cloud-uid",Kh={components:{EditorUsers:Yh},methods:{onInputKeyup:function(t){var e=t.keyCode||t.which,n=this.inMacOS?t.metaKey:t.ctrlKey;n&&13===e&&(t.preventDefault(),this.$emit("submit"))},clickAtUser:function(t){var e=this;t&&requestAnimationFrame((function(){e.insertAtUser(t)}))},onInput:function(){this.$emit("setValue",this.getValue()),this.autoParseSearchUserText()},autoParseSearchUserText:function(){var t=this;clearTimeout(this.searchUserHandle),this.searchUserHandle=setTimeout((function(){var e=t.getSearchUserText(),n=t.$refs.users;n&&(e?(e=e.substr(1),n.searchUser(e)):n.hide())}),50)},onCompositionStart:function(){this.inComposition=!0},onCompositionEnd:function(){this.inComposition=!1},onInputPaste:function(t){var e=t.clipboardData,n=e.getData("text/plain");this.insertText(n)},clickInput:function(t){var e,n=t.target,r=this.$refs.input;if(r!=n&&(e="INPUT"===n.tagName?+n.getAttribute(Xh):NaN,!isNaN(e))){var i=window.getSelection(),a=document.createRange(),o=!1,s=n.nextSibling;if(s&&3===s.nodeType){var c=s.textContent;c&&c.length>0&&(c=c[0]," "!==c&&" "!==c||(a.setStart(s,1),o=!0))}o||a.setStartAfter(n),a.collapse(!0),i.removeAllRanges(),i.addRange(a)}},moveRangeToEnd:function(t){if(t||(t=this.$refs.input),t&&window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}},setFocus:function(){this.isInputFocus||this._setLastRange()},_setLastRange:function(){var t=this.$refs.input;if(t){t.focus();var e=this.lastRange;if(e){var n=window.getSelection();n.removeAllRanges(),n.addRange(e)}else this.moveRangeToEnd(t)}},_appendData:function(t,e){var n=this;this._setLastRange(),document.execCommand("insertHTML",!1,t),e&&document.execCommand("insertText",!1," "),requestAnimationFrame((function(){var t=n.$refs.input;if(t)for(var e=t.querySelectorAll("*"),r=0,i=e.length;r<i;r++){var a=e[r],o=a.tagName;switch(o){case"P":case"DIV":case"SPAN":case"FONT":var s=a.style.cssText;s&&(a.style.cssText="");break}}}))},getUserText:function(t){return"[@uid:".concat(t,";]")},insertAtUser:function(t){var e;if(t){null===(e=this.$refs.input)||void 0===e||e.focus();var n=this.canEnterTextLength(),r=this.getUserText(t.id);if(n-r<0)this.showTextTip("文本长度已超过输入框允许的最大值:".concat(this.maxlength));else{var i="<input type='button' ".concat(Xh,"='").concat(t.id,"'  class='at-user' value='@").concat(t.nickName,"' />"),a=this.lastRange;if(a){var o=a.startContainer,s=a.endContainer,c=a.startOffset,l=a.endOffset;if(o&&o==s&&c==l&&3===o.nodeType){var u=o.textContent;if(u){var d=u.substring(0,c).lastIndexOf("@");if(-1!==d){var h=document.createRange();h.setStart(o,d),h.setEnd(o,c);var f=window.getSelection();f.removeAllRanges(),f.addRange(h),document.execCommand("insertText",!1,""),this.lastRange=h}}}}this._appendData(i,!0)}}},insertText:function(t){var e;if(Object(l["h"])(t)&&(t=Object(c["htmlEncode"])(t),Object(l["h"])(t))){var n=this.canEnterTextLength();if(0!==n){var r=t.length;n<r&&(t=t.substr(0,n)),null===(e=this.$refs.input)||void 0===e||e.focus(),this._appendData(t)}else this.showTextTip("文本长度已超过输入框允许的最大值:".concat(this.maxlength))}},canEnterTextLength:function(){var t=this.maxlength,e=this.getValue().length,n=this.getSelectText().length;return Math.max(t-e+n,0)},getSearchUserText:function(){var t=this.lastRange;if(!t)return"";var e=t.startContainer,n=t.endContainer,r=t.startOffset,i=t.endOffset;if(e!=n)return"";if(r!=i)return"";if(3!==e.nodeType)return"";var a=e.textContent;if(!a)return"";a=a.substring(0,r);var o=a.substring(0,r).lastIndexOf("@");return-1===o?"":(a=a.substring(o),/[ [\]]/.test(a)?"":a)},getSelectText:function(){var t=this.lastRange;if(!t)return"";var e=t.cloneContents();try{for(var n=e.childNodes,r="",i=0,a=n.length;i<a;i++){var o=n[i];r+=this.getNodeValue(o)}return r.replace(/\xa0/g," ")}finally{e=null}},getNodeValue:function(t){var e=this;switch(t.nodeType){case 3:return t.textContent||"";case 1:var n=+t.getAttribute(Xh);if(isNaN(n)||!(n>0)){var r,i=t.tagName;switch(i){case"DIV":case"P":case"SECTION":r=" ";break;default:r="";break}var a=t.childNodes;return a.forEach((function(t){r+=e.getNodeValue(t)})),r}return"[@uid:".concat(n,";]");default:return""}},getValue:function(){var t=this.$refs.input;if(t){for(var e=t.childNodes,n="",r=0,i=e.length;r<i;r++){var a=e[r];n+=this.getNodeValue(a)}return n.replace(/\xa0/g," ")}},setEmpty:function(){var t,e=this.$refs.input;if(e)while(null!=(t=e.firstChild))e.removeChild(t)},onSelectionChange:function(){var t=window.getSelection();this.lastRange=t.rangeCount>0?t.getRangeAt(0):null},onInputFocus:function(){this.isInputFocus=!0,document.addEventListener("selectionchange",this.onSelectionChange)},onInputBlur:function(){this.isInputFocus=!1,document.removeEventListener("selectionchange",this.onSelectionChange)}},watch:{isInputFocus:function(t){var e=this;clearTimeout(this.autoHideUsersHandle),t||(this.autoHideUsersHandle=setTimeout((function(){var t;null===(t=e.$refs.users)||void 0===t||t.hide()}),500))}},data:function(){return{isInputFocus:!1,searchUserHandle:0,lastRange:null,inComposition:!1,autoHideUsersHandle:0}},beforeDestroy:function(){this.lastRange=null,clearTimeout(this.searchUserHandle),document.removeEventListener("selectionchange",this.onSelectionChange),this.setEmpty()},created:function(){l["a"]&&(window.vue_EditorTextarea=this)},props:{placeholder:{type:String,default:""},maxlength:{type:Number,default:0},initValue:{type:String,default:""}}},Zh=Kh,qh=(n("2838"),Object(qe["a"])(Zh,Vh,Uh,!1,null,"8361a6b8",null)),Qh=qh.exports,Jh={components:{BlobImage:nr,EditorTextarea:Qh},methods:{setValue:function(t){this.summary=t},autoHideEmojiList:function(){var t=this;clearTimeout(this.emojiListHideHandle),this.emojiListHideHandle=setTimeout((function(){t.emojiListVisible=!1}),50)},clickEmojiItem:function(t){var e=this;this.emojiListVisible=!1,t&&requestAnimationFrame((function(){var n=e.$refs.customInput;n&&n.insertText("[".concat(t.text,"]"))}))},openEmojiList:function(){this.emojiListVisible=!this.emojiListVisible},startPoint:function(t){var e=this;return Object(i["a"])(Object(r["a"])().mark((function n(){var i,a,o;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.pointInfo,a=e.preventPoint,o=e.inDrawing,!o){n.next=4;break}return e.showTextTip("正在编辑截图，无法添加评注"),n.abrupt("return");case 4:if(!e.pointed){n.next=11;break}return n.next=7,e.confirm({text:"确认移除该评论的评注?"});case 7:if(!n.sent){n.next=10;break}i.point.enable=!1,i.instance=null;case 10:return n.abrupt("return");case 11:e.showTextTip("点击当前区域任意位置添加评注"),a.enable=!0,a.x=t.clientX,a.y=t.clientY,i.instance=e;case 16:case"end":return n.stop()}}),n)})))()},clickAttach:function(t){var e=this.attachments.map((function(t){return t.blob})),n=e.findIndex((function(e){return e===t.blob}));-1===n&&(n=0),this.$store.commit("setImageViewer",{imgList:e,currentIndex:n})},fixScroll:function(){var t=this.replyId;if(0!==t){var e=this.$refs.btns;e&&e.scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"})}},focus:function(){var t=this.$refs.customInput;null===t||void 0===t||t.setFocus()},clean:function(){this.attachments.splice(0);var t=this.$refs.customInput;null===t||void 0===t||t.setEmpty();var e=this.preventPoint,n=this.point,r=this.pointInfo,i=this.editComment;r.instance===this&&(r.instance=null,n.enable=!1,n.x=n.y=0,e.enable=!1,e.x=e.y=0),this.inDrawingSelf&&(i.instance=null,i.drawing=!1)},clickRemove:function(t){var e=this.attachments,n=e.findIndex((function(e){return e===t}));-1!==n&&e.splice(n,1)},getCustomEditorValue:function(){var t,e,n=null!==(t=null===(e=this.$refs.customInput)||void 0===e?void 0:e.getValue())&&void 0!==t?t:"";return n},submit:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i,a,o,s,u,d,h,f,m,p,b,v,g;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.attachments,i=t.fetchState,a=t.curArtboardId,i!==c["FetchState"].Fetching){e.next=4;break}return e.abrupt("return");case 4:if(!t.inDrawing){e.next=7;break}return t.showTextTip("正在编辑截图,请先保存或取消"),e.abrupt("return");case 7:if(o=[],s=t.getCustomEditorValue(),u=t.maxLength,d=s.length,!(d>u)){e.next=14;break}return t.showTextTip("文本长度已超过输入框允许的最大值(".concat(u,")")),e.abrupt("return");case 14:if(h={artboardId:a,commentId:t.commentId,replyId:t.replyId,summary:s,attachments:[]},n.forEach((function(t){o.push(t.blob),t.thumbBlob&&o.push(t.thumbBlob),h.attachments.push(t.data)})),Object(l["h"])(h.summary)||0!==h.attachments.length){e.next=20;break}return t.showTextTip("评论内容和图片附件不能都为空"),t.focus(),e.abrupt("return");case 20:if(t.pointed&&(h.pointX=t.point.x,h.pointY=t.point.y,h.pointEnable=!0),t.fetchState=c["FetchState"].Fetching,e.prev=22,t.checkLoginThrow()){e.next=26;break}return t.fetchState=c["FetchState"].Error,e.abrupt("return");case 26:return f=Object(c["strToUtf8ArrayBuffer"])(JSON.stringify(h)),o.unshift(f),o.unshift(Object(c["numberToUint32"])(f.byteLength)),f=Object(c["combineArrayBuffer"])(o),e.next=32,t.fetchPostCloudApi("addartboardcommentbyweb",{body:f});case 32:if(m=e.sent,t.fetchState=c["FetchState"].Success,o=h=null,Object(l["o"])(m)){e.next=37;break}throw"返回值异常:".concat(m);case 37:if(m.success){e.next=39;break}throw m.errMsg;case 39:if(Object(l["o"])(m.data)){e.next=41;break}throw"返回值异常:".concat(JSON.stringify(m));case 41:m=m.data,p=m.commentUpdateTime,t.$emit("onCommentUpdateTime",{commentUpdateTime:p,artboardId:a}),b=m,v=b.atUsers,h=m.comment,g=t.users,g&&Object(l["g"])(v)&&v.forEach((function(e){e&&t.$set(g,e.id,e)})),h=Tn(h,{id:0,email:t.cloudUserEmail,userKey:t.cloudUserKey,nickName:t.cloudNickName},c["OUTPUT_CLOUD_HOST_URL"],t.parent,g),t.clean(),t.showTextTip("评论已提交成功"),t.$emit("commentAdded",h),e.next=58;break;case 54:e.prev=54,e.t0=e["catch"](22),t.showTextTip(e.t0),t.fetchState=c["FetchState"].Error;case 58:case"end":return e.stop()}}),e,null,[[22,54]])})))()},clickLocalFile:function(){var t;this.attachments.length>=In?this.showTextTip("无法选择图片,已达图片提交上限"):null===(t=this.$refs.file)||void 0===t||t.click()},onLocalFileChange:function(t){var e=this,n=t.target,r=n.files?n.files[0]:null;if(r){n.value="";var i=r.name,a=r.size,o=r.type;if(i&&!(a<1)&&o)if(0===o.indexOf("image/"))if(a>An)this.showTextTip("选择的文件大小[".concat(Object(c["transformPcSize"])(a),"]太大,不能超过[").concat(Object(c["transformPcSize"])(An),"]"));else{i=i.toLowerCase();var s=i.length,l=this.isSupportWebp,u=_n.find((function(t){if(!l&&t===Sn)return!1;var e=i.indexOf(t);return-1!==e&&e+t.length===s}));u?this.addAttachMent(r).then((function(){e.showTextTip("图片已添加")})).catch((function(t){return e.showTextTip(t)})):this.showTextTip("请选择正确的图片文件")}else this.showTextTip("请选择正确的图片文件")}},addAttachMent:function(t){var e=this;return Object(i["a"])(Object(r["a"])().mark((function n(){var i;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.attachLoading=!0,n.next=3,H(t);case 3:return i=n.sent,e.attachments.push(i),e.attachLoading=!1,n.abrupt("return",i);case 7:case"end":return n.stop()}}),n)})))()},startDraw:function(){this.inDrawing?this.showTextTip("当前已在画板截图编辑模式"):this.attachments.length>=In?this.showTextTip("无法编辑画板截图,已达图片提交上限"):(this.$store.commit("startDraw",this),this.showTextTip("在当前区域编辑画板相关截图"))}},watch:{emojiListVisible:function(t){clearTimeout(this.emojiListHideHandle),t?window.addEventListener("click",this.autoHideEmojiList,!0):window.removeEventListener("click",this.autoHideEmojiList,!0)},curArtboardId:function(){this.clean()}},computed:{canSubmit:function(){var t=this.fetchState,e=this.summary,n=this.attachments;return t!==c["FetchState"].Fetching&&!(0===n.length&&!Object(l["h"])(e.trim()))},EnumEmojiSupportList:function(){return lr},point:function(){return this.pointInfo.point},preventPoint:function(){return this.pointInfo.preventPoint},pointInfo:function(){return this.$store.state.editComment.pointInfo},pointed:function(){return this.pointInfo.instance===this&&this.point.enable},pointEnable:function(){return this.pointInfo.instance===this&&(this.point.enable||this.preventPoint.enable)},pointIndex:function(){return this.pointed?this.point.pointIndex:""},attachFetching:function(){return this.fetchState===c["FetchState"].Fetching},isSupportWebp:function(){return this.$store.state.isSupportWebp===pe.Support},canDestory:function(){return 0===this.attachments.length&&!Object(l["h"])(this.summary)},supportFileExt:function(){var t=_n;return this.isSupportWebp||(t=t.filter((function(t){return t!==Sn}))),t.join(",")},inDrawing:function(){var t=this.editComment;return t.drawing},inDrawingSelf:function(){var t=this.editComment;return t.drawing&&t.instance===this},artboard:function(){var t=this.curArtboard;return t?t.artboard:null}},beforeDestroy:function(){clearTimeout(this.emojiListHideHandle),window.removeEventListener("click",this.autoHideEmojiList,!0),this.clean()},created:function(){this.summary=Object(l["h"])(this.initSummary)?this.initSummary:""},data:function(){return{maxLength:256,inputFocused:!1,emojiListHideHandle:0,emojiListVisible:!1,attachLoading:!1,summary:"",attachments:[],fetchState:c["FetchState"].Normal}},props:{commentId:Number,parent:Object,replyId:Number,users:Object,initSummary:{type:String,default:""}}},tf=Jh,ef=(n("2893"),Object(qe["a"])(tf,Rh,Bh,!1,null,"19e1ecbc",null)),nf=ef.exports,rf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.comment?n("div",{staticClass:"comment-detail",attrs:{id:"art_c"+t.comment.commentId+"_"+t.comment.id}},[n("div",{staticClass:"content",class:{on:t.selectComment===t.comment},on:{click:t.clickPoint}},[n("UserFace2",{attrs:{self:t.isSelfComment,title:t.userFaceTitle,text:t.userFaceText}}),n("div",{staticClass:"userinfo"},[n("div",{staticClass:"summary",class:{reply:t.isReply}},[t.canRemove?n("a",{staticClass:"btn-del",attrs:{href:"javascript:;",title:"删除评论"},on:{click:t.clickRemove}}):t._e(),n("div",{staticClass:"name"},[t._v(t._s(t.userNickName)),t.isReplyOther?n("span",{staticClass:"reply-to"},[t._v("回复 "+t._s(t.comment.replyUser.nickName))]):t._e()]),t.comment.pointEnable?n("span",{staticClass:"point"},[t._v(t._s(t.comment.pointIndex))]):t._e(),n("span",{domProps:{innerHTML:t._s(t.summaryHTML)}})]),t.attachMentImgs.length>0?n("ul",{staticClass:"attachments"},t._l(t.attachMentImgs,(function(e,r){return n("li",{key:r,on:{click:function(n){return n.preventDefault(),t.clickAttach(e)}}},[n("BlobImage",{attrs:{image:e.preview}})],1)})),0):t._e(),n("div",{staticClass:"date"},[t._v(t._s(t.comment.dateStr)),n("a",{class:{on:t.editorVisible},attrs:{href:"javascript:;"},on:{click:t.clickReply}},[t._v(t._s(t.editorVisible?"收起回复":"回复"))])])])],1),t.editorEnable?n("Editor",{directives:[{name:"show",rawName:"v-show",value:t.editorVisible,expression:"editorVisible"}],ref:"editor",attrs:{commentId:t.comment.commentId,replyId:t.comment.id,parent:t.comment.parent||t.comment,users:t.users},on:{commentAdded:t.commentAdded,onCommentUpdateTime:t.onCommentUpdateTime}}):t._e(),t.comment.comments?n("div",{staticClass:"child"},t._l(t.comment.comments,(function(e,r){return n("CommentItem",{key:0===e.id?t.comment.id+"_index_"+r:t.comment.id+"_id_"+e.id,attrs:{comment:e,selectComment:t.selectComment,users:t.users},on:{commentAdded:t.commentAdded,commentRemove:t.commentRemove,onCommentUpdateTime:t.onCommentUpdateTime}})})),1):t._e()],1):t._e()},af=[],of={off:1,on:2,hide:3},sf={components:{UserFace2:cr,Editor:nf,BlobImage:nr},name:"CommentItem",methods:{onCommentUpdateTime:function(t){this.$emit("onCommentUpdateTime",t)},clickPoint:function(t){var e=t.target,n=this.comment,r=this.selectComment,i=n===r?null:n;if(!i&&e){var a=e.tagName;if("A"===a)return;if("LI"===a&&e.parentNode.classList.contains("attachments"))return}this.setSelectComment(i)},setSelectComment:function(t){this.$store.commit("setSelectComment",{comment:t,notScrollList:!0})},setCommentEditorVisibleId:function(t){this.$store.commit("setCommentEditorVisibleId",t)},commentRemove:function(t){if(t){var e=this.comment.comments;if(e){var n=e.findIndex((function(e){return e===t}));-1!==n&&e.splice(n,1)}}},clickRemove:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i,a,o,s,c,u,d,h,f,m,p,b;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.canRemove){e.next=2;break}return e.abrupt("return");case 2:if(n=t.comment,n){e.next=5;break}return e.abrupt("return");case 5:if(i=n.id,a=n.commentId,o=n.artboardId,e.prev=6,t.checkLoginThrow()){e.next=9;break}return e.abrupt("return");case 9:return s=0===a?"是否确认删除该评论及所属的所有二级评论?":"是否确认删除该评论?",e.next=12,t.confirm({text:s});case 12:if(e.sent){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,t.fetchPostCloudApi("removecommentbyweb",{body:{id:i,commentId:a,artboardId:o}});case 16:if(c=e.sent,Object(l["o"])(c)){e.next=19;break}throw new Error("返回值异常:".concat(c));case 19:if(c.success){e.next=21;break}throw new Error(c.errMsg);case 21:t.showTextTip("评论已删除"),t.$emit("commentRemove",n),u=t.artboard,d=t.artboardDetail,Object(l["o"])(c.data)&&u&&(h=c.data,f=h.comments,m=h.replies,p=h.commentUpdateTime,b=h.artboardMaxPointIndex,"number"===typeof f&&(u.comments-=f),"number"===typeof m&&(u.replies-=m),b>=0&&(d.maxPointIndex=b),t.$emit("onCommentUpdateTime",{commentUpdateTime:p,artboardId:o})),e.next=30;break;case 27:e.prev=27,e.t0=e["catch"](6),t.showTextTip(e.t0);case 30:case"end":return e.stop()}}),e,null,[[6,27]])})))()},clickAttach:function(t){var e=this.attachMentImgs.map((function(t){return t.imgSrc})),n=e.findIndex((function(e){return e===t.imgSrc}));-1===n&&(n=0),this.$store.commit("setImageViewer",{imgList:e,currentIndex:n})},commentAdded:function(t){this.$emit("commentAdded",t),this.editorVisible&&this.clickReply()},clickCopy:function(){var t=this.comment;Object(c["copyValueFromText"])(mr(t.summary,t.atUsers))?this.showTextTip("已复制评论到剪切板",2):this.showTextTip("复制评论到剪切板失败",2)},clickReply:function(){var t=this;if(this.cloudIsLogin)if(this.editorVisible){var e=this.$refs.editor;if(e&&e.canDestory)return this.editorVisible&&this.setCommentEditorVisibleId(0),void(this.editorState=of.off);this.editorState=of.hide}else this.editorState=of.on,this.setCommentEditorVisibleId(this.comment.id),this.$nextTick((function(){var e=t.$refs.editor;e&&(e.focus(),e.fixScroll())}));else this.showTextTip("未登录,需要登录才可进行评论")}},computed:{summaryHTML:function(){return hr(dr(this.comment.summary),this.comment.atUsers)},artboardDetail:function(){return this.$store.state.artboardDetail},selectComment:function(){return this.artboardDetail.selectComment},commentEditorVisibleId:function(){return this.$store.state.commentEditorVisibleId},artboard:function(){var t;return null===(t=this.curArtboard)||void 0===t?void 0:t.artboard},canRemove:function(){return this.isSelfComment},attachMentImgs:function(){var t,e=null===(t=this.comment)||void 0===t?void 0:t.attachMents,n=[];return e?(e.forEach((function(t){if(t){var e=t.thumbFileName||t.fileName;e&&n.push({imgSrc:t.fold+t.fileName,preview:t.fold+e})}})),n):n},userFaceTitle:function(){var t=this.comment;if(!t)return null;var e=t.user;return e?"".concat(e.nickName,"(").concat(e.email,")"):null},userNickName:function(){var t=this.comment;if(!t)return"-";var e=t.user;if(!e)return"-";var n=e.nickName;return n||"-"},isSelfComment:function(){var t=this.comment;if(!t)return!1;var e=t.user;return!!e&&e.userKey===this.cloudUserKey},userFaceText:function(){var t=this.userNickName;return t[t.length-1]},editorEnable:function(){return this.editorState!==of.off},editorVisible:function(){return this.editorState===of.on&&this.commentEditorVisibleId===this.comment.id},isReply:function(){var t=this.comment;return!!t&&0!==t.commentId},isReplyOther:function(){var t=this.comment;return!!t&&(0!==t.commentId&&t.replyUser)}},data:function(){return{editorState:of.off}},props:{comment:Object,users:Object}},cf=sf,lf=(n("db1a"),Object(qe["a"])(cf,rf,af,!1,null,"4d1d10e6",null)),uf=lf.exports,df={components:{Editor:nf,CommentItem:uf,NetworkLoading:aa},methods:{onCommentUpdateTime:function(t){this.$emit("onCommentUpdateTime",t)},commentRemove:function(t){if(t){var e=this.comments;if(e){var n=e.findIndex((function(e){return e===t}));-1!==n&&e.splice(n,1)}}},clickReload:function(){this.$emit("clickReload")},commentAdded:function(t){var e=this;this.setSelectComment(t),this.$emit("commentAdded",t),this.$nextTick((function(){if(0===t.commentId){var n=e.$refs.commentList;n&&(n.scrollTop=1e5)}else e.scrollToComment(t)}))},getCommentOrReplyFromId:function(t,e){var n=this.comments;if(!n)return null;for(var r=0,i=n.length;r<i;r++){var a=n[r];if(!e&&a.id==t)return a;if(e){var o=a.comments;if(o){var s=o.find((function(e){return e.id===t}));if(s)return s}}}},refreshCommentList:function(){var t,e,n,r=this,i=this.comments,a=this.autoIntoInfo,o=null!==(t=null===(e=this.selectComment)||void 0===e?void 0:e.id)&&void 0!==t?t:0,s=o>0&&(null===(n=this.selectComment)||void 0===n?void 0:n.commentId)>0;if(null!=i){this.setSelectComment(null);var c=a.commentId,u=a.commentArtboardId,d=a.isReply;if(l["a"]&&console.log("refreshCommentList",c,u,o,s),0!==u&&u==this.curArtboardId&&c>0){var h=this.getCommentOrReplyFromId(c,d);if(!h)return this.showTextTip("未定位到评论信息,可能已经被删除"),this.$store.commit("artboardCommentVisible",!0),a.commentId=a.commentArtboardId=-1,void this.$nextTick((function(){var t=r.$refs.commentList;t&&(t.scrollTop=1e5)}));this.setSelectComment(h),l["a"]&&console.log("selectComment",h)}if(a.commentId=a.commentArtboardId=-1,null==this.selectComment&&o>0){var f=this.getCommentOrReplyFromId(o,s);f&&(this.setSelectComment(f),l["a"]&&console.log("selectComment.old",f))}null==this.selectComment&&this.$nextTick((function(){var t=r.$refs.commentList;t&&(t.scrollTop=1e5)}))}},scrollToComment:function(t){var e="art_c".concat(t.commentId,"_").concat(t.id),n=document.getElementById(e),r=this.$refs.commentList;if(n&&r){var i=n.getBoundingClientRect(),a=r.getBoundingClientRect(),o=a.top+Math.round(a.height/2)-Math.round(i.height/2);l["a"]&&console.log("scrollToComment",o-i.top,o,i.top),r.scrollBy({top:i.top-o,behavior:"smooth"})}},setSelectComment:function(t){this.$store.commit("setSelectComment",{comment:t})}},computed:{selectComment:function(){return this.$store.state.artboardDetail.selectComment},autoIntoInfo:function(){return this.$store.state.autoIntoInfo},FetchState:function(){return c["FetchState"]},users:function(){var t;return null!==(t=this.$store.state.artboardDetail.commentUsers)&&void 0!==t?t:{}},comments:function(){return this.$store.state.artboardDetail.comments},commentRoot:function(){return{id:0,comments:this.comments}},artboard:function(){var t;return null===(t=this.curArtboard)||void 0===t?void 0:t.artboard},visible:function(){return!0},commentInfoList:function(){var t;return null===(t=this.commentInfo)||void 0===t?void 0:t.list}},watch:{"autoIntoInfo.commentId":function(t){if(t>0){var e=this.autoIntoInfo,n=this.autoIntoInfo,r=n.commentId,i=n.commentArtboardId,a=n.isReply;if(i>0&&i===this.curArtboardId){var o=this.getCommentOrReplyFromId(r,a);if(!o)return void this.clickReload();this.selectComment===o?this.scrollToComment(o):this.setSelectComment(o),e.commentId=-1,e.commentArtboardId=-1}}},selectComment:function(t){var e=this;if(t){var n=this.$store.state.artboardDetail.notScrollList;!n&&this.$nextTick((function(){e.scrollToComment(t)}))}},comments:function(t,e){t!==e&&this.refreshCommentList()}},props:{listNeedRefresh:Boolean,fetchDetailState:Number,notSupportCommentCloudVersion:Boolean,errorText:{validator:function(){return!0}}},created:function(){l["a"]&&(window.vueDetailComment=this),this.refreshCommentList()}},hf=df,ff=(n("889f"),Object(qe["a"])(hf,Ph,jh,!1,null,"0323fe7b",null)),mf=ff.exports,pf={components:{DetailComment:mf},methods:{onCommentUpdateTime:function(t){if(Object(l["o"])(t)){var e=t.artboardId,n=t.commentUpdateTime;e===this.curArtboardId&&(this.$set(this.selfChangecommentUpdateTimes,n,1),l["a"]&&console.log("onCommentUpdateTime",t))}},commentAdded:function(t){if(t){var e=this.artboardDetail,n=this.artboard;n&&(t.pointEnable&&(e.maxPointIndex=Math.max(e.maxPointIndex,t.pointIndex)),0===t.commentId?n.comments++:n.replies++)}},_getCommentsWithCache:function(t){var e=this;return Object(i["a"])(Object(r["a"])().mark((function n(){var i,a,o,s;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.curArtboardId,i){n.next=3;break}throw new Error("画板id不存在");case 3:if(t){n.next=7;break}if(a=Fh("comment",i),!a){n.next=7;break}return n.abrupt("return",a);case 7:return o=new FormData,o.append("artboardid",i),n.next=11,e.fetchPostCloudApi("GetCommentsByArtboard",{body:o});case 11:if(a=n.sent,s=Object(l["o"])(a),s){n.next=17;break}throw new Error("获取评论返回值异常:".concat(a));case 17:a.success&&Dh("comment",i,a,8e3);case 18:return n.abrupt("return",a);case 19:case"end":return n.stop()}}),n)})))()},clickRefresh:function(){this.getComments(!0)},getComments:function(t){var e=this;return Object(i["a"])(Object(r["a"])().mark((function n(){var i,a,o,s,u,d,h,f,m,p,b;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.inCloudMode){n.next=2;break}return n.abrupt("return");case 2:if(e.inArtboardMode){n.next=4;break}return n.abrupt("return");case 4:if(e.artboardInComment||e.pointCommentShowAlways){n.next=6;break}return n.abrupt("return");case 6:if(e.commentDetailVisible){n.next=8;break}return n.abrupt("return");case 8:if(i=e.curArtboardId,i){n.next=11;break}return n.abrupt("return");case 11:if(e.fetchDetailState!==c["FetchState"].Fetching){n.next=13;break}return n.abrupt("return");case 13:return a=e.artboardDetail,e.fetchDetailState=c["FetchState"].Fetching,e.errorText="",a.comments=null,a.commentUsers=null,n.prev=18,e.selfChangecommentUpdateTimes={},n.next=22,e._getCommentsWithCache(t||e.listNeedRefresh);case 22:if(d=n.sent,d.success){n.next=25;break}throw d.errMsg;case 25:d=d.data,h=On(d,c["OUTPUT_CLOUD_HOST_URL"]),a.comments=h,a.commentUsers=null===(o=d)||void 0===o?void 0:o.users,a.maxPointIndex=null!==(s=null===(u=d)||void 0===u?void 0:u.artboardMaxPointIndex)&&void 0!==s?s:0,e.refreshedMinNotifyId=e.maxNotifyId,Object(l["o"])(d)&&(f=0,m=0,Object(l["g"])(d.list)&&(f=d.list.length,d.list.forEach((function(t){var e,n;m+=null!==(e=null===t||void 0===t||null===(n=t.comments)||void 0===n?void 0:n.length)&&void 0!==e?e:0}))),p=e.artboard,p&&(p.comments=f,p.replies=m,d.commentUpdateTime>=0&&(p.commentUpdateTime=d.commentUpdateTime,b=e.$store.state.userNotify.commentUpdateStates,e.$set(b,e.cloudKey,{artboardId:i,commentUpdateTime:d.commentUpdateTime})))),e.listNeedRefresh=!1,e.fetchDetailState=c["FetchState"].Success,n.next=41;break;case 36:n.prev=36,n.t0=n["catch"](18),e.errorText=n.t0,e.fetchDetailState=c["FetchState"].Error,e.showTextTip(n.t0);case 41:case"end":return n.stop()}}),n,null,[[18,36]])})))()}},computed:{pointCommentShowAlways:function(){return this.$store.state.pointCommentShowAlways},commentDetailVisible:function(){return this.cloudIsLogin||!this.cloudNeedLogin&&this.supportPublicCloudShowCommentCloudVersion},supportPublicCloudShowCommentCloudVersion:function(){return!Object(l["m"])(this.cloudVersion)},artboardCommentUpdateTimeChanged:function(){var t,e=this.artboardNewCommentUpdateTime,n=this.listNeedRefresh,r=this.selfChangecommentUpdateTimes,i=this.curArtboardId;return!(i<1)&&(!n&&(0!==e&&(!r[e]&&e!==(null===(t=this.artboard)||void 0===t?void 0:t.commentUpdateTime))))},artboardNewCommentUpdateTime:function(){var t,e=this.$store.state.userNotify.commentUpdateStates[this.cloudKey];return e?e.artboardId!==this.curArtboardId?0:null!==(t=e.commentUpdateTime)&&void 0!==t?t:0:0},maxNotifyId:function(){var t,e=this.notifyList;return 0===e.length?0:null===(t=e[0])||void 0===t?void 0:t.id},notifyList:function(){var t,e;return null!==(t=null===(e=this.$store.state.userNotify.cloudList[this.cloudKey])||void 0===e?void 0:e.list)&&void 0!==t?t:[]},artboardCommentVisible:function(){return this.$store.state.artboardCommentVisible},artboardDetail:function(){return this.$store.state.artboardDetail},notSupportCommentCloudVersion:function(){return Object(l["i"])(this.cloudVersion)},artboard:function(){var t=this.curArtboard;return t?t.artboard:null},curArtboardId:function(){var t,e;return null!==(t=null===(e=this.artboard)||void 0===e?void 0:e.cid)&&void 0!==t?t:0}},watch:{artboardCommentUpdateTimeChanged:function(t){t&&(this.listNeedRefresh=!0)},inArtboardMode:function(){this.getComments()},pointCommentShowAlways:function(){this.getComments()},curArtboardId:function(){this.getComments()},cloudIsLogin:function(){this.getComments()}},data:function(){return{selfChangecommentUpdateTimes:{},listNeedRefresh:!1,refreshedMinNotifyId:0,fetchDetailState:c["FetchState"].Normal,errorText:""}},created:function(){l["a"]&&(window.vueCommentMain=this),this.getComments()}},bf=pf,vf=(n("1781"),Object(qe["a"])(bf,Mh,Lh,!1,null,"a190ca0c",null)),gf=vf.exports,wf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.inMultDownMode&&t.curArtboard?n("section",{staticClass:"mult-download"},[n("Header",{attrs:{exportNodeCount:t.exportNodeCount,options:t.platformSelectOptions},on:{onPlatformSelectChanged:t.onPlatformSelectChanged}}),0===t.exportNodeCount?[n("div",{staticClass:"empty"},[t._v("当前画板不存在切图")])]:[n("div",{staticClass:"list"},t._l(t.curArtboard.exportNodes,(function(t,e){return n("ExportNodeItem",{key:e+"-"+t.guid,attrs:{node:t}})})),1),t.currentResInSvg?t._e():n("div",{staticClass:"platform-set"},[n("PropertyDownloadOptions",{ref:"downOptions",attrs:{jpgQuality:t.jpgQuality,currentResInSvg:t.currentResInSvg,currentResInJpg:t.currentResInJpg,exportSvgOnly:t.exportSvgOnly,downloadPlatform:t.downloadPlatform,node:null,bottomPosition:!0},on:{setJpgQuality:t.setJpgQuality}})],1)],n("div",{staticClass:"btns"},[n("Select",{attrs:{options:t.resTypeSelectOptions,expandUp:!0},on:{changed:t.onResTypeSelectChanged}}),n("a",{staticClass:"button light download",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickDownSelectAll()}}},[t._v("下载切图")])],1),n("footer",[n("a",{staticClass:"button",attrs:{href:"javascript:;"},on:{click:function(e){return t.setInMultDownMode(!1)}}},[t._v("关闭")])])],2):t._e()},xf=[],yf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"header"},[n("a",{staticClass:"btn-set-platform",class:{on:t.setting},attrs:{href:"javascript:;"},on:{click:function(e){t.setting=!t.setting}}},[t._v(" "+t._s(t.calcPlatformTypeText)+" ")]),t.setting?n("div",{staticClass:"platforms"},[n("SetPlatform",{attrs:{options:t.options},on:{clickCalcPlatform:t.clickCalcPlatform}})],1):t._e(),n("div",[0!==t.exportNodeCount?n("Radio",{attrs:{text:t.selectAllText,selected:t.allSelected},on:{click:t.clickAllSelectBtn}}):t._e()],1)])},Cf=[],kf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"set-platform"},[n("ul",t._l(t.options,(function(e){return n("li",{key:e.name,class:{on:t.calcPlatformType2===e.value}},[n("a",{staticClass:"name",attrs:{href:"javascript:;"},on:{click:function(n){return t.clickCalcPlatform(e)}}},[t._v(t._s(e.name))])])})),0)])},Sf=[],_f={methods:{clickCalcPlatform:function(t){this.$emit("clickCalcPlatform",t)}},data:function(){return{calcPlatformType2:0,CALC_PLATFORM_TYPE:o["b"]}},created:function(){this.calcPlatformType2=(this.options.find((function(t){return t.selected}))||{value:0}).value},props:{options:Array}},Af=_f,If=(n("814c"),Object(qe["a"])(Af,kf,Sf,!1,null,"61524a7c",null)),Tf=If.exports,Of={methods:{clickCalcPlatform:function(t){this.$emit("onPlatformSelectChanged",t),this.setting=!1},clickAllSelectBtn:function(t){t=!this.allSelected&&(this.exportNodeCount,!0);var e=this.curArtboard.exportNodes;e.forEach((function(e){e.markedForExport&&(e.mlUserSelectDown=t)}))}},computed:{selectAllText:function(){return"全选(".concat(this.selectNodeCount,"/").concat(this.exportNodeCount,")")},calcPlatformTypeText:function(){if(!Object(l["g"])(this.options))return"UnKnown";var t=this.options.find((function(t){return t.selected}));return t?t.name:"UnKnown"},allSelected:function(){return 0!==this.exportNodeCount&&this.exportNodeCount===this.selectNodeCount},selectNodeCount:function(){var t=this.curArtboard.exportNodes,e=0;return t.forEach((function(t){t.markedForExport&&t.mlUserSelectDown&&(e+=1)})),e}},data:function(){return{setting:!1}},props:{exportNodeCount:Number,options:Array},components:{Radio:Yl,SetPlatform:Tf}},Ef=Of,Mf=(n("5bf6"),Object(qe["a"])(Ef,yf,Cf,!1,null,"5349ca90",null)),Lf=Mf.exports,Nf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"item"},[n("div",{staticClass:"preview",class:{on:t.node.mlUserSelectDown,white:t.exportBoxBackground===t.ExportBoxBackgroundType.White,black:t.exportBoxBackground===t.ExportBoxBackgroundType.Black},on:{click:function(e){t.node.mlUserSelectDown=!t.node.mlUserSelectDown},contextmenu:function(e){e.preventDefault(),t.exportBgTabVisible=!0}}},[n("img",{attrs:{src:t.exportPreviewPng}}),n("Radio",{attrs:{text:"",selected:t.node.mlUserSelectDown}})],1),n("div",{staticClass:"info"},[n("NodeName",{attrs:{node:t.node}}),n("div",{staticClass:"size"},[t._v(t._s(t.size))])],1),t.exportBgTabVisible?n("ul",{staticClass:"export-bg"},[n("li",{class:{on:t.ExportBoxBackgroundType.Black===t.exportBoxBackground,black:1},on:{click:function(e){return t.clickExportBoxBackgroundType(t.ExportBoxBackgroundType.Black)}}},[t._v(" 深色预览背景 ")]),n("li",{class:{on:t.ExportBoxBackgroundType.Transparent===t.exportBoxBackground,transparent:1},on:{click:function(e){return t.clickExportBoxBackgroundType(t.ExportBoxBackgroundType.Transparent)}}},[t._v(" 浅色预览背景 ")])]):t._e()])},Df=[],Ff={methods:{clickExportBoxBackgroundType:function(t){this.$store.commit("exportBoxBackgroundType",t)},hideSelect:function(){var t=this;requestAnimationFrame((function(){t.exportBgTabVisible=!1}))}},computed:{ExportBoxBackgroundType:function(){return o["q"]},exportPreviewPng:function(){var t=this.node.mlConfig.pngPreview||this.node.mlConfig.svgPreview;return this.inCloudMode?t:t+"?"+this.curArtboard.artboard.mlOutputTime},size:function(){var t,e=this.node,n=this.curArtboard;if(n&&(t=n.artboard.mlConfig),t){var r=t.sizeMap;if(r)for(var i=e.exportPath.toLowerCase(),a=0;a<ja.length;a++){var o=ja[a],s=o.scale,c=o.ext,l=r[i+c];if(l){var u=Math.ceil(l.width/s),d=Math.ceil(l.height/s);return"".concat(u,"x").concat(d)}}}return"".concat(Math.ceil(this.originWidth),"x").concat(Math.ceil(this.originHeight))},originWidth:function(){return this.node.boundsInArtboard.width},originHeight:function(){return this.node.boundsInArtboard.height}},watch:{exportBgTabVisible:function(t){t?(window.addEventListener("click",this.hideSelect,!0),window.addEventListener("contextmenu",this.hideSelect,!0)):(window.removeEventListener("click",this.hideSelect,!0),window.removeEventListener("contextmenu",this.hideSelect,!0))}},beforeDestroy:function(){window.removeEventListener("click",this.hideSelect,!0),window.removeEventListener("contextmenu",this.hideSelect,!0)},data:function(){return{exportBgTabVisible:!1}},components:{Radio:Yl,NodeName:pd},props:{node:Object}},Pf=Ff,jf=(n("9a1c"),Object(qe["a"])(Pf,Nf,Df,!1,null,"bf39bf0e",null)),Rf=jf.exports;function Bf(t,e){if(Object(l["o"])(t)){var n=t.exportNodes;Object(l["g"])(n)&&(e=!!e,n.forEach((function(t){t.mlUserSelectDown=e})))}}var Vf={methods:{setJpgQuality:function(t){t>0&&t<=100&&(this.jpgQuality=t,Object(c["setLocalStorage"])(O,t))},onPlatformSelectChanged:function(t){Object(l["o"])(t)&&(this.downloadPlatform=t.value)},onResTypeSelectChanged:function(t){Object(l["o"])(t)&&this.clickCurrentResType(t.value)},clickCurrentResType:function(t){switch(t){case o["t"].PNG:if(!this.exportPng)return void this.showTextTip("设计狮没有为该画板导出[PNG]格式的切图");break;case o["t"].WEBP:if(!this.exportWebP)return void this.showTextTip("设计狮没有为该画板导出[WEBP]格式的切图");break;case o["t"].SVG:if(!this.exportSvg)return void this.showTextTip("设计狮没有为该画板导出[SVG]格式的切图");break;case o["t"].JPG:if(!this.inCloudMode)return void this.showTextTip("导出到本地的标注信息不支持导出JPG的节点切图");break}this.currentResType=t,Object(c["setLocalStorage"])("resType",t)},clickDownSelectAll:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.exportNodeCount){e.next=3;break}return t.showTextTip("当前画板不存在切图"),e.abrupt("return");case 3:if(t.setInOutput(!0),e.prev=4,!t.currentResInSvg){e.next=10;break}return e.next=8,Ba(t.selectNodes,t.curArtboard);case 8:e.next=17;break;case 10:if(!t.currentResInJpg){e.next=15;break}return e.next=13,Ga(t.downloadPlatform,t.androidUseMipmap,t.$refs.downOptions.checkSetting,t.selectNodes,t.curArtboard,t.jpgQuality/100);case 13:e.next=17;break;case 15:return e.next=17,Ya(t.downloadPlatform,t.androidUseMipmap,t.$refs.downOptions.checkSetting,t.selectNodes,t.curArtboard,t.currentResInWebP);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e["catch"](4),t.showTextTip(e.t0);case 22:return e.prev=22,t.setInOutput(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[4,19,22,25]])})))()},initJpgQuality:function(){var t=this.curArtboard;if(t){var e=parseInt(Object(c["getLocalStorage"])(O,!1));(isNaN(e)||e<1||e>=100)&&(e=T),this.jpgQuality=e}},initCurrentResType:function(){var t=this.curArtboard;if(t){var e=parseInt(Object(c["getLocalStorage"])("resType",!1));(isNaN(e)||!isFinite(e)||e!==o["t"].SVG&&e!==o["t"].WEBP&&e!==o["t"].JPG)&&(e=o["t"].PNG);var n=this.curArtboard.artboard.mlConfig.resType;n||(n=o["t"].PNG);var r=this.exportPng,i=this.exportSvg,a=this.exportWebP;switch(e){case o["t"].PNG:r||(a?e=o["t"].WEBP:i&&(e=o["t"].SVG));break;case o["t"].SVG:i||(r?e=o["t"].PNG:a&&(e=o["t"].WEBP));break;case o["t"].WEBP:a||(r?e=o["t"].PNG:i&&(e=o["t"].SVG));break;case o["t"].JPG:this.inCloudMode||(r?e=o["t"].PNG:a?e=o["t"].WEBP:i&&(e=o["t"].SVG));break}this.currentResType=e}}},computed:{platformSelectOptions:function(){return[{name:"Web",value:o["b"].WEB,selected:this.downloadPlatform===o["b"].WEB},{name:"Android",value:o["b"].ANDROID,selected:this.downloadPlatform===o["b"].ANDROID},{name:"iOS",value:o["b"].IOS,selected:this.downloadPlatform===o["b"].IOS}]},resTypeSelectOptions:function(){var t=this.currentResType,e={value:o["t"].PNG,name:"PNG",selected:t===o["t"].PNG,disabled:!this.exportPng},n={value:o["t"].WEBP,name:"WEBP",selected:t===o["t"].WEBP,disabled:!this.exportWebP},r={value:o["t"].SVG,name:"SVG",selected:t===o["t"].SVG,disabled:!this.exportSvg},i={value:o["t"].JPG,name:"JPG",selected:t===o["t"].JPG,disabled:!this.inCloudMode};return[e,n,r,i]},exportWebP:function(){return Object(c["hadExportWebP"])(this.curArtboard.artboard)},exportPng:function(){return Object(c["hadExportPng"])(this.curArtboard.artboard)},exportSvg:function(){return Object(c["hadExportSvg"])(this.curArtboard.artboard)},exportSvgOnly:function(){return this.exportSvg&&!this.exportPng&&!this.exportWebP},currentResInSvg:function(){return this.currentResType===o["t"].SVG},currentResInJpg:function(){return this.currentResType===o["t"].JPG},currentResInWebP:function(){return this.currentResType===o["t"].WEBP},selectNodes:function(){var t=this.curArtboard.exportNodes,e=[];return t.forEach((function(t){t.markedForExport&&t.mlUserSelectDown&&e.push(t)})),e},exportNodeCount:function(){var t=this.curArtboard.exportNodes;return t.length}},components:{Header:Lf,ExportNodeItem:Rf,PropertyDownloadOptions:uh,Select:oh},watch:{inMultDownMode:function(t){this.downloadPlatform=this.calcPlatformUse,Bf(this.curArtboard,t),this.initCurrentResType(),this.initJpgQuality()},curArtboard:function(t,e){Bf(e,!1),this.inMultDownMode&&Bf(t,!0),this.initCurrentResType(),this.initJpgQuality()}},data:function(){return{currentResType:o["t"].PNG,jpgQuality:T,CALC_PLATFORM_TYPE:o["b"],downloadPlatform:o["b"].WEB}},created:function(){this.downloadPlatform=this.calcPlatformUse,this.inMultDownMode&&Bf(this.curArtboard,!0),this.initCurrentResType(),this.initJpgQuality()}},Uf=Vf,$f=(n("672f"),Object(qe["a"])(Uf,wf,xf,!1,null,"7acc5f27",null)),Hf=$f.exports,zf={components:{ZoomContainer:Hi,Properties:Eh,LeftSide:Tu,MultDownload:Hf,CommentMain:gf},methods:{clickReload:function(){window.location.reload()},checkArtboardData:function(t){var e=this;if(t){var n=!0;Object(l["o"])(t)&&!1===t.isLoaded&&(n=!1),l["a"]&&console.log("data.load.start"),qt(t,this.documentArtboards).then((function(t){if(!n&&t.isLoaded){l["a"]&&console.log("data.loaded");var r=t.artboard;if(Object(l["o"])(r)){var i=r.mlConfig;if(Object(l["o"])(i)&&"number"===typeof i.platform){var a=Object(c["getCustomPlatform"])(r.docGuid,i.platform);e.$store.commit("setPlatform",a);var o=Object(c["getUnitTemplate"])(r.docGuid);e.$store.commit("setUnitTemplate",o)}var s=c["globalData"].initNodeGuid;if(s){c["globalData"].initNodeGuid=null;var u=t.childs.find((function(t){return t.guid===s}));u&&e.curNode!==u&&e.setCurNode(u)}}}}))}}},watch:{curArtboard:function(t){this.checkArtboardData(t)}},computed:{EnumScaleType:function(){return o["m"]},isLoaded:function(){return this.curArtboard.isLoaded},isFetching:function(){return this.curArtboard.isFetching},isError:function(){return this.curArtboard.isError}},created:function(){this.checkArtboardData(this.curArtboard)}},Wf=zf,Gf=(n("7305"),Object(qe["a"])(Wf,nu,ru,!1,null,"99cb215a",null)),Yf=Gf.exports,Xf=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("section",{staticClass:"pop-box webp-tip"},[n("div",{staticClass:"box"},[n("h4",[t._v("浏览器性能提示")]),n("p",[t._v("Safari浏览器可能会出现响应卡顿及WebP资源无法加载,建议使用Chrome、Firefox浏览器访问.")]),n("div",{staticClass:"footer"},[n("div",[n("a",{staticClass:"checkbox",class:{on:t.remember},attrs:{href:"javascript:;"},on:{click:function(e){t.remember=!t.remember}}},[n("i",[t._v("浏览器关闭前不再提示")])])]),n("div",[n("a",{staticClass:"button light",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickConfirm()}}},[t._v("我知道了")])])])])]):t._e()},Kf=[],Zf="safari_webp_notip",qf={methods:{clickConfirm:function(){this.remember&&Object(c["setSessionStorage"])(Zf,"1"),this.visible=!1},checkWebPSupport:function(){var t=this;clearTimeout(this.handle),this.handle=setTimeout((function(){t._checkWebPSupport()}),100)},_checkWebPSupport:function(){var t=this;if(this.inCloudMode&&this.allArtboardLoadChecked){var e="1"===Object(c["getSessionStorage"])(Zf,!1);e||me((function(e){be?t.visible=!0:e===pe.Support&&Object(c["setSessionStorage"])(Zf,"1")}))}}},computed:{allArtboardLoadChecked:function(){return this.$store.state.allArtboardLoadChecked}},watch:{allArtboardLoadChecked:function(){this.checkWebPSupport()},inCloudMode:function(){this.checkWebPSupport()}},data:function(){return{visible:!1,remember:!1,handle:0}},beforeDestroy:function(){clearTimeout(this.handle)},created:function(){this.checkWebPSupport()}},Qf=qf,Jf=(n("6ee2"),Object(qe["a"])(Qf,Xf,Kf,!1,null,"d989a384",null)),tm=Jf.exports,em={components:{EmptyData:jl,ArtboardList:eu,ArtboardInfo:Yf,Header:_l,Tip:ao,ArtboardListItemMenu:Ja,InOutputTip:xs,Authority:Ml,FolderNav:ms,CloudNeedLoginTip:Ea,SafariWebpTip:tm,ImageViewer:Yi,NetDiskFileMain:Sa},methods:{onVisibilitychange:function(){var t=Object(c["isWebViewHidden"])(),e=this.webViewHidden;l["a"]&&console.log("webViewHidden:new-%s,old-%s",t,e),e!=t&&this.$store.commit("setWebViewHidden",t)}},computed:{emptyText:function(){return this.inCloudMode?0===this.cloudCurrentFolderId?"私有云下还没有文件夹,请在标记狮中添加":this.inNetDiskFileMode?"文件不存在,可能已经被移动或删除":"当前文件夹是空的":"未检测到数据,请尝试重新导出画板"},artboardLoadProgressText:function(){return Math.floor(1e4*this.artboardLoadProgress.current/this.artboardLoadProgress.count)/100+"%"},artboardLoadProgress:function(){return this.$store.state.artboardLoadProgress},allArtboardLoadChecked:function(){return this.$store.state.allArtboardLoadChecked},isEmptyData:function(){return this.inNetDiskFileMode?null==this.curNetDiskFile:0===this.documentArtboards.length}},watch:{cloudCurrentFolderId:function(){ba.clear(150)},curArtboard:function(t){var e=this;this.checkUserState().then((function(t){e.$store.commit("setMyState",t)})).catch((function(){})),t||this.setInMultDownMode(!1)}},created:function(){document.addEventListener("visibilitychange",this.onVisibilitychange,!1)},beforeDestroy:function(){document.removeEventListener("visibilitychange",this.onVisibilitychange,!1)}},nm=em,rm=(n("87c8"),Object(qe["a"])(nm,He,ze,!1,null,"4b056eb0",null)),im=rm.exports;function am(t,e){return om.apply(this,arguments)}function om(){return om=Object(i["a"])(Object(r["a"])().mark((function t(e,n){var i,s,u;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:i=+Object(c["queryString"])("commentid","#"),s="1"===Object(c["queryString"])("isreply","#"),e().then((function(){c["globalData"].inCloudMode?function(){try{var t=Ue.state;if(ae.cloud.renderMode==o["n"].File)return t.cloud.allFoldersBoxVisible=!1,function(){l["a"]&&console.log("初始化文件信息",ae.cloud.fileInfo)}();t.cloud.allFoldersBoxVisible="1"===Object(c["getSessionStorage"])(o["d"],!1),yt(t.documentArtboards);var e=t.cloud.defaultArtboardGuid,r=null,a=null;if(e){if(r=ae.documentArtboards.find((function(t){return t.artboard.guid===e})),r){var u=window.location.href,d=/\/viewer\/\d+\/[^\\/]+\/([^\\/]+)\//i.exec(u),h=d?decodeURIComponent(d[1]):null;a=r.childs.find((function(t){return t.guid===h})),a||(c["globalData"].initNodeGuid=h)}if(t.curArtboard!==r&&Ue.commit("curArtboard",{artboard:r}),t.curNode!==a&&(Ue.commit("curNode",a),Ue.commit("setArtboardInComment",!1)),i>0){var f,m,p,b=t.autoIntoInfo;b.commentArtboardId=null!==(f=null===(m=r)||void 0===m||null===(p=m.artboard)||void 0===p?void 0:p.cid)&&void 0!==f?f:0,b.commentId=i,b.isReply=s,Ue.commit("setArtboardInComment",!0)}}n()}finally{Ue.commit("allArtboardLoadChecked",!0)}}():function(){var t=function(){var t=window.location.hash,e=null,n=null;if(t){var r=/\/artboard\/([^\\/]+)/i.exec(t);if(r){var i=r[1];e=ae.documentArtboards.find((function(t){return t.artboard.guid===i}))}if(e&&(r=/\/node\/([^\\/]+)/i.exec(t),r)){var a=r[1],o=e.childs;n=o.find((function(t){return t.guid===a}))}}Ue.state.curArtboard!==e&&Ue.commit("curArtboard",{artboard:e}),Ue.state.curNode!==n&&Ue.commit("curNode",n)};window.addEventListener("hashchange",t),t(),setTimeout((function(){Ue.commit("allArtboardLoadChecked",!0)}),100)}()})),u=new a["a"]({store:Ue,render:function(t){return t(im)}}),me((function(t){Ue.commit("isSupportWebp",t),u.$mount("#app")}));case 5:case"end":return t.stop()}}),t)}))),om.apply(this,arguments)}var sm=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{class:{"header-off":!t.headerVisible},attrs:{id:"main"}},[!t.cloudNeedLogin||t.cloudIsLogin?n("div",{staticClass:"loading",class:{on:!t.allArtboardLoadChecked}},[t._v("正在加载画板数据中("+t._s(t.artboardLoadProgressText)+"),请稍后...")]):t._e(),t.cloudNeedLogin&&!t.cloudIsLogin?n("CloudNeedLoginTip"):t.allArtboardLoadChecked?[n("Header"),n("a",{staticClass:"btn-visible-pop",attrs:{href:"javascript:;",title:t.headerVisibleTitle},on:{click:t.clickHeaderVisible}}),n("main",{style:{backgroundColor:t.backgroundColor}},[t.cloudFolderNotFound?n("EmptyData",{attrs:{text:"链接已失效,无法找到对应的文件夹"}}):t.permission?t.isEmptyData?n("EmptyData",{attrs:{text:t.emptyText}}):[n("LeftSide")]:n("Authority"),n("device-container")],2)]:t._e(),n("Tip")],2)},cm=[],lm=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"left-side-pc",class:{on:t.leftSideVisible}},[n("a",{staticClass:"btn-visible",class:{on:t.leftSideVisible,off:!t.headerVisible},attrs:{href:"javascript:;",title:t.leftSideVisible?"收起左侧(F3)":"展开左侧(F3)"},on:{click:function(e){return t.setVisible(!t.visible)}}}),n("div",{staticClass:"filter"},[n("div",{staticClass:"search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText.artboard,expression:"searchText.artboard"}],attrs:{type:"text",placeholder:"搜索画板名",spellcheck:"false"},domProps:{value:t.searchText.artboard},on:{input:function(e){e.target.composing||t.$set(t.searchText,"artboard",e.target.value)}}}),t.searchText.artboard?n("a",{staticClass:"btn-clear",attrs:{href:"javascript:;"},on:{click:function(e){t.searchText.artboard=""}}}):t._e()]),n("a",{staticClass:"artlist-mode",class:{min:!t.artlistModeMin},attrs:{href:"javascript:;",title:t.artlistModeMinTitle},on:{click:t.clickArtlistModeMin}})]),n("section",{staticClass:"box"},[n("ArtboardList",{attrs:{artlistModeMin:t.artlistModeMin,visible:!0,list:t.renderDocumentArtboards,renderArtboardList:t.renderArtboardList,sliceFilterOpen:t.sliceFilterOpen}})],1)])},um=[],dm=[],hm={toggleFullscreen:function(){this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()},isFullscreen:function(){var t=!0===document.fullscreen||null!=document.fullscreenElement||null!=document.msFullscreenElement||null!=document.mozFullscreenElement||null!=document.webkitFullscreenElement;return t||(t=screen.height==Math.max(window.outerHeight,window.innerHeight)&&screen.width==Math.max(window.outerWidth,window.innerWidth),t)},requestFullscreen:function(){var t=document.documentElement,e=t.requestFullscreen||t.webkitRequestFullscreen||t.msRequestFullscreen||t.mozRequestFullscreen;try{e&&e.call(t).catch((function(){}))}catch(n){}},exitFullscreen:function(){var t=document.exitFullscreen||document.webkitExitFullscreen||document.msExitFullscreen||document.mozExitFullscreen;t&&t.call(document)},onChange:function(t){if("function"===typeof t){var e=dm.findIndex((function(e){return e===t}));-1===e&&dm.push(t)}},offChange:function(t){if("function"===typeof t){var e=dm.findIndex((function(e){return e===t}));-1!==e&&dm.splice(e,1)}}};function fm(){if(0!=dm.length){var t=hm.isFullscreen();dm.forEach((function(e){try{e(t)}catch(n){console.error(n)}}))}}document.addEventListener("webkitfullscreenchange",fm),document.addEventListener("mozfullscreenchange",fm),document.addEventListener("msfullscreenchange",fm),document.addEventListener("fullscreenchange",fm),window.addEventListener("resize",fm);var mm={components:{ArtboardList:Su},methods:{clickArtlistModeMin:function(){this.artlistModeMin=!this.artlistModeMin,Object(c["setLocalStorage"])("leftside.artlistmodemin",this.artlistModeMin?"1":"0")},quickKeyShift:function(t){this.shiftKey=t.shiftKey},quickKey:function(t){var e=this;return Object(i["a"])(Object(r["a"])().mark((function n(){var i,a,o,s,c;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.quickKeyShift(t),i=t.keyCode||t.which,n.t0=i,n.next=112===n.t0||122===n.t0?5:113===n.t0?8:114===n.t0?11:38===n.t0||40===n.t0?14:48;break;case 5:return hm.toggleFullscreen(),t.preventDefault(),n.abrupt("break",48);case 8:return e.$store.commit("setInteractionHeaderVisible",!e.headerVisible),t.preventDefault(),n.abrupt("break",48);case 11:return e.setVisible(!e.visible),t.preventDefault(),n.abrupt("break",48);case 14:if(!e.keydownConfirming){n.next=16;break}return n.abrupt("return");case 16:if(!e.imageViewer.visible){n.next=18;break}return n.abrupt("return");case 18:if(a=38===i?-1:1,o=t.ctrlKey||t.metaKey,o){n.next=22;break}return n.abrupt("break",48);case 22:if(s=e.renderArtboardList,0!==s.length){n.next=26;break}return e.showTextTip(1===a?"已经到达最后一个画板":"已经到达第一个画板"),n.abrupt("return");case 26:if(c=s.findIndex((function(t){return e.curArtboard===t})),-1===c?c=0:c+=a,!(c<0)){n.next=33;break}return e.showTextTip("已经到达第一个画板"),n.abrupt("return");case 33:if(!(c>=s.length)){n.next=36;break}return e.showTextTip("已经到达最后一个画板"),n.abrupt("return");case 36:if(!e.inCommentDrawing){n.next=46;break}return e.keydownConfirming=!0,n.prev=38,n.next=41,e.confirm({text:"正在编辑画板截图,是否清理截图信息并切换画板?"});case 41:if(n.sent){n.next=43;break}return n.abrupt("return");case 43:return n.prev=43,e.keydownConfirming=!1,n.finish(43);case 46:return e.setCurArtboard(s[c]),n.abrupt("break",48);case 48:case"end":return n.stop()}}),n,null,[[38,,43,46]])})))()},getArtboardExportNodeCount:function(t){if(this.inCloudMode)return t.artboard.resNodeCount;var e=t.exportNodes;return e.length},setVisible:function(t){if(!this.headerVisible)return this.$store.commit("setInteractionHeaderVisible",!0),void this.$store.commit("leftSideVisible",!0);this.$store.commit("leftSideVisible",t)}},computed:{leftSideVisible:function(){return this.visible&&this.headerVisible},headerVisible:function(){return this.$store.state.artboardDetail.interactionSet.headerVisible},imageViewer:function(){return this.$store.state.imageViewer},renderArtboardList:function(){var t=this,e=this.artboardSearchText,n=this.sliceFilterOpen,r=this.renderDocumentArtboards,i=""!==e,a=[];return r.forEach((function(r){if(r&&r.artboard&&(!n||0!==t.getArtboardExportNodeCount(r))){if(i){var o=r.artboard.name;if(!o)return;if(-1===o.toLowerCase().indexOf(e))return}a.push(r)}})),a},artboardSearchText:function(){return this.searchText.artboard.toLowerCase()},artlistModeMinTitle:function(){return this.artlistModeMin?"单击切换到大图模式":"单击切换到小图模式"},visible:function(){return this.$store.state.artboardDetail.leftSideVisible}},data:function(){return{keydownConfirming:!1,preloadCount:2,shiftKey:!1,artlistModeMin:"1"===Object(c["getLocalStorage"])("leftside.artlistmodemin",!1),sliceFilterOpen:!1,commentFilterOpen:!1,searchText:{artboard:""}}},created:function(){window.addEventListener("keydown",this.quickKey),window.addEventListener("keyup",this.quickKeyShift)},beforeDestroy:function(){window.removeEventListener("keydown",this.quickKey),window.removeEventListener("keyup",this.quickKeyShift)}},pm=mm,bm=(n("312d"),Object(qe["a"])(pm,lm,um,!1,null,null,null)),vm=bm.exports,gm=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",[n("div",{staticClass:"nav"},[n("PathNav")],1),n("device-set"),n("div",{staticClass:"preview-set"},[n("a",{staticClass:"btn-fullscreen",class:{on:t.isFullscreen},attrs:{href:"javascript:;",title:t.isFullscreen?"退出全屏(F1)":"全屏查看(F1)"},on:{click:t.clickFullscreen}}),n("BtnContainerColor"),n("div",{staticClass:"line"}),t.inCloudMode?n("BtnGoInteraction"):t._e(),n("div",{staticClass:"helper",class:{on:t.helperVisible,inright:!t.inCloudMode},on:{click:function(e){return e.target!==e.currentTarget?null:t.clickHelper(!t.helperVisible)}}},[n("Helper")],1),t.inCloudMode&&t.cloudIsLogin?n("UserNotifyButton"):t._e(),t.inCloudMode?n("UserInfo",{attrs:{setVisible:t.setVisible}}):t._e()],1),t.inCloudMode?n("UserNotify"):t._e()],1)},wm=[],xm=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"nav-item no-link"},[n("div",{staticClass:"name",attrs:{title:t.folderName}},[t._v(t._s(t.folderName))]),t.showArtboardPages?n("PathNavArtboardPages"):t._e()],1)},ym=[],Cm={components:{PathNavArtboardPages:Nc},computed:{folderName:function(){var t=this.cloudName,e=this.cloudCurrentFolderId,n=this.cloudFolderNotFound,r=this.documentName;return 0===e?t||"私有云根目录":n?"链接已失效":r},showArtboardPages:function(){return this.documents.length>0}}},km=Cm,Sm=(n("e135"),Object(qe["a"])(km,xm,ym,!1,null,"000b51d0",null)),_m=Sm.exports,Am=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"btn-container-color"},[n("a",{staticClass:"btn-color",style:{backgroundColor:t.backgroundColor},attrs:{href:"javascript:;",title:"设置预览底色"},on:{click:function(e){t.boxVisible=!t.boxVisible}}}),t.boxVisible?n("div",{staticClass:"box"},[n("h5",[t._v("预览底色")]),n("ul",t._l(t.recommendedColors,(function(e,r){return n("li",{key:r,class:{on:t.backgroundColor===e},style:{"background-color":e},on:{click:function(n){return t.clickRecommendColor(e)}}})})),0)]):t._e()])},Im=[],Tm={methods:{clickRecommendColor:function(t){this.$store.commit("setInteractionBackground",t)},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),this.handle=setTimeout((function(){e.boxVisible=!1}),100))}},watch:{boxVisible:function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))}},computed:{backgroundColor:function(){return this.interactionSet.backgroundColor},interactionSet:function(){return this.$store.state.artboardDetail.interactionSet}},data:function(){return{handle:0,recommendedColors:["#000","#fff","#eee","#f4f6f7"],boxVisible:!1}},beforeDestroy:function(){window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0)}},Om=Tm,Em=(n("8904"),Object(qe["a"])(Om,Am,Im,!1,null,"d9efe478",null)),Mm=Em.exports,Lm=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"device-set"},[n("div",{staticClass:"device-name"},[n("div",{staticClass:"cur-text",class:{on:t.boxVisible},on:{click:function(e){t.boxVisible=!t.boxVisible}}},[t._v(t._s(t.pcDeviceSet.name))]),t.boxVisible?n("div",{staticClass:"device-list"},t._l(t.interactionDeviceList,(function(e,r){return n("div",{key:r,staticClass:"device-item",class:{web:e.type===t.InteractionDeviceType.Web}},[n("div",{staticClass:"text",class:{on:t.pcDeviceSet.name===e.name},on:{click:function(n){return t.clickDevice(e)}}},[t._v(t._s(e.name))]),e.type===t.InteractionDeviceType.Group?n("div",{staticClass:"device-sublist"},t._l(e.list,(function(e,i){return n("div",{key:r+"-"+i,staticClass:"device-subitem"},[n("div",{staticClass:"subtext",class:{on:t.pcDeviceSet.name===e.name},on:{click:function(n){return t.clickDevice(e)}}},[t._v(t._s(e.name)+" ("+t._s(e.width)+" × "+t._s(e.height)+")")])])})),0):t._e()])})),0):t._e()]),n("div",{staticClass:"device-size",class:{off:!t.showDeviceSize}},[n("input",{attrs:{type:"number",readonly:!t.canChangeDeviceSize},domProps:{value:t.pcDeviceSet.width},on:{blur:function(e){return t.blurDeviceSize(e,"width")}}}),n("div",{staticClass:"split"},[t._v("x")]),n("input",{attrs:{type:"number",readonly:!t.canChangeDeviceSize},domProps:{value:t.pcDeviceSet.height},on:{blur:function(e){return t.blurDeviceSize(e,"height")}}})]),n("a",{staticClass:"btn btn-use-horizontal",class:{off:!t.showUseHorizontal},attrs:{href:"javascript:;",title:"切换横竖屏"},on:{click:t.clickHorizontal}})])},Nm=[],Dm={methods:{blurDeviceSize:function(t,e){if(this.canChangeDeviceSize){var n=this.pcDeviceSet,r=+t.target.value;isNaN(r)?t.target.value=n[e]:(r<100&&(r=100,t.target.value=r),n[e]=r)}},clickHorizontal:function(){var t=this.pcDeviceSet,e=t.height,n=t.width;this.setPCDeviceSet({isHorizontal:!this.isHorizontal,width:e,height:n})},clickDevice:function(t){if(Object(l["o"])(t))switch(t.type){case xe.Group:return void(this.notCloseThisTime=!0);case xe.Web:case xe.Mobile:return void this.setPCDeviceSet(t);case xe.Custom:var e=this.pcDeviceSet,n={width:0===e.width?375:Math.max(e.width,100),height:0===e.height?667:Math.max(e.height,100)};return n.type=xe.Custom,n.name=t.name,n.hasBangs=!1,void this.setPCDeviceSet(n)}},setPCDeviceSet:function(t){this.$store.commit("setPCDeviceSet",t)},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.boxHandle),this.boxHandle=setTimeout((function(){e.notCloseThisTime?e.notCloseThisTime=!1:e.boxVisible=!1}),100))}},watch:{boxVisible:function(t){t?(clearTimeout(this.boxHandle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))}},computed:{isHorizontal:function(){return this.pcDeviceSet.isHorizontal},canChangeDeviceSize:function(){switch(this.pcDeviceSet.type){case xe.Custom:return!0}return!1},showDeviceSize:function(){switch(this.pcDeviceSet.type){case xe.Custom:return!0}return!1},showUseHorizontal:function(){switch(this.pcDeviceSet.type){case xe.Mobile:case xe.Custom:return!0}return!1},pcDeviceSet:function(){return this.$store.state.artboardDetail.interactionSet.pcDeviceSet}},data:function(){return{interactionDeviceList:Ce,InteractionDeviceType:xe,boxVisible:!1,boxHandle:0,notCloseThisTime:!1}},created:function(){l["a"]&&(window.vue_DeviceSet=this)},beforeDestroy:function(){window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0)}},Fm=Dm,Pm=(n("28cf"),Object(qe["a"])(Fm,Lm,Nm,!1,null,"82609efa",null)),jm=Pm.exports,Rm={components:{PathNav:_m,BtnContainerColor:Mm,DeviceSet:jm,UserNotifyButton:sl,UserNotify:xl,UserInfo:el,Helper:js,BtnGoInteraction:Ms},methods:{clickHelper:function(t){this.$store.commit("setHelperVisible",t)},clickFullscreen:function(){hm.toggleFullscreen()},onFullscreen:function(t){this.isFullscreen=t}},computed:{helperVisible:function(){return this.$store.state.helper.visible},setVisible:function(){return!this.cloudFolderNotFound&&this.permission&&this.documentArtboards.length>0}},data:function(){return{isFullscreen:hm.isFullscreen()}},beforeDestroy:function(){hm.offChange(this.onFullscreen)},created:function(){hm.onChange(this.onFullscreen)}},Bm=Rm,Vm=(n("90e1"),Object(qe["a"])(Bm,gm,wm,!1,null,"fae55be6",null)),Um=Vm.exports,$m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"device-container",class:{"margin-left":t.leftSideVisible,pc:t.isWeb,mobile:!t.isWeb}},[n("div",{staticClass:"device-ui"},[t.isWeb?t._e():n("div",{staticClass:"device-border"},[t.pcDeviceSet.hasBangs?n("div",{staticClass:"device-bangs"}):t._e(),n("div",{staticClass:"device-top-left"}),n("div",{staticClass:"device-top-center"}),n("div",{staticClass:"device-top-right"}),n("div",{staticClass:"device-middle-left"}),n("div",{staticClass:"device-middle-right"}),n("div",{staticClass:"device-bottom-left"}),n("div",{staticClass:"device-bottom-center"}),n("div",{staticClass:"device-bottom-right"})]),n("device-box")],1)])},Hm=[],zm=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"device-box",style:t.boxStyle,on:{click:t.clickDeviceBox}},[t.itemCurrent.artboard?n("InteractionArtboardItem",{attrs:{artboard:t.itemCurrent.artboard,overlayArtboards:t.itemCurrent.overlayArtboards,renderTapInteraction:t.currentRenderTapInteraction,overlayVisible:t.currentOverlayVisible}}):t._e(),t.gobackArtboard?n("InteractionArtboardItem",{attrs:{overlayVisible:!1,artboard:t.gobackArtboard.fromArtboard.artboard,renderTapInteraction:t.gobackArtboard.renderTapInteraction}}):t._e(),t.gotoArtboard?n("InteractionArtboardItem",{attrs:{artboard:t.gotoArtboard.fromArtboard.artboard,renderTapInteraction:t.gotoArtboard.renderTapInteraction}}):t._e()],1)},Wm=[],Gm=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"interaction-artboard-item",class:t.itemCls,style:t.itemStyle,attrs:{"data-unset-control":t.rootSize?"1":""},on:{"!touchstart":function(e){return t.onTouchStart.apply(null,arguments)},"!mousedown":function(e){return t.onMouseDown.apply(null,arguments)},click:function(e){return e.target!==e.currentTarget?null:t.clickArtboardItemSelf.apply(null,arguments)}}},[n("div",{ref:"artboardScrollBox",staticClass:"artboard-content-scroll non-width-scroll",class:{top:t.isTopArtboard},attrs:{"data-unset-control":t.rootSize?"1":""},on:{scroll:t.onScroll,click:function(e){return e.target!==e.currentTarget?null:t.clickArtboardItemSelf.apply(null,arguments)}}},[n("div",{staticClass:"artboard-content",class:{pc:t.isWeb,"interaction-node-show":t.isMouseDown||t.interactionRectAlwaysVisible},style:t.contentStyle,on:{dragstart:function(t){t.preventDefault()}}},[n("img",{staticClass:"preview",style:t.imgStyle,attrs:{src:t.imgSrc},on:{load:t.onImgLoad,error:t.onImgError}}),n("InteractionNodePoints",{attrs:{artboard:t.artboard,overlayScale:t.overlayScale}}),t.imgLoading?n("div",{staticClass:"img-loading",style:{backgroundColor:t.backgroundColor}},[n("div",{staticClass:"loading"},[t._v("正在加载画板预览图...")])]):t._e()],1)]),t.renderOverlayArtboardDatas.length>0?t._l(t.renderOverlayArtboardDatas,(function(e){return n("interaction-artboard-item",{key:e.key,attrs:{artboard:e.overlayArtboard.artboard,renderTapInteraction:e.overlayArtboard.renderTapInteraction,overlayArtboards:null,rootSize:t.artboard.boundsInParentForList,overlayOffset:e.overlayArtboardOffset,overlayVisible:e.overlayArtboard.visible}})})):t._e()],2)},Ym=[],Xm=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{staticClass:"interaction-node-points"},t._l(t.renderInteractions,(function(e,r){return n("InteractionNodePointItem",{key:r,attrs:{item:e,index:r,itemScale:t.itemScale}})})),1):t._e()},Km=[],Zm=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"interaction-node-pointitem",class:{on:t.hoverGuid===t.item.guid,pc:!t.inMobile},style:t.style,attrs:{"data-unset-control":"1"},on:{mouseenter:function(e){return t.mouseEnterItem(!0)},mouseleave:function(e){return t.mouseEnterItem(!1)},click:t.clickGoArtboard}})},qm=[],Qm={methods:{mouseEnterItem:function(t){var e;l["e"]||(this.interactionSet.hoverGuid=t?null===(e=this.item)||void 0===e?void 0:e.guid:null)},clickGoArtboard:function(){this.$store.commit("setInteractionArtboard",this.item.renderTapInteraction)}},computed:{interactionRectAlwaysVisible:function(){return this.$store.state.artboardDetail.interactionSet.rectAlwaysVisible},style:function(){var t=this.rect;return"top:".concat(t.top,"px;left:").concat(t.left,"px;width:").concat(t.width,"px;height:").concat(t.height,"px;")},hoverGuid:function(){return this.interactionSet.hoverGuid},artboardDetail:function(){return this.$store.state.artboardDetail},interactionSet:function(){return this.artboardDetail.interactionSet},boundsInArtboard:function(){var t,e;return null!==(t=null===(e=this.item)||void 0===e?void 0:e.boundsInArtboard)&&void 0!==t?t:new d["a"]},rect:function(){var t=this.boundsInArtboard,e=this.itemScale,n=t.width,r=t.height,i=t.x,a=t.y;return n*=e,r*=e,i*=e,a*=e,{width:n,height:r,left:i,top:a}}},props:{item:Object,index:Number,itemScale:Number}},Jm=Qm,tp=(n("685e"),Object(qe["a"])(Jm,Zm,qm,!1,null,"8a48b29e",null)),ep=tp.exports,np={components:{InteractionNodePointItem:ep},methods:{},computed:{visible:function(){var t=this.currentInteractionData;if(t.fetchState!=c["FetchState"].Success)return!1;var e=this.renderInteractions;return 0!=e.length},isWeb:function(){return!l["e"]&&this.pcDeviceSet.type===xe.Web},pcDeviceSet:function(){return this.$store.state.artboardDetail.interactionSet.pcDeviceSet},mobileSize:function(){return this.$store.state.mobileInteraction.mobileSize},renderSize:function(){var t,e,n=this.mobileSize,r=this.pcDeviceSet;return this.inMobile?(t=n.width,e=n.height):(t=r.width,e=r.height),{width:t,height:e}},itemScale:function(){if(this.isWeb)return 1;var t=this.renderSize.width/this.rect.width;return isNaN(t)&&(t=1),t*this.overlayScale},currentInteractionData:function(){return this.artboard.interactionInfo},renderInteractions:function(){var t,e,n=this.currentInteractionData;return n.fetchState===c["FetchState"].Success&&null!==(t=null===(e=n.data)||void 0===e?void 0:e.renderInteractions)&&void 0!==t?t:[]},rect:function(){var t,e=this.artboard,n=null!==(t=null===e||void 0===e?void 0:e.boundsInParentForList)&&void 0!==t?t:new d["a"];return(new d["a"]).set(0,0,n.width,n.height)}},props:{artboard:Object,overlayScale:Number},created:function(){l["a"]&&(window.vue_InteractionNodePoints=this)}},rp=np,ip=(n("db03"),Object(qe["a"])(rp,Xm,Km,!1,null,"92d77816",null)),ap=ip.exports,op={},sp={name:"interaction-artboard-item",components:{InteractionNodePoints:ap},methods:{onTouchStart:function(){this.isMouseDown=!0,window.addEventListener("touchend",this.onTouchEnd,!0)},onTouchEnd:function(){window.removeEventListener("touchend",this.onTouchEnd,!0),this.isMouseDown=!1},onMouseDown:function(){l["e"]||(this.isMouseDown=!0,window.addEventListener("mouseup",this.onMouseUp,!0))},onMouseUp:function(){window.removeEventListener("mouseup",this.onMouseUp,!0),l["e"]||(this.isMouseDown=!1)},clickArtboardItemSelf:function(){var t=this.rootSize;t&&this.$store.commit("setInteractionArtboard",{type:pt.goBack})},onImgLoad:function(){this.imgState=c["FetchState"].Success,op[this.imgSrc]=1},onImgError:function(){this.imgState=c["FetchState"].Error},onScroll:function(t){if(this.isTopArtboard){var e=this.scrollYCache;e[this.artboard.cid]=t.target.scrollTop}},resetScroll:function(){var t;if(this.isTopArtboard){var e=this.$refs.artboardScrollBox;if(e){var n=null!==(t=this.scrollYCache[this.artboard.cid])&&void 0!==t?t:0;e.scrollTop=n}}}},watch:{imgSrc:function(t){t&&(op[t]||(this.imgState=c["FetchState"].Fetching))},curArtboard:function(){this.resetScroll()}},computed:{interactionRectAlwaysVisible:function(){return this.interactionSet.rectAlwaysVisible},overlayArtboardOffset:function(){var t=new F,e=this.overlayArtboards;if(!e)return t;var n=e.length;if(n<=1)return t;for(var r=0;r<n-1;r++){var i=e[r].renderTapInteraction;if(i){var a=i.overlayTopLeft;a&&(t.x+=a.x,t.y+=a.y)}}return t},previousOverlayArtboardOffset:function(){var t=new F,e=this.overlayArtboards;if(!e)return t;var n=e.length;if(n<1)return t;for(var r=0;r<n-2;r++){var i=e[r].renderTapInteraction;if(i){var a=i.overlayTopLeft;a&&(t.x+=a.x,t.y+=a.y)}}return t},renderOverlayArtboardDatas:function(){var t=[],e=this.overlayArtboard,n=this.previousOverlayArtboard,r=this.previousOverlayArtboardOffset,i=this.overlayArtboardOffset,a=this.artboard.guid;return n&&t.push({overlayArtboard:n,overlayArtboardOffset:r,key:"".concat(a,"-").concat(n.artboard.guid)}),e&&t.push({overlayArtboard:e,overlayArtboardOffset:i,key:"".concat(a,"-").concat(e.artboard.guid)}),t},previousOverlayArtboard:function(){var t=this.overlayArtboards;if(!t)return null;var e=t.length;if(e<1)return null;var n=t[e-1];return n.visible?t[e-2]:null},overlayArtboard:function(){var t=this.overlayArtboards;if(!t)return null;var e=t.length;return 0===e?null:t[e-1]},isTopArtboard:function(){var t=this.rootSize;return!t},itemStyle:function(){var t=this.renderTapInteraction,e=this.imgStyle,n=this.isWeb,r=this.backgroundColor,i=this.isTopArtboard,a={};if(i&&(a["background-color"]=r),n&&i&&(a=Object.assign(a,e,{position:"relative",top:"auto",left:"auto","max-height":"100%","max-width":"100%"})),!t)return a;var o=t.transition;if(!o)return a;var s=mt[o.easing];return s||(s=mt.linear),a["animation-timing-function"]=s,a["animation-duration"]=(o.duration||.3).toFixed(3)+"s",this.overlayVisible||(a["pointer-events"]="none"),a},itemCls:function(){var t=this.renderTapInteraction,e=[];if(this.inMobile&&e.push("in-mobile"),this.imgLoading&&e.push("inloading"),!t)return e;var n=t.transition;if(!n)return e;var r=this.overlayVisible?"":"-reverse";switch(n.type){case"dissolve":case"autoAnimate":e.push("animation-opacity".concat(r));break;case"push":case"slide":var i=ft[n.fromSide];i||(i=ft.L),e.push("animation-slide-".concat(i).concat(r));break;case"push-background":case"slide-background":var a=ft[n.fromSide];a||(a=ft.L),e.push("animation-".concat(n.type,"-").concat(a).concat(r)),e.push(n.type);break}return e},isWeb:function(){return!this.inMobile&&this.pcDeviceSet.type===xe.Web},interactionSet:function(){return this.$store.state.artboardDetail.interactionSet},backgroundColor:function(){return this.interactionSet.backgroundColor},mobileSize:function(){return this.$store.state.mobileInteraction.mobileSize},renderSize:function(){var t,e,n=this.mobileSize,r=this.pcDeviceSet;return this.inMobile?(t=n.width,e=n.height):(t=r.width,e=r.height),{width:t,height:e}},pcDeviceSet:function(){return this.interactionSet.pcDeviceSet},overlayScale:function(){if(this.isWeb)return 1;var t=this.rootSize;return t?this.artboard.boundsInParentForList.width/t.width:1},rootScale:function(){if(this.isWeb)return 1;var t=this.rootSize,e=this.artboard,n=this.renderSize,r=t?t.width:e.boundsInParentForList.width;return n.width/r},contentStyle:function(){var t=this.renderTapInteraction,e=this.isTopArtboard,n=this.isWeb,r=this.rootScale,i=this.overlayOffset,a=this.imgStyle;if(e)return a;var o=t.overlayTopLeft||{},c=o.x,l=void 0===c?0:c,u=o.y,d=void 0===u?0:u;return i&&(l+=i.x,d+=i.y),n||(l*=r,d*=r),Object(s["a"])({top:d+"px",left:l+"px"},a)},imgStyle:function(){var t=this.artboard.boundsInParentForList;if(this.isWeb)return{width:t.width+"px",height:t.height+"px"};var e=this.renderSize.width;return e=Math.round(this.overlayScale*e),{width:e+"px",height:Math.round(e/t.width*t.height)+"px"}},imgLoading:function(){return this.imgState===c["FetchState"].Fetching},imgSrc:function(){var t,e=this.artboard,n=this.isSupportWebp;return n&&(t=e.artboardPreviewWebp,t)?t:e.artboardPreviewPng},isSupportWebp:function(){return this.$store.state.isSupportWebp===pe.Support},scrollYCache:function(){return this.$store.state.mobileInteraction.scrollYCache}},data:function(){return{imgState:c["FetchState"].Normal,isMouseDown:!1}},props:{artboard:Object,overlayArtboards:{type:Array,default:null},rootSize:{type:Object,default:null},renderTapInteraction:{type:Object,default:null},overlayOffset:{type:Object,default:null},overlayVisible:{type:Boolean,default:!0}},mounted:function(){this.resetScroll()},beforeDestroy:function(){window.removeEventListener("touchend",this.onTouchEnd,!0),window.removeEventListener("mouseup",this.onMouseUp,!0)}},cp=sp,lp=(n("516c"),Object(qe["a"])(cp,Gm,Ym,!1,null,"329080a8",null)),up=lp.exports,dp={components:{InteractionArtboardItem:up},methods:{clickDeviceBox:function(){this.currentArtboardHasRenderInteraction||this.showTextTip("当前画板没有或未提交交互原型热区",1)}},computed:{currentOverlayVisible:function(){return!this.gobackArtboard},currentArtboardHasRenderInteraction:function(){return null!=this.currentArtboardRenderInteractions},currentArtboardRenderInteractions:function(){var t,e,n,r=null===(t=this.curArtboard)||void 0===t||null===(e=t.artboard)||void 0===e?void 0:e.interactionInfo;if(!r)return null;if(r.fetchState!==c["FetchState"].Success)return null;var i=null===(n=r.data)||void 0===n?void 0:n.renderInteractions;return Object(l["g"])(i)&&i.length>0?i:null},currentRenderTapInteraction:function(){var t,e=this.gobackArtboard,n=this.gotoArtboard,r=null===(t=null!==e&&void 0!==e?e:n)||void 0===t?void 0:t.renderTapInteraction;if(r){var i=r,a=i.transition,o=i.trigger_type,c=i.type,u=i.preserveScrollPosition,d=i.toArtboard;if(!Object(l["o"])(a))return null;switch(a=Object(s["a"])({},a),a.type){case"dissolve":case"autoAnimate":return null;case"push":case"slide":a.type="".concat(a.type,"-background");break}r={transition:a,trigger_type:o,type:c,preserveScrollPosition:u,toArtboard:d}}return r},itemCurrent:function(){var t;return{artboard:null===(t=this.curArtboard)||void 0===t?void 0:t.artboard,overlayArtboards:this.interactionSet.overlayArtboards}},gobackArtboard:function(){return this.interactionSet.gobackArtboard},gotoArtboard:function(){return this.interactionSet.gotoArtboard},interactionSet:function(){return this.$store.state.artboardDetail.interactionSet},boxStyle:function(){return this.isWeb?{width:"100%",height:"100%"}:{width:this.pcDeviceSet.width+"px",height:this.pcDeviceSet.height+"px"}},isWeb:function(){return this.pcDeviceSet.type===xe.Web},pcDeviceSet:function(){return this.interactionSet.pcDeviceSet},isHorizontal:function(){return this.pcDeviceSet.isHorizontal},headerVisible:function(){return this.interactionSet.headerVisible},leftSideVisible:function(){return this.$store.state.artboardDetail.leftSideVisible&&this.headerVisible}}},hp=dp,fp=(n("b90c"),Object(qe["a"])(hp,zm,Wm,!1,null,"3cb6bb0a",null)),mp=fp.exports,pp={components:{DeviceBox:mp},computed:{isWeb:function(){return this.pcDeviceSet.type===xe.Web},pcDeviceSet:function(){return this.$store.state.artboardDetail.interactionSet.pcDeviceSet},isHorizontal:function(){return this.pcDeviceSet.isHorizontal},headerVisible:function(){return this.$store.state.artboardDetail.interactionSet.headerVisible},leftSideVisible:function(){return this.$store.state.artboardDetail.leftSideVisible&&this.headerVisible}}},bp=pp,vp=(n("3c4a"),Object(qe["a"])(bp,$m,Hm,!1,null,"091dc974",null)),gp=vp.exports,wp={components:{CloudNeedLoginTip:Ea,Header:Um,EmptyData:jl,Authority:Ml,Tip:ao,LeftSide:vm,DeviceContainer:gp},methods:{clickHeaderVisible:function(){this.$store.commit("setInteractionHeaderVisible",!this.headerVisible)}},computed:{emptyText:function(){return this.inCloudMode?0===this.cloudCurrentFolderId?"私有云下还没有文件夹,请在标记狮中添加":this.inNetDiskFileMode?"文件不存在,可能已经被移动或删除":"当前文件夹是空的":"未检测到数据,请尝试重新导出画板"},backgroundColor:function(){return this.interactionSet.backgroundColor},interactionSet:function(){return this.$store.state.artboardDetail.interactionSet},headerVisibleTitle:function(){return this.headerVisible?"隐藏顶部(F2)":"显示顶部(F2)"},headerVisible:function(){return this.interactionSet.headerVisible},artboardLoadProgressText:function(){return Math.floor(1e4*this.artboardLoadProgress.current/this.artboardLoadProgress.count)/100+"%"},artboardLoadProgress:function(){return this.$store.state.artboardLoadProgress},allArtboardLoadChecked:function(){return this.$store.state.allArtboardLoadChecked},isEmptyData:function(){return 0===this.documentArtboards.length}},created:function(){l["a"]&&(window.vue_InteractionViewerApp=this)}},xp=wp,yp=(n("e9d1"),Object(qe["a"])(xp,sm,cm,!1,null,"02e4262a",null)),Cp=yp.exports,kp=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{attrs:{id:"main"}},[!t.cloudNeedLogin||t.cloudIsLogin?n("div",{staticClass:"loading",class:{on:!t.allArtboardLoadChecked}},[t._v("正在加载画板数据中("+t._s(t.artboardLoadProgressText)+"),请稍后...")]):t._e(),t.cloudNeedLogin&&!t.cloudIsLogin?n("CloudNeedLoginTip"):t.allArtboardLoadChecked?[t.cloudFolderNotFound||!t.permission?[n("Header"),n("Nav"),n("main",[t.cloudFolderNotFound?n("EmptyData",{attrs:{text:"链接已失效,无法找到对应的文件夹"}}):t.permission?t._e():n("Authority",{attrs:{include:!0}})],1)]:[t.inList?n("ArtboardList"):n("ArtboardInfo")]]:t._e(),n("TipInMobile")],2)},Sp=[],_p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",[t.cloudNeedLogin||t.cloudIsLogin?n("user-info"):t._e(),n("div",{staticClass:"search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.mobileInteraction.searchText,expression:"mobileInteraction.searchText"}],ref:"searchInput",attrs:{type:"text",placeholder:t.showAll?"搜索文件夹和画板":"搜索画板",autocomplete:"off"},domProps:{value:t.mobileInteraction.searchText},on:{input:function(e){e.target.composing||t.$set(t.mobileInteraction,"searchText",e.target.value)}}}),t.hasSearchText?n("span",{staticClass:"search-clear",on:{click:t.clickSearchClear}}):t._e()]),n("div",{staticClass:"btn-control-refresh",on:{click:t.clickRefresh}}),n("div",{staticClass:"btn-control-copyurl",on:{click:t.copyUrl}})],1)},Ap=[],Ip=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"userinfo"},[n("div",{staticClass:"nickname",class:{on:t.menuVisible},on:{click:t.clickShowMenu}},[n("UserFace",{attrs:{canClick:!1}})],1),t.menuVisible?n("div",{staticClass:"m-popbox",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.menuVisible=!1}}},[n("div",{staticClass:"box"},[n("div",{staticClass:"u-info"},[n("UserFace",{attrs:{canClick:!1}}),n("div",{staticClass:"info"},[n("div",{staticClass:"name"},[t._v(t._s(t.showName))]),n("div",{staticClass:"email"},[t._v(t._s(t.showEmail))])])],1),t.cloudIsLogin?n("a",{staticClass:"button btn-logout",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickLogout()}}},[t._v("退出登录")]):t._e()])]):t._e()])},Tp=[],Op=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"userface",class:{on:t.canClick},attrs:{title:t.title},on:{click:function(e){return e.stopPropagation(),t.clickUserFace.apply(null,arguments)}}},[t.showIcon?n("div",{staticClass:"icon"}):n("div",{staticClass:"user"},[t._v(t._s(t.iconText))])])},Ep=[],Mp={methods:{clickUserFace:function(){this.$emit("click")}},computed:{showIcon:function(){return!this.cloudIsLogin},iconText:function(){if(!this.cloudIsLogin)return"";var t=this.cloudNickName;return Object(l["h"])(t)||(t=this.cloudUserEmail),t[t.length-1]}},props:{title:String,canClick:Boolean}},Lp=Mp,Np=(n("9bdc"),Object(qe["a"])(Lp,Op,Ep,!1,null,"21cd411d",null)),Dp=Np.exports,Fp={components:{UserFace:Dp},methods:{clickLogout:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.logoutting){e.next=2;break}return e.abrupt("return");case 2:return t.logoutting=!0,e.prev=3,e.next=6,t.goCloudLogout();case 6:return e.prev=6,t.logoutting=!1,e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[3,,6,9]])})))()},clickShowMenu:function(){this.cloudIsLogin?this.menuVisible=!0:this.goCloudLogin()}},computed:{showName:function(){return this.cloudIsLogin?this.cloudNickName:"未登录"},showEmail:function(){return this.cloudIsLogin?this.cloudUserEmail:""}},data:function(){return{menuVisible:!1,logoutting:!1}}},Pp=Fp,jp=(n("7c0a"),Object(qe["a"])(Pp,Ip,Tp,!1,null,"35031a94",null)),Rp=jp.exports,Bp={components:{UserInfo:Rp},methods:{clickRefresh:function(){this.goCloudFolderInteractionUrl(this.cloudCurrentFolderId,this.curArtboardGuid)},copyUrl:function(){Object(c["copyValueFromText"])(this.getCurrentInteractionUrl())?this.showTextTip("已复制预览地址到剪切板",2):this.showTextTip("预览地址复制到剪切板失败",2)},clickSearchClear:function(){var t;this.mobileInteraction.searchText="",null===(t=this.$refs.searchInput)||void 0===t||t.focus()}},computed:{mobileInteraction:function(){return this.$store.state.mobileInteraction},hasSearchText:function(){return!!this.searchText},searchText:function(){return this.mobileInteraction.searchText}},props:{showAll:Boolean}},Vp=Bp,Up=(n("4eb2"),Object(qe["a"])(Vp,_p,Ap,!1,null,"47a290c4",null)),$p=Up.exports,Hp=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"nav"},[n("path-nav"),n("nav-filter")],1)},zp=[],Wp=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"path-nav"},[n("div",{staticClass:"navs"},t._l(t.navs,(function(e,r){return n("div",{key:r,staticClass:"nav-item",class:{"no-link":!e.link}},[n("div",{staticClass:"name",attrs:{title:e.name},on:{click:function(n){return t.clickNav(e)}}},[t._v(t._s(e.name))]),t.showArtboardPages&&e.selectPages?n("PathNavArtboardPages"):t._e()],1)})),0)])},Gp=[],Yp=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"select-artboard-page",attrs:{title:"点击切换显示的页面"}},[n("div",{staticClass:"page-current",on:{click:function(e){t.visible=!t.visible}}},[n("div",{staticClass:"text"},[t._v(t._s(t.currentPageName))])]),n("ul",{staticClass:"page-list",class:{on:t.visible}},[n("li",{class:{on:!t.filterDocumentGuid},on:{click:function(e){return t.clickItem(null)}}},[n("span",{staticClass:"text"},[t._v(t._s(t.allPageName)),n("span",{staticClass:"art-count"},[t._v("("+t._s(t.documentArtboards.length)+")")])])]),t._l(t.sortDocumentsWithSketchDocument,(function(e){return n("li",{key:e.guid,class:{on:t.filterDocumentGuid===e.guid},on:{click:function(n){return t.clickItem(e)}}},[n("span",{staticClass:"text"},[t._v(t._s(e.docFullName)),n("span",{staticClass:"art-count"},[t._v("("+t._s(e.arts.length)+")")])])])}))],2)])},Xp=[],Kp={methods:{clickItem:function(t){var e,n=null!==(e=null===t||void 0===t?void 0:t.guid)&&void 0!==e?e:null;this.$store.commit("setFilterDocumentGuid",n)},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),this.handle=setTimeout((function(){e.visible=!1}),100))}},computed:{sortDocumentsWithSketchDocument:function(){return this.$store.state.sortDocumentsWithSketchDocument},currentPageName:function(){var t,e,n,r=this.filterDocumentGuid;return r&&(n=this.sortDocumentsWithSketchDocument.find((function(t){return t.guid===r}))),null!==(t=null===(e=n)||void 0===e?void 0:e.name)&&void 0!==t?t:this.allPageName}},watch:{visible:function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0)):window.removeEventListener("mouseup",this.hideContextmenu,!0)}},data:function(){return{allPageName:"全部页面",visible:!1,handle:0}},beforeDestroy:function(){clearTimeout(this.handle),window.removeEventListener("mouseup",this.hideContextmenu,!0)}},Zp=Kp,qp=(n("1596"),Object(qe["a"])(Zp,Yp,Xp,!1,null,"7626b65b",null)),Qp=qp.exports,Jp={components:{PathNavArtboardPages:Qp},methods:{clickNav:function(t){t.link&&setTimeout((function(){t.link()}),100)}},computed:{showArtboardPages:function(){return this.inCloudMode&&!this.inNetDiskFileMode&&this.documents.length>0},navs:function(){var t=this,e=[],n=this.inCloudMode,r=this.inArtboardMode,i=this.curArtboard,a=this.cloudCurrentFolderId,o=this.curNetDiskFile,s=this.inNetDiskFileMode;if(n){var c=this.cloudName,l=this.cloudParentFolder,u=this;r||(0===a?e.push({name:c||"私有云根目录",link:null}):l&&e.push({name:0===l.id&&c||l.name,id:l.id,link:function(){u.goCloudFolderInteractionUrl(this.id)}}))}if(n&&this.cloudFolderNotFound?e.push({name:"链接已失效",link:null}):n&&0==a||e.push({name:this.documentName,selectPages:!0,link:r?function(){t.setCurArtboard(null)}:s?function(){t.goCloudFolderInteractionUrl(a)}:null}),r){var d,h,f=null!==(d=null===i||void 0===i||null===(h=i.artboard)||void 0===h?void 0:h.name)&&void 0!==d?d:"";f&&e.push({name:f,link:null})}else if(s){var m,p=null!==(m=null===o||void 0===o?void 0:o.name)&&void 0!==m?m:"";p&&e.push({name:p,link:null})}return e}}},tb=Jp,eb=(n("0bb5"),Object(qe["a"])(tb,Wp,Gp,!1,null,"6a28d143",null)),nb=eb.exports,rb=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"nav-filter"},[n("div",{staticClass:"nav-sort"},[n("div",{staticClass:"title",class:{desc:t.listConfig.orderDesc},on:{click:function(e){t.menuVisible=!0}}},[t._v(t._s(t.renderTitle))]),t.menuVisible?n("div",{staticClass:"m-popbox",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.menuVisible=!1}}},[n("div",{staticClass:"box"},[n("div",{staticClass:"sort-order"},[n("div",{staticClass:"item asc",class:{on:!t.listConfig.orderDesc},on:{click:function(e){return t.setMobileInteractionListConfig({orderDesc:!1},!0)}}},[t._v("升序")]),n("div",{staticClass:"item desc",class:{on:t.listConfig.orderDesc},on:{click:function(e){return t.setMobileInteractionListConfig({orderDesc:!0},!0)}}},[t._v("降序")])]),n("div",{staticClass:"sort-types"},[n("div",{staticClass:"item",class:{on:t.listConfig.sortType===t.EnumCloudListSortType.Name},on:{click:function(e){return t.setMobileInteractionListConfig({sortType:t.EnumCloudListSortType.Name},!0)}}},[t._v("按名称排序")]),n("div",{staticClass:"item",class:{on:t.listConfig.sortType===t.EnumCloudListSortType.Date},on:{click:function(e){return t.setMobileInteractionListConfig({sortType:t.EnumCloudListSortType.Date},!0)}}},[t._v("按时间排序")]),n("div",{staticClass:"item",class:{on:t.listConfig.sortType===t.EnumCloudListSortType.ArtboardRect},attrs:{title:"画板列表按画板在文档中的坐标从上到下,从左到右排序;文件夹按名称排序"},on:{click:function(e){return t.setMobileInteractionListConfig({sortType:t.EnumCloudListSortType.ArtboardRect},!0)}}},[t._v("按坐标排序")])])])]):t._e()]),n("div",{staticClass:"nav-render"},[n("div",{staticClass:"item",class:{on:t.listConfig.renderType===t.EnumCloudMobileInteractionListRenderType.All},on:{click:function(e){return t.setMobileInteractionListConfig({renderType:t.EnumCloudMobileInteractionListRenderType.All})}}},[t._v("全部")]),n("div",{staticClass:"item",class:{on:t.listConfig.renderType===t.EnumCloudMobileInteractionListRenderType.Artboard},on:{click:function(e){return t.setMobileInteractionListConfig({renderType:t.EnumCloudMobileInteractionListRenderType.Artboard})}}},[t._v("画板")])])])},ib=[],ab={methods:{setMobileInteractionListConfig:function(t,e){this.$store.commit("setMobileInteractionListConfig",t),e&&(this.menuVisible=!1)}},computed:{EnumCloudMobileInteractionListRenderType:function(){return o["g"]},EnumCloudListSortType:function(){return o["f"]},renderTitle:function(){var t=this.listConfig,e=t.sortType,n=t.orderDesc;return"按".concat(e===o["f"].Name?"名称":e===o["f"].Date?"时间":"坐标").concat(n?"降序":"升序")},listConfig:function(){return this.$store.state.mobileInteraction.listConfig}},data:function(){return{menuVisible:!1}}},ob=ab,sb=(n("e96f"),Object(qe["a"])(ob,rb,ib,!1,null,"d85c16d8",null)),cb=sb.exports,lb={components:{PathNav:nb,NavFilter:cb}},ub=lb,db=(n("b334"),Object(qe["a"])(ub,Hp,zp,!1,null,"72e5b43a",null)),hb=db.exports,fb=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"artboard-list",class:{"safari-standalone":t.inSafariStandalone}},[n("Header",{attrs:{showAll:t.showAll}}),n("Nav"),t.isEmptyList?n("main",[n("EmptyData",{attrs:{text:t.emptyText}})],1):t.showAll?n("main",{ref:"mainAll",on:{scroll:t.onMainAllViewScroll,mousewheel:t.onMainAllViewMouseWheel}},[n("div",{staticClass:"box",class:{off:t.mainAllView.mousewheelTimes>0},style:{height:t.mainAllView.boxRealHeight+"px"}},[n("div",{staticClass:"brace",style:t.allListBraceStyle},t._l(t.showLazyAllList,(function(t){return n("ArtboardListItem",{key:t.key,attrs:{item:t.item}})})),1)])]):n("main",{ref:"mainArtboard",on:{scroll:t.onMainArtboardViewScroll,mousewheel:t.onMainArtboardViewMouseWheel}},[n("div",{staticClass:"box",class:{off:t.mainArtboardView.mousewheelTimes>0},style:{height:t.mainArtboardView.boxRealHeight+"px"}},t._l(t.showLazyArtboardList,(function(t){return n("ArtboardListArtboardItem",{key:t.key,attrs:{item:t}})})),1)]),t.listFetchState===t.FetchState.Fetching?n("div",{staticClass:"list-loading"},[n("div",{staticClass:"box"},[t.listFetchState===t.FetchState.Fetching?n("NetworkLoading",{attrs:{loadText:"正在获取文件夹数据...",errorText:"",isLoading:t.listFetchState===t.FetchState.Fetching,isError:!1,reLoadText:""}}):t._e()],1)]):t._e()],1)},mb=[],pb=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"artboard-item",style:t.style},[n("div",{staticClass:"title"},[t._v(t._s(t.item.artboard.name))]),n("div",{staticClass:"img",on:{click:function(e){return t.setCurArtboard(t.item.item)}}},[n("img",{attrs:{src:t.artboardReviewImg,alt:""},on:{error:t.errPreviewImage}}),t.artboard.flowStart?n("div",{staticClass:"flow-start"}):t._e()])])},bb=[],vb={methods:{errPreviewImage:function(){this.userMiniPreviewImg&&(this.userMiniPreviewImg=!1)}},computed:{isSupportWebp:function(){return this.$store.state.isSupportWebp===pe.Support},artboardReviewImg:function(){var t=this.artboard,e=this.userMiniPreviewImg?this.isSupportWebp&&t.artboardPreviewWebp?t.artboardPreviewWebp:t.artboardPreviewThumbPng:t.artboardPreviewPng;return e},artboard:function(){return this.item.artboard},style:function(){var t=this.item.rect;return"top:".concat(t.top,"px;left:").concat(t.left,"px;width:").concat(t.width,"px;height:").concat(t.height,"px;")}},props:{item:Object},data:function(){return{userMiniPreviewImg:!0}}},gb=vb,wb=(n("8b25"),Object(qe["a"])(gb,pb,bb,!1,null,"904ae240",null)),xb=wb.exports,yb=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"item",on:{click:t.clickItem}},[n("div",{staticClass:"img",class:{folder:t.isFolder,lock:t.isFolder&&1===t.item.shareMode,artboard:t.isArtboard}},[t.isArtboard?n("img",{attrs:{src:t.artboardReviewImg,alt:""},on:{error:t.errPreviewImage}}):t._e()]),n("div",{staticClass:"info"},[n("div",{staticClass:"name"},[t._v(t._s(t.name))]),n("div",{staticClass:"summary"},[t._v(t._s(t.summary))])])])},Cb=[],kb={methods:{errPreviewImage:function(){this.userMiniPreviewImg&&(this.userMiniPreviewImg=!1)},clickItem:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i,a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.item,i=t.isFolder,a=t.isArtboard,!i){e.next=5;break}return e.next=4,t.goCloudFolderInteractionUrl(n.id);case 4:return e.abrupt("return");case 5:a&&t.setCurArtboard(n);case 6:case"end":return e.stop()}}),e)})))()}},computed:{artboardReviewImg:function(){var t=this.item,e=this.isArtboard;if(!e)return null;var n=t.artboard,r=this.userMiniPreviewImg?n.artboardPreviewThumbPng:n.artboardPreviewPng;return r},name:function(){var t=this.item,e=this.isFolder,n=this.isArtboard;return e?t.name:n?t.artboard.name:null},summary:function(){var t=this.item,e=this.isFolder,n=this.isArtboard;return e?"".concat(t.folderCount,"个文件夹,").concat(t.artboardCount,"个画板"):n?"".concat(t.artboard.updaterName," 提交于 ").concat(t.artboard.updateTimeStr):null},isFolder:function(){return this.item.id>0},isArtboard:function(){var t;return!this.isFolder&&(null===(t=this.item.artboard)||void 0===t?void 0:t.cid)>0}},data:function(){return{userMiniPreviewImg:!0}},props:{item:Object}},Sb=kb,_b=(n("c0e6"),Object(qe["a"])(Sb,yb,Cb,!1,null,"d0959946",null)),Ab=_b.exports,Ib=68,Tb={components:{Header:$p,ArtboardListArtboardItem:xb,ArtboardListItem:Ab,Nav:hb,EmptyData:jl,NetworkLoading:aa},methods:{sortData:function(t,e,n){var r=this.orderDesc,i=this.sortType,a=n===o["e"].Artboard;if(i===o["f"].Date)t.sort((function(t,n){a&&(t=t.artboard,n=n.artboard);var i=t[e]>n[e]?1:-1;return r?-i:i}));else if(i===o["f"].ArtboardRect&&a){var s={},l=[];t.forEach((function(t){var e=t.artboard,n=e.docName,r=e.docGuid,i=e.pageGuid,a=e.pageName,o=i||r||"",c=a||n||"",u="".concat(n).concat(a?"/".concat(a):""),d=s[o];d||(d=s[o]={arts:[],guid:o,name:c,fileType:t.artboard.fileType,docFullName:u,docGuid:r,docName:n},l.push(d)),d.arts.push(t.artboard)})),s=null;var u=function(t,e){var n=t.boundsInParentForList||t.frame,r=e.boundsInParentForList||e.frame;if(t.updateTimeTimes>0&&e.updateTimeTimes>0){var i=(new d["a"]).set(n.x,n.y,n.width,n.height),a=(new d["a"]).set(r.x,r.y,r.width,r.height);if(i.isOverlap(a)){var o=t.updateTimeTimes-e.updateTimeTimes;if(Math.abs(o)>1500){if(o>0)return 1;if(o<0)return-1}}}var s=n.y,c=r.y,l=Math.round(s/100),u=Math.round(c/100),h=l-u;if(h>0)return 1;if(h<0)return-1;var f=n.x,m=r.x,p=f-m;return p>0?1:-1};l.sort((function(t,e){var n=Object(c["localeCompareString"])(t.docFullName,e.docFullName);return r?-n:n}));var h=0,f={};l.forEach((function(t){t.arts.sort((function(t,e){var n=u(t,e);return r?-n:n})),t.arts.forEach((function(t){f[t.cid]=h++}))})),t.sort((function(t,e){return a&&(t=t.artboard,e=e.artboard),f[t.cid]-f[e.cid]>0?1:-1}))}else t.sort((function(t,e){a&&(t=t.artboard,e=e.artboard);var n=Object(c["localeCompareString"])(t.name,e.name);return r?-n:n}))},designPXToShowPX:function(t,e){var n=t/c["MobileDesignWidth"]*this.mainArtboardView.docWidth;return e?Math.ceil(n):Math.floor(n)},designPXToShowVW:function(t){return t/c["MobileDesignWidth"]*100+"vw"},onMainViewResize:function(){var t=this.$refs.mainArtboard,e=this.$refs.mainAll,n=document.documentElement.offsetWidth,r=this.mainArtboardView;r.docWidth=n,t&&(r.height=Math.ceil(t.getBoundingClientRect().height));var i=this.mainAllView;i.docWidth=n,e&&(i.height=Math.ceil(e.getBoundingClientRect().height))},onMainAllViewScroll:function(){var t=this.$refs.mainAll;if(t){var e=this.mainAllView;e.scrollTop=t.scrollTop}},onMainAllViewMouseWheel:function(t){var e;this.mainAllView.mousewheelTimes=null!==(e=t.timeStamp)&&void 0!==e?e:Date.now()},onMainArtboardViewMouseWheel:function(t){var e;this.mainArtboardView.mousewheelTimes=null!==(e=t.timeStamp)&&void 0!==e?e:Date.now()},onMainArtboardViewScroll:function(){var t=this.$refs.mainArtboard;if(t){var e=this.mainArtboardView;e.scrollTop=t.scrollTop}},refreshBrowserInfo:function(){var t=this,e=this.showAll,n=this.isEmptyList;n||this.$nextTick((function(){t.onMainViewResize();var n=e?t.$refs.mainAll:t.$refs.mainArtboard,r=e?t.mainAllView:t.mainArtboardView;n&&(r.scrollTop=n.scrollTop=0)}))}},watch:{"mainAllView.mousewheelTimes":function(t){var e=this,n=this.mainAllView;clearTimeout(n.handle),t&&(n.handle=setTimeout((function(){e.mainAllView.mousewheelTimes=0}),200))},"mainArtboardView.mousewheelTimes":function(t){var e=this,n=this.mainArtboardView;clearTimeout(n.handle),t&&(n.handle=setTimeout((function(){e.mainArtboardView.mousewheelTimes=0}),200))},cloudCurrentFolderId:function(){this.refreshBrowserInfo()},isEmptyList:function(){this.refreshBrowserInfo()},showAll:function(){this.refreshBrowserInfo()}},computed:{FetchState:function(){return c["FetchState"]},listFetchState:function(){return this.$store.state.mobileInteraction.listFetchState},allListBraceStyle:function(){var t;return t=this.renderAllListIndexStart*Ib,{paddingTop:this.designPXToShowVW(t)}},isEmptyList:function(){var t=this.showAll,e=this.renderSortArtboardList,n=this.renderSortedAllList,r=t?n:e;return 0===r.length},emptyText:function(){var t=this.showAll,e=this.searchText,n=this.hasSearchText,r=t?"子文件夹和画板":"画板";return n?"未找到“".concat(e,"”相关的").concat(r):"当前文件夹不存在".concat(r)},showAll:function(){return this.renderType===o["g"].All},sortType:function(){return this.listConfig.sortType},orderDesc:function(){return this.listConfig.orderDesc},renderType:function(){return this.listConfig.renderType},listConfig:function(){return this.$store.state.mobileInteraction.listConfig},mobileInteraction:function(){return this.$store.state.mobileInteraction},hasSearchText:function(){return!!this.searchText},searchText:function(){return this.mobileInteraction.searchText},showLazyArtboardList:function(){var t=[],e=this.renderArtboardList,n=this.mainArtboardView,r=(new d["a"]).set(0,n.scrollTop,n.docWidth,n.height);return e.forEach((function(e){var n=e.rect;r.isOverlap(n)&&t.push(e)})),t},renderArtboardList:function(){var t=this.renderSortArtboardList,e=this.mainArtboardView,n=e.docWidth,r=[];if(e.boxRealHeight=0,0===n)return r;var i={titleHeight:this.designPXToShowPX(39,!0),imgWidth:this.designPXToShowPX(154,!0),lineCount:2,offsetX:this.designPXToShowPX(21),artboardFullEqualWidth:0};i.lineCount=Math.floor(n/i.imgWidth),i.artboardFullEqualWidth=Math.round(n/i.lineCount);var a=new Array(i.lineCount).fill(0),o=0;return t.forEach((function(t){var n,s=t.artboard,c=s.boundsInParentForList;if(c){var l=new d["a"],u=a[o],h=Math.ceil(c.height*i.imgWidth/c.width)+i.titleHeight;l.set(i.offsetX+(i.offsetX+i.imgWidth)*o,u,i.imgWidth,h),u+=h,a[o]=u,e.boxRealHeight=Math.max(e.boxRealHeight,u),o++,o>=i.lineCount&&(o=0),r.push({item:t,artboard:s,rect:l,titleHeight:i.titleHeight,key:null!==(n=s.cid)&&void 0!==n?n:"".concat(s.fileType,":").concat(s.guid)})}})),r},renderSortArtboardList:function(){var t,e,n=this.hasSearchText,r=this.searchText,i=this.renderDocumentArtboards,a=[];return r=n&&null!==(t=null===(e=r)||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"",i.forEach((function(t){var e=null===t||void 0===t?void 0:t.artboard;if(e){if(n){var i=e.name;if(!i)return;if(-1===i.toLowerCase().indexOf(r))return}a.push(t)}})),a.length>0&&this.sortData(a,"updateTimeTimes",o["e"].Artboard),a},renderAllListIndexStart:function(){var t=this.mainAllView;return Math.floor(t.scrollTop/this.designPXToShowPX(Ib))},showLazyAllList:function(){for(var t=this.renderSortedAllList,e=this.mainAllView,n=this.renderAllListIndexStart,r=Math.ceil(e.height/this.designPXToShowPX(Ib))+1,i=[],a=Math.min(n+r,t.length);n<a;n++){var o,s,c=t[n];i.push({item:c,key:"".concat(c.id,"-").concat(null!==(o=null===(s=c.artboard)||void 0===s?void 0:s.cid)&&void 0!==o?o:0)})}return i},renderSortedAllList:function(){var t,e,n=this.cloudSubFolders,r=this.hasSearchText,i=this.searchText,a=this.mainAllView,s=[];i=r&&null!==(t=null===(e=i)||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"",Object(l["g"])(n)&&n.forEach((function(t){if(r){var e=t.name;if(!e)return;if(-1===e.toLowerCase().indexOf(i))return}s.push(t)})),this.sortData(s,"createTimeTimes",o["e"].Folder);var c=this.renderSortArtboardList;return c.length>0&&s.push.apply(s,Object(u["a"])(c)),a.boxRealHeight=this.designPXToShowPX(Ib)*s.length,s}},data:function(){return{mainArtboardView:{scrollTop:0,height:0,docWidth:0,boxRealHeight:0,mousewheelTimes:0,handle:0},mainAllView:{scrollTop:0,height:0,docWidth:0,boxRealHeight:0,mousewheelTimes:0,handle:0},inSafariStandalone:l["f"]}},created:function(){window.addEventListener("resize",this.onMainViewResize),l["a"]&&(window.vue_MobileInteractionArtboardList=this)},mounted:function(){this.onMainViewResize(),this.onMainArtboardViewScroll(),this.onMainAllViewScroll()},beforeDestroy:function(){window.removeEventListener("resize",this.onMainViewResize),clearTimeout(this.mainArtboardView.handle),clearTimeout(this.mainAllView.handle)}},Ob=Tb,Eb=(n("18a8"),Object(qe["a"])(Ob,fb,mb,!1,null,"7469df55",null)),Mb=Eb.exports,Lb=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"artboard-info"},[n("ArtboardPanel",{attrs:{renderArtboardList:t.renderDocumentArtboards,curArtboardIndex:t.curArtboardIndex}}),!t.homeListVisible&&t.mobileInteraction.controlVisible?n("div",{staticClass:"control"},[n("div",{staticClass:"btns"},[n("div",{staticClass:"btn btn-control-golist",on:{click:function(e){return t.setCurArtboard(null)}}}),n("div",{staticClass:"line"}),n("div",{staticClass:"btn btn-control-copyurl",on:{click:t.copyUrl}})]),n("menu",[n("span",{staticClass:"btn btn-go-prev",class:{disabled:!t.hasPrevArtboard},on:{click:t.clickGoPrev}}),n("span",{staticClass:"btn btn-interaction-rect-always-visible",class:{on:t.interactionRectAlwaysVisible},on:{click:t.clickInteractionRectAlwaysVisible}}),n("span",{staticClass:"btn btn-homelist",class:{disabled:0===t.homeList.length},on:{click:t.clickHomeList}}),n("span",{staticClass:"btn btn-go-next",class:{disabled:!t.hasNextArtboard},on:{click:t.clickGoNext}})])]):t._e(),n("home-list",{attrs:{homeList:t.homeList,visible:t.homeListVisible},on:{hideHomeList:t.hideHomeList}})],1)},Nb=[],Db=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"artboard-panel",on:{touchstart:t.touchstartPanel}},[n("div",{staticClass:"box",class:{animation:t.animation,moving:t.movingX},style:t.style},t._l(t.showArtboards,(function(t){return n("div",{key:t.key,staticClass:"item"},[t.artboard?n("InteractionArtboardItem",{attrs:{artboard:t.artboard,overlayArtboards:t.overlayArtboards,renderTapInteraction:t.renderTapInteraction,overlayVisible:t.overlayVisible}}):n("artboard-empty")],1)})),0),t.gobackArtboard?n("InteractionArtboardItem",{attrs:{overlayVisible:!1,artboard:t.gobackArtboard.fromArtboard.artboard,overlayArtboards:[],renderTapInteraction:t.gobackArtboard.renderTapInteraction}}):t._e(),t.gotoArtboard?n("InteractionArtboardItem",{attrs:{artboard:t.gotoArtboard.fromArtboard.artboard,overlayArtboards:[],renderTapInteraction:t.gotoArtboard.renderTapInteraction}}):t._e()],1)},Fb=[],Pb=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},jb=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"artboard-empty"},[n("div",{staticClass:"box"},[n("div",{staticClass:"text"},[t._v("没有画板了")])])])}],Rb=(n("d3de"),{}),Bb=Object(qe["a"])(Rb,Pb,jb,!1,null,"dbda9962",null),Vb=Bb.exports,Ub={components:{InteractionArtboardItem:up,ArtboardEmpty:Vb},methods:{touchmovePanel:function(t){var e=t.changedTouches[0];if(e){var n=this.maxDiffNum,r=this.docWidth,i=e.pageX-this.touchStartX,a=e.pageY-this.touchStartY,o=Math.abs(i),s=Math.abs(a);this.movingX||this.movingY||(s>=n&&o<s&&(this.movingY=!0),!this.movingY&&o>=n&&(this.movingX=!0)),this.movingX&&(t.preventDefault(),i=i>0?Math.min(i,r):Math.max(i,-r),this.mouseDiffX=i)}},touchendPanel:function(t){window.removeEventListener("touchmove",this.touchmovePanel,{passive:!1}),window.removeEventListener("touchend",this.touchendPanel);var e=t.changedTouches[0];if(e)if(this.movingX){var n=e.pageX-this.touchStartX;this.onSlide(n)}else if(this.movingY)this.movingY=!1;else{var r,i=t.target,a=i&&!!i.getAttribute("data-unset-control"),o=this.mobileInteraction,s=Math.abs(Date.now()-this.touchStartTime),c=s<300,l=s>1500,u=o.controlVisible;a&&c?a=!1:(l&&a||c)&&(r=!u),r!==u&&setTimeout((function(){o.controlVisible=r}),10),this.currentArtboardHasRenderInteraction||this.showTextTip("当前画板没有或未提交交互原型热区",1)}},touchstartPanel:function(t){if(!this.animation){window.addEventListener("touchmove",this.touchmovePanel,{passive:!1}),window.addEventListener("touchend",this.touchendPanel);var e=t.touches[0];e&&(this.mouseDiffX=0,this.movingX=this.movingY=!1,this.touchStartX=e.pageX,this.touchStartY=e.pageY,this.touchStartTime=Date.now())}},onSlide:function(t){var e,n=this,r=this.mouseDiffX,i=0;try{if(0===t)return;var a=this.prevArtboard,o=this.nextArtboard,s=this.docWidth;if(null==a&&t>0)return;if(null==o&&t<0)return;if(Math.abs(t)<s/5)return;if(t>0?(e=a,i=s):(e=o,i=-s),!e)return}finally{0!==r&&(this.animation=!0,this.mouseDiffX=i,setTimeout((function(){n.animation=!1,n.mouseDiffX=0,n.movingX=!1,n.movingY=!1,e&&n.setCurArtboard(e)}),200))}}},computed:{gobackArtboard:function(){return this.interactionSet.gobackArtboard},gotoArtboard:function(){return this.interactionSet.gotoArtboard},currentOverlayVisible:function(){return!this.gobackArtboard},currentRenderTapInteraction:function(){var t,e=this.gobackArtboard,n=this.gotoArtboard,r=null===(t=null!==e&&void 0!==e?e:n)||void 0===t?void 0:t.renderTapInteraction;if(r){var i=r,a=i.transition,o=i.trigger_type,c=i.type,u=i.preserveScrollPosition,d=i.toArtboard;if(!Object(l["o"])(a))return null;switch(a=Object(s["a"])({},a),a.type){case"dissolve":case"autoAnimate":return null;case"push":case"slide":a.type="".concat(a.type,"-background");break}r={transition:a,trigger_type:o,type:c,preserveScrollPosition:u,toArtboard:d}}return r},currentArtboardHasRenderInteraction:function(){return null!=this.currentArtboardRenderInteractions},currentArtboardRenderInteractions:function(){var t,e,n,r=null===(t=this.curArtboard)||void 0===t||null===(e=t.artboard)||void 0===e?void 0:e.interactionInfo;if(!r)return null;if(r.fetchState!==c["FetchState"].Success)return null;var i=null===(n=r.data)||void 0===n?void 0:n.renderInteractions;return Object(l["g"])(i)&&i.length>0?i:null},showArtboards:function(){var t=this.prevArtboard,e=this.nextArtboard,n=this.curArtboard,r=this.overlayArtboards,i=[];return t?i.push({key:t.artboard.cid,artboard:t.artboard,overlayArtboards:null,renderTapInteraction:null,overlayVisible:!0}):i.push({key:"prevArtboard.null",artboard:null,overlayArtboards:null,renderTapInteraction:null,overlayVisible:!0}),i.push({key:n.artboard.cid,artboard:n.artboard,overlayArtboards:r,renderTapInteraction:this.currentRenderTapInteraction,overlayVisible:this.currentOverlayVisible}),e?i.push({key:e.artboard.cid,artboard:e.artboard,overlayArtboards:null,renderTapInteraction:null,overlayVisible:!0}):i.push({key:"nextArtboard.null",artboard:null,overlayArtboards:null,renderTapInteraction:null,overlayVisible:!0}),i},moving:function(){return this.movingX||this.movingY},style:function(){var t=this.mouseDiffX;return{transform:"translate3d(".concat(t,"px, 0, 1px)")}},docWidth:function(){return this.mobileInteraction.mobileSize.width},mobileInteraction:function(){return this.$store.state.mobileInteraction},interactionSet:function(){return this.$store.state.artboardDetail.interactionSet},overlayArtboards:function(){return this.interactionSet.overlayArtboards},prevArtboard:function(){var t=this.curArtboardIndex,e=this.renderArtboardList;return t<=0?null:e[t-1]},nextArtboard:function(){var t=this.curArtboardIndex,e=this.renderArtboardList,n=e.length;return t>=n-1?null:e[t+1]}},data:function(){return{touchStartTime:0,touchStartX:0,touchStartY:0,movingX:!1,movingY:!1,maxDiffNum:3,animation:!1,mouseDiffX:0}},props:{renderArtboardList:Array,curArtboardIndex:Number}},$b=Ub,Hb=(n("ab00"),Object(qe["a"])($b,Db,Fb,!1,null,"0b5f34b2",null)),zb=Hb.exports,Wb=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-list",class:{on:t.visible},on:{click:function(e){return e.target!==e.currentTarget?null:t.clickHide.apply(null,arguments)}}},[n("ul",{staticClass:"box"},t._l(t.homeList,(function(e,r){return n("li",{key:r,on:{click:function(n){return t.clickItem(e)}}},[n("span",{staticClass:"text"},[t._v(t._s(e.artboard.name))])])})),0)])},Gb=[],Yb={methods:{clickItem:function(t){this.setCurArtboard(t),this.clickHide()},clickHide:function(){this.$emit("hideHomeList")}},props:{homeList:Array,visible:Boolean}},Xb=Yb,Kb=(n("f963"),Object(qe["a"])(Xb,Wb,Gb,!1,null,"10774c3a",null)),Zb=Kb.exports,qb={components:{ArtboardPanel:zb,HomeList:Zb},methods:{copyUrl:function(){Object(c["copyValueFromText"])(this.getCurrentInteractionUrl())?this.showTextTip("已复制预览地址到剪切板",2):this.showTextTip("预览地址复制到剪切板失败",2)},hideHomeList:function(){this.homeListVisible=!1},clickHomeList:function(){var t=this.homeList;if(0!==t.length)return 1===t.length?(this.setCurArtboard(t[0]),void this.showTextTip("已切换到起始画板")):void(this.homeListVisible=!0);this.showTextTip("当前没有配置起始画板")},clickInteractionRectAlwaysVisible:function(){var t=!this.interactionRectAlwaysVisible;this.showTextTip(t?"已开启原型热区常显":"已关闭原型热区常显"),this.$store.commit("setInteractionRectAlwaysVisible",t)},clickGoPrev:function(){var t=this.renderDocumentArtboards,e=this.curArtboardIndex,n=e-1;n<0?this.showTextTip("已经到达第一个画板"):this.setCurArtboard(t[n])},clickGoNext:function(){var t=this.renderDocumentArtboards,e=this.curArtboardIndex,n=e+1;n>=t.length?this.showTextTip("已经到达最后一个画板"):this.setCurArtboard(t[n])},clickGoArtboardByIndex:function(t){t<0&&(t=0);var e=this.renderDocumentArtboards,n=e.length;t>n-1&&(t=n-1);var r=e[t];this.setCurArtboard(r)}},computed:{homeList:function(){var t=this.renderDocumentArtboards;return t.filter((function(t){var e;return null===(e=t.artboard)||void 0===e?void 0:e.flowStart}))},hasPrevArtboard:function(){var t=this.curArtboardIndex;return t>0},hasNextArtboard:function(){var t=this.renderDocumentArtboards,e=this.curArtboardIndex,n=t.length;return e<n-1},curArtboardIndex:function(){var t=this.curArtboard;return this.renderDocumentArtboards.findIndex((function(e){return e===t}))},interactionRectAlwaysVisible:function(){return this.$store.state.artboardDetail.interactionSet.rectAlwaysVisible},mobileInteraction:function(){return this.$store.state.mobileInteraction},hasSearchText:function(){return!!this.searchText},searchText:function(){return this.mobileInteraction.searchText},renderArtboardList:function(){var t,e,n=this.searchText,r=this.renderDocumentArtboards,i=this.hasSearchText,a=[];return n=i&&null!==(t=null===(e=n)||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"",r.forEach((function(t){var e=null===t||void 0===t?void 0:t.artboard;if(e){if(i){var r=e.name;if(!r)return;if(-1===r.toLowerCase().indexOf(n))return}var o=e.boundsInParent;o&&a.push(t)}})),a}},watch:{curArtboard:function(t){t||(this.mobileInteraction.controlVisible=!1)}},data:function(){return{homeListVisible:!1}},created:function(){this.mobileInteraction.controlVisible=!1,l["a"]&&(window.vue_InteractionArtboardInfo=this)}},Qb=qb,Jb=(n("680f"),Object(qe["a"])(Qb,Lb,Nb,!1,null,"3616155a",null)),tv=Jb.exports,ev=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.tipVisible?n("div",{staticClass:"pop-tip-text"},[n("p",[t._v(t._s(t.tipText))])]):t._e()},nv=[],rv={computed:{tipText:function(){return this.$store.state.textTip.text},tipVisible:function(){return this.$store.state.textTip.visible}}},iv=rv,av=(n("c93f"),Object(qe["a"])(iv,ev,nv,!1,null,"74a7e4ce",null)),ov=av.exports,sv=l["e"]&&/MQQBrowser/i.test(navigator.userAgent),cv={components:{ArtboardList:Mb,ArtboardInfo:tv,TipInMobile:ov,CloudNeedLoginTip:Ea,Authority:Ml,EmptyData:jl,Header:$p,Nav:hb},methods:{onResize:function(){var t=document.documentElement,e=this.mobileSize;e.width=t.offsetWidth,e.height=t.offsetHeight},fullScreen:function(){var t=this.allArtboardLoadChecked,e=this.cloudIsLogin,n=this.cloudNeedLogin,r=this.cloudFolderNotFound,i=this.permission,a=this.isEmptyData,o=this.inList;t&&(n&&!e||r||i&&(a||o||this.isQQBrowser||this.isFullscreen||hm.requestFullscreen()))},onFullscreen:function(t){this.isFullscreen=t},setFullscreen:function(t){var e=document.documentElement;t?hm.onChange(this.onFullscreen):hm.offChange(this.onFullscreen);var n=t?"addEventListener":"removeEventListener";e[n]("touchend",this.fullScreen),e[n]("click",this.fullScreen),e=null}},data:function(){return{isFullscreen:hm.isFullscreen()}},computed:{isQQBrowser:function(){return sv},emptyText:function(){return this.inCloudMode?0===this.cloudCurrentFolderId?"私有云下还没有文件夹,请在标记狮中添加":this.inNetDiskFileMode?"文件不存在,可能已经被移动或删除":"当前文件夹没有画板信息":"未检测到数据,请尝试重新导出画板"},artboardLoadProgressText:function(){return Math.floor(1e4*this.artboardLoadProgress.current/this.artboardLoadProgress.count)/100+"%"},artboardLoadProgress:function(){return this.$store.state.artboardLoadProgress},allArtboardLoadChecked:function(){return this.$store.state.allArtboardLoadChecked},isEmptyData:function(){return 0===this.documentArtboards.length},mobileSize:function(){return this.$store.state.mobileInteraction.mobileSize},inList:function(){return null==this.curArtboard}},created:function(){this.setFullscreen(!0),window.addEventListener("resize",this.onResize),this.onResize(),l["a"]&&(window.vue_InteractionViewerApp=this)},beforeDestroy:function(){this.setFullscreen(!1),window.removeEventListener("resize",this.onResize)}},lv=cv,uv=(n("1a71"),Object(qe["a"])(lv,kp,Sp,!1,null,"d009b6a8",null)),dv=uv.exports;function hv(t,e){Object(c["initMobileMeta"])(!0),Object(c["disableMultiTouch"])();var n=+Object(c["queryString"])("commentid","#"),r="1"===Object(c["queryString"])("isreply","#");t().then((function(){var t=Ue.state;Ue.commit("allArtboardLoadChecked",!0),t.cloud.allFoldersBoxVisible="1"===Object(c["getSessionStorage"])(o["d"],!1),yt(t.documentArtboards);var i=t.cloud.defaultArtboardGuid,a=null;if(i&&(a=ae.documentArtboards.find((function(t){return t.artboard.guid===i})),t.curArtboard!==a&&Ue.commit("curArtboard",{artboard:a})),n>0){var s,u,d,h=t.autoIntoInfo;h.commentArtboardId=null!==(s=null===(u=a)||void 0===u||null===(d=u.artboard)||void 0===d?void 0:d.cid)&&void 0!==s?s:0,h.commentId=n,h.isReply=r,Ue.commit("setArtboardInComment",!0)}e(),a||l["e"]||(t.renderDocuments.find((function(t){if(a=t.arts.find((function(t){return t.artboard.flowStart})),a)return!0})),a||t.renderDocuments.find((function(t){if(t.arts.length>0)return a=t.arts[0],!0})),a&&t.curArtboard!==a&&Ue.commit("curArtboard",{artboard:a}))}));var i=new a["a"]({store:Ue,render:function(t){return t(l["e"]?dv:Cp)}});me((function(t){Ue.commit("isSupportWebp",t),i.$mount("#app")}))}var fv,mv,pv=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pop-box confirm"},[n("div",{staticClass:"box"},[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),n("div",{staticClass:"text"},[t._v(t._s(t.text))]),n("div",{staticClass:"btns"},[t.noText?n("a",{staticClass:"button btn-no",attrs:{href:"javascript:;"},on:{click:t.clickNo}},[t._v(t._s(t.noText))]):t._e(),n("a",{staticClass:"button light btn-yes",attrs:{href:"javascript:;"},on:{click:t.clickYes}},[t._v(t._s(t.yesText))])])])])},bv=[],vv={created:function(){window.addEventListener("keydown",this.onKeyDown)},beforeDestroy:function(){window.removeEventListener("keydown",this.onKeyDown)},methods:{onKeyDown:function(t){var e=t.keyCode||t.which;if(27===e){try{t.preventDefault(),t.stopPropagation()}catch(n){}this.clickNo()}},clickYes:function(){this.$emit("clickYes")},clickNo:function(){this.$emit("clickNo")}},props:{title:{type:String,default:"提示"},text:{validator:function(){return!0}},yesText:{type:String,default:"确认"},noText:{type:String,default:"取消"}}},gv=vv,wv=(n("ac60"),Object(qe["a"])(gv,pv,bv,!1,null,"1ef8e8a0",null)),xv=wv.exports,yv=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pop-box prompt"},[n("form",{on:{submit:t.clickSubmit}},[n("div",{staticClass:"box"},[n("a",{staticClass:"sys-close",attrs:{href:"javascript:;",title:t.noText},on:{click:t.clickNo}}),n("div",{staticClass:"title"},[t._v(t._s(t.title))]),n("div",{staticClass:"text"},[n("UserInput",{ref:"text",attrs:{defaultBorder:!0,placeholder:t.placeholder,target:"text",initValue:t.text,maxLength:t.maxLength},on:{change:t.onChange}})],1),n("div",{staticClass:"btns"},[n("a",{staticClass:"button light btn-yes",attrs:{href:"javascript:;"},on:{click:t.clickYes}},[t._v(t._s(t.yesText))])])])])])},Cv=[],kv=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input",class:t.cls},["checkbox"===t.type?n("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"input",attrs:{maxlength:t.maxLength,placeholder:t.placeholder,autocomplete:t.autocomplete,spellcheck:"false",type:"checkbox"},domProps:{checked:Array.isArray(t.value)?t._i(t.value,null)>-1:t.value},on:{blur:t.blur,focus:t.focus,change:function(e){var n=t.value,r=e.target,i=!!r.checked;if(Array.isArray(n)){var a=null,o=t._i(n,a);r.checked?o<0&&(t.value=n.concat([a])):o>-1&&(t.value=n.slice(0,o).concat(n.slice(o+1)))}else t.value=i}}}):"radio"===t.type?n("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"input",attrs:{maxlength:t.maxLength,placeholder:t.placeholder,autocomplete:t.autocomplete,spellcheck:"false",type:"radio"},domProps:{checked:t._q(t.value,null)},on:{blur:t.blur,focus:t.focus,change:function(e){t.value=null}}}):n("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"input",attrs:{maxlength:t.maxLength,placeholder:t.placeholder,autocomplete:t.autocomplete,spellcheck:"false",type:t.type},domProps:{value:t.value},on:{blur:t.blur,focus:t.focus,input:function(e){e.target.composing||(t.value=e.target.value)}}}),t.showVerify?n("img",{staticClass:"verifycode",attrs:{src:t.verifySrc,title:"点击刷新验证码"},on:{click:function(e){return t.clickVerifyCode()}}}):t.showPwd?n("span",{staticClass:"pwd-mode",class:{"in-text":t.pwdModeInText},on:{click:function(e){t.pwdModeInText=!t.pwdModeInText}}}):t.showPhoneCode?n("a",{staticClass:"button btn-phoneCodeSend",class:{off:!t.phoneCodeBtnEnable,light:t.phoneCodeBtnEnable},attrs:{href:"javascript:;"},on:{click:t.sendPhoneCode}},[t._v(t._s(t.phoneCodeBtnText))]):t._e()])},Sv=[],_v={methods:{sendPhoneCode:function(){this.$emit("sendPhoneCode")},setFocus:function(){var t=this.$refs.input;t&&t.focus()},setValue:function(t){"string"===typeof t&&(this.value=t)},clearAndFocus:function(){this.value="",this.setFocus()},refreshCode:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.ticks=Date.now(),t.value="";case 2:case"end":return e.stop()}}),e)})))()},clickVerifyCode:function(t){var e=this.ticks,n=Date.now(),r=n-e;r<500&&r>=0||(this.ticks=n,this.value="",!0!==t&&this.setFocus())},focus:function(){this.focused=!0},blur:function(){this.focused=!1}},watch:{showVerify:function(t){t&&this.refreshCode()},value:function(t){this.$emit("change",t)}},props:{target:String,initValue:String,placeholder:String,maxLength:Number,defaultBorder:Boolean,phoneCodeBtnText:String,phoneCodeBtnEnable:Boolean},computed:{autocomplete:function(){return"password"===this.type?"new-password":"off"},type:function(){return"pwd2"===this.target||"pwd3"===this.target?"password":this.showPwd?this.pwdModeInText?"text":"password":"text"},verifySrc:function(){return"".concat(c["SERVER_HOST"],"router/verifycode.ashx?r=").concat(this.ticks)},showPwd:function(){return"pwd"===this.target},showVerify:function(){return"verify"===this.target},showPhoneCode:function(){return"phoneCode"===this.target},cls:function(){var t=[],e=this.target;return e&&t.push(e),this.focused&&t.push("focused"),this.defaultBorder&&t.push("default-bor"),t}},created:function(){this.value=this.initValue,this.showVerify&&this.refreshCode()},data:function(){return{pwdModeInText:!1,focused:!1,value:"",ticks:Date.now()}}},Av=_v,Iv=(n("7b94"),Object(qe["a"])(Av,kv,Sv,!1,null,"474237c6",null)),Tv=Iv.exports,Ov={methods:{clickSubmit:function(t){t.preventDefault(),this.clickYes()},onChange:function(t){this.value=t}},components:{UserInput:Tv},props:{title:{type:String,default:"提示"},maxLength:{type:Number,default:256},placeholder:{type:String,default:""},text:String,yesText:{type:String,default:"确认"},noText:{type:String,default:"取消"}},data:function(){return{value:""}},created:function(){var t=this;this.value=this.text,Object(l["h"])(this.value)&&this.$nextTick((function(){var e=t.$refs.text;e&&e.setFocus&&e.setFocus()}))}},Ev=Ov,Mv=(n("7069"),Object(qe["a"])(Ev,yv,Cv,!1,null,"2cb5dbd0",null)),Lv=Mv.exports,Nv=function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e,n){var i,a,s,u=arguments;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=!(u.length>2&&void 0!==u[2])||u[2],"string"!==typeof n&&(n=JSON.stringify(n)),a="".concat(c["OUTPU_CLOUD_API_DEVPATH"],"/api/").concat(e),t.next=5,fetch(a,{method:"post",body:n,credentials:l["a"]?"include":void 0});case 5:s=t.sent,t.t0=s.status,t.next=200===t.t0?9:500===t.t0?21:25;break;case 9:return t.next=11,s.text();case 11:if(n=t.sent,Object(l["h"])(n)){t.next=14;break}throw"接口".concat(e,"请求失败,不存在返回值");case 14:if(n=Object(c["string2Data"])(n),Object(l["o"])(n)){t.next=17;break}throw"接口".concat(e,"请求失败,无法解析返回值");case 17:if(n.success){t.next=20;break}throw n.code===o["s"].NotLogin&&Object(c["threadSleep"])(2e3).then((function(){window.location.reload(!0)})),n.errMsg;case 20:return t.abrupt("return",i?Object(c["base64ToUint8Array"])(n.data):n.data);case 21:return t.next=23,s.text();case 23:throw n=t.sent,n;case 25:throw"接口".concat(e,"请求失败");case 26:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Dv=function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e,n){var i,a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(Object(l["o"])(n)){t.next=2;break}throw"接口[".concat(e,"]返回值格式异常");case 2:if(n.success){t.next=4;break}return t.abrupt("return",n);case 4:if(n=n.data,Object(l["h"])(n)){t.next=7;break}throw"接口[".concat(e,"]返回值格式异常,无法解析data");case 7:return i="".concat(c["OUTPU_CLOUD_API_DEVPATH"],"/api/").concat(e),t.next=10,fetch(i,{method:"post",body:n,credentials:l["a"]?"include":void 0});case 10:a=t.sent,t.t0=a.status,t.next=200===t.t0?14:500===t.t0?23:27;break;case 14:return t.next=16,a.text();case 16:if(n=t.sent,Object(l["h"])(n)){t.next=19;break}throw"接口[".concat(e,"]请求失败,不存在返回值");case 19:if(n=Object(c["string2Data"])(n),Object(l["o"])(n)){t.next=22;break}throw"接口[".concat(e,"]请求失败,无法解析返回值");case 22:return t.abrupt("return",n);case 23:return t.next=25,a.text();case 25:throw n=t.sent,"接口[".concat(e,"]").concat(n);case 27:throw"接口[".concat(e,"]请求失败");case 28:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Fv=function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(e,n){var a,o,s,l,u,d,h,f,m=arguments;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=m.length>2&&void 0!==m[2]?m[2]:0,o="pre"+e,t.next=4,Nv(o,n,!1);case 4:return s=t.sent,l="".concat(c["SERVER_HOST"],"router/web/webupdate.ashx"),u=document.createElement("iframe"),d="__postdata_"+Date.now(),u.name=d,u.style.cssText="width:1px;height:1px;position: absolute;top:-10px;left:-10px;overflow:hidden;",h=document.createElement("form"),h.style.cssText="width:1px;height:1px;position: absolute;top:-10px;left:-10px;overflow:hidden;",h.appendChild(u),h.target=d,h.method="POST",h.action=l,h.enctype="multipart/form-data",f=document.createElement("input"),f.name="router",f.value=e,h.appendChild(f),f=document.createElement("input"),f.name="body",f.value=s,h.appendChild(f),f=null,document.body.appendChild(h),t.abrupt("return",new Promise((function(t,n){var o,s=function(){clearTimeout(o),c&&(window.removeEventListener("message",c),document.body.removeChild(h),c=h=u=null)};a>0&&(o=setTimeout((function(){s(),n("[".concat(e,"]操作已超时"))}),a));var c=function(){var a=Object(i["a"])(Object(r["a"])().mark((function i(a){var o,c;return Object(r["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(o=a.source,o===u.contentWindow){r.next=3;break}return r.abrupt("return");case 3:if(r.prev=3,c=a.data,"string"!==typeof c){r.next=9;break}return r.abrupt("return",n(c));case 9:return r.prev=9,r.t0=t,r.next=13,Dv(e,c);case 13:r.t1=r.sent,(0,r.t0)(r.t1),r.next=20;break;case 17:r.prev=17,r.t2=r["catch"](9),n(r.t2);case 20:return r.prev=20,s(),r.finish(20);case 23:case"end":return r.stop()}}),i,null,[[3,,20,23],[9,17]])})));return function(t){return a.apply(this,arguments)}}();window.addEventListener("message",c),h.submit()})));case 28:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Pv={computed:{webViewHidden:function(){return this.$store.state.webViewHidden},allFoldersBoxVisible:function(){return this.$store.state.cloud.allFoldersBoxVisible},fileViewUrl:function(){var t=this.curNetDiskFile;return t&&t.viewUrl?"".concat(t.viewUrl,"?type=res&t=").concat(t.updateTimeTimes):null},fileDownloadUrl:function(){var t=this.curNetDiskFile;return t&&t.viewUrl?"".concat(t.viewUrl,"?type=download&t=").concat(t.updateTimeTimes):null},inMobile:function(){return l["e"]},inMacOS:function(){return l["d"]},editComment:function(){return this.$store.state.editComment},inCommentDrawing:function(){var t=this.editComment;if(!t.drawing)return!1;var e=t.drawInfo.histories;return e.length>0},numberAutoRound:function(){return this.$store.state.setting.numberAutoRound},exportBoxBackground:function(){return this.$store.state.setting.exportBoxBackground},inCloudMode:function(){return this.$store.state.inCloudMode},permission:function(){return this.$store.state.permission},cloudNeedLogin:function(){return this.$store.state.cloudNeedLogin},cloudIsLogin:function(){return this.$store.state.cloudIsLogin},cloudNickName:function(){return this.$store.state.cloudNickName},cloudUserEmail:function(){return this.$store.state.cloudUserEmail},cloudUserKey:function(){return this.$store.state.cloudUserKey},cloudName:function(){return this.$store.state.cloudName},cloudKey:function(){return this.$store.state.cloudKey},cloudVersion:function(){return this.$store.state.cloudVersion},cloudFolderNotFound:function(){return this.$store.state.cloud.folderNotFound},cloudCurrentFolderId:function(){return this.$store.state.cloud.currentFolderId},cloudDefaultArtboardGuid:function(){return this.$store.state.cloud.defaultArtboardGuid},cloudSubFolders:function(){return this.$store.state.cloud.subFolders},cloudSubFiles:function(){return this.$store.state.cloud.subFiles},cloudParentFolder:function(){return this.$store.state.cloud.parentFolder},androidUseMipmap:function(){return this.$store.state.androidUseMipmap},calcPlatformUse:function(){var t=this.calcPlatformType;switch(t){case o["b"].ANDROID:case o["b"].IOS:return t;case o["b"].CUSTOM:switch(this.calcPlatformCustomUnit){case o["c"].DP:return o["b"].ANDROID;case o["c"].PT:return o["b"].IOS;default:return o["b"].WEB}default:return o["b"].WEB}},calcArtScale:function(){var t=this.curArtboard;if(!t)return 1;var e=t.artboard;if(!e)return 1;var n=e.mlConfig;if(!n)return 1;var r=n.artScale;return null==r||r<=0?1:r},calcPlatformType:function(){return this.$store.state.platform.type},calcPlatformCustomUnit:function(){return this.$store.state.platform.customUnit},calcPlatformShowType:function(){switch(this.calcPlatformType){case o["b"].ANDROID:case o["b"].IOS:return this.calcPlatformType;case o["b"].CUSTOM:switch(this.calcPlatformCustomUnit){case o["c"].DP:return o["b"].ANDROID;case o["c"].PT:return o["b"].IOS;default:return o["b"].WEB}default:return o["b"].WEB}},calcUnitTemplateValue:function(){if(!this.inArtboardMode)return"";var t=this.$store.state.unitTemplate.template;return t||""},calcPlatformCustomDocWidth:function(){if(!this.inArtboardMode)return 1;var t=this.$store.state.platform.customDocWidth;return(isNaN(t)||!isFinite(t)||t<1)&&(t=0),t},calcPlatformCustomDocWidthShow:function(){var t=this.calcPlatformCustomDocWidth;return 0===t&&(t=this.curArtboard.artboard.boundsInArtboard.width),t},scaleArtboard:function(){return this.$store.state.scale.artboard},scaleList:function(){return this.$store.state.scale.list},scaleImageViewer:function(){var t=this.$store.state.imageViewer;return t.scale},inArtboardMode:function(){return null!==this.curArtboard},inCloudViewerMode:function(){return this.inCloudMode&&this.$store.state.cloud.renderMode===o["n"].Normal},inNetDiskFileMode:function(){return this.inCloudMode&&this.$store.state.cloud.renderMode===o["n"].File},inInteractionMode:function(){return this.inCloudMode&&this.$store.state.cloud.renderMode===o["n"].Interaction},curNetDiskFile:function(){return this.inNetDiskFileMode?this.$store.state.cloud.fileInfo:null},curArtboard:function(){return this.$store.state.curArtboard},curArtboardGuid:function(){var t,e,n;return null!==(t=null===(e=this.curArtboard)||void 0===e||null===(n=e.artboard)||void 0===n?void 0:n.guid)&&void 0!==t?t:""},curArtboardId:function(){var t,e;return null===(t=this.curArtboard)||void 0===t||null===(e=t.artboard)||void 0===e?void 0:e.cid},curNode:function(){return this.$store.state.curNode},propertyVisible:function(){return this.inMultDownMode||this.inArtboardMode&&null!==this.curNode},artboardInComment:function(){return this.inCloudMode&&this.$store.state.artboardInComment},clickedNode:function(){return this.$store.state.clickedNode},enterNode:function(){return this.$store.state.enterNode},documents:function(){return this.$store.state.documents},renderDocuments:function(){return this.$store.state.renderDocuments},filterDocumentGuid:function(){return this.inCloudMode?this.$store.state.filterDocumentGuid:null},documentArtboards:function(){return this.$store.state.documentArtboards},renderDocumentArtboards:function(){return this.$store.state.renderDocumentArtboards},documentName:function(){return this.$store.state.documentName},inMultDownMode:function(){return this.inArtboardMode&&this.$store.state.inMultDownMode&&!this.artboardInComment},inArtboardMultDownMode:function(){return!this.inArtboardMode&&this.$store.state.inArtboardMultDownMode}},methods:{goCloudFolderInteractionUrl:function(t,e){var n=this;return Object(i["a"])(Object(r["a"])().mark((function a(){var o,s,u,d,h,f;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(o="/interactionviewer/".concat(t,"/").concat(e?"".concat(e,"/"):""),!l["f"]){a.next=28;break}if(s=n.$store,u=t!==s.state.cloud.currentFolderId,a.prev=4,s.state.mobileInteraction.listFetchState!==c["FetchState"].Fetching){a.next=7;break}return a.abrupt("return");case 7:return s.state.mobileInteraction.listFetchState=c["FetchState"].Fetching,a.next=10,n.fetchPostCloudApi(o,{timeout:1e4,abortKey:"goCloudFolderInteractionUrl"});case 10:return d=a.sent,n.setCurArtboard(null),ae.dataInit({cloudData:d}),h=function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ae.allArtboardLoadChecked((function(){}));case 2:s.commit("setDocument",ae);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),f=function(){u&&s.commit("setFilterDocumentGuid",null)},a.next=17,h();case 17:yt(s.state.documentArtboards),f(),s.state.mobileInteraction.listFetchState=c["FetchState"].Success,a.next=26;break;case 22:a.prev=22,a.t0=a["catch"](4),s.state.mobileInteraction.listFetchState=c["FetchState"].Error,n.showTextTip(a.t0);case 26:a.next=29;break;case 28:location.href=o;case 29:case"end":return a.stop()}}),a,null,[[4,22]])})))()},clickNetDiskFile:function(t){t&&(o["k"].isSupportOnlineViewType(t.fileType)?(l["a"]&&console.log("clickNetDiskFile",t),window.open(t.viewUrl)):this.clickDownloadNetDiskFile(t))},clickDownloadNetDiskFile:function(t){var e,n,r=t&&t.viewUrl?"".concat(t.viewUrl,"?type=download&t=").concat(t.updateTimeTimes):null;if(r){var i=null!==(e=t.name)&&void 0!==e?e:"".concat(t.fileName).concat(null!==(n=t.fileExt)&&void 0!==n?n:"");Object(c["downloadRes"])(i,r)}},alert:function(t){var e=t.title,n=t.text,r=t.yesText,i=void 0===r?"确认":r;return this.confirm({title:e,text:n,noText:"",yesText:i})},confirm:function(t){var e=t.title,n=t.text,r=t.noText,i=void 0===r?"取消":r,o=t.yesText,s=void 0===o?"确认":o;return new Promise((function(t){var r=function(){if(o){var t=o.$el;o.$destroy(),o=null,t&&t.parentNode&&(t.parentNode.removeChild(t),t=null)}},o=new(a["a"].extend(xv))({propsData:{title:e,text:n,noText:i,yesText:s},methods:{clickYes:function(){r(),t(!0)},clickNo:function(){r(),t(!1)}}}).$mount();document.body.appendChild(o.$el)}))},cleanFoldersCache:function(t){var e=this,n=function(t){var n="allfoldersbyweb_".concat(e.cloudUserKey,"_").concat(t?1:0);Object(c["removeSessionStorage"])(n),Object(c["removeSessionStorage"])("".concat(n,".t"))};void 0===t||null===t?(n(!0),n(!1)):n(t)},getAllUsers:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i,a,o,s;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.cloudVersion,i=t.inCloudMode,a=t.cloudIsLogin,i){e.next=3;break}return e.abrupt("return",null);case 3:if(!Object(l["j"])(n)){e.next=5;break}throw new Error("无法使用@功能,私有云版本过低(".concat(n,"),请先升级私有云部署包"));case 5:if(a){e.next=7;break}throw new Error("未登录,请先登录");case 7:if(o=Fh("cloudusers","all"),!o){e.next=10;break}return e.abrupt("return",o);case 10:return e.next=12,t.fetchPostCloudApi("GetUsersByWeb",{method:"post",body:"",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});case 12:if(s=e.sent,Object(l["o"])(s)){e.next=15;break}throw new Error("返回值异常,无法解析数据:".concat(s));case 15:if(s.success){e.next=17;break}throw new Error(s.errMsg);case 17:if(o=s.data,Object(l["g"])(o)){e.next=20;break}throw new Error("返回值异常,无法解析数据:".concat(JSON.stringify(s)));case 20:return o.forEach((function(t){var e,n=t.nickName;e=n?n[n.length-1]:"-",t.userFaceText=e})),o.sort((function(t,e){var n=Object(c["localeCompareString"])(t.nickName,e.nickName);return 0==n&&(n=Object(c["localeCompareString"])(t.email,e.email)),n})),Dh("cloudusers","all",o,3e4),e.abrupt("return",o);case 24:case"end":return e.stop()}}),e)})))()},searchWebItem:function(t){var e=this;return Object(i["a"])(Object(r["a"])().mark((function n(){var i,a,s,u,d,h,f,m,p,b,v,g,w;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.cloudVersion,a=e.inCloudMode,a){n.next=3;break}return n.abrupt("return",null);case 3:if(!Object(l["n"])(i)){n.next=5;break}throw new Error("私有云版本过低(".concat(i,"),请先升级私有云部署包"));case 5:if(s="webitemsearch",u="".concat(e.cloudUserKey,"_").concat(t),d=Fh(s,u),Object(l["g"])(d)){n.next=32;break}return n.next=11,e.fetchPostCloudApi("webitemsearch",{abortKey:"webitemsearch",timeout:1e4,method:"post",body:"wd=".concat(encodeURIComponent(t)),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});case 11:if(d=n.sent,Object(l["o"])(d)){n.next=14;break}throw new Error("返回值异常,无法解析数据:".concat(d));case 14:if(d.success){n.next=16;break}throw new Error(d.errMsg);case 16:if(d=d.data,Object(l["o"])(d)){n.next=19;break}throw new Error("返回值异常,无法解析数据:".concat(JSON.stringify(d)));case 19:h=d,f=h.folders,m=h.artboards,p=h.files,b=h.updaterNames,v=h.fromFolders,g=h.allParents,Object(l["g"])(f)||(f=[]),Object(l["g"])(m)||(m=[]),Object(l["g"])(p)||(p=[]),Object(l["o"])(b)||(b={}),Object(l["o"])(v)||(v={}),d=[],w=function(t){if(g){var e=t.parents=[],n=t.parentId;while(n>0){var r=v[n];if(!r)break;e.unshift(r),n=r.parentId}0==e.length&&e.push({folderId:0,name:"私有云根目录",parentId:0,shareMode:0})}else t.parents=null},f.forEach((function(t){var e=v[t];e&&(e=Object.assign({localSearchType:o["p"].Folder},e),e.parent=v[e.parentId],w(e),d.push(e))})),m.forEach((function(t){var e;t&&(t.localSearchType=o["p"].Artboard,t.updaterName=null!==(e=b[t.updaterId])&&void 0!==e?e:"undefined",t.parent=v[t.parentId],w(t),d.push(t))})),p.forEach((function(t){var e;t&&(t.localSearchType=o["p"].File,t.updaterName=null!==(e=b[t.updaterId])&&void 0!==e?e:"undefined",t.parent=v[t.parentId],w(t),d.push(t))})),d.sort((function(t,e){return Object(c["localeCompareString"])(t.name,e.name)})),Dh(s,u,d,8e3);case 32:return n.abrupt("return",d);case 33:case"end":return n.stop()}}),n)})))()},getAllFolders:function(t,e){var n=this;return Object(i["a"])(Object(r["a"])().mark((function i(){var a,s,u,d,h,f,m,p,b,v,g,w,x,y,C,k,S,_;return Object(r["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=n.cloudVersion,s=n.inCloudMode,s){r.next=3;break}return r.abrupt("return",null);case 3:if(!Object(l["j"])(a)){r.next=5;break}throw new Error("私有云版本过低(".concat(a,"),请先升级私有云部署包"));case 5:if(d=!1,h="allfoldersbyweb_".concat(n.cloudUserKey,"_").concat(t?1:0),f=Object(c["getSessionStorage"])(h+".t",!0),"number"===typeof f&&f>0&&(m=Math.abs(Date.now()-f),d=m<1e4),d&&(u=Object(c["getSessionStorage"])(h,!0)),Object(l["g"])(u)){r.next=23;break}return r.next=13,n.fetchPostCloudApi("getallfoldersbyweb",{method:"post",body:"needPreview=".concat(t?1:0),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});case 13:if(u=r.sent,Object(l["o"])(u)){r.next=16;break}throw new Error("返回值异常,无法解析数据:".concat(u));case 16:if(u.success){r.next=18;break}throw new Error(u.errMsg);case 18:if(u=u.data,Object(l["g"])(u)){r.next=21;break}throw new Error("返回值异常,无法解析数据:".concat(JSON.stringify(u)));case 21:Object(c["setSessionStorage"])(h,u),Object(c["setSessionStorage"])(h+".t",Date.now());case 23:if(p={},b={},v=null,u.forEach((function(t){if(t){0===t.id&&(v=t),t.childArtboardCount=0,t.childFileCount=0,t.childFolderCount=0,p[t.id]=t;var e=b[t.parentId];e||(e=b[t.parentId]=[]);var n=b[t.id];n||(n=b[t.id]=[]),t.childs=n,0===t.id&&0===t.parentId||e.push(t)}})),g=!1,w=function(t,e){var n=Object(c["localeCompareString"])(t.name,e.name);return g?-n:n},Object.keys(b).forEach((function(t){var e=b[t];e.sort(w)})),u.forEach((function(t){t&&(t.parent=0===t.id?null:p[t.parentId],t.childsVisible=0===t.id,t.deepCount=0===t.id?0:1,t.name?t.nameLower=t.name.toLowerCase():t.name=t.nameLower="")})),x=Object(c["getSessionStorage"])(o["a"],!0),Object(l["o"])(x)||(x={}),y=Object.keys(x),C=n.cloudCurrentFolderId,C>=0&&y.push(C),y.forEach((function(t){var e=p[t];while(e)(e.id||0!==e.childs.length)&&(e.childsVisible=!0),e=e.parent})),u.forEach((function(t){var e=t;while(null!=(e=e.parent)){var n,r,i;e.childArtboardCount+=null!==(n=t.artboardCount)&&void 0!==n?n:0,e.childFileCount+=null!==(r=t.fileCount)&&void 0!==r?r:0,e.childFolderCount+=null!==(i=t.folderCount)&&void 0!==i?i:0}})),!e){r.next=44;break}return k=[],S=!1,_=function t(e,n,r){n&&(n.deepCount=r,(0!==n.id||S)&&e.push(n),n.childs.forEach((function(n){t(e,n,r+1)})))},_(k,v,S?0:-1),r.abrupt("return",{root:v,folders:k});case 44:return r.abrupt("return",v);case 45:case"end":return r.stop()}}),i)})))()},goCloudPath:function(t){var e=this;return Object(i["a"])(Object(r["a"])().mark((function n(){var i,a,o,s,c,u,d,h,f,m,p,b,v,g,w;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=t.folderId,a=void 0===i?0:i,o=t.artboardId,s=void 0===o?0:o,c=t.artboardGuid,u=void 0===c?"":c,d=t.commentId,h=void 0===d?0:d,f=t.isReply,m=void 0!==f&&f,!(h>0&&e.cloudCurrentFolderId===a&&e.inCloudViewerMode)){n.next=21;break}if(p=e.documentArtboards,b=e.curArtboardId,v=e.$store.state.autoIntoInfo,b!==s){n.next=11;break}return e.$store.commit("setArtboardInComment",!0),v.isReply=m,v.commentArtboardId=s,v.commentId=h,l["a"]&&console.log("curArtboard.comment.select",v),n.abrupt("return");case 11:if(!Object(l["g"])(p)){n.next=21;break}if(g=p.find((function(t){var e;return(null===t||void 0===t||null===(e=t.artboard)||void 0===e?void 0:e.cid)===s})),!g){n.next=21;break}return e.$store.commit("setArtboardInComment",!0),e.setCurArtboard(g),v.commentArtboardId=s,v.commentId=h,v.isReply=m,l["a"]&&console.log("curArtboard.comment.select2",v,g),n.abrupt("return");case 21:w="/viewer/".concat(a,"/"),u&&(w+="".concat(u,"/"),h>0&&(w+="#commentid=".concat(h,"&isreply=").concat(m?"1":"0"))),window.location.href=w;case 24:case"end":return n.stop()}}),n)})))()},checkUserState:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var n,i;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.inCloudMode&&t.cloudNeedLogin){e.next=2;break}return e.abrupt("return");case 2:return n=new FormData,n.append("folderid",t.cloudCurrentFolderId),e.next=6,t.fetchPostCloudApi("getmystate",{body:n});case 6:if(i=e.sent,Object(l["o"])(i)){e.next=9;break}throw"返回值异常";case 9:return e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})))()},cryptoMarklionWeb2:function(t,e){var n=arguments,a=this;return Object(i["a"])(Object(r["a"])().mark((function i(){var s,l;return Object(r["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s=n.length>2&&void 0!==n[2]?n[2]:0,r.next=3,Fv(t,e,s);case 3:if(e=r.sent,e.success){r.next=19;break}r.t0=e.code,r.next=r.t0===o["s"].NotLogin?8:18;break;case 8:return a.showTextTip(e.errMsg),r.next=11,fetch("".concat(c["OUTPU_CLOUD_API_DEVPATH"],"/api/logout"),{method:"post",body:""});case 11:return l=r.sent,r.next=14,l.text();case 14:return r.next=16,Object(c["threadSleep"])(2e3);case 16:return window.location.reload(!0),r.abrupt("break",18);case 18:throw e.errMsg;case 19:return r.abrupt("return",e);case 20:case"end":return r.stop()}}),i)})))()},goCloudLogout:function(){return Object(i["a"])(Object(r["a"])().mark((function t(){var e,n;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(c["OUTPU_CLOUD_API_DEVPATH"],"/api/logout"),{method:"post",body:""});case 3:return e=t.sent,t.next=6,e.text();case 6:t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:return t.prev=10,n="".concat(c["SERVER_HOST"],"router/web/weblogout.ashx?redirect=").concat(encodeURIComponent(_e.href)),l["f"]?location.replace(n):window.location.href=n,t.finish(10);case 14:case"end":return t.stop()}}),t,null,[[0,8,10,14]])})))()},getCurrentInteractionUrl:function(){if(this.inNetDiskFileMode)return null;var t,e=this.cloudCurrentFolderId,n=this.curArtboard,r=this.filterDocumentGuid,i=window.location;t="".concat(i.protocol,"//").concat(i.host,"/interactionviewer/").concat(e,"/"),n&&(t+="".concat(encodeURIComponent(n.artboard.guid),"/"));var a=!1,o=function(e,n){t+="".concat(a?"&":"?").concat(e,"=").concat(encodeURIComponent(n)),a=!0};return r&&o("filterDoc",r),t},goCloudLogin:function(){var t=location.href;t=t.replace(/https?:\/\/[^/]+\//i,"/"),t="".concat(c["SERVER_HOST"],"web/?action=cloud.login&cloudkey=").concat(encodeURIComponent(this.cloudKey),"&ver=").concat(encodeURIComponent(this.cloudVersion),"&redirect=").concat(encodeURIComponent(t)),l["f"]?location.replace(t):location.href=t},prompt:function(t){var e=t.title,n=t.text,r=t.placeholder,i=void 0===r?"":r,o=t.beforeYes,s=t.maxLength,c=void 0===s?256:s,l=t.noText,u=void 0===l?"取消":l,d=t.yesText,h=void 0===d?"确认":d;return new Promise((function(t,r){var s=function(){if(l){var t=l.$el;l.$destroy(),l=null,t&&t.parentNode&&(t.parentNode.removeChild(t),t=null)}},l=new(a["a"].extend(Lv))({propsData:{title:e,text:n,noText:u,yesText:h,placeholder:i,maxLength:c},methods:{clickYes:function(){var e=this.value;"function"!==typeof o||!1!==o(e)?(s(),t(e)):this.$refs.text.setFocus()},clickNo:function(){s(),r()}}}).$mount();document.body.appendChild(l.$el)}))},getCalcPlatformUnit:function(t){var e;switch(this.calcPlatformType){case o["b"].ANDROID:e=t?"sp":"dp";break;case o["b"].IOS:e="pt";break;case o["b"].CUSTOM:e=this.getCalcPlatformCustomUnitText(t);break;default:e="px";break}return e},getCalcPlatformCustomUnitText:function(t){var e,n=this.calcPlatformCustomUnit;switch(n){case o["c"].DP:e=t?"sp":"dp";break;case o["c"].PT:e="pt";break;default:e="px";break}return e},getCalcRectScale:function(){if(!this.inArtboardMode)return 1;switch(this.calcPlatformType){case o["b"].CUSTOM:var t=this.calcPlatformCustomDocWidthShow,e=this.curArtboard.artboard.boundsInArtboard.width;return t/e;default:return 1}},getCalcValue:function(t,e,n){if(!this.inArtboardMode)return 0;var r;switch(c["globalData"].inCloudMode&&n&&(t=Object(d["b"])(t,this.calcArtScale,e)),this.calcPlatformType){case o["b"].ANDROID:r=t;break;case o["b"].IOS:r=t;break;case o["b"].CUSTOM:var i=this.calcPlatformCustomDocWidthShow,a=this.curArtboard.artboard.boundsInArtboard.width;r=i/a*t;break;default:r=t;break}return r=Math.round(100*r)/100,this.numberAutoRound&&(r=r>0&&r<1?1:e?Math.ceil(r):Math.round(r)),r},getCalcPlatformValue:function(t,e){if(null==t)return 0;if(!this.inArtboardMode)return 0;var n,r,i,a;e?(n=e.fontSize,r=e.markedForExport,i=e.noUnitTemplate,a=e.needArtScale):(n=!1,r=!1,i=!1,a=!1);var o=this.getCalcValue(t,r,a);if(i){var s=this.getCalcPlatformUnit(n);return o+s}return this.getCalcUnitTemplateValue(o,n)},getCalcUnitTemplateValue:function(t,e){var n=this.$store.state.unitTemplate;if(n.enable){var r=this.curArtboard.artboard.boundsInArtboard;return n.template.replace(/%[^%]+%/g,(function(e){switch(e){case"%num%":return t.toString();case"%W%":return r.width.toString();case"%H%":return r.height.toString();case"%VW%":return Object(c["decimalNumber"])(t/r.width*100,2).toString();case"%VH%":return Object(c["decimalNumber"])(t/r.height*100,2).toString();default:return e}}))}var i=this.getCalcPlatformUnit(e);return t+i},setInOutput:function(t){this.$store.commit("setInOutput",t)},setInMultDownMode:function(t){this.$store.commit("setInMultDownMode",t)},setInArtboardMultDownMode:function(t){this.$store.commit("setInArtboardMultDownMode",t)},setScaleArtboard:function(t){this.$store.commit("setScale",{artboard:t})},setScaleList:function(t){this.$store.commit("setScale",{list:t})},setScaleImageViewer:function(t){var e=this.$store.state.imageViewer,n=.1,r=6;t=Math.min(r,t),t=Math.max(n,t),t=Math.round(100*t),t=ce["a"].div(t,100),e.scale=t},resetImageViewerScale:function(){var t=this.$store.state.imageViewer,e=t.imgList;e&&0!==e.length&&(t.resetScale=Date.now())},setCurArtboard:function(t,e){this.$store.commit("curArtboard",{artboard:t,extral:e}),this.setCurNode(null),this.setEnterNode(null),this.setClickedNode(null)},setCurNode:function(t){this.$store.commit("curNode",t)},setClickedNode:function(t){this.$store.commit("clickedNode",t)},setEnterNode:function(t){this.$store.commit("enterNode",t)},showTextTip:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;"string"!==typeof t&&null!=t&&(t=t.toString()),this.$store.commit("Tip_showTextTip",{second:e,text:t})},hideTextTip:function(){this.$store.commit("Tip_hideTextTip")},fetchPostCloudApi:function(t,e){var n=this;return Object(i["a"])(Object(r["a"])().mark((function i(){var a;return Object(r["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,ht(t,e);case 2:if(a=r.sent,!Object(l["o"])(a)){r.next=9;break}r.t0=a.code,r.next=r.t0===o["j"].WebUser_NotLogin?7:9;break;case 7:return n.$store.commit("setUserLogout"),r.abrupt("break",9);case 9:return r.abrupt("return",a);case 10:case"end":return r.stop()}}),i)})))()},updateCloudUsersByCloud:function(t){var e=this.cloudKey;if(e){var n=this.$store.state.userNotify.cloudUsersByCloud;this.$set(n,e,t)}},getCloudNotifies:function(t,e){var n=this;return Object(i["a"])(Object(r["a"])().mark((function i(){var a,s,c,u,d,h,f,m,p,b,v,g,w,x,y,C,k,S,_,A,I,T,O;return Object(r["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=new FormData,a.append("minNotifyId",t),a.append("artboardId",e),r.next=5,n.fetchPostCloudApi("getnotifiesbyweb",{body:a,timeout:t>0?1e4:3e4});case 5:if(s=r.sent,Object(l["o"])(s)){r.next=8;break}throw new Error("消息列表返回值异常:".concat(s));case 8:if(s.success){r.next=10;break}throw new Error(s.errMsg);case 10:if(s=s.data,c=s,u=c.list,d=c.folders,h=c.users,f=c.cloudUserListNeedUpdate,m=c.cloudUserListState,p=c.cloudUserListTimes,b=[],Object(l["g"])(u)){r.next=15;break}return r.abrupt("return",b);case 15:if(Object(l["o"])(d)||(d={}),Object(l["o"])(h)||(h={}),u.forEach((function(t){if(t){t.date=new Date(t.date);try{t.dateStr=Object(l["c"])(t.date)}catch(i){t.dateStr=t.date}switch(t.type){case o["o"].Artboard_Comment:case o["o"].Artboard_Reply:case o["o"].Artboard_Comment_At:case o["o"].Artboard_Reply_At:var e=t.msg;if(!e)return;if(e.commentUser=h[e.commentUserId],!e.commentUser)return;e.folder=d[e.folderId];var n=e.commentSummary,r=e.atUserIds;Object(l["g"])(r)&&r.length>0&&Object(l["h"])(n)&&(e.commentSummary=n.replace(/\[@uid:(\d+);\]/g,(function(t,e){var n=h[e];return n?"@"+n.nickName:t})));break}b.push(t)}})),v=n.$store.state.userNotify,g=v.cloudList,w=v.sysTipIds,x=v.commentUpdateStates,y=n.cloudKey,C=g[y],k=w[y]||0,null!=m&&n.updateCloudUsersByCloud({needUpdate:f,userListState:m,times:p}),s.artboardId>0&&n.$set(x,y,{artboardId:s.artboardId,commentUpdateTime:s.commentUpdateTime}),0!==t&&C){for(C.updateTime=Date.now(),I=null!==(_=null===(A=C.list[0])||void 0===A?void 0:A.id)&&void 0!==_?_:0,T=b.length-1;T>=0;T--)O=b[T],O.id>I&&(C.list.unshift(O),k=Math.max(O.id,k));k&&(w[y]=k)}else w[y]=Math.max((null===(S=b[0])||void 0===S?void 0:S.id)||0,k),n.$set(g,y,{updateTime:Date.now(),list:b});return r.abrupt("return",b);case 26:case"end":return r.stop()}}),i)})))()},checkLoginThrow:function(){if(!this.cloudIsLogin){var t="未登录,请先登录";throw t}return!0}}};a["a"].config.productionTip=!1,a["a"].mixin(Pv);var jv=window.__marklionData;jv&&(window.__marklionData=null);var Rv=null!==(fv=null===jv||void 0===jv||null===(mv=jv.cloudData)||void 0===mv?void 0:mv.renderMode)&&void 0!==fv?fv:o["n"].File,Bv=-1!==navigator.userAgent.indexOf("MSIE");if(Bv)document.body.innerHTML="很抱歉,不支持在IE浏览器中浏览标注信息,请使用Chrome,Firefox,Edge等浏览器浏览";else{ae.dataInit(jv),$e();var Vv=function(){var t=Object(i["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ae.allArtboardLoadChecked((function(t){Ue.commit("artboardLoadProgress",t)}));case 2:Ue.commit("setDocument",ae);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Uv=function(){var t=Ue.state,e=t.cloud.defaultArtboardGuid,n=Object(c["queryString"])("filterDoc");if("none"===n)n=null;else if(n){var r=t.sortDocumentsWithSketchDocument.find((function(t){return t.guid===n}));if(r){var i=ae.documentArtboards.find((function(t){var n=t.artboard;return n.guid===e&&n.docGuid===r.guid||n.pageGuid===r.guid}));e&&!i&&(n=null)}else n=null}n?Ue.commit("setFilterDocumentGuid",n):Ue.commit("setFilterDocumentGuid",null)};switch(Rv){case o["n"].Interaction:hv(Vv,Uv);break;default:am(Vv,Uv);break}}},5721:function(t,e,n){"use strict";n("7035")},5746:function(t,e,n){},5880:function(t,e,n){},"5bbf":function(t,e,n){"use strict";n("03fb")},"5bf6":function(t,e,n){"use strict";n("edcd")},"5c8b":function(t,e,n){},"5f9e":function(t,e,n){"use strict";n("92af")},"61df":function(t,e,n){"use strict";n("396e")},"627e":function(t,e,n){"use strict";n("4455")},"646d":function(t,e,n){},"650d":function(t,e,n){},"655b":function(t,e,n){"use strict";n("d60d")},"672f":function(t,e,n){"use strict";n("76b3")},"680f":function(t,e,n){"use strict";n("847e")},"685e":function(t,e,n){"use strict";n("48cc")},"692d":function(t,e,n){},"692f":function(t,e,n){},"694a":function(t,e,n){},"6cd5":function(t,e,n){},"6ee2":function(t,e,n){"use strict";n("d932")},"6f25":function(t,e,n){},"6f34":function(t,e,n){"use strict";n("1e67")},"6f77":function(t,e,n){"use strict";n("c58d")},"6fc8":function(t,e,n){},7035:function(t,e,n){},7043:function(t,e,n){},7069:function(t,e,n){"use strict";n("7558")},"70b8":function(t,e,n){"use strict";n("e94e")},7305:function(t,e,n){"use strict";n("df8b")},"73ee":function(t,e,n){},7549:function(t,e,n){},7558:function(t,e,n){},"76b3":function(t,e,n){},7820:function(t,e,n){"use strict";n("b3a7")},7851:function(t,e,n){"use strict";n("b78c")},"7a8d":function(t,e,n){"use strict";n("fc14")},"7b94":function(t,e,n){"use strict";n("0824")},"7bcb":function(t,e,n){"use strict";n("694a")},"7c0a":function(t,e,n){"use strict";n("3a11")},"7d74":function(t,e,n){"use strict";n("39ac")},"80f5":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return d})),n.d(e,"f",(function(){return h})),n.d(e,"p",(function(){return f})),n.d(e,"g",(function(){return m})),n.d(e,"h",(function(){return p})),n.d(e,"o",(function(){return b})),n.d(e,"i",(function(){return v})),n.d(e,"j",(function(){return g})),n.d(e,"l",(function(){return w})),n.d(e,"k",(function(){return x})),n.d(e,"n",(function(){return y})),n.d(e,"m",(function(){return C})),n.d(e,"c",(function(){return k}));n("1b2e"),n("35e9"),n("e47f"),n("fff2"),n("872d"),n("25e4");var r=n("fa7d"),i=!1,a="file:"===location.protocol,o=function(){var t=navigator.platform;return"Mac68K"==t||"MacPPC"==t||"Macintosh"==t||"MacIntel"==t||"MacAmd"==t||"iPhone"==t||"iPad"==t}(),s=/Mobile|Android|Iphone|Ipad/i.test(navigator.userAgent);if(o&&!s){var c=window.screen,l=c.width,u=c.height;(768===l&&1024===u||1536===l&&2048===u||1668===l&&2224===u||1668===l&&2388===u||2048===l&&2732===u)&&(s=!0)}var d=s,h=d&&navigator.standalone;function f(t){for(var e=[],n={},r=0;r<t.length;r++){var i=t[r];n[i]||(n[i]=1,e.push(i))}return e}var m=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},p=function(t){return"string"===typeof t&&0!==t.length},b=function(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)},v=function(t){return Object(r["compareVersion"])("1.3.2470.0",t)},g=function(t){return Object(r["compareVersion"])("1.5.2772.0",t)},w=function(t){return Object(r["compareVersion"])("1.6.3656.0",t)},x=function(t){return Object(r["compareVersion"])("1.6.3656.0",t)},y=function(t){return Object(r["compareVersion"])("1.6.3656.0",t)},C=function(t){return Object(r["compareVersion"])("1.6.3656.0",t)};function k(t){var e=new Date,n=t.getFullYear(),r=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0"),a=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0");if(n==e.getFullYear()){var s=e-t;if(s>864e5)return"".concat(r,"-").concat(i," ").concat(a,":").concat(o);var c=s/6e4;return c<1?"刚刚":c<60?"".concat(Math.floor(c),"分钟前"):"".concat(Math.floor(c/60),"小时前")}return"".concat(n,"-").concat(r,"-").concat(i," ").concat(a,":").concat(o)}},"814c":function(t,e,n){"use strict";n("2493")},8163:function(t,e,n){},8292:function(t,e,n){},"847e":function(t,e,n){},8625:function(t,e,n){"use strict";n("f064")},8680:function(t,e,n){},8729:function(t,e,n){"use strict";n("8e45")},"87c8":function(t,e,n){"use strict";n("692f")},"889f":function(t,e,n){"use strict";n("0e3c")},"88b4":function(t,e,n){"use strict";n("40d5")},8904:function(t,e,n){"use strict";n("353e")},"8b25":function(t,e,n){"use strict";n("27ee")},"8c49":function(t,e,n){"use strict";n("cdb1")},"8cf1":function(t,e,n){},"8d92":function(t,e,n){"use strict";n("957f")},"8e45":function(t,e,n){},"90e1":function(t,e,n){"use strict";n("0e27")},"92af":function(t,e,n){},9397:function(t,e,n){},"946c":function(t,e,n){"use strict";n("0cbc")},"957f":function(t,e,n){},9584:function(t,e,n){},"96a3":function(t,e,n){},"96b5":function(t,e,n){},"96e6":function(t,e,n){"use strict";n("4f30")},"98bd":function(t,e,n){"use strict";n("e3c5")},"9a1c":function(t,e,n){"use strict";n("09a1")},"9bdc":function(t,e,n){"use strict";n("9cac")},"9cac":function(t,e,n){},"9cf0":function(t,e,n){},"9d95":function(t,e,n){},"9f03":function(t,e,n){},"9f38":function(t,e,n){},a031:function(t,e,n){"use strict";n("7549")},a135:function(t,e,n){},a2e0:function(t,e,n){"use strict";n("4e4a")},a54d:function(t,e,n){"use strict";n("96b5")},a8ba:function(t,e,n){},a8e1:function(t,e,n){},aa0d:function(t,e,n){"use strict";n("a135")},aa35:function(t,e,n){"use strict";n("39cd")},ab00:function(t,e,n){"use strict";n("f3ef")},ac60:function(t,e,n){"use strict";n("650d")},ad0e:function(t,e,n){"use strict";n("16a2")},ae0f:function(t,e,n){"use strict";n("692d")},aed7:function(t,e,n){},b16b:function(t,e,n){"use strict";(function(t,r,i){n.d(e,"a",(function(){return s}));var a,o=n("182c");n("0f1f"),n("e9c4"),n("1b2e"),n("b24a"),n("6f12"),n("e47f"),n("ea28"),n("a146"),n("08ab"),n("3bf3"),n("5d7f"),n("fa9a"),n("12b2"),n("a9c6"),n("33ef"),n("d437"),n("d466"),n("ff52"),n("d449"),n("86c4"),n("d3d2"),n("abf7"),n("0985"),n("a0fe"),n("395d"),n("8d7e"),n("5a19"),n("a685"),n("d1ce"),n("e1a5"),n("c600"),n("d98d"),n("4b3f"),n("6a04"),n("7e9b"),n("e526"),n("0bfb"),n("078c"),n("f89d"),n("35e9"),n("25e4"),n("ce75"),n("872d"),n("6c61"),n("c8eb"),n("2563"),n("4b74");
/*!

JSZip v3.3.0 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/master/LICENSE
*/
(function(t){if("object"===("undefined"===typeof exports?"undefined":Object(o["a"])(exports))&&"undefined"!==typeof i)i.exports=t();else if("function"===typeof define&&n("f3fa"))define([],t);else{var e;e="undefined"!==typeof window?window:"undefined"!==typeof r?r:"undefined"!==typeof self?self:this,e.JSZip=t()}})((function(){return function t(e,n,r){function i(s,c){if(!n[s]){if(!e[s]){var l="function"==typeof a&&a;if(!c&&l)return a(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[s]={exports:{}};e[s][0].call(d.exports,(function(t){var n=e[s][1][t];return i(n||t)}),d,d.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof a&&a,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){var r=t("./utils"),i=t("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(t){var e,n,i,o,s,c,l,u=[],d=0,h=t.length,f=h,m="string"!==r.getTypeOf(t);while(d<t.length)f=h-d,m?(e=t[d++],n=d<h?t[d++]:0,i=d<h?t[d++]:0):(e=t.charCodeAt(d++),n=d<h?t.charCodeAt(d++):0,i=d<h?t.charCodeAt(d++):0),o=e>>2,s=(3&e)<<4|n>>4,c=f>1?(15&n)<<2|i>>6:64,l=f>2?63&i:64,u.push(a.charAt(o)+a.charAt(s)+a.charAt(c)+a.charAt(l));return u.join("")},n.decode=function(t){var e,n,r,o,s,c,l,u=0,d=0,h="data:";if(t.substr(0,h.length)===h)throw new Error("Invalid base64 input, it looks like a data url.");t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");var f,m=3*t.length/4;if(t.charAt(t.length-1)===a.charAt(64)&&m--,t.charAt(t.length-2)===a.charAt(64)&&m--,m%1!==0)throw new Error("Invalid base64 input, bad content length.");f=i.uint8array?new Uint8Array(0|m):new Array(0|m);while(u<t.length)o=a.indexOf(t.charAt(u++)),s=a.indexOf(t.charAt(u++)),c=a.indexOf(t.charAt(u++)),l=a.indexOf(t.charAt(u++)),e=o<<2|s>>4,n=(15&s)<<4|c>>2,r=(3&c)<<6|l,f[d++]=e,64!==c&&(f[d++]=n),64!==l&&(f[d++]=r);return f}},{"./support":30,"./utils":32}],2:[function(t,e,n){var r=t("./external"),i=t("./stream/DataWorker"),a=t("./stream/DataLengthProbe"),o=t("./stream/Crc32Probe");function s(t,e,n,r,i){this.compressedSize=t,this.uncompressedSize=e,this.crc32=n,this.compression=r,this.compressedContent=i}s.prototype={getContentWorker:function(){var t=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),e=this;return t.on("end",(function(){if(this.streamInfo["data_length"]!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),t},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(t,e,n){return t.pipe(new o).pipe(new a("uncompressedSize")).pipe(e.compressWorker(n)).pipe(new a("compressedSize")).withStreamInfo("compression",e)},e.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,e,n){var r=t("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(t){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,e,n){var r=t("./utils");function i(){for(var t,e=[],n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}var a=i();function o(t,e,n,r){var i=a,o=r+n;t^=-1;for(var s=r;s<o;s++)t=t>>>8^i[255&(t^e[s])];return-1^t}function s(t,e,n,r){var i=a,o=r+n;t^=-1;for(var s=r;s<o;s++)t=t>>>8^i[255&(t^e.charCodeAt(s))];return-1^t}e.exports=function(t,e){if("undefined"===typeof t||!t.length)return 0;var n="string"!==r.getTypeOf(t);return n?o(0|e,t,t.length,0):s(0|e,t,t.length,0)}},{"./utils":32}],5:[function(t,e,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(t,e,n){var r=null;r="undefined"!==typeof Promise?Promise:t("lie"),e.exports={Promise:r}},{lie:37}],7:[function(t,e,n){var r="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array,i=t("pako"),a=t("./utils"),o=t("./stream/GenericWorker"),s=r?"uint8array":"array";function c(t,e){o.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}n.magic="\b\0",a.inherits(c,o),c.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(s,t.data),!1)},c.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},n.compressWorker=function(t){return new c("Deflate",t)},n.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,e,n){var r=t("../utils"),i=t("../stream/GenericWorker"),a=t("../utf8"),o=t("../crc32"),s=t("../signature"),c=function(t,e){var n,r="";for(n=0;n<e;n++)r+=String.fromCharCode(255&t),t>>>=8;return r},l=function(t,e){var n=t;return t||(n=e?16893:33204),(65535&n)<<16},u=function(t,e){return 63&(t||0)},d=function(t,e,n,i,d,h){var f,m,p=t["file"],b=t["compression"],v=h!==a.utf8encode,g=r.transformTo("string",h(p.name)),w=r.transformTo("string",a.utf8encode(p.name)),x=p.comment,y=r.transformTo("string",h(x)),C=r.transformTo("string",a.utf8encode(x)),k=w.length!==p.name.length,S=C.length!==x.length,_="",A="",I="",T=p.dir,O=p.date,E={crc32:0,compressedSize:0,uncompressedSize:0};e&&!n||(E.crc32=t["crc32"],E.compressedSize=t["compressedSize"],E.uncompressedSize=t["uncompressedSize"]);var M=0;e&&(M|=8),v||!k&&!S||(M|=2048);var L=0,N=0;T&&(L|=16),"UNIX"===d?(N=798,L|=l(p.unixPermissions,T)):(N=20,L|=u(p.dosPermissions,T)),f=O.getUTCHours(),f<<=6,f|=O.getUTCMinutes(),f<<=5,f|=O.getUTCSeconds()/2,m=O.getUTCFullYear()-1980,m<<=4,m|=O.getUTCMonth()+1,m<<=5,m|=O.getUTCDate(),k&&(A=c(1,1)+c(o(g),4)+w,_+="up"+c(A.length,2)+A),S&&(I=c(1,1)+c(o(y),4)+C,_+="uc"+c(I.length,2)+I);var D="";D+="\n\0",D+=c(M,2),D+=b.magic,D+=c(f,2),D+=c(m,2),D+=c(E.crc32,4),D+=c(E.compressedSize,4),D+=c(E.uncompressedSize,4),D+=c(g.length,2),D+=c(_.length,2);var F=s.LOCAL_FILE_HEADER+D+g+_,P=s.CENTRAL_FILE_HEADER+c(N,2)+D+c(y.length,2)+"\0\0\0\0"+c(L,4)+c(i,4)+g+_+y;return{fileRecord:F,dirRecord:P}},h=function(t,e,n,i,a){var o="",l=r.transformTo("string",a(i));return o=s.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(t,2)+c(t,2)+c(e,4)+c(n,4)+c(l.length,2)+l,o},f=function(t){var e="";return e=s.DATA_DESCRIPTOR+c(t["crc32"],4)+c(t["compressedSize"],4)+c(t["uncompressedSize"],4),e};function m(t,e,n,r){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(m,i),m.prototype.push=function(t){var e=t.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,i.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:n?(e+100*(n-r-1))/n:100}}))},m.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t["file"].name;var e=this.streamFiles&&!t["file"].dir;if(e){var n=d(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t["file"].dir,n=d(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),e)this.push({data:f(t),meta:{percent:100}});else{this.push({data:n.fileRecord,meta:{percent:0}});while(this.contentBuffer.length)this.push(this.contentBuffer.shift())}this.currentFile=null},m.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var n=this.bytesWritten-t,r=h(this.dirRecords.length,n,t,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()})),t.on("error",(function(t){e.error(t)})),this},m.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(t){var e=this._sources;if(!i.prototype.error.call(this,t))return!1;for(var n=0;n<e.length;n++)try{e[n].error(t)}catch(t){}return!0},m.prototype.lock=function(){i.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()},e.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,e,n){var r=t("../compressions"),i=t("./ZipFileWorker"),a=function(t,e){var n=t||e,i=r[n];if(!i)throw new Error(n+" is not a valid compression method !");return i};n.generateWorker=function(t,e,n){var r=new i(e.streamFiles,n,e.platform,e.encodeFileName),o=0;try{t.forEach((function(t,n){o++;var i=a(n.options.compression,e.compression),s=n.options.compressionOptions||e.compressionOptions||{},c=n.dir,l=n.date;n._compressWorker(i,s).withStreamInfo("file",{name:t,dir:c,date:l,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(r)})),r.entriesCount=o}catch(s){r.error(s)}return r}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,e,n){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var t=new r;for(var e in this)"function"!==typeof this[e]&&(t[e]=this[e]);return t}}r.prototype=t("./object"),r.prototype.loadAsync=t("./load"),r.support=t("./support"),r.defaults=t("./defaults"),r.version="3.2.0",r.loadAsync=function(t,e){return(new r).loadAsync(t,e)},r.external=t("./external"),e.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,e,n){var r=t("./utils"),i=t("./external"),a=t("./utf8"),o=(r=t("./utils"),t("./zipEntries")),s=t("./stream/Crc32Probe"),c=t("./nodejsUtils");function l(t){return new i.Promise((function(e,n){var r=t.decompressed.getContentWorker().pipe(new s);r.on("error",(function(t){n(t)})).on("end",(function(){r.streamInfo.crc32!==t.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):e()})).resume()}))}e.exports=function(t,e){var n=this;return e=r.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),c.isNode&&c.isStream(t)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",t,!0,e.optimizedBinaryString,e.base64).then((function(t){var n=new o(e);return n.load(t),n})).then((function(t){var n=[i.Promise.resolve(t)],r=t.files;if(e.checkCRC32)for(var a=0;a<r.length;a++)n.push(l(r[a]));return i.Promise.all(n)})).then((function(t){for(var r=t.shift(),i=r.files,a=0;a<i.length;a++){var o=i[a];n.file(o.fileNameStr,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:e.createFolders})}return r.zipComment.length&&(n.comment=r.zipComment),n}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,e,n){var r=t("../utils"),i=t("../stream/GenericWorker");function a(t,e){i.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}r.inherits(a,i),a.prototype._bindStream=function(t){var e=this;this._stream=t,t.pause(),t.on("data",(function(t){e.push({data:t,meta:{percent:0}})})).on("error",(function(t){e.isPaused?this.generatedError=t:e.error(t)})).on("end",(function(){e.isPaused?e._upstreamEnded=!0:e.end()}))},a.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,e,n){var r=t("readable-stream").Readable,i=t("../utils");function a(t,e,n){r.call(this,e),this._helper=t;var i=this;t.on("data",(function(t,e){i.push(t)||i._helper.pause(),n&&n(e)})).on("error",(function(t){i.emit("error",t)})).on("end",(function(){i.push(null)}))}i.inherits(a,r),a.prototype._read=function(){this._helper.resume()},e.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,n,r){n.exports={isNode:"undefined"!==typeof t,newBufferFrom:function(e,n){if(t.from&&t.from!==Uint8Array.from)return t.from(e,n);if("number"===typeof e)throw new Error('The "data" argument must not be a number');return new t(e,n)},allocBuffer:function(e){if(t.alloc)return t.alloc(e);var n=new t(e);return n.fill(0),n},isBuffer:function(e){return t.isBuffer(e)},isStream:function(t){return t&&"function"===typeof t.on&&"function"===typeof t.pause&&"function"===typeof t.resume}}},{}],15:[function(t,e,n){var r=t("./utf8"),i=t("./utils"),a=t("./stream/GenericWorker"),o=t("./stream/StreamHelper"),s=t("./defaults"),c=t("./compressedObject"),l=t("./zipObject"),u=t("./generate"),d=t("./nodejsUtils"),h=t("./nodejs/NodejsStreamInputAdapter"),f=function(t,e,n){var r,o=i.getTypeOf(e),u=i.extend(n||{},s);u.date=u.date||new Date,null!==u.compression&&(u.compression=u.compression.toUpperCase()),"string"===typeof u.unixPermissions&&(u.unixPermissions=parseInt(u.unixPermissions,8)),u.unixPermissions&&16384&u.unixPermissions&&(u.dir=!0),u.dosPermissions&&16&u.dosPermissions&&(u.dir=!0),u.dir&&(t=p(t)),u.createFolders&&(r=m(t))&&b.call(this,r,!0);var f="string"===o&&!1===u.binary&&!1===u.base64;n&&"undefined"!==typeof n.binary||(u.binary=!f);var v=e instanceof c&&0===e.uncompressedSize;(v||u.dir||!e||0===e.length)&&(u.base64=!1,u.binary=!0,e="",u.compression="STORE",o="string");var g=null;g=e instanceof c||e instanceof a?e:d.isNode&&d.isStream(e)?new h(t,e):i.prepareContent(t,e,u.binary,u.optimizedBinaryString,u.base64);var w=new l(t,g,u);this.files[t]=w},m=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},p=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},b=function(t,e){return e="undefined"!==typeof e?e:s.createFolders,t=p(t),this.files[t]||f.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function v(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var g={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,n,r;for(e in this.files)this.files.hasOwnProperty(e)&&(r=this.files[e],n=e.slice(this.root.length,e.length),n&&e.slice(0,this.root.length)===this.root&&t(n,r))},filter:function(t){var e=[];return this.forEach((function(n,r){t(n,r)&&e.push(r)})),e},file:function(t,e,n){if(1===arguments.length){if(v(t)){var r=t;return this.filter((function(t,e){return!e.dir&&r.test(t)}))}var i=this.files[this.root+t];return i&&!i.dir?i:null}return t=this.root+t,f.call(this,t,e,n),this},folder:function(t){if(!t)return this;if(v(t))return this.filter((function(e,n){return n.dir&&t.test(e)}));var e=this.root+t,n=b.call(this,e),r=this.clone();return r.root=n.name,r},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!==t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var n=this.filter((function(e,n){return n.name.slice(0,t.length)===t})),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(t){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,n={};try{if(n=i.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode}),n.type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");i.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var s=n.comment||this.comment||"";e=u.generateWorker(this,n,s)}catch(c){e=new a("error"),e.error(c)}return new o(e,n.type||"string",n.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return t=t||{},t.type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};e.exports=g},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,e,n){e.exports=t("stream")},{stream:void 0}],17:[function(t,e,n){var r=t("./DataReader"),i=t("../utils");function a(t){r.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}i.inherits(a,r),a.prototype.byteAt=function(t){return this.data[this.zero+t]},a.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),n=t.charCodeAt(1),r=t.charCodeAt(2),i=t.charCodeAt(3),a=this.length-4;a>=0;--a)if(this.data[a]===e&&this.data[a+1]===n&&this.data[a+2]===r&&this.data[a+3]===i)return a-this.zero;return-1},a.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),n=t.charCodeAt(1),r=t.charCodeAt(2),i=t.charCodeAt(3),a=this.readData(4);return e===a[0]&&n===a[1]&&r===a[2]&&i===a[3]},a.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,e,n){var r=t("../utils");function i(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,n=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)n=(n<<8)+this.byteAt(e);return this.index+=t,n},readString:function(t){return r.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},e.exports=i},{"../utils":32}],19:[function(t,e,n){var r=t("./Uint8ArrayReader"),i=t("../utils");function a(t){r.call(this,t)}i.inherits(a,r),a.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,e,n){var r=t("./DataReader"),i=t("../utils");function a(t){r.call(this,t)}i.inherits(a,r),a.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},a.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},a.prototype.readAndCheckSignature=function(t){var e=this.readData(4);return t===e},a.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,e,n){var r=t("./ArrayReader"),i=t("../utils");function a(t){r.call(this,t)}i.inherits(a,r),a.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,e,n){var r=t("../utils"),i=t("../support"),a=t("./ArrayReader"),o=t("./StringReader"),s=t("./NodeBufferReader"),c=t("./Uint8ArrayReader");e.exports=function(t){var e=r.getTypeOf(t);return r.checkSupport(e),"string"!==e||i.uint8array?"nodebuffer"===e?new s(t):i.uint8array?new c(r.transformTo("uint8array",t)):new a(r.transformTo("array",t)):new o(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,e,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(t,e,n){var r=t("./GenericWorker"),i=t("../utils");function a(t){r.call(this,"ConvertWorker to "+t),this.destType=t}i.inherits(a,r),a.prototype.processChunk=function(t){this.push({data:i.transformTo(this.destType,t.data),meta:t.meta})},e.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(t,e,n){var r=t("./GenericWorker"),i=t("../crc32"),a=t("../utils");function o(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}a.inherits(o,r),o.prototype.processChunk=function(t){this.streamInfo.crc32=i(t.data,this.streamInfo.crc32||0),this.push(t)},e.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,e,n){var r=t("../utils"),i=t("./GenericWorker");function a(t){i.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}r.inherits(a,i),a.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}i.prototype.processChunk.call(this,t)},e.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(t,e,n){var r=t("../utils"),i=t("./GenericWorker"),a=16384;function o(t){i.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then((function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=r.getTypeOf(t),e.isPaused||e._tickAndRepeat()}),(function(t){e.error(t)}))}r.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=a,e=null,n=Math.min(this.max,this.index+t);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,n);break;case"uint8array":e=this.data.subarray(this.index,n);break;case"array":case"nodebuffer":e=this.data.slice(this.index,n);break}return this.index=n,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,e,n){function r(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var n=0;n<this._listeners[t].length;n++)this._listeners[t][n].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.end()})),t.on("error",(function(t){e.error(t)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var t=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},e.exports=r},{}],29:[function(e,n,r){var i=e("../utils"),a=e("./ConvertWorker"),o=e("./GenericWorker"),s=e("../base64"),c=e("../support"),l=e("../external"),u=null;if(c.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch(p){}function d(t,e,n){switch(t){case"blob":return i.newBlob(i.transformTo("arraybuffer",e),n);case"base64":return s.encode(e);default:return i.transformTo(t,e)}}function h(e,n){var r,i=0,a=null,o=0;for(r=0;r<n.length;r++)o+=n[r].length;switch(e){case"string":return n.join("");case"array":return Array.prototype.concat.apply([],n);case"uint8array":for(a=new Uint8Array(o),r=0;r<n.length;r++)a.set(n[r],i),i+=n[r].length;return a;case"nodebuffer":return t.concat(n);default:throw new Error("concat : unsupported type '"+e+"'")}}function f(t,e){return new l.Promise((function(n,r){var i=[],a=t._internalType,o=t._outputType,s=t._mimeType;t.on("data",(function(t,n){i.push(t),e&&e(n)})).on("error",(function(t){i=[],r(t)})).on("end",(function(){try{var t=d(o,h(a,i),s);n(t)}catch(p){r(p)}i=[]})).resume()}))}function m(t,e,n){var r=e;switch(e){case"blob":case"arraybuffer":r="uint8array";break;case"base64":r="string";break}try{this._internalType=r,this._outputType=e,this._mimeType=n,i.checkSupport(r),this._worker=t.pipe(new a(r)),t.lock()}catch(p){this._worker=new o("error"),this._worker.error(p)}}m.prototype={accumulate:function(t){return f(this,t)},on:function(t,e){var n=this;return"data"===t?this._worker.on(t,(function(t){e.call(n,t.data,t.meta)})):this._worker.on(t,(function(){i.delay(e,arguments,n)})),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},t)}},n.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof Uint8Array,r.nodebuffer="undefined"!==typeof t,r.uint8array="undefined"!==typeof Uint8Array,"undefined"===typeof ArrayBuffer)r.blob=!1;else{var i=new ArrayBuffer(0);try{r.blob=0===new Blob([i],{type:"application/zip"}).size}catch(s){try{var a=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,o=new a;o.append(i),r.blob=0===o.getBlob("application/zip").size}catch(s){r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch(s){r.nodestream=!1}},{"readable-stream":16}],31:[function(t,e,n){for(var r=t("./utils"),i=t("./support"),a=t("./nodejsUtils"),o=t("./stream/GenericWorker"),s=new Array(256),c=0;c<256;c++)s[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;s[254]=s[254]=1;var l=function(t){var e,n,r,a,o,s=t.length,c=0;for(a=0;a<s;a++)n=t.charCodeAt(a),55296===(64512&n)&&a+1<s&&(r=t.charCodeAt(a+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),a++)),c+=n<128?1:n<2048?2:n<65536?3:4;for(e=i.uint8array?new Uint8Array(c):new Array(c),o=0,a=0;o<c;a++)n=t.charCodeAt(a),55296===(64512&n)&&a+1<s&&(r=t.charCodeAt(a+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),a++)),n<128?e[o++]=n:n<2048?(e[o++]=192|n>>>6,e[o++]=128|63&n):n<65536?(e[o++]=224|n>>>12,e[o++]=128|n>>>6&63,e[o++]=128|63&n):(e[o++]=240|n>>>18,e[o++]=128|n>>>12&63,e[o++]=128|n>>>6&63,e[o++]=128|63&n);return e},u=function(t,e){var n;e=e||t.length,e>t.length&&(e=t.length),n=e-1;while(n>=0&&128===(192&t[n]))n--;return n<0||0===n?e:n+s[t[n]]>e?n:e},d=function(t){var e,n,i,a,o=t.length,c=new Array(2*o);for(n=0,e=0;e<o;)if(i=t[e++],i<128)c[n++]=i;else if(a=s[i],a>4)c[n++]=65533,e+=a-1;else{i&=2===a?31:3===a?15:7;while(a>1&&e<o)i=i<<6|63&t[e++],a--;a>1?c[n++]=65533:i<65536?c[n++]=i:(i-=65536,c[n++]=55296|i>>10&1023,c[n++]=56320|1023&i)}return c.length!==n&&(c.subarray?c=c.subarray(0,n):c.length=n),r.applyFromCharCode(c)};function h(){o.call(this,"utf-8 decode"),this.leftOver=null}function f(){o.call(this,"utf-8 encode")}n.utf8encode=function(t){return i.nodebuffer?a.newBufferFrom(t,"utf-8"):l(t)},n.utf8decode=function(t){return i.nodebuffer?r.transformTo("nodebuffer",t).toString("utf-8"):(t=r.transformTo(i.uint8array?"uint8array":"array",t),d(t))},r.inherits(h,o),h.prototype.processChunk=function(t){var e=r.transformTo(i.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var a=e;e=new Uint8Array(a.length+this.leftOver.length),e.set(this.leftOver,0),e.set(a,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var o=u(e),s=e;o!==e.length&&(i.uint8array?(s=e.subarray(0,o),this.leftOver=e.subarray(o,e.length)):(s=e.slice(0,o),this.leftOver=e.slice(o,e.length))),this.push({data:n.utf8decode(s),meta:t.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=h,r.inherits(f,o),f.prototype.processChunk=function(t){this.push({data:n.utf8encode(t.data),meta:t.meta})},n.Utf8EncodeWorker=f},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,e,n){var r=t("./support"),i=t("./base64"),a=t("./nodejsUtils"),o=t("set-immediate-shim"),s=t("./external");function c(t){var e=null;return e=r.uint8array?new Uint8Array(t.length):new Array(t.length),u(t,e)}function l(t){return t}function u(t,e){for(var n=0;n<t.length;++n)e[n]=255&t.charCodeAt(n);return e}n.newBlob=function(t,e){n.checkSupport("blob");try{return new Blob([t],{type:e})}catch(a){try{var r=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,i=new r;return i.append(t),i.getBlob(e)}catch(a){throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(t,e,n){var r=[],i=0,a=t.length;if(a<=n)return String.fromCharCode.apply(null,t);while(i<a)"array"===e||"nodebuffer"===e?r.push(String.fromCharCode.apply(null,t.slice(i,Math.min(i+n,a)))):r.push(String.fromCharCode.apply(null,t.subarray(i,Math.min(i+n,a)))),i+=n;return r.join("")},stringifyByChar:function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,a.allocBuffer(1)).length}catch(t){return!1}}()}};function h(t){var e=65536,r=n.getTypeOf(t),i=!0;if("uint8array"===r?i=d.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=d.applyCanBeUsed.nodebuffer),i)while(e>1)try{return d.stringifyByChunk(t,r,e)}catch(a){e=Math.floor(e/2)}return d.stringifyByChar(t)}function f(t,e){for(var n=0;n<t.length;n++)e[n]=t[n];return e}n.applyFromCharCode=h;var m={};m["string"]={string:l,array:function(t){return u(t,new Array(t.length))},arraybuffer:function(t){return m["string"]["uint8array"](t).buffer},uint8array:function(t){return u(t,new Uint8Array(t.length))},nodebuffer:function(t){return u(t,a.allocBuffer(t.length))}},m["array"]={string:h,array:l,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return a.newBufferFrom(t)}},m["arraybuffer"]={string:function(t){return h(new Uint8Array(t))},array:function(t){return f(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:l,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return a.newBufferFrom(new Uint8Array(t))}},m["uint8array"]={string:h,array:function(t){return f(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:l,nodebuffer:function(t){return a.newBufferFrom(t)}},m["nodebuffer"]={string:h,array:function(t){return f(t,new Array(t.length))},arraybuffer:function(t){return m["nodebuffer"]["uint8array"](t).buffer},uint8array:function(t){return f(t,new Uint8Array(t.length))},nodebuffer:l},n.transformTo=function(t,e){if(e||(e=""),!t)return e;n.checkSupport(t);var r=n.getTypeOf(e),i=m[r][t](e);return i},n.getTypeOf=function(t){return"string"===typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":r.nodebuffer&&a.isBuffer(t)?"nodebuffer":r.uint8array&&t instanceof Uint8Array?"uint8array":r.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(t){var e=r[t.toLowerCase()];if(!e)throw new Error(t+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(t){var e,n,r="";for(n=0;n<(t||"").length;n++)e=t.charCodeAt(n),r+="\\x"+(e<16?"0":"")+e.toString(16).toUpperCase();return r},n.delay=function(t,e,n){o((function(){t.apply(n||null,e||[])}))},n.inherits=function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n},n.extend=function(){var t,e,n={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&"undefined"===typeof n[e]&&(n[e]=arguments[t][e]);return n},n.prepareContent=function(t,e,a,o,l){var u=s.Promise.resolve(e).then((function(t){var e=r.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)));return e&&"undefined"!==typeof FileReader?new s.Promise((function(e,n){var r=new FileReader;r.onload=function(t){e(t.target.result)},r.onerror=function(t){n(t.target.error)},r.readAsArrayBuffer(t)})):t}));return u.then((function(e){var r=n.getTypeOf(e);return r?("arraybuffer"===r?e=n.transformTo("uint8array",e):"string"===r&&(l?e=i.decode(e):a&&!0!==o&&(e=c(e))),e):s.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(t,e,n){var r=t("./reader/readerFor"),i=t("./utils"),a=t("./signature"),o=t("./zipEntry"),s=(t("./utf8"),t("./support"));function c(t){this.files=[],this.loadOptions=t}c.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(e)+", expected "+i.pretty(t)+")")}},isSignature:function(t,e){var n=this.reader.index;this.reader.setIndex(t);var r=this.reader.readString(4),i=r===e;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=s.uint8array?"uint8array":"array",n=i.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};var t,e,n,r=this.zip64EndOfCentralSize-44,i=0;while(i<r)t=this.reader.readInt(2),e=this.reader.readInt(4),n=this.reader.readData(e),this.zip64ExtensibleData[t]={id:t,length:e,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;this.reader.setIndex(this.centralDirOffset);while(this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER))t=new o({zip64:this.zip64},this.loadOptions),t.readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(t<0){var e=!this.isSignature(0,a.LOCAL_FILE_HEADER);throw e?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(t);var n=t;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,t=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),t<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var o=n-r;if(o>0)this.isSignature(n,a.CENTRAL_FILE_HEADER)||(this.reader.zero=o);else if(o<0)throw new Error("Corrupted zip: missing "+Math.abs(o)+" bytes.")},prepareReader:function(t){this.reader=r(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(t,e,n){var r=t("./reader/readerFor"),i=t("./utils"),a=t("./compressedObject"),o=t("./crc32"),s=t("./utf8"),c=t("./compressions"),l=t("./support"),u=0,d=3,h=function(t){for(var e in c)if(c.hasOwnProperty(e)&&c[e].magic===t)return c[e];return null};function f(t,e){this.options=t,this.loadOptions=e}f.prototype={isEncrypted:function(){return 1===(1&this.bitFlag)},useUTF8:function(){return 2048===(2048&this.bitFlag)},readLocalPart:function(t){var e,n;if(t.skip(22),this.fileNameLength=t.readInt(2),n=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(e=h(this.compressionMethod),null===e)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),t===u&&(this.dosPermissions=63&this.externalFileAttributes),t===d&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,n,r,i=t.index+this.extraFieldsLength;this.extraFields||(this.extraFields={});while(t.index<i)e=t.readInt(2),n=t.readInt(2),r=t.readData(n),this.extraFields[e]={id:e,length:n,value:r}},handleUTF8:function(){var t=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var n=i.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var a=i.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=r(t.value);return 1!==e.readInt(1)||o(this.fileName)!==e.readInt(4)?null:s.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=r(t.value);return 1!==e.readInt(1)||o(this.fileComment)!==e.readInt(4)?null:s.utf8decode(e.readData(t.length-5))}return null}},e.exports=f},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,e,n){var r=t("./stream/StreamHelper"),i=t("./stream/DataWorker"),a=t("./utf8"),o=t("./compressedObject"),s=t("./stream/GenericWorker"),c=function(t,e,n){this.name=t,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=e,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}};c.prototype={internalStream:function(t){var e=null,n="string";try{if(!t)throw new Error("No output type specified.");n=t.toLowerCase();var i="string"===n||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),e=this._decompressWorker();var o=!this._dataBinary;o&&!i&&(e=e.pipe(new a.Utf8EncodeWorker)),!o&&i&&(e=e.pipe(new a.Utf8DecodeWorker))}catch(c){e=new s("error"),e.error(c)}return new r(e,n,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof o&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new a.Utf8EncodeWorker)),o.createWorkerFrom(n,t,e)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof s?this._data:new i(this._data)}};for(var l=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<l.length;d++)c.prototype[l[d]]=u;e.exports=c},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,e,n){(function(t){var n,r,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var a=0,o=new i(u),s=t.document.createTextNode("");o.observe(s,{characterData:!0}),n=function(){s.data=a=++a%2}}else if(t.setImmediate||"undefined"===typeof t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var c=new t.MessageChannel;c.port1.onmessage=u,n=function(){c.port2.postMessage(0)}}var l=[];function u(){var t,e;r=!0;var n=l.length;while(n){e=l,l=[],t=-1;while(++t<n)e[t]();n=l.length}r=!1}function d(t){1!==l.push(t)||r||n()}e.exports=d}).call(this,"undefined"!==typeof r?r:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],37:[function(t,e,n){var r=t("immediate");function i(){}var a={},s=["REJECTED"],c=["FULFILLED"],l=["PENDING"];function u(t){if("function"!==typeof t)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,t!==i&&m(this,t)}function d(t,e,n){this.promise=t,"function"===typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"===typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(t,e,n){r((function(){var r;try{r=e(n)}catch(i){return a.reject(t,i)}r===t?a.reject(t,new TypeError("Cannot resolve promise with itself")):a.resolve(t,r)}))}function f(t){var e=t&&t.then;if(t&&("object"===Object(o["a"])(t)||"function"===typeof t)&&"function"===typeof e)return function(){e.apply(t,arguments)}}function m(t,e){var n=!1;function r(e){n||(n=!0,a.reject(t,e))}function i(e){n||(n=!0,a.resolve(t,e))}function o(){e(i,r)}var s=p(o);"error"===s.status&&r(s.value)}function p(t,e){var n={};try{n.value=t(e),n.status="success"}catch(r){n.status="error",n.value=r}return n}function b(t){return t instanceof this?t:a.resolve(new this(i),t)}function v(t){var e=new this(i);return a.reject(e,t)}function g(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);var o=new Array(n),s=0,c=-1,l=new this(i);while(++c<n)u(t[c],c);return l;function u(t,i){function c(t){o[i]=t,++s!==n||r||(r=!0,a.resolve(l,o))}e.resolve(t).then(c,(function(t){r||(r=!0,a.reject(l,t))}))}}function w(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);var o=-1,s=new this(i);while(++o<n)c(t[o]);return s;function c(t){e.resolve(t).then((function(t){r||(r=!0,a.resolve(s,t))}),(function(t){r||(r=!0,a.reject(s,t))}))}}e.exports=u,u.prototype["finally"]=function(t){if("function"!==typeof t)return this;var e=this.constructor;return this.then(n,r);function n(n){function r(){return n}return e.resolve(t()).then(r)}function r(n){function r(){throw n}return e.resolve(t()).then(r)}},u.prototype["catch"]=function(t){return this.then(null,t)},u.prototype.then=function(t,e){if("function"!==typeof t&&this.state===c||"function"!==typeof e&&this.state===s)return this;var n=new this.constructor(i);if(this.state!==l){var r=this.state===c?t:e;h(n,r,this.outcome)}else this.queue.push(new d(n,t,e));return n},d.prototype.callFulfilled=function(t){a.resolve(this.promise,t)},d.prototype.otherCallFulfilled=function(t){h(this.promise,this.onFulfilled,t)},d.prototype.callRejected=function(t){a.reject(this.promise,t)},d.prototype.otherCallRejected=function(t){h(this.promise,this.onRejected,t)},a.resolve=function(t,e){var n=p(f,e);if("error"===n.status)return a.reject(t,n.value);var r=n.value;if(r)m(t,r);else{t.state=c,t.outcome=e;var i=-1,o=t.queue.length;while(++i<o)t.queue[i].callFulfilled(e)}return t},a.reject=function(t,e){t.state=s,t.outcome=e;var n=-1,r=t.queue.length;while(++n<r)t.queue[n].callRejected(e);return t},u.resolve=b,u.reject=v,u.all=g,u.race=w},{immediate:36}],38:[function(t,e,n){var r=t("./lib/utils/common").assign,i=t("./lib/deflate"),a=t("./lib/inflate"),o=t("./lib/zlib/constants"),s={};r(s,i,a,o),e.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,e,n){var r=t("./zlib/deflate"),i=t("./utils/common"),a=t("./utils/strings"),o=t("./zlib/messages"),s=t("./zlib/zstream"),c=Object.prototype.toString,l=0,u=4,d=0,h=1,f=2,m=-1,p=0,b=8;function v(t){if(!(this instanceof v))return new v(t);this.options=i.assign({level:m,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==d)throw new Error(o[n]);if(e.header&&r.deflateSetHeader(this.strm,e.header),e.dictionary){var l;if(l="string"===typeof e.dictionary?a.string2buf(e.dictionary):"[object ArrayBuffer]"===c.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,n=r.deflateSetDictionary(this.strm,l),n!==d)throw new Error(o[n]);this._dict_set=!0}}function g(t,e){var n=new v(e);if(n.push(t,!0),n.err)throw n.msg||o[n.err];return n.result}function w(t,e){return e=e||{},e.raw=!0,g(t,e)}function x(t,e){return e=e||{},e.gzip=!0,g(t,e)}v.prototype.push=function(t,e){var n,o,s=this.strm,m=this.options.chunkSize;if(this.ended)return!1;o=e===~~e?e:!0===e?u:l,"string"===typeof t?s.input=a.string2buf(t):"[object ArrayBuffer]"===c.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(m),s.next_out=0,s.avail_out=m),n=r.deflate(s,o),n!==h&&n!==d)return this.onEnd(n),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||o!==u&&o!==f)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&n!==h);return o===u?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===d):o!==f||(this.onEnd(d),s.avail_out=0,!0)},v.prototype.onData=function(t){this.chunks.push(t)},v.prototype.onEnd=function(t){t===d&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Deflate=v,n.deflate=g,n.deflateRaw=w,n.gzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,e,n){var r=t("./zlib/inflate"),i=t("./utils/common"),a=t("./utils/strings"),o=t("./zlib/constants"),s=t("./zlib/messages"),c=t("./zlib/zstream"),l=t("./zlib/gzheader"),u=Object.prototype.toString;function d(t){if(!(this instanceof d))return new d(t);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,e.windowBits);if(n!==o.Z_OK)throw new Error(s[n]);this.header=new l,r.inflateGetHeader(this.strm,this.header)}function h(t,e){var n=new d(e);if(n.push(t,!0),n.err)throw n.msg||s[n.err];return n.result}function f(t,e){return e=e||{},e.raw=!0,h(t,e)}d.prototype.push=function(t,e){var n,s,c,l,d,h,f=this.strm,m=this.options.chunkSize,p=this.options.dictionary,b=!1;if(this.ended)return!1;s=e===~~e?e:!0===e?o.Z_FINISH:o.Z_NO_FLUSH,"string"===typeof t?f.input=a.binstring2buf(t):"[object ArrayBuffer]"===u.call(t)?f.input=new Uint8Array(t):f.input=t,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(m),f.next_out=0,f.avail_out=m),n=r.inflate(f,o.Z_NO_FLUSH),n===o.Z_NEED_DICT&&p&&(h="string"===typeof p?a.string2buf(p):"[object ArrayBuffer]"===u.call(p)?new Uint8Array(p):p,n=r.inflateSetDictionary(this.strm,h)),n===o.Z_BUF_ERROR&&!0===b&&(n=o.Z_OK,b=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&n!==o.Z_STREAM_END&&(0!==f.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(c=a.utf8border(f.output,f.next_out),l=f.next_out-c,d=a.buf2string(f.output,c),f.next_out=l,f.avail_out=m-l,l&&i.arraySet(f.output,f.output,c,l,0),this.onData(d)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(b=!0)}while((f.avail_in>0||0===f.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),f.avail_out=0,!0)},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Inflate=d,n.inflate=h,n.inflateRaw=f,n.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,e,n){var r="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;n.assign=function(t){var e=Array.prototype.slice.call(arguments,1);while(e.length){var n=e.shift();if(n){if("object"!==Object(o["a"])(n))throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}}return t},n.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var i={arraySet:function(t,e,n,r,i){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+r),i);else for(var a=0;a<r;a++)t[i+a]=e[n+a]},flattenChunks:function(t){var e,n,r,i,a,o;for(r=0,e=0,n=t.length;e<n;e++)r+=t[e].length;for(o=new Uint8Array(r),i=0,e=0,n=t.length;e<n;e++)a=t[e],o.set(a,i),i+=a.length;return o}},a={arraySet:function(t,e,n,r,i){for(var a=0;a<r;a++)t[i+a]=e[n+a]},flattenChunks:function(t){return[].concat.apply([],t)}};n.setTyped=function(t){t?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(r)},{}],42:[function(t,e,n){var r=t("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(l){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(l){a=!1}for(var o=new r.Buf8(256),s=0;s<256;s++)o[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function c(t,e){if(e<65537&&(t.subarray&&a||!t.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var n="",o=0;o<e;o++)n+=String.fromCharCode(t[o]);return n}o[254]=o[254]=1,n.string2buf=function(t){var e,n,i,a,o,s=t.length,c=0;for(a=0;a<s;a++)n=t.charCodeAt(a),55296===(64512&n)&&a+1<s&&(i=t.charCodeAt(a+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),a++)),c+=n<128?1:n<2048?2:n<65536?3:4;for(e=new r.Buf8(c),o=0,a=0;o<c;a++)n=t.charCodeAt(a),55296===(64512&n)&&a+1<s&&(i=t.charCodeAt(a+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),a++)),n<128?e[o++]=n:n<2048?(e[o++]=192|n>>>6,e[o++]=128|63&n):n<65536?(e[o++]=224|n>>>12,e[o++]=128|n>>>6&63,e[o++]=128|63&n):(e[o++]=240|n>>>18,e[o++]=128|n>>>12&63,e[o++]=128|n>>>6&63,e[o++]=128|63&n);return e},n.buf2binstring=function(t){return c(t,t.length)},n.binstring2buf=function(t){for(var e=new r.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},n.buf2string=function(t,e){var n,r,i,a,s=e||t.length,l=new Array(2*s);for(r=0,n=0;n<s;)if(i=t[n++],i<128)l[r++]=i;else if(a=o[i],a>4)l[r++]=65533,n+=a-1;else{i&=2===a?31:3===a?15:7;while(a>1&&n<s)i=i<<6|63&t[n++],a--;a>1?l[r++]=65533:i<65536?l[r++]=i:(i-=65536,l[r++]=55296|i>>10&1023,l[r++]=56320|1023&i)}return c(l,r)},n.utf8border=function(t,e){var n;e=e||t.length,e>t.length&&(e=t.length),n=e-1;while(n>=0&&128===(192&t[n]))n--;return n<0||0===n?e:n+o[t[n]]>e?n:e}},{"./common":41}],43:[function(t,e,n){function r(t,e,n,r){var i=65535&t|0,a=t>>>16&65535|0,o=0;while(0!==n){o=n>2e3?2e3:n,n-=o;do{i=i+e[r++]|0,a=a+i|0}while(--o);i%=65521,a%=65521}return i|a<<16|0}e.exports=r},{}],44:[function(t,e,n){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,e,n){function r(){for(var t,e=[],n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}var i=r();function a(t,e,n,r){var a=i,o=r+n;t^=-1;for(var s=r;s<o;s++)t=t>>>8^a[255&(t^e[s])];return-1^t}e.exports=a},{}],46:[function(t,e,n){var r,i=t("../utils/common"),a=t("./trees"),o=t("./adler32"),s=t("./crc32"),c=t("./messages"),l=0,u=1,d=3,h=4,f=5,m=0,p=1,b=-2,v=-3,g=-5,w=-1,x=1,y=2,C=3,k=4,S=0,_=2,A=8,I=9,T=15,O=8,E=29,M=256,L=M+1+E,N=30,D=19,F=2*L+1,P=15,j=3,R=258,B=R+j+1,V=32,U=42,$=69,H=73,z=91,W=103,G=113,Y=666,X=1,K=2,Z=3,q=4,Q=3;function J(t,e){return t.msg=c[e],e}function tt(t){return(t<<1)-(t>4?9:0)}function et(t){var e=t.length;while(--e>=0)t[e]=0}function nt(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(i.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function rt(t,e){a._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,nt(t.strm)}function it(t,e){t.pending_buf[t.pending++]=e}function at(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function ot(t,e,n,r){var a=t.avail_in;return a>r&&(a=r),0===a?0:(t.avail_in-=a,i.arraySet(e,t.input,t.next_in,a,n),1===t.state.wrap?t.adler=o(t.adler,e,a,n):2===t.state.wrap&&(t.adler=s(t.adler,e,a,n)),t.next_in+=a,t.total_in+=a,a)}function st(t,e){var n,r,i=t.max_chain_length,a=t.strstart,o=t.prev_length,s=t.nice_match,c=t.strstart>t.w_size-B?t.strstart-(t.w_size-B):0,l=t.window,u=t.w_mask,d=t.prev,h=t.strstart+R,f=l[a+o-1],m=l[a+o];t.prev_length>=t.good_match&&(i>>=2),s>t.lookahead&&(s=t.lookahead);do{if(n=e,l[n+o]===m&&l[n+o-1]===f&&l[n]===l[a]&&l[++n]===l[a+1]){a+=2,n++;do{}while(l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&a<h);if(r=R-(h-a),a=h-R,r>o){if(t.match_start=e,o=r,r>=s)break;f=l[a+o-1],m=l[a+o]}}}while((e=d[e&u])>c&&0!==--i);return o<=t.lookahead?o:t.lookahead}function ct(t){var e,n,r,a,o,s=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=s+(s-B)){i.arraySet(t.window,t.window,s,s,0),t.match_start-=s,t.strstart-=s,t.block_start-=s,n=t.hash_size,e=n;do{r=t.head[--e],t.head[e]=r>=s?r-s:0}while(--n);n=s,e=n;do{r=t.prev[--e],t.prev[e]=r>=s?r-s:0}while(--n);a+=s}if(0===t.strm.avail_in)break;if(n=ot(t.strm,t.window,t.strstart+t.lookahead,a),t.lookahead+=n,t.lookahead+t.insert>=j){o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;while(t.insert)if(t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+j-1])&t.hash_mask,t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,t.lookahead+t.insert<j)break}}while(t.lookahead<B&&0!==t.strm.avail_in)}function lt(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(ct(t),0===t.lookahead&&e===l)return X;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var r=t.block_start+n;if((0===t.strstart||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,rt(t,!1),0===t.strm.avail_out))return X;if(t.strstart-t.block_start>=t.w_size-B&&(rt(t,!1),0===t.strm.avail_out))return X}return t.insert=0,e===h?(rt(t,!0),0===t.strm.avail_out?Z:q):(t.strstart>t.block_start&&(rt(t,!1),t.strm.avail_out),X)}function ut(t,e){for(var n,r;;){if(t.lookahead<B){if(ct(t),t.lookahead<B&&e===l)return X;if(0===t.lookahead)break}if(n=0,t.lookahead>=j&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+j-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-B&&(t.match_length=st(t,n)),t.match_length>=j)if(r=a._tr_tally(t,t.strstart-t.match_start,t.match_length-j),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=j){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+j-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(rt(t,!1),0===t.strm.avail_out))return X}return t.insert=t.strstart<j-1?t.strstart:j-1,e===h?(rt(t,!0),0===t.strm.avail_out?Z:q):t.last_lit&&(rt(t,!1),0===t.strm.avail_out)?X:K}function dt(t,e){for(var n,r,i;;){if(t.lookahead<B){if(ct(t),t.lookahead<B&&e===l)return X;if(0===t.lookahead)break}if(n=0,t.lookahead>=j&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+j-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=j-1,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-B&&(t.match_length=st(t,n),t.match_length<=5&&(t.strategy===x||t.match_length===j&&t.strstart-t.match_start>4096)&&(t.match_length=j-1)),t.prev_length>=j&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-j,r=a._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-j),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+j-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!==--t.prev_length);if(t.match_available=0,t.match_length=j-1,t.strstart++,r&&(rt(t,!1),0===t.strm.avail_out))return X}else if(t.match_available){if(r=a._tr_tally(t,0,t.window[t.strstart-1]),r&&rt(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return X}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=a._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<j-1?t.strstart:j-1,e===h?(rt(t,!0),0===t.strm.avail_out?Z:q):t.last_lit&&(rt(t,!1),0===t.strm.avail_out)?X:K}function ht(t,e){for(var n,r,i,o,s=t.window;;){if(t.lookahead<=R){if(ct(t),t.lookahead<=R&&e===l)return X;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=j&&t.strstart>0&&(i=t.strstart-1,r=s[i],r===s[++i]&&r===s[++i]&&r===s[++i])){o=t.strstart+R;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o);t.match_length=R-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=j?(n=a._tr_tally(t,1,t.match_length-j),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(rt(t,!1),0===t.strm.avail_out))return X}return t.insert=0,e===h?(rt(t,!0),0===t.strm.avail_out?Z:q):t.last_lit&&(rt(t,!1),0===t.strm.avail_out)?X:K}function ft(t,e){for(var n;;){if(0===t.lookahead&&(ct(t),0===t.lookahead)){if(e===l)return X;break}if(t.match_length=0,n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(rt(t,!1),0===t.strm.avail_out))return X}return t.insert=0,e===h?(rt(t,!0),0===t.strm.avail_out?Z:q):t.last_lit&&(rt(t,!1),0===t.strm.avail_out)?X:K}function mt(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}function pt(t){t.window_size=2*t.w_size,et(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=j-1,t.match_available=0,t.ins_h=0}function bt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=A,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*F),this.dyn_dtree=new i.Buf16(2*(2*N+1)),this.bl_tree=new i.Buf16(2*(2*D+1)),et(this.dyn_ltree),et(this.dyn_dtree),et(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(P+1),this.heap=new i.Buf16(2*L+1),et(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*L+1),et(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function vt(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=_,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?U:G,t.adler=2===e.wrap?0:1,e.last_flush=l,a._tr_init(e),m):J(t,b)}function gt(t){var e=vt(t);return e===m&&pt(t.state),e}function wt(t,e){return t&&t.state?2!==t.state.wrap?b:(t.state.gzhead=e,m):b}function xt(t,e,n,r,a,o){if(!t)return b;var s=1;if(e===w&&(e=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),a<1||a>I||n!==A||r<8||r>15||e<0||e>9||o<0||o>k)return J(t,b);8===r&&(r=9);var c=new bt;return t.state=c,c.strm=t,c.wrap=s,c.gzhead=null,c.w_bits=r,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=a+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+j-1)/j),c.window=new i.Buf8(2*c.w_size),c.head=new i.Buf16(c.hash_size),c.prev=new i.Buf16(c.w_size),c.lit_bufsize=1<<a+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new i.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=e,c.strategy=o,c.method=n,gt(t)}function yt(t,e){return xt(t,e,A,T,O,S)}function Ct(t,e){var n,i,o,c;if(!t||!t.state||e>f||e<0)return t?J(t,b):b;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||i.status===Y&&e!==h)return J(t,0===t.avail_out?g:b);if(i.strm=t,n=i.last_flush,i.last_flush=e,i.status===U)if(2===i.wrap)t.adler=0,it(i,31),it(i,139),it(i,8),i.gzhead?(it(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),it(i,255&i.gzhead.time),it(i,i.gzhead.time>>8&255),it(i,i.gzhead.time>>16&255),it(i,i.gzhead.time>>24&255),it(i,9===i.level?2:i.strategy>=y||i.level<2?4:0),it(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(it(i,255&i.gzhead.extra.length),it(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=s(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=$):(it(i,0),it(i,0),it(i,0),it(i,0),it(i,0),it(i,9===i.level?2:i.strategy>=y||i.level<2?4:0),it(i,Q),i.status=G);else{var v=A+(i.w_bits-8<<4)<<8,w=-1;w=i.strategy>=y||i.level<2?0:i.level<6?1:6===i.level?2:3,v|=w<<6,0!==i.strstart&&(v|=V),v+=31-v%31,i.status=G,at(i,v),0!==i.strstart&&(at(i,t.adler>>>16),at(i,65535&t.adler)),t.adler=1}if(i.status===$)if(i.gzhead.extra){o=i.pending;while(i.gzindex<(65535&i.gzhead.extra.length)){if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),nt(t),o=i.pending,i.pending===i.pending_buf_size))break;it(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++}i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=H)}else i.status=H;if(i.status===H)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),nt(t),o=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,it(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),0===c&&(i.gzindex=0,i.status=z)}else i.status=z;if(i.status===z)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),nt(t),o=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,it(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),0===c&&(i.status=W)}else i.status=W;if(i.status===W&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&nt(t),i.pending+2<=i.pending_buf_size&&(it(i,255&t.adler),it(i,t.adler>>8&255),t.adler=0,i.status=G)):i.status=G),0!==i.pending){if(nt(t),0===t.avail_out)return i.last_flush=-1,m}else if(0===t.avail_in&&tt(e)<=tt(n)&&e!==h)return J(t,g);if(i.status===Y&&0!==t.avail_in)return J(t,g);if(0!==t.avail_in||0!==i.lookahead||e!==l&&i.status!==Y){var x=i.strategy===y?ft(i,e):i.strategy===C?ht(i,e):r[i.level].func(i,e);if(x!==Z&&x!==q||(i.status=Y),x===X||x===Z)return 0===t.avail_out&&(i.last_flush=-1),m;if(x===K&&(e===u?a._tr_align(i):e!==f&&(a._tr_stored_block(i,0,0,!1),e===d&&(et(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),nt(t),0===t.avail_out))return i.last_flush=-1,m}return e!==h?m:i.wrap<=0?p:(2===i.wrap?(it(i,255&t.adler),it(i,t.adler>>8&255),it(i,t.adler>>16&255),it(i,t.adler>>24&255),it(i,255&t.total_in),it(i,t.total_in>>8&255),it(i,t.total_in>>16&255),it(i,t.total_in>>24&255)):(at(i,t.adler>>>16),at(i,65535&t.adler)),nt(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?m:p)}function kt(t){var e;return t&&t.state?(e=t.state.status,e!==U&&e!==$&&e!==H&&e!==z&&e!==W&&e!==G&&e!==Y?J(t,b):(t.state=null,e===G?J(t,v):m)):b}function St(t,e){var n,r,a,s,c,l,u,d,h=e.length;if(!t||!t.state)return b;if(n=t.state,s=n.wrap,2===s||1===s&&n.status!==U||n.lookahead)return b;1===s&&(t.adler=o(t.adler,e,h,0)),n.wrap=0,h>=n.w_size&&(0===s&&(et(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new i.Buf8(n.w_size),i.arraySet(d,e,h-n.w_size,n.w_size,0),e=d,h=n.w_size),c=t.avail_in,l=t.next_in,u=t.input,t.avail_in=h,t.next_in=0,t.input=e,ct(n);while(n.lookahead>=j){r=n.strstart,a=n.lookahead-(j-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+j-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--a);n.strstart=r,n.lookahead=j-1,ct(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=j-1,n.match_available=0,t.next_in=l,t.input=u,t.avail_in=c,n.wrap=s,m}r=[new mt(0,0,0,0,lt),new mt(4,4,8,4,ut),new mt(4,5,16,8,ut),new mt(4,6,32,32,ut),new mt(4,4,16,16,dt),new mt(8,16,32,32,dt),new mt(8,16,128,128,dt),new mt(8,32,128,256,dt),new mt(32,128,258,1024,dt),new mt(32,258,258,4096,dt)],n.deflateInit=yt,n.deflateInit2=xt,n.deflateReset=gt,n.deflateResetKeep=vt,n.deflateSetHeader=wt,n.deflate=Ct,n.deflateEnd=kt,n.deflateSetDictionary=St,n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,e,n){function r(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=r},{}],48:[function(t,e,n){var r=30,i=12;e.exports=function(t,e){var n,a,o,s,c,l,u,d,h,f,m,p,b,v,g,w,x,y,C,k,S,_,A,I,T;n=t.state,a=t.next_in,I=t.input,o=a+(t.avail_in-5),s=t.next_out,T=t.output,c=s-(e-t.avail_out),l=s+(t.avail_out-257),u=n.dmax,d=n.wsize,h=n.whave,f=n.wnext,m=n.window,p=n.hold,b=n.bits,v=n.lencode,g=n.distcode,w=(1<<n.lenbits)-1,x=(1<<n.distbits)-1;t:do{b<15&&(p+=I[a++]<<b,b+=8,p+=I[a++]<<b,b+=8),y=v[p&w];e:for(;;){if(C=y>>>24,p>>>=C,b-=C,C=y>>>16&255,0===C)T[s++]=65535&y;else{if(!(16&C)){if(0===(64&C)){y=v[(65535&y)+(p&(1<<C)-1)];continue e}if(32&C){n.mode=i;break t}t.msg="invalid literal/length code",n.mode=r;break t}k=65535&y,C&=15,C&&(b<C&&(p+=I[a++]<<b,b+=8),k+=p&(1<<C)-1,p>>>=C,b-=C),b<15&&(p+=I[a++]<<b,b+=8,p+=I[a++]<<b,b+=8),y=g[p&x];n:for(;;){if(C=y>>>24,p>>>=C,b-=C,C=y>>>16&255,!(16&C)){if(0===(64&C)){y=g[(65535&y)+(p&(1<<C)-1)];continue n}t.msg="invalid distance code",n.mode=r;break t}if(S=65535&y,C&=15,b<C&&(p+=I[a++]<<b,b+=8,b<C&&(p+=I[a++]<<b,b+=8)),S+=p&(1<<C)-1,S>u){t.msg="invalid distance too far back",n.mode=r;break t}if(p>>>=C,b-=C,C=s-c,S>C){if(C=S-C,C>h&&n.sane){t.msg="invalid distance too far back",n.mode=r;break t}if(_=0,A=m,0===f){if(_+=d-C,C<k){k-=C;do{T[s++]=m[_++]}while(--C);_=s-S,A=T}}else if(f<C){if(_+=d+f-C,C-=f,C<k){k-=C;do{T[s++]=m[_++]}while(--C);if(_=0,f<k){C=f,k-=C;do{T[s++]=m[_++]}while(--C);_=s-S,A=T}}}else if(_+=f-C,C<k){k-=C;do{T[s++]=m[_++]}while(--C);_=s-S,A=T}while(k>2)T[s++]=A[_++],T[s++]=A[_++],T[s++]=A[_++],k-=3;k&&(T[s++]=A[_++],k>1&&(T[s++]=A[_++]))}else{_=s-S;do{T[s++]=T[_++],T[s++]=T[_++],T[s++]=T[_++],k-=3}while(k>2);k&&(T[s++]=T[_++],k>1&&(T[s++]=T[_++]))}break}}break}}while(a<o&&s<l);k=b>>3,a-=k,b-=k<<3,p&=(1<<b)-1,t.next_in=a,t.next_out=s,t.avail_in=a<o?o-a+5:5-(a-o),t.avail_out=s<l?l-s+257:257-(s-l),n.hold=p,n.bits=b}},{}],49:[function(t,e,n){var r=t("../utils/common"),i=t("./adler32"),a=t("./crc32"),o=t("./inffast"),s=t("./inftrees"),c=0,l=1,u=2,d=4,h=5,f=6,m=0,p=1,b=2,v=-2,g=-3,w=-4,x=-5,y=8,C=1,k=2,S=3,_=4,A=5,I=6,T=7,O=8,E=9,M=10,L=11,N=12,D=13,F=14,P=15,j=16,R=17,B=18,V=19,U=20,$=21,H=22,z=23,W=24,G=25,Y=26,X=27,K=28,Z=29,q=30,Q=31,J=32,tt=852,et=592,nt=15,rt=nt;function it(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function at(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ot(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=C,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new r.Buf32(tt),e.distcode=e.distdyn=new r.Buf32(et),e.sane=1,e.back=-1,m):v}function st(t){var e;return t&&t.state?(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,ot(t)):v}function ct(t,e){var n,r;return t&&t.state?(r=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?v:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,st(t))):v}function lt(t,e){var n,r;return t?(r=new at,t.state=r,r.window=null,n=ct(t,e),n!==m&&(t.state=null),n):v}function ut(t){return lt(t,rt)}var dt,ht,ft=!0;function mt(t){if(ft){var e;dt=new r.Buf32(512),ht=new r.Buf32(32),e=0;while(e<144)t.lens[e++]=8;while(e<256)t.lens[e++]=9;while(e<280)t.lens[e++]=7;while(e<288)t.lens[e++]=8;s(l,t.lens,0,288,dt,0,t.work,{bits:9}),e=0;while(e<32)t.lens[e++]=5;s(u,t.lens,0,32,ht,0,t.work,{bits:5}),ft=!1}t.lencode=dt,t.lenbits=9,t.distcode=ht,t.distbits=5}function pt(t,e,n,i){var a,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),i>=o.wsize?(r.arraySet(o.window,e,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(a=o.wsize-o.wnext,a>i&&(a=i),r.arraySet(o.window,e,n-i,a,o.wnext),i-=a,i?(r.arraySet(o.window,e,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}function bt(t,e){var n,tt,et,nt,rt,at,ot,st,ct,lt,ut,dt,ht,ft,bt,vt,gt,wt,xt,yt,Ct,kt,St,_t,At=0,It=new r.Buf8(4),Tt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return v;n=t.state,n.mode===N&&(n.mode=D),rt=t.next_out,et=t.output,ot=t.avail_out,nt=t.next_in,tt=t.input,at=t.avail_in,st=n.hold,ct=n.bits,lt=at,ut=ot,kt=m;t:for(;;)switch(n.mode){case C:if(0===n.wrap){n.mode=D;break}while(ct<16){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}if(2&n.wrap&&35615===st){n.check=0,It[0]=255&st,It[1]=st>>>8&255,n.check=a(n.check,It,2,0),st=0,ct=0,n.mode=k;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&st)<<8)+(st>>8))%31){t.msg="incorrect header check",n.mode=q;break}if((15&st)!==y){t.msg="unknown compression method",n.mode=q;break}if(st>>>=4,ct-=4,Ct=8+(15&st),0===n.wbits)n.wbits=Ct;else if(Ct>n.wbits){t.msg="invalid window size",n.mode=q;break}n.dmax=1<<Ct,t.adler=n.check=1,n.mode=512&st?M:N,st=0,ct=0;break;case k:while(ct<16){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}if(n.flags=st,(255&n.flags)!==y){t.msg="unknown compression method",n.mode=q;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=q;break}n.head&&(n.head.text=st>>8&1),512&n.flags&&(It[0]=255&st,It[1]=st>>>8&255,n.check=a(n.check,It,2,0)),st=0,ct=0,n.mode=S;case S:while(ct<32){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}n.head&&(n.head.time=st),512&n.flags&&(It[0]=255&st,It[1]=st>>>8&255,It[2]=st>>>16&255,It[3]=st>>>24&255,n.check=a(n.check,It,4,0)),st=0,ct=0,n.mode=_;case _:while(ct<16){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}n.head&&(n.head.xflags=255&st,n.head.os=st>>8),512&n.flags&&(It[0]=255&st,It[1]=st>>>8&255,n.check=a(n.check,It,2,0)),st=0,ct=0,n.mode=A;case A:if(1024&n.flags){while(ct<16){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}n.length=st,n.head&&(n.head.extra_len=st),512&n.flags&&(It[0]=255&st,It[1]=st>>>8&255,n.check=a(n.check,It,2,0)),st=0,ct=0}else n.head&&(n.head.extra=null);n.mode=I;case I:if(1024&n.flags&&(dt=n.length,dt>at&&(dt=at),dt&&(n.head&&(Ct=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,tt,nt,dt,Ct)),512&n.flags&&(n.check=a(n.check,tt,dt,nt)),at-=dt,nt+=dt,n.length-=dt),n.length))break t;n.length=0,n.mode=T;case T:if(2048&n.flags){if(0===at)break t;dt=0;do{Ct=tt[nt+dt++],n.head&&Ct&&n.length<65536&&(n.head.name+=String.fromCharCode(Ct))}while(Ct&&dt<at);if(512&n.flags&&(n.check=a(n.check,tt,dt,nt)),at-=dt,nt+=dt,Ct)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=O;case O:if(4096&n.flags){if(0===at)break t;dt=0;do{Ct=tt[nt+dt++],n.head&&Ct&&n.length<65536&&(n.head.comment+=String.fromCharCode(Ct))}while(Ct&&dt<at);if(512&n.flags&&(n.check=a(n.check,tt,dt,nt)),at-=dt,nt+=dt,Ct)break t}else n.head&&(n.head.comment=null);n.mode=E;case E:if(512&n.flags){while(ct<16){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}if(st!==(65535&n.check)){t.msg="header crc mismatch",n.mode=q;break}st=0,ct=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=N;break;case M:while(ct<32){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}t.adler=n.check=it(st),st=0,ct=0,n.mode=L;case L:if(0===n.havedict)return t.next_out=rt,t.avail_out=ot,t.next_in=nt,t.avail_in=at,n.hold=st,n.bits=ct,b;t.adler=n.check=1,n.mode=N;case N:if(e===h||e===f)break t;case D:if(n.last){st>>>=7&ct,ct-=7&ct,n.mode=X;break}while(ct<3){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}switch(n.last=1&st,st>>>=1,ct-=1,3&st){case 0:n.mode=F;break;case 1:if(mt(n),n.mode=U,e===f){st>>>=2,ct-=2;break t}break;case 2:n.mode=R;break;case 3:t.msg="invalid block type",n.mode=q}st>>>=2,ct-=2;break;case F:st>>>=7&ct,ct-=7&ct;while(ct<32){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}if((65535&st)!==(st>>>16^65535)){t.msg="invalid stored block lengths",n.mode=q;break}if(n.length=65535&st,st=0,ct=0,n.mode=P,e===f)break t;case P:n.mode=j;case j:if(dt=n.length,dt){if(dt>at&&(dt=at),dt>ot&&(dt=ot),0===dt)break t;r.arraySet(et,tt,nt,dt,rt),at-=dt,nt+=dt,ot-=dt,rt+=dt,n.length-=dt;break}n.mode=N;break;case R:while(ct<14){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}if(n.nlen=257+(31&st),st>>>=5,ct-=5,n.ndist=1+(31&st),st>>>=5,ct-=5,n.ncode=4+(15&st),st>>>=4,ct-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=q;break}n.have=0,n.mode=B;case B:while(n.have<n.ncode){while(ct<3){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}n.lens[Tt[n.have++]]=7&st,st>>>=3,ct-=3}while(n.have<19)n.lens[Tt[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,St={bits:n.lenbits},kt=s(c,n.lens,0,19,n.lencode,0,n.work,St),n.lenbits=St.bits,kt){t.msg="invalid code lengths set",n.mode=q;break}n.have=0,n.mode=V;case V:while(n.have<n.nlen+n.ndist){for(;;){if(At=n.lencode[st&(1<<n.lenbits)-1],bt=At>>>24,vt=At>>>16&255,gt=65535&At,bt<=ct)break;if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}if(gt<16)st>>>=bt,ct-=bt,n.lens[n.have++]=gt;else{if(16===gt){_t=bt+2;while(ct<_t){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}if(st>>>=bt,ct-=bt,0===n.have){t.msg="invalid bit length repeat",n.mode=q;break}Ct=n.lens[n.have-1],dt=3+(3&st),st>>>=2,ct-=2}else if(17===gt){_t=bt+3;while(ct<_t){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}st>>>=bt,ct-=bt,Ct=0,dt=3+(7&st),st>>>=3,ct-=3}else{_t=bt+7;while(ct<_t){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}st>>>=bt,ct-=bt,Ct=0,dt=11+(127&st),st>>>=7,ct-=7}if(n.have+dt>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=q;break}while(dt--)n.lens[n.have++]=Ct}}if(n.mode===q)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=q;break}if(n.lenbits=9,St={bits:n.lenbits},kt=s(l,n.lens,0,n.nlen,n.lencode,0,n.work,St),n.lenbits=St.bits,kt){t.msg="invalid literal/lengths set",n.mode=q;break}if(n.distbits=6,n.distcode=n.distdyn,St={bits:n.distbits},kt=s(u,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,St),n.distbits=St.bits,kt){t.msg="invalid distances set",n.mode=q;break}if(n.mode=U,e===f)break t;case U:n.mode=$;case $:if(at>=6&&ot>=258){t.next_out=rt,t.avail_out=ot,t.next_in=nt,t.avail_in=at,n.hold=st,n.bits=ct,o(t,ut),rt=t.next_out,et=t.output,ot=t.avail_out,nt=t.next_in,tt=t.input,at=t.avail_in,st=n.hold,ct=n.bits,n.mode===N&&(n.back=-1);break}for(n.back=0;;){if(At=n.lencode[st&(1<<n.lenbits)-1],bt=At>>>24,vt=At>>>16&255,gt=65535&At,bt<=ct)break;if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}if(vt&&0===(240&vt)){for(wt=bt,xt=vt,yt=gt;;){if(At=n.lencode[yt+((st&(1<<wt+xt)-1)>>wt)],bt=At>>>24,vt=At>>>16&255,gt=65535&At,wt+bt<=ct)break;if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}st>>>=wt,ct-=wt,n.back+=wt}if(st>>>=bt,ct-=bt,n.back+=bt,n.length=gt,0===vt){n.mode=Y;break}if(32&vt){n.back=-1,n.mode=N;break}if(64&vt){t.msg="invalid literal/length code",n.mode=q;break}n.extra=15&vt,n.mode=H;case H:if(n.extra){_t=n.extra;while(ct<_t){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}n.length+=st&(1<<n.extra)-1,st>>>=n.extra,ct-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=z;case z:for(;;){if(At=n.distcode[st&(1<<n.distbits)-1],bt=At>>>24,vt=At>>>16&255,gt=65535&At,bt<=ct)break;if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}if(0===(240&vt)){for(wt=bt,xt=vt,yt=gt;;){if(At=n.distcode[yt+((st&(1<<wt+xt)-1)>>wt)],bt=At>>>24,vt=At>>>16&255,gt=65535&At,wt+bt<=ct)break;if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}st>>>=wt,ct-=wt,n.back+=wt}if(st>>>=bt,ct-=bt,n.back+=bt,64&vt){t.msg="invalid distance code",n.mode=q;break}n.offset=gt,n.extra=15&vt,n.mode=W;case W:if(n.extra){_t=n.extra;while(ct<_t){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}n.offset+=st&(1<<n.extra)-1,st>>>=n.extra,ct-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=q;break}n.mode=G;case G:if(0===ot)break t;if(dt=ut-ot,n.offset>dt){if(dt=n.offset-dt,dt>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=q;break}dt>n.wnext?(dt-=n.wnext,ht=n.wsize-dt):ht=n.wnext-dt,dt>n.length&&(dt=n.length),ft=n.window}else ft=et,ht=rt-n.offset,dt=n.length;dt>ot&&(dt=ot),ot-=dt,n.length-=dt;do{et[rt++]=ft[ht++]}while(--dt);0===n.length&&(n.mode=$);break;case Y:if(0===ot)break t;et[rt++]=n.length,ot--,n.mode=$;break;case X:if(n.wrap){while(ct<32){if(0===at)break t;at--,st|=tt[nt++]<<ct,ct+=8}if(ut-=ot,t.total_out+=ut,n.total+=ut,ut&&(t.adler=n.check=n.flags?a(n.check,et,ut,rt-ut):i(n.check,et,ut,rt-ut)),ut=ot,(n.flags?st:it(st))!==n.check){t.msg="incorrect data check",n.mode=q;break}st=0,ct=0}n.mode=K;case K:if(n.wrap&&n.flags){while(ct<32){if(0===at)break t;at--,st+=tt[nt++]<<ct,ct+=8}if(st!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=q;break}st=0,ct=0}n.mode=Z;case Z:kt=p;break t;case q:kt=g;break t;case Q:return w;case J:default:return v}return t.next_out=rt,t.avail_out=ot,t.next_in=nt,t.avail_in=at,n.hold=st,n.bits=ct,(n.wsize||ut!==t.avail_out&&n.mode<q&&(n.mode<X||e!==d))&&pt(t,t.output,t.next_out,ut-t.avail_out)?(n.mode=Q,w):(lt-=t.avail_in,ut-=t.avail_out,t.total_in+=lt,t.total_out+=ut,n.total+=ut,n.wrap&&ut&&(t.adler=n.check=n.flags?a(n.check,et,ut,t.next_out-ut):i(n.check,et,ut,t.next_out-ut)),t.data_type=n.bits+(n.last?64:0)+(n.mode===N?128:0)+(n.mode===U||n.mode===P?256:0),(0===lt&&0===ut||e===d)&&kt===m&&(kt=x),kt)}function vt(t){if(!t||!t.state)return v;var e=t.state;return e.window&&(e.window=null),t.state=null,m}function gt(t,e){var n;return t&&t.state?(n=t.state,0===(2&n.wrap)?v:(n.head=e,e.done=!1,m)):v}function wt(t,e){var n,r,a,o=e.length;return t&&t.state?(n=t.state,0!==n.wrap&&n.mode!==L?v:n.mode===L&&(r=1,r=i(r,e,o,0),r!==n.check)?g:(a=pt(t,e,o,o),a?(n.mode=Q,w):(n.havedict=1,m))):v}n.inflateReset=st,n.inflateReset2=ct,n.inflateResetKeep=ot,n.inflateInit=ut,n.inflateInit2=lt,n.inflate=bt,n.inflateEnd=vt,n.inflateGetHeader=gt,n.inflateSetDictionary=wt,n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,e,n){var r=t("../utils/common"),i=15,a=852,o=592,s=0,c=1,l=2,u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,n,m,p,b,v,g){var w,x,y,C,k,S,_,A,I,T=g.bits,O=0,E=0,M=0,L=0,N=0,D=0,F=0,P=0,j=0,R=0,B=null,V=0,U=new r.Buf16(i+1),$=new r.Buf16(i+1),H=null,z=0;for(O=0;O<=i;O++)U[O]=0;for(E=0;E<m;E++)U[e[n+E]]++;for(N=T,L=i;L>=1;L--)if(0!==U[L])break;if(N>L&&(N=L),0===L)return p[b++]=20971520,p[b++]=20971520,g.bits=1,0;for(M=1;M<L;M++)if(0!==U[M])break;for(N<M&&(N=M),P=1,O=1;O<=i;O++)if(P<<=1,P-=U[O],P<0)return-1;if(P>0&&(t===s||1!==L))return-1;for($[1]=0,O=1;O<i;O++)$[O+1]=$[O]+U[O];for(E=0;E<m;E++)0!==e[n+E]&&(v[$[e[n+E]]++]=E);if(t===s?(B=H=v,S=19):t===c?(B=u,V-=257,H=d,z-=257,S=256):(B=h,H=f,S=-1),R=0,E=0,O=M,k=b,D=N,F=0,y=-1,j=1<<N,C=j-1,t===c&&j>a||t===l&&j>o)return 1;for(;;){_=O-F,v[E]<S?(A=0,I=v[E]):v[E]>S?(A=H[z+v[E]],I=B[V+v[E]]):(A=96,I=0),w=1<<O-F,x=1<<D,M=x;do{x-=w,p[k+(R>>F)+x]=_<<24|A<<16|I|0}while(0!==x);w=1<<O-1;while(R&w)w>>=1;if(0!==w?(R&=w-1,R+=w):R=0,E++,0===--U[O]){if(O===L)break;O=e[n+v[E]]}if(O>N&&(R&C)!==y){0===F&&(F=N),k+=M,D=O-F,P=1<<D;while(D+F<L){if(P-=U[D+F],P<=0)break;D++,P<<=1}if(j+=1<<D,t===c&&j>a||t===l&&j>o)return 1;y=R&C,p[y]=N<<24|D<<16|k-b|0}}return 0!==R&&(p[k+R]=O-F<<24|64<<16|0),g.bits=N,0}},{"../utils/common":41}],51:[function(t,e,n){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,e,n){var r=t("../utils/common"),i=4,a=0,o=1,s=2;function c(t){var e=t.length;while(--e>=0)t[e]=0}var l=0,u=1,d=2,h=3,f=258,m=29,p=256,b=p+1+m,v=30,g=19,w=2*b+1,x=15,y=16,C=7,k=256,S=16,_=17,A=18,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],M=512,L=new Array(2*(b+2));c(L);var N=new Array(2*v);c(N);var D=new Array(M);c(D);var F=new Array(f-h+1);c(F);var P=new Array(m);c(P);var j,R,B,V=new Array(v);function U(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}function $(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function H(t){return t<256?D[t]:D[256+(t>>>7)]}function z(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function W(t,e,n){t.bi_valid>y-n?(t.bi_buf|=e<<t.bi_valid&65535,z(t,t.bi_buf),t.bi_buf=e>>y-t.bi_valid,t.bi_valid+=n-y):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function G(t,e,n){W(t,n[2*e],n[2*e+1])}function Y(t,e){var n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}function X(t){16===t.bi_valid?(z(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}function K(t,e){var n,r,i,a,o,s,c=e.dyn_tree,l=e.max_code,u=e.stat_desc.static_tree,d=e.stat_desc.has_stree,h=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,m=e.stat_desc.max_length,p=0;for(a=0;a<=x;a++)t.bl_count[a]=0;for(c[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<w;n++)r=t.heap[n],a=c[2*c[2*r+1]+1]+1,a>m&&(a=m,p++),c[2*r+1]=a,r>l||(t.bl_count[a]++,o=0,r>=f&&(o=h[r-f]),s=c[2*r],t.opt_len+=s*(a+o),d&&(t.static_len+=s*(u[2*r+1]+o)));if(0!==p){do{a=m-1;while(0===t.bl_count[a])a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[m]--,p-=2}while(p>0);for(a=m;0!==a;a--){r=t.bl_count[a];while(0!==r)i=t.heap[--n],i>l||(c[2*i+1]!==a&&(t.opt_len+=(a-c[2*i+1])*c[2*i],c[2*i+1]=a),r--)}}}function Z(t,e,n){var r,i,a=new Array(x+1),o=0;for(r=1;r<=x;r++)a[r]=o=o+n[r-1]<<1;for(i=0;i<=e;i++){var s=t[2*i+1];0!==s&&(t[2*i]=Y(a[s]++,s))}}function q(){var t,e,n,r,i,a=new Array(x+1);for(n=0,r=0;r<m-1;r++)for(P[r]=n,t=0;t<1<<I[r];t++)F[n++]=r;for(F[n-1]=r,i=0,r=0;r<16;r++)for(V[r]=i,t=0;t<1<<T[r];t++)D[i++]=r;for(i>>=7;r<v;r++)for(V[r]=i<<7,t=0;t<1<<T[r]-7;t++)D[256+i++]=r;for(e=0;e<=x;e++)a[e]=0;t=0;while(t<=143)L[2*t+1]=8,t++,a[8]++;while(t<=255)L[2*t+1]=9,t++,a[9]++;while(t<=279)L[2*t+1]=7,t++,a[7]++;while(t<=287)L[2*t+1]=8,t++,a[8]++;for(Z(L,b+1,a),t=0;t<v;t++)N[2*t+1]=5,N[2*t]=Y(t,5);j=new U(L,I,p+1,b,x),R=new U(N,T,0,v,x),B=new U(new Array(0),O,0,g,C)}function Q(t){var e;for(e=0;e<b;e++)t.dyn_ltree[2*e]=0;for(e=0;e<v;e++)t.dyn_dtree[2*e]=0;for(e=0;e<g;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*k]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function J(t){t.bi_valid>8?z(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function tt(t,e,n,i){J(t),i&&(z(t,n),z(t,~n)),r.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}function et(t,e,n,r){var i=2*e,a=2*n;return t[i]<t[a]||t[i]===t[a]&&r[e]<=r[n]}function nt(t,e,n){var r=t.heap[n],i=n<<1;while(i<=t.heap_len){if(i<t.heap_len&&et(e,t.heap[i+1],t.heap[i],t.depth)&&i++,et(e,r,t.heap[i],t.depth))break;t.heap[n]=t.heap[i],n=i,i<<=1}t.heap[n]=r}function rt(t,e,n){var r,i,a,o,s=0;if(0!==t.last_lit)do{r=t.pending_buf[t.d_buf+2*s]<<8|t.pending_buf[t.d_buf+2*s+1],i=t.pending_buf[t.l_buf+s],s++,0===r?G(t,i,e):(a=F[i],G(t,a+p+1,e),o=I[a],0!==o&&(i-=P[a],W(t,i,o)),r--,a=H(r),G(t,a,n),o=T[a],0!==o&&(r-=V[a],W(t,r,o)))}while(s<t.last_lit);G(t,k,e)}function it(t,e){var n,r,i,a=e.dyn_tree,o=e.stat_desc.static_tree,s=e.stat_desc.has_stree,c=e.stat_desc.elems,l=-1;for(t.heap_len=0,t.heap_max=w,n=0;n<c;n++)0!==a[2*n]?(t.heap[++t.heap_len]=l=n,t.depth[n]=0):a[2*n+1]=0;while(t.heap_len<2)i=t.heap[++t.heap_len]=l<2?++l:0,a[2*i]=1,t.depth[i]=0,t.opt_len--,s&&(t.static_len-=o[2*i+1]);for(e.max_code=l,n=t.heap_len>>1;n>=1;n--)nt(t,a,n);i=c;do{n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],nt(t,a,1),r=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=r,a[2*i]=a[2*n]+a[2*r],t.depth[i]=(t.depth[n]>=t.depth[r]?t.depth[n]:t.depth[r])+1,a[2*n+1]=a[2*r+1]=i,t.heap[1]=i++,nt(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],K(t,e),Z(a,l,t.bl_count)}function at(t,e,n){var r,i,a=-1,o=e[1],s=0,c=7,l=4;for(0===o&&(c=138,l=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=e[2*(r+1)+1],++s<c&&i===o||(s<l?t.bl_tree[2*i]+=s:0!==i?(i!==a&&t.bl_tree[2*i]++,t.bl_tree[2*S]++):s<=10?t.bl_tree[2*_]++:t.bl_tree[2*A]++,s=0,a=i,0===o?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4))}function ot(t,e,n){var r,i,a=-1,o=e[1],s=0,c=7,l=4;for(0===o&&(c=138,l=3),r=0;r<=n;r++)if(i=o,o=e[2*(r+1)+1],!(++s<c&&i===o)){if(s<l)do{G(t,i,t.bl_tree)}while(0!==--s);else 0!==i?(i!==a&&(G(t,i,t.bl_tree),s--),G(t,S,t.bl_tree),W(t,s-3,2)):s<=10?(G(t,_,t.bl_tree),W(t,s-3,3)):(G(t,A,t.bl_tree),W(t,s-11,7));s=0,a=i,0===o?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4)}}function st(t){var e;for(at(t,t.dyn_ltree,t.l_desc.max_code),at(t,t.dyn_dtree,t.d_desc.max_code),it(t,t.bl_desc),e=g-1;e>=3;e--)if(0!==t.bl_tree[2*E[e]+1])break;return t.opt_len+=3*(e+1)+5+5+4,e}function ct(t,e,n,r){var i;for(W(t,e-257,5),W(t,n-1,5),W(t,r-4,4),i=0;i<r;i++)W(t,t.bl_tree[2*E[i]+1],3);ot(t,t.dyn_ltree,e-1),ot(t,t.dyn_dtree,n-1)}function lt(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return a;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return o;for(e=32;e<p;e++)if(0!==t.dyn_ltree[2*e])return o;return a}c(V);var ut=!1;function dt(t){ut||(q(),ut=!0),t.l_desc=new $(t.dyn_ltree,j),t.d_desc=new $(t.dyn_dtree,R),t.bl_desc=new $(t.bl_tree,B),t.bi_buf=0,t.bi_valid=0,Q(t)}function ht(t,e,n,r){W(t,(l<<1)+(r?1:0),3),tt(t,e,n,!0)}function ft(t){W(t,u<<1,3),G(t,k,L),X(t)}function mt(t,e,n,r){var a,o,c=0;t.level>0?(t.strm.data_type===s&&(t.strm.data_type=lt(t)),it(t,t.l_desc),it(t,t.d_desc),c=st(t),a=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=a&&(a=o)):a=o=n+5,n+4<=a&&-1!==e?ht(t,e,n,r):t.strategy===i||o===a?(W(t,(u<<1)+(r?1:0),3),rt(t,L,N)):(W(t,(d<<1)+(r?1:0),3),ct(t,t.l_desc.max_code+1,t.d_desc.max_code+1,c+1),rt(t,t.dyn_ltree,t.dyn_dtree)),Q(t),r&&J(t)}function pt(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(F[n]+p+1)]++,t.dyn_dtree[2*H(e)]++),t.last_lit===t.lit_bufsize-1}n._tr_init=dt,n._tr_stored_block=ht,n._tr_flush_block=mt,n._tr_tally=pt,n._tr_align=ft},{"../utils/common":41}],53:[function(t,e,n){function r(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=r},{}],54:[function(t,e,n){e.exports="function"===typeof setImmediate?setImmediate:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)}},{}]},{},[10])(10)}));var s=window.JSZip;window.JSZip=null;try{delete window.JSZip}catch(c){}}).call(this,n("fd40").Buffer,n("2409"),n("2ffc")(t))},b1a7:function(t,e,n){},b1fd:function(t,e,n){},b334:function(t,e,n){"use strict";n("8cf1")},b3a7:function(t,e,n){},b470:function(t,e,n){},b4bc:function(t,e,n){},b6d9:function(t,e,n){"use strict";n("0868")},b78c:function(t,e,n){},b819:function(t,e,n){},b90c:function(t,e,n){"use strict";n("0676")},bb48:function(t,e,n){},bb7b:function(t,e,n){},bc8f:function(t,e,n){"use strict";n.d(e,"g",(function(){return a})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"e",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"d",(function(){return d}));n("e125"),n("25e4"),n("fff2"),n("e47f"),n("872d");var r=n("fe80"),i=n("80f5"),a=function(t){var e,n,i,a;if("number"===typeof t&&!isNaN(t)&&isFinite(t)){i=t%256;var o=r["a"].div(r["a"].sub(t,i),256);n=o%256,o=r["a"].div(r["a"].sub(o,n),256),e=o%256,o=r["a"].div(r["a"].sub(o,e),256),a=o%256}else e=n=i=a=255;var s=r["a"].div(a,255);return s=r["a"].div(Math.round(r["a"].mul(s,100)),100),{r:e,g:n,b:i,a:a,opacity:s,hexa:"#".concat(e.toString(16).padStart(2,"0")).concat(n.toString(16).padStart(2,"0")).concat(i.toString(16).padStart(2,"0")).concat(a.toString(16).padStart(2,"0")),value:"rgba(".concat(e,", ").concat(n,", ").concat(i,", ").concat(s,")"),type:"rgba"}},o=function(t){if("string"!==typeof t||9!==t.length||"#"!==t[0])return t;var e=parseInt(t.substr(1,2),16),n=parseInt(t.substr(3,2),16),r=parseInt(t.substr(5,2),16),i=parseInt(t.substr(7,2),16);return s(e,n,r,i)},s=function(t,e,n,i){var a=r["a"].mul(i,16777216);return a=r["a"].add(a,r["a"].mul(t,65536)),a=r["a"].add(a,r["a"].mul(e,256)),a=r["a"].add(a,n),a},c=function(t){if(Object(i["o"])(t))return{value:"#".concat(t.r.toString(16).padStart(2,"0")).concat(t.g.toString(16).padStart(2,"0")).concat(t.b.toString(16).padStart(2,"0")),a:t.a,opacity:null!=t.opacity?t.opacity:r["a"].div(t.a,255),type:"hex"}},l=function(t){if(Object(i["o"])(t))return{value:"#".concat(t.a.toString(16).padStart(2,"0")).concat(t.r.toString(16).padStart(2,"0")).concat(t.g.toString(16).padStart(2,"0")).concat(t.b.toString(16).padStart(2,"0")),type:"ahex"}},u=function(t){if(Object(i["o"])(t))return{value:"#".concat(t.r.toString(16).padStart(2,"0")).concat(t.g.toString(16).padStart(2,"0")).concat(t.b.toString(16).padStart(2,"0")).concat(t.a.toString(16).padStart(2,"0")),type:"hexa"}},d=function(t){var e=t.r,n=t.g,i=t.b;e/=255,n/=255,i/=255;var a,o,s=Math.max(e,n,i),c=Math.min(e,n,i),l=(s+c)/2;if(s==c)a=o=0;else{var u=s-c;switch(o=l>.5?u/(2-s-c):u/(s+c),s){case e:a=(n-i)/u+(n<i?6:0);break;case n:a=(i-e)/u+2;break;case i:a=(e-n)/u+4;break}a/=6}a=Math.round(r["a"].mul(a,360)),o=Math.round(r["a"].mul(o,100)),l=Math.round(r["a"].mul(l,100));var d=null!=t.opacity?t.opacity:r["a"].div(t.a,255);return d=r["a"].div(Math.round(r["a"].mul(d,100)),100),{h:a,s:r["a"].div(o,100),l:r["a"].div(l,100),a:t.a,opacity:d,value:"hsla(".concat(a,", ").concat(o,"%, ").concat(l,"%, ").concat(d,")"),type:"hsla"}}},be43:function(t,e,n){"use strict";n("e99a")},bead:function(t,e,n){"use strict";n("07aa")},bed8:function(t,e,n){},c018:function(t,e,n){},c0e6:function(t,e,n){"use strict";n("dde3")},c0ee:function(t,e,n){"use strict";n("1a31")},c58d:function(t,e,n){},c817:function(t,e,n){"use strict";n("494d")},c93f:function(t,e,n){"use strict";n("231b")},cae1:function(t,e,n){"use strict";n("9584")},cbf8:function(t,e,n){"use strict";n("b1a7")},cc8f:function(t,e,n){"use strict";n("32f2")},cd55:function(t,e,n){"use strict";n("2e5e")},cdb1:function(t,e,n){},d1af:function(t,e,n){"use strict";n("9f03")},d1e7:function(t,e,n){"use strict";n("2a9c")},d3de:function(t,e,n){"use strict";n("bed8")},d3fa:function(t,e,n){},d60d:function(t,e,n){},d7d3:function(t,e,n){"use strict";n("b470")},d914:function(t,e,n){},d932:function(t,e,n){},da20:function(t,e,n){},db03:function(t,e,n){"use strict";n("b819")},db1a:function(t,e,n){"use strict";n("222e")},dd35:function(t,e,n){"use strict";n("427a")},dde3:function(t,e,n){},df8b:function(t,e,n){},e135:function(t,e,n){"use strict";n("1a83")},e138:function(t,e,n){"use strict";n("549b")},e3c5:function(t,e,n){},e44e:function(t,e,n){},e5cd:function(t,e,n){"use strict";n("bb48")},e94e:function(t,e,n){},e96f:function(t,e,n){"use strict";n("9cf0")},e99a:function(t,e,n){},e9d1:function(t,e,n){"use strict";n("09b4")},ea39:function(t,e,n){},ea6b:function(t,e,n){"use strict";n("4f19")},ea6e:function(t,e,n){"use strict";n("1429")},eba2:function(t,e,n){"use strict";n("6cd5")},ed17:function(t,e,n){"use strict";n("8292")},edcd:function(t,e,n){},f004:function(t,e,n){"use strict";n("d914")},f064:function(t,e,n){},f3ef:function(t,e,n){},f414:function(t,e,n){"use strict";n("34d9")},f4c4:function(t,e,n){"use strict";n("0429")},f70e:function(t,e,n){"use strict";n("8680")},f73c:function(t,e,n){"use strict";n("3e62")},f7a7:function(t,e,n){"use strict";n("bb7b")},f963:function(t,e,n){"use strict";n("e44e")},fa7d:function(t,e,n){"use strict";n.r(e),n.d(e,"SERVER_HOST",(function(){return b})),n.d(e,"OUTPUT_CLOUD_HOST",(function(){return v})),n.d(e,"OUTPUT_CLOUD_HOST_URL",(function(){return g})),n.d(e,"OUTPU_CLOUD_API_DEVPATH",(function(){return w})),n.d(e,"MobileDesignWidth",(function(){return x})),n.d(e,"threadSleep",(function(){return y})),n.d(e,"globalData",(function(){return C})),n.d(e,"listImageLoader",(function(){return k})),n.d(e,"getUnitTemplate",(function(){return S})),n.d(e,"getCustomPlatform",(function(){return _})),n.d(e,"localeCompareString",(function(){return A})),n.d(e,"getScalePathKey",(function(){return I})),n.d(e,"getStringByteLength",(function(){return T})),n.d(e,"isVaildNickName",(function(){return O})),n.d(e,"getArtboardsMaxRect",(function(){return E})),n.d(e,"calculateTriangleAngle",(function(){return M})),n.d(e,"rndHexString",(function(){return L})),n.d(e,"fixedLinkedResUrl",(function(){return N})),n.d(e,"hadExportPng",(function(){return D})),n.d(e,"hadExportWebP",(function(){return F})),n.d(e,"hadExportSvg",(function(){return P})),n.d(e,"downloadRes",(function(){return j})),n.d(e,"downloadOnePngAndCloverJpg",(function(){return R})),n.d(e,"downloadOnePng",(function(){return V})),n.d(e,"checkSupportFileProtocol",(function(){return $})),n.d(e,"fetchPng",(function(){return H})),n.d(e,"getNodeShowName",(function(){return X})),n.d(e,"getDownloadName",(function(){return K})),n.d(e,"getSafePathName",(function(){return q})),n.d(e,"goCloudFolderUrl",(function(){return Q})),n.d(e,"getNodeCustomName",(function(){return J})),n.d(e,"setNodeCustomName",(function(){return tt})),n.d(e,"getLocalStorage",(function(){return et})),n.d(e,"setLocalStorage",(function(){return nt})),n.d(e,"removeLocalStorage",(function(){return rt})),n.d(e,"getSessionStorage",(function(){return it})),n.d(e,"setSessionStorage",(function(){return at})),n.d(e,"removeSessionStorage",(function(){return ot})),n.d(e,"queryString",(function(){return st})),n.d(e,"SCENENODE_BLEND_MODE",(function(){return ct})),n.d(e,"copyValueFromText",(function(){return lt})),n.d(e,"copyValueFromSelect",(function(){return ut})),n.d(e,"onlyUseConsoleAssignObject",(function(){return dt})),n.d(e,"deepClone",(function(){return ht})),n.d(e,"decimalNumber",(function(){return ft})),n.d(e,"getNumberOrDefault",(function(){return mt})),n.d(e,"getRootGroupFillColor",(function(){return pt})),n.d(e,"getTintColor",(function(){return bt})),n.d(e,"EnumMarkLionUserState",(function(){return vt})),n.d(e,"getMarkLionUserState",(function(){return gt})),n.d(e,"data2String",(function(){return wt})),n.d(e,"string2Data",(function(){return xt})),n.d(e,"base64ToUint8Array",(function(){return yt})),n.d(e,"compareVersion",(function(){return kt})),n.d(e,"getPixelRatio",(function(){return St})),n.d(e,"FetchState",(function(){return _t})),n.d(e,"transformPcSize",(function(){return At})),n.d(e,"numberToUint32",(function(){return It})),n.d(e,"strToUtf8ArrayBuffer",(function(){return Tt})),n.d(e,"combineArrayBuffer",(function(){return Ot})),n.d(e,"isWebViewHidden",(function(){return Lt})),n.d(e,"htmlEncode",(function(){return Nt})),n.d(e,"splitKeywordText",(function(){return Dt})),n.d(e,"isRelativeUrl",(function(){return Ft})),n.d(e,"initMobileMeta",(function(){return Rt})),n.d(e,"disableMultiTouch",(function(){return Bt}));var r=n("d941"),i=n("182c"),a=n("c3ae"),o=(n("e47f"),n("1b2e"),n("b24a"),n("35e9"),n("c4e2"),n("0879"),n("266c"),n("7e9b"),n("872d"),n("f6b3"),n("02f0"),n("9862"),n("f728"),n("6a04"),n("6307"),n("25e4"),n("cb12"),n("19f9"),n("a8db"),n("8c15"),n("0bfb"),n("f1ee"),n("4e1a"),n("2baf"),n("a858"),n("6f12"),n("ea28"),n("a146"),n("08ab"),n("3bf3"),n("5d7f"),n("fa9a"),n("12b2"),n("a9c6"),n("33ef"),n("d437"),n("d466"),n("ff52"),n("d449"),n("86c4"),n("d3d2"),n("abf7"),n("0985"),n("a0fe"),n("395d"),n("8d7e"),n("5a19"),n("a685"),n("d1ce"),n("e1a5"),n("c600"),n("8e39"),n("09ae"),n("e9c4"),n("bc8f")),s=n("80f5"),c=n("08f3"),l=n("c15f"),u=n("a35b"),d=n("1554"),h=(n("4b74"),n("b2e3"),n("e099"),"function"===typeof createImageBitmap),f="function"===typeof Image,m=function(){function t(){Object(l["a"])(this,t),Object(d["a"])(this,"queue",[]),Object(d["a"])(this,"runningCount",0),Object(d["a"])(this,"runningMax",10),Object(d["a"])(this,"_paused",!1)}return Object(u["a"])(t,[{key:"canNext",get:function(){return!this.paused&&(this.runningCount<this.runningMax&&this.queue.length>0)}},{key:"paused",get:function(){return this._paused},set:function(t){if(this._paused=!!t,!this._paused)for(var e=0;e<this.runningMax-this.runningCount;e++)this.run()}},{key:"run",value:function(){var t=Object(a["a"])(Object(r["a"])().mark((function t(){var e,n,i,a,o,s,c=this;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.canNext){t.next=2;break}return t.abrupt("return");case 2:if(e=this.queue.splice(0,1)[0],e){t.next=5;break}return t.abrupt("return");case 5:if(0!==e.list.length){t.next=8;break}return this.run(),t.abrupt("return");case 8:if(this.runningCount++,n=function(t){c.runningCount--;var n=e.list;n&&0!==n.length&&(n.forEach((function(e){try{e.callback(t,e.state)}catch(n){}})),c.run())},t.prev=10,!f){t.next=18;break}i=new Image,i.onerror=function(){n(null)},i.onload=function(t){n(t.target)},i.src=e.src,t.next=33;break;case 18:if(!h){t.next=32;break}return t.next=21,fetch(e.src);case 21:return a=t.sent,t.next=24,a.blob();case 24:return o=t.sent,t.next=27,createImageBitmap(o);case 27:s=t.sent,o=null,n(s),t.next=33;break;case 32:n(null);case 33:t.next=38;break;case 35:t.prev=35,t.t0=t["catch"](10),n(null);case 38:case"end":return t.stop()}}),t,this,[[10,35]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"add",value:function(t,e,n){if(!t)return e(null,n);var r=this._get(t);if(!r)return r={src:t,list:[{callback:e,state:n}]},this.queue.push(r),void this.run();var i=r.list.findIndex((function(t){return e===t.callback&&t.state===n}));-1===i&&(r.list.push({callback:e,state:n}),this.run())}},{key:"remove",value:function(t,e,n){if(t){var r=this._get(t);if(r){var i=r.list.findIndex((function(t){return e===t.callback&&t.state===n}));-1!==i&&r.list.splice(i,1)}}}},{key:"_get",value:function(t){return this.queue.find((function(e){return e.src===t}))}},{key:"clean",value:function(){this.runningCount=0,this.queue.splice(0)}}]),t}(),p=n("30be"),b="https://user.marklion.cn/",v="",g="",w=s["a"]?"/cloudapi":"",x=375,y=function(t){return new Promise((function(e){setTimeout((function(){e()}),t||0)}))},C={documentName:"",documentGuid:"",config:null,inCloudMode:!1,cloudFolderId:0,initTitle:"",fileType:c["h"].XD,cloudVersion:"",docsMinScale:{}},k=new m;s["a"]&&(window.listImageLoader=k,window.globalData=C);var S=function(t){var e=et("unittemplate.".concat(t),!0);return Object(s["o"])(e)||(e={enable:!1,template:"rem(%num%)"}),e.fromInited=!0,e.guid=t,e},_=function(t,e){var n=et("platform.".concat(t),!0);return Object(s["o"])(n)||(n={},n.type=e),n.fromInited=!0,n.guid=t,n},A=function(t,e){return(null!==t&&void 0!==t?t:"").localeCompare(null!==e&&void 0!==e?e:"",["zh"],{numeric:!0,caseFirst:"upper"})},I=function(t){return 1==t?"":"@".concat(t,"x")},T=function(t){if(null==t)return 0;try{return t.replace(/[^\u0020-\u00ff]/g,"aa").length}catch(e){return 0}},O=function(t){var e=T(t);return!!(e>=5&&e<=20&&/^[a-zA-Z\u4e00-\u9fa5][\w\u4e00-\u9fa5-]{1,19}$/.test(t))};function E(t){var e=t[t.length-1];if(!e)return new p["a"];var n=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;t.forEach((function(t){var e=t.artboard.boundsInParentForList||t.artboard.boundsInParent||t.artboard.frame;n=Math.min(e.x,n),r=Math.min(e.y,r),i=Math.max(e.x+e.width,i),a=Math.max(e.y+e.height,a)}));var o=new p["a"];return o.x=n,o.y=r,o.width=i-n,o.height=a-r,o}function M(t,e){var n=t.x,r=t.y,i=e.x,a=e.y;if(n===i)return r>=a?270:90;if(r===a)return n>=i?0:180;var o=180*Math.atan2(a-r,i-n)/Math.PI;return o=Math.round(100*(180-o))/100,360===o&&(o=0),o}function L(){return Math.random().toString(16).substring(2)}function N(t,e,n){if(!t)return e+n;var r=t.mlConfig.linked;if(!Object(s["o"])(r))return e+n;var i=r[n.toLowerCase()];return i?C.inCloudMode?i:e+i:e+n}var D=function(t){if(!Object(s["o"])(t))return!1;var e,n=t.mlConfig;return e=Object(s["o"])(n)&&null!=n.resType?n.resType:c["t"].PNG,(e&c["t"].PNG)===c["t"].PNG},F=function(t){if(!Object(s["o"])(t))return!1;var e=t.mlConfig;return!!Object(s["o"])(e)&&(e.resType&c["t"].WEBP)===c["t"].WEBP},P=function(t){if(!Object(s["o"])(t))return!1;var e=t.mlConfig;return!!Object(s["o"])(e)&&(e.resType&c["t"].SVG)===c["t"].SVG};function j(t,e){var n,r;"string"===typeof e?n=e:(n=URL.createObjectURL(e),r=!0);var i=document.createElement("a");i.href=n,i.style.cssText+="width:0!important;height:0!important;overflow:hidden!important;position: absolute!important;opacity:0!important;top:0!important;left:0!important;",i.download=t,i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i),i=null,r&&URL.revokeObjectURL(n),n=null}function R(t,e,n){return B.apply(this,arguments)}function B(){return B=Object(a["a"])(Object(r["a"])().mark((function t(e,n,i){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,H(n,null);case 2:return a=t.sent,t.next=5,i(a);case 5:return a=t.sent,j(e,a),t.abrupt("return","success");case 8:case"end":return t.stop()}}),t)}))),B.apply(this,arguments)}function V(t,e,n){return U.apply(this,arguments)}function U(){return U=Object(a["a"])(Object(r["a"])().mark((function t(e,n,i){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,H(n,i);case 2:return a=t.sent,"string"===typeof a&&(a="data:application/octet-stream;base64,"+a),j(e,a),t.abrupt("return","success");case 6:case"end":return t.stop()}}),t)}))),U.apply(this,arguments)}function $(t){if(s["b"]&&!t.mlConfig.supportFileProtocol)throw"画板(".concat(t.name,")导出时[选择导出包支持范围]选择了[精简版];需要部署到HTTP服务上才支持下载切图,请自行前往res目录拷贝切图");return!0}function H(t,e){return z.apply(this,arguments)}function z(){return z=Object(a["a"])(Object(r["a"])().mark((function t(e,n){var i,a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!s["b"]){t.next=4;break}return t.next=3,Y(n);case 3:return t.abrupt("return",t.sent);case 4:return i={},C.inCloudMode&&(i.cache="reload"),t.next=8,fetch(e,i);case 8:return a=t.sent,t.next=11,a.blob();case 11:return t.abrupt("return",t.sent);case 12:case"end":return t.stop()}}),t)}))),z.apply(this,arguments)}var W={},G=1;function Y(t){return new Promise((function(e,n){var r=document.createElement("script"),i=function(t){t&&null!=t.parentNode&&setTimeout((function(){t&&null!=t.parentNode&&(t.parentNode.removeChild(t),t=null)}),200)};r._marklionBack=function(t,a){r._marklionBack=null,r._marklionCallId=null,t?e(a):n(a),i(r),r=null},r.addEventListener("error",(function(e){var n=e.target._marklionBack;n&&n(!1,"资源加载失败[".concat(t,"]"))})),r.addEventListener("load",(function(t){i(t.target)}));var a="marklion_".concat(Date.now(),"_").concat(G++);r._marklionCallId=a,r.src=t+"?marklion_res_id="+a,W[a]=r._marklionBack,document.body.appendChild(r)}))}window.marklion_res=function(t,e){if(null!=t){var n=t._marklionBack,r=t._marklionCallId;n&&r&&(t._marklionBack=null,t._marklionCallId=null,W[r]=null,n(!0,e))}},window.addEventListener("error",(function(t){var e=t.filename;if(e){var n=e.match(/marklion_res_id=(\w+)/);if(n&&(n=n[1],n)){e=e.replace(/\\/g,"/");var r=e.indexOf("/res/");-1!==r&&(e=e.substr(r+1)),r=e.indexOf("?"),-1!==r&&(e=e.substr(0,r)),e=decodeURIComponent(e);var i=W[n];i&&i(!1,"资源加载失败[".concat(e,"]"))}}}),!0);var X=function(t){if(!t)return null;var e=t.mlCustomName;return e||(e=t.name),e},K=function(t,e,n){var r;switch(n){case c["t"].WEBP:r=".webp";break;case c["t"].JPG:r=".jpg";break;default:r=".png";break}return 1===t||"1"===t?e+r:"".concat(e,"@").concat(t,"x").concat(r)},Z=/[\s\\/$:*?"'<>|\0]/g,q=function(t){if(Object(s["h"])(t)){t=t.replace(Z,(function(t){return" "===t?t:""})).trim();var e=50;return t.length>e&&(t=t.substr(0,e)),t}return null},Q=function(t){var e="/viewer/".concat(t,"/");window.location.href=e},J=function(t){if(Object(s["o"])(t)){var e=t.guid;if(e)if(t.markedForExport){var n="".concat(C.documentGuid,"_").concat(e),r=et(n,!1);t.mlCustomName=q(r)}else t.mlCustomName=null}},tt=function(t,e,n){if(Object(s["o"])(e)&&e.markedForExport){var r=e.guid;if(r){var i="".concat(C.documentGuid,"_").concat(r);if(n=q(n),e.mlCustomName!==n){if(Object(s["h"])(n)&&n!==e.name)return t.$set(e,"mlCustomName",n),void nt(i,n);t.$set(e,"mlCustomName",null),rt(i)}}}},et=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var n=localStorage.getItem("marklion."+t);if(!Object(s["h"])(n))return n;if(!e)return n;try{n=JSON.parse(n)}catch(r){}return n}catch(i){return null}},nt=function(t,e){try{"string"!==typeof e&&(e=JSON.stringify(e)),localStorage.setItem("marklion."+t,e)}catch(n){}},rt=function(t){try{return localStorage.removeItem("marklion."+t)}catch(e){}},it=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var n=sessionStorage.getItem("marklion."+t);if(!Object(s["h"])(n))return n;if(!e)return n;try{n=JSON.parse(n)}catch(r){}return n}catch(i){return null}},at=function(t,e){try{"string"!==typeof e&&(e=JSON.stringify(e)),sessionStorage.setItem("marklion."+t,e)}catch(n){}},ot=function(t){try{return sessionStorage.removeItem("marklion."+t)}catch(e){}},st=function(t,e,n){var r,i,a,o,s="";null==n?(n=window.location.href,i="#"==e?n.split("#"):n.split("#")[0].split("?"),r=1==i.length?"":i[1]):r=n;if(""!=r){a=r.split("&");var c=a.length;o=t+"=";for(var l=0;l<c;l++)if(0==a[l].indexOf(o)){s=a[l].replace(o,"");break}}return decodeURIComponent(s)},ct={NORMAL:"normal",PASSTHROUGH:"pass-through",MULTIPLY:"multiply",DARKEN:"darken",COLOR_BURN:"color-burn",LIGHTEN:"lighten",SCREEN:"screen",COLOR_DODGE:"color-dodge",OVERLAY:"overlay",SOFT_LIGHT:"soft-light",HARD_LIGHT:"hard-light",DIFFERENCE:"difference",EXCLUSION:"exclusion",HUE:"hue",SATURATION:"saturation",COLOR:"color",LUMINOSITY:"luminosity"};function lt(t){try{if(document.execCommand){var e=document.createElement("textarea");e.style.cssText="position:absolute;left:-1000px;top:-1000px;width:50px;height:10px;background:none;border:none;opacity:0.01;z-index:99999;",e.value=t,document.body.appendChild(e),e.focus(),e.select();var n=document.execCommand("copy");return setTimeout((function(){e.parentNode.removeChild(e)}),0),n}if(window.clipboardData)return window.clipboardData.setData("Text",t),!0}catch(r){return!1}return!1}function ut(t){try{if(document.execCommand)return document.execCommand("copy");if(window.clipboardData)return window.clipboardData.setData("Text",t),!0}catch(e){return!1}return!1}var dt=function(t){return JSON.parse(JSON.stringify(t))},ht=function t(e){if(void 0===e||null===e)return e;if("object"!==Object(i["a"])(e))return e;var n={};for(var r in e){var a=e[r];if(void 0!==a&&null!==a){var o=Object(i["a"])(a);"object"===o?Object(s["g"])(a)?n[r]=a.map((function(e){return t(e)})):n[r]=t(a):n[r]="function"===o?a.bind(n):a}else n[r]=a}return n},ft=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=10*e;return Math.round(t*n)/n},mt=function(t,e){return"number"===typeof t?t:e},pt=function(t){var e;while(t){var n=t.types;if(1===n.Group)if(t.fillEnabled)if(t.fill){var r=t.fill.value;null!=r&&(e=r),t=t.parentNode}else t=t.parentNode;else t=t.parentNode;else t=t.parentNode}if(e)return Object(o["g"])(e)},bt=function(t,e){if(null==t)return e;if(null==e)return e;var n=Object(o["g"])(e),r=Math.round(n.a*t.a/255);return Object(o["b"])(t.r,t.g,t.b,r)},vt={NOT_APP:-1,NOT_LOGIN:0,LOGINED:1},gt=function(){return new Promise((function(t){var e,n=!1,r=function(){clearTimeout(e),n||(n=!0,t(vt.NOT_APP))};fetch("http://127.0.0.1:23456/appstate.marklion",{method:"get"}).then((function(n){n.text().then((function(n){switch(clearTimeout(e),n){case"1":return t(vt.LOGINED);case"0":return t(vt.NOT_LOGIN);default:return t(vt.NOT_APP)}})).catch(r)})).catch(r),e=setTimeout((function(){t(vt.NOT_APP)}),500)}))};s["a"]&&(window.getMarkLionUserState=gt);var wt=function(t){if(void 0!==t){if(null===t)return null;var e=Object(i["a"])(t);switch(e){case"string":case"number":case"boolean":return t;case"function":return"[object Function]";default:var n=Object.prototype.toString.call(t);return 0===n.indexOf("[object HTML")||"[object Window]"===n||"[object global]"===n?n:JSON.stringify(t)}}},xt=function(t){if(void 0!=t){if(null===t)return null;var e=Object(i["a"])(t);switch(e){case"string":var n;try{n=JSON.parse(t)}catch(r){n=t}return n;default:return t}}};function yt(t){for(var e=atob(t),n=e.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=e.charCodeAt(i);return r}var Ct=/^\d{1,7}(\.\d{1,7})*$/i,kt=function(t,e){if("string"!==typeof t)return!1;if("string"!==typeof e)return!0;if(!Ct.test(t))return!1;if(!Ct.test(e))return!0;t=t.split("."),e=e.split(".");var n=t.length,r=e.length;if(n>r){for(var i=r;i<n;i++)e.push("0");r=n}else if(n<r){for(var a=n;a<r;a++)t.push("0");n=r}for(var o=0;o<n;o++){var s=parseInt(t[o]),c=parseInt(e[o]);if(s>c)return!0;if(s<c)return!1}return!0},St=function(){return window.devicePixelRatio||1},_t={Normal:0,Fetching:1,Error:2,Success:3},At=function(t){return"number"!==typeof t?t:t<1024?"".concat(t,"B"):t<1048576?"".concat((t/1024).toFixed(2),"KB"):t<1073741824?"".concat((t/1048576).toFixed(2),"MB"):t<1099511627776?"".concat((t/1073741824).toFixed(2),"GB"):"".concat((t/1099511627776).toFixed(2),"TB")};function It(t){for(var e=new Uint8Array(4),n=0;n<4;n++){var r=t%256;if(e[n]=r,t-=r,t<=0)break;t/=256}return e}function Tt(t){for(var e,n=new Array,r=0,i=t.length;r<i;r++)e=t.charCodeAt(r),e>=65536&&e<=1114111?(n.push(e>>18&7|240),n.push(e>>12&63|128),n.push(e>>6&63|128),n.push(63&e|128)):e>=2048&&e<=65535?(n.push(e>>12&15|224),n.push(e>>6&63|128),n.push(63&e|128)):e>=128&&e<=2047?(n.push(e>>6&31|192),n.push(63&e|128)):n.push(255&e);return new Uint8Array(n).buffer}function Ot(t){return new Blob(t)}function Et(){var t=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var e=0;e<t.length;e++)if(t[e]+"Hidden"in document)return t[e]+"Hidden";return null}function Mt(){var t=["webkit","moz","ms","o"];if("visibilityState"in document)return"visibilityState";for(var e=0;e<t.length;e++)if(t[e]+"VisibilityState"in document)return t[e]+"VisibilityState";return null}function Lt(){var t=Mt();return null!==t?"visible"!=document[t]:(t=Et(),!!t&&document[t])}function Nt(t){return Object(s["h"])(t)?t:/[<> ]/gi.replace((function(t){switch(t){case" ":return"&nbsp;";case"<":return"&lt;";case">":return"&gt;"}return t}))}function Dt(t,e){var n=[];if(Object(s["h"])(t)&&Object(s["h"])(e)){var r=-1,i=t.toLowerCase(),a=e.toLowerCase(),o=[];while(-1!=(r=i.indexOf(a,r+1)))o.push(r);var c=a.length,l=0;o.forEach((function(e){e>l&&n.push({light:!1,text:t.substr(l,e-l)}),n.push({light:!0,text:t.substr(e,c)}),l=e+c})),l<t.length&&n.push({light:!1,text:t.substr(l)})}else n.push({text:"",light:!1});return n}var Ft=function(t){return"string"===typeof t&&!/^(((https?|file):)?\/)?\//i.test(t)};function Pt(t,e,n){var r="meta",i=document.querySelector("".concat(r,"[name='").concat(e,"']")),a=!i;a&&(i=document.createElement(r),i.setAttribute("name",e)),i.setAttribute("content",n),a&&t.appendChild(i)}function jt(t,e,n,r){var i,a="link";r?(i=[],Object.keys(r).forEach((function(t){i.push("[".concat(t,"='").concat(r[t],"']"))})),i=i.join("")):i="";var o=document.querySelector("".concat(a,"[rel='").concat(e,"']").concat(i)),s=!o;s&&(o=document.createElement(a),o.setAttribute("rel",e),r&&Object.keys(r).forEach((function(t){o.setAttribute(t,r[t])}))),o.setAttribute("href",n),s&&t.appendChild(o)}function Rt(t){if(s["e"]){var e=document.head;e||(e=document.querySelector("head")),e||(e=document.body),Pt(e,"viewport","width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,minimal-ui,viewport-fit=cover,user-scalable=no"),Pt(e,"apple-mobile-web-app-capable","yes"),Pt(e,"mobile-web-app-capable","yes"),Pt(e,"apple-mobile-web-app-status-bar-style","black-translucent"),Pt(e,"apple-touch-fullscreen","yes"),Pt(e,"webkit","renderer");var n=t?"/favicon_interaction.png":"/favicon.ico";jt(e,"icon",n),jt(e,"apple-touch-icon",n,{sizes:"64x64"}),jt(e,"apple-touch-icon",n,{sizes:"128x128"}),jt(e,"apple-touch-icon",n,{sizes:"256x256"});var r=document.documentElement;r.classList.add("i-mobile"),s["f"]&&r.classList.add("i-mobile-safari-standalone")}}function Bt(){s["e"]&&document.documentElement.addEventListener("touchstart",(function(t){t.touches.length>1&&t.preventDefault()}),{passive:!1})}},fc08:function(t,e,n){},fc14:function(t,e,n){},fc3e:function(t,e,n){"use strict";n("9397")},fe80:function(t,e,n){"use strict";n("1b2e"),n("a8db"),n("e47f"),n("872d"),n("0879"),n("b24a");e["a"]={add:function(t,e){if("undefined"==typeof t||"undefined"==typeof e||null==t||null==e)return NaN;var n=0,r=0,i=1;try{n=t.toString().split(".")[1].length}catch(a){}try{r=e.toString().split(".")[1].length}catch(a){}return i=Math.pow(10,Math.max(n,r)),(this.mul(t,i)+this.mul(e,i))/i},sub:function(t,e){if("undefined"==typeof t||"undefined"==typeof e||null==t||null==e)return NaN;var n=0,r=0,i=1;try{n=t.toString().split(".")[1].length}catch(a){}try{r=e.toString().split(".")[1].length}catch(a){}return i=Math.pow(10,Math.max(n,r)),(this.mul(t,i)-this.mul(e,i))/i},mul:function(t,e){if("undefined"==typeof t||"undefined"==typeof e||null==t||null==e)return NaN;var n=0,r=t.toString(),i=e.toString();try{n+=r.split(".")[1].length}catch(a){}try{n+=i.split(".")[1].length}catch(a){}return Number(r.replace(".",""))*Number(i.replace(".",""))/Math.pow(10,n)},div:function(t,e){if("undefined"==typeof t||"undefined"==typeof e||null==t||null==e)return NaN;var n=1,r=1,i=0,a=0;try{i=t.toString().split(".")[1].length}catch(o){}try{a=e.toString().split(".")[1].length}catch(o){}return n=Number(t.toString().replace(".","")),r=Number(e.toString().replace(".","")),this.mul(n/r,Math.pow(10,a-i))}}},ff09:function(t,e,n){}});